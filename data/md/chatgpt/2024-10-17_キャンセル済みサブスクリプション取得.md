# ã‚­ãƒ£ãƒ³ã‚»ãƒ«æ¸ˆã¿ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³å–å¾—

Date: 2024-10-17

---

## ğŸ‘¤ User
*2024-10-17 11:21:46*

Swiftã§ã“ã‚Œã®é…åˆ—ã‹ã‚‰cancelAtãŒã‚ã‚‹ã‚‚ã®ã§ã€endAtãŒä¸€ç•ªå¤ã„æ—¥ã‚’å–å¾—ã—ãŸã„

struct Subscription: Sendable, Identifiable, Hashable {
    /// id
    let id: String
    /// `apple` or `stripe` or `corporate`
    let type: SubscriptionType
    /// é–‹å§‹æ—¥
    let startAt: Date
    /// çµ‚äº†æ—¥
    let endAt: Date
    /// ã‚­ãƒ£ãƒ³ã‚»ãƒ«æ—¥ (nil ã®å ´åˆã¯æœªã‚­ãƒ£ãƒ³ã‚»ãƒ«)
    let cancelAt: Date?
}

---

## ğŸ¤– Assistant
*2024-10-17 11:21:58*

`Subscription`ã®é…åˆ—ã‹ã‚‰`cancelAt`ãŒ`nil`ã§ã¯ãªã„ã‚‚ã®ã‚’ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã—ã¦ã€`endAt`ãŒæœ€ã‚‚å¤ã„ã‚‚ã®ã‚’å–å¾—ã™ã‚‹ãŸã‚ã«ã¯ã€æ¬¡ã®ã‚ˆã†ã«`filter`ã¨`min(by:)`ã‚’ä½¿ã£ã¦å®Ÿè£…ã§ãã¾ã™ã€‚

```swift
func getOldestCancelledSubscription(from subscriptions: [Subscription]) -> Subscription? {
    return subscriptions
        .filter { $0.cancelAt != nil } // cancelAtãŒã‚ã‚‹ã‚‚ã®ã‚’ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
        .min(by: { $0.endAt < $1.endAt }) // endAtãŒä¸€ç•ªå¤ã„ã‚‚ã®ã‚’å–å¾—
}
```

ã“ã®é–¢æ•°ã¯ã€ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã•ã‚ŒãŸã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ã®ä¸­ã‹ã‚‰`endAt`ãŒä¸€ç•ªå¤ã„ã‚‚ã®ã‚’è¿”ã—ã¾ã™ã€‚ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã•ã‚ŒãŸã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ãŒãªã„å ´åˆã€`nil`ã‚’è¿”ã—ã¾ã™ã€‚

---
