# New chat

æ—¥ä»˜: 2024-02-21

---

## ğŸ‘¤ ãƒ¦ãƒ¼ã‚¶ãƒ¼
*2024/2/21 15:53:19*

ã“ã‚Œã®ä½¿ã„æ–¹ã‚’æ•™ãˆã¦ã»ã—ã„

/// The testing tool which generates snapshot images from scenarios managed by `Playbook`.
public struct Snapshot: TestTool {
    /// A base directory for exporting snapshot image files.
    public var directory: URL

    /// Specifies whether that to clean directory before generating snapshots.
    public var clean: Bool

    /// An image file format of exported data.
    public var format: SnapshotSupport.ImageFormat

    /// A timeout interval until the finish snapshot of all scenarios.
    public var timeout: TimeInterval

    /// A rendering scale of the snapshot image.
    public var scale: CGFloat

    /// The key window of the application.
    public weak var keyWindow: UIWindow?

    /// A set of snapshot environment simulating devices.
    public var devices: [SnapshotDevice]

    /// A closure to preprocess scenario UIView before generating snapshot.
    public var viewPreprocessor: ((UIView) -&gt; UIView)?

    /// Creates a new snapshot tool for export all image files into specified directory.
    ///
    /// - Parameters:
    ///   - directory: A base directory for exporting snapshot image files.
    ///   - clean: Specifies whether to clean directory before generating snapshots.
    ///   - format: An image file format of exported data.
    ///   - timeout: A timeout interval until the finish snapshot of all scenarios.
    ///   - scale: A rendering scale of the snapshot image.
    ///   - keyWindow: The key window of the application.
    ///   - devices: A set of snapshot environment simulating devices.
    ///   - viewPreprocessor: A closure to preprocess scenario UIView before generating snapshot.
    public init(
        directory: URL,
        clean: Bool = false,
        format: SnapshotSupport.ImageFormat,
        timeout: TimeInterval = 600,
        scale: CGFloat = UIScreen.main.scale,
        keyWindow: UIWindow? = nil,
        devices: [SnapshotDevice],
        viewPreprocessor: ((UIView) -&gt; UIView)? = nil
    ) {
        self.directory = directory
        self.clean = clean
        self.format = format
        self.timeout = timeout
        self.scale = scale
        self.keyWindow = keyWindow
        self.devices = devices
        self.viewPreprocessor = viewPreprocessor
    }

---

## ğŸ¤– ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ
*2024/2/21 15:57:15*

ã“ã®ã‚³ãƒ¼ãƒ‰ã¯ã€iOSã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ†ã‚¹ãƒˆä¸­ã«ç‰¹å®šã®ã‚·ãƒŠãƒªã‚ªã®ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆï¼ˆã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆï¼‰ã‚’ç”Ÿæˆã™ã‚‹ãŸã‚ã®ãƒ„ãƒ¼ãƒ«ã‚’å®šç¾©ã—ã¦ã„ã¾ã™ã€‚ä¸»ã«UIãƒ†ã‚¹ãƒˆã®è‡ªå‹•åŒ–ã«å½¹ç«‹ã¡ã€ç•°ãªã‚‹ãƒ‡ãƒã‚¤ã‚¹ã‚„æ¡ä»¶ã§ã®ã‚¢ãƒ—ãƒªã®ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«è¡¨ç¾ã‚’ç¢ºèªã™ã‚‹ã®ã«ä½¿ã‚ã‚Œã¾ã™ã€‚å„ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã¨ãƒ¡ã‚½ãƒƒãƒ‰ã®æ¦‚è¦ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ï¼š

- `directory`: ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã™ã‚‹åŸºæœ¬ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®URLã€‚
- `clean`: ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆç”Ÿæˆå‰ã«ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ã™ã‚‹ã‹ã©ã†ã‹ã‚’æŒ‡å®šã—ã¾ã™ã€‚
- `format`: ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã•ã‚Œã‚‹ãƒ‡ãƒ¼ã‚¿ã®ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼ã€‚
- `timeout`: ã™ã¹ã¦ã®ã‚·ãƒŠãƒªã‚ªã®ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆã‚’çµ‚äº†ã™ã‚‹ã¾ã§ã®ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆé–“éš”ã€‚
- `scale`: ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆç”»åƒã®ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã‚¹ã‚±ãƒ¼ãƒ«ã€‚
- `keyWindow`: ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ã‚­ãƒ¼ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã€‚
- `devices`: ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆç’°å¢ƒã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆã™ã‚‹ãƒ‡ãƒã‚¤ã‚¹ã®ã‚»ãƒƒãƒˆã€‚
- `viewPreprocessor`: ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆç”Ÿæˆå‰ã«ã‚·ãƒŠãƒªã‚ªUIViewã‚’å‰å‡¦ç†ã™ã‚‹ãŸã‚ã®ã‚¯ãƒ­ãƒ¼ã‚¸ãƒ£ã€‚

`init`ãƒ¡ã‚½ãƒƒãƒ‰ã¯ã€ã“ã‚Œã‚‰ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å—ã‘å–ã‚Šã€æ–°ã—ã„ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆãƒ„ãƒ¼ãƒ«ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ä½œæˆã—ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€æŒ‡å®šã•ã‚ŒãŸãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã™ã¹ã¦ã®ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã™ã‚‹æº–å‚™ãŒæ•´ã„ã¾ã™ã€‚

### ä½¿ã„æ–¹ã®ä¾‹

1. **åˆæœŸè¨­å®š**: ã¾ãšã€ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã™ã‚‹ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆã®åŸºæœ¬ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã€ç”»åƒå½¢å¼ã€ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆé–“éš”ãªã©ã€å¿…è¦ãªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’è¨­å®šã—ã¦`Snapshot`ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’åˆæœŸåŒ–ã—ã¾ã™ã€‚

2. **ãƒ‡ãƒã‚¤ã‚¹ã®è¨­å®š**: ãƒ†ã‚¹ãƒˆã™ã‚‹ãƒ‡ãƒã‚¤ã‚¹ã‚„ç”»é¢ã‚µã‚¤ã‚ºã‚’`devices`é…åˆ—ã«è¿½åŠ ã—ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ç•°ãªã‚‹ãƒ‡ãƒã‚¤ã‚¹ã§ã®ã‚¢ãƒ—ãƒªã®è¦‹ãŸç›®ã‚’ç¢ºèªã§ãã¾ã™ã€‚

3. **ãƒ“ãƒ¥ãƒ¼ã®å‰å‡¦ç†**: å¿…è¦ã«å¿œã˜ã¦ã€`viewPreprocessor`ã‚¯ãƒ­ãƒ¼ã‚¸ãƒ£ã‚’ä½¿ç”¨ã—ã¦ã€ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆã‚’å–ã‚‹å‰ã«UIViewã®çŠ¶æ…‹ã‚’ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã§ãã¾ã™ã€‚ä¾‹ãˆã°ã€ãƒ†ã‚¹ãƒˆä¸­ã«ç‰¹å®šã®è¦ç´ ã‚’éè¡¨ç¤ºã«ã™ã‚‹ãªã©ã€‚

4. **ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆã®ç”Ÿæˆ**: è¨­å®šã—ãŸãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«åŸºã¥ã„ã¦ã€`Snapshot`ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã—ã¦ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®UIã‚·ãƒŠãƒªã‚ªã®ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆã‚’ç”Ÿæˆã—ã¾ã™ã€‚ã“ã‚Œã¯ã€ãƒ†ã‚¹ãƒˆã‚¹ã‚¤ãƒ¼ãƒˆã®ä¸€ç’°ã¨ã—ã¦è‡ªå‹•çš„ã«è¡Œã‚ã‚Œã‚‹ã“ã¨ãŒå¤šã„ã§ã™ã€‚

ã“ã®ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ã†ã“ã¨ã§ã€é–‹ç™ºè€…ã¯UIã®å¤‰æ›´ãŒç•°ãªã‚‹ãƒ‡ãƒã‚¤ã‚¹ã‚„æ¡ä»¶ä¸‹ã§äºˆæœŸã—ãŸé€šã‚Šã«è¡¨ç¤ºã•ã‚Œã‚‹ã‹ã©ã†ã‹ã‚’ç°¡å˜ã«ç¢ºèªã§ãã¾ã™ã€‚ã“ã‚Œã¯ã€UIã®å“è³ªã‚’ç¶­æŒã—ã¤ã¤ã€é–‹ç™ºãƒ—ãƒ­ã‚»ã‚¹ã‚’åŠ¹ç‡åŒ–ã™ã‚‹ã®ã«å½¹ç«‹ã¡ã¾ã™ã€‚

---
