# ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚¨ãƒ©ãƒ¼ä¿®æ­£

æ—¥ä»˜: 2024-12-13

---

## ğŸ‘¤ ãƒ¦ãƒ¼ã‚¶ãƒ¼
*2024/12/13 16:16:43*

loadingBuilder ã®ã¨ã“ã‚ã‚„ error ã®ã¨ã“ã‚ã®å®Ÿè£…ãŒé–“é•ã£ã¦ã„ã‚‹æ°—ãŒã™ã‚‹ã€‚
ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ä¸­ã®æç”»ãŒã§ãªã„ã‚“ã ã€‚

import 'package:flutter/material.dart';
import 'package:go\_router/go\_router.dart';
import 'package:snpit\_guild\_app/domain/screen.dart';
import 'package:snpit\_guild\_app/utils/extensions/uri\_extensions.dart';

class SpotListPage extends StatelessWidget {
  const SpotListPage({super.key});

  @override
  Widget build(BuildContext context) {
    final spotList = List.generate(
      12,
      (index) =&gt; {
        'imageUrl': UriExtensions.randomImageUrl.toString(),
        'label': String.fromCharCode(65 + index),
      },
    );

    return Scaffold(
      appBar: AppBar(
        automaticallyImplyLeading: false,
        title: const Text('Spot list'),
        actions: \[
          IconButton(
            icon: const Icon(Icons.close),
            onPressed: () {
              // ãƒœãƒˆãƒ ã‚·ãƒ¼ãƒˆå…¨ä½“ã‚’é–‰ã˜ã‚‹
              Navigator.of(context, rootNavigator: true).pop();
            },
          ),
        \],
      ),
      body: GridView.builder(
        padding: const EdgeInsets.all(16),
        gridDelegate: const SliverGridDelegateWithFixedCrossAxisCount(
          crossAxisCount: 3,
          crossAxisSpacing: 8,
          mainAxisSpacing: 8,
        ),
        itemCount: spotList.length,
        itemBuilder: (context, index) {
          final spot = spotList\[index\];
          final imageUrl = spot\['imageUrl'\]!;
          final label = spot\['label'\]!;

          return GestureDetector(
            onTap: () {
              context.push(Screen.spotDetail.path);
            },
            child: Stack(
              alignment: Alignment.bottomCenter,
              children: \[
                Container(
                  color: Colors.grey\[200\],
                  child: ClipRRect(
                    borderRadius: BorderRadius.circular(8),
                    child: Image.network(
                      imageUrl,
                      fit: BoxFit.cover,
                      width: double.infinity,
                      height: double.infinity,
                      loadingBuilder: (context, child, loadingProgress) {
                        if (loadingProgress == null) {
                          return child;
                        }
                        return const Center(
                          child: CircularProgressIndicator(),
                        );
                      },
                      errorBuilder: (context, error, stackTrace) {
                        return const Center(
                          child: Icon(Icons.error, color: Colors.red),
                        );
                      },
                    ),
                  ),
                ),
                Positioned(
                  top: 8,
                  left: 8,
                  child: Container(
                    padding:
                        const EdgeInsets.symmetric(horizontal: 8, vertical: 4),
                    decoration: BoxDecoration(
                      color: Colors.black.withOpacity(0.5),
                      borderRadius: BorderRadius.circular(4),
                    ),
                    child: Text(
                      label,
                      style: const TextStyle(color: Colors.white, fontSize: 12),
                    ),
                  ),
                ),
              \],
            ),
          );
        },
      ),
    );
  }
}

---

## ğŸ¤– ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ
*2024/12/13 16:17:01*

`loadingBuilder` ã‚„ `errorBuilder` ã®å®Ÿè£…ã¯ä¸€è¦‹æ­£ã—ãè¦‹ãˆã¾ã™ãŒã€ä»¥ä¸‹ã®ç‚¹ã‚’ç¢ºèªã™ã‚‹ã“ã¨ã§å•é¡ŒãŒè§£æ¶ˆã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚

### 1. **ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ä¸­ã®æç”»ãŒå‡ºãªã„ç†ç”±**
- **ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çŠ¶æ…‹ã®æ¤œå‡º**  
  `loadingBuilder` å†…ã§ `loadingProgress` ã‚’é©åˆ‡ã«å‡¦ç†ã—ã¦ã„ã‚‹ã‹ç¢ºèªã—ã¾ã™ã€‚`loadingProgress` ãŒ `null` ã®å ´åˆã¯ç”»åƒã®èª­ã¿è¾¼ã¿ãŒå®Œäº†ã—ã¦ã„ã‚‹ãŸã‚ã€`CircularProgressIndicator` ãŒè¡¨ç¤ºã•ã‚Œã¾ã›ã‚“ã€‚

- **ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®å•é¡Œ**  
  `UriExtensions.randomImageUrl` ãŒæ­£ã—ã„ URL ã‚’è¿”ã—ã¦ã„ã‚‹ã‹ç¢ºèªã—ã¦ãã ã•ã„ã€‚ä¸æ­£ãª URL ã‚’ç”Ÿæˆã—ã¦ã„ã‚‹å ´åˆã€`loadingBuilder` ã¯å‘¼ã³å‡ºã•ã‚Œãšã«ç›´æ¥ `errorBuilder` ã«é£›ã¶å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚

### ä¿®æ­£ä¾‹
ä»¥ä¸‹ã®ã‚ˆã†ã« `loadingBuilder` ã‚’æ”¹å–„ã—ã¾ã™ã€‚`loadingProgress` ã® `expectedTotalBytes` ã‚„ `cumulativeBytesLoaded` ã‚’ä½¿ç”¨ã—ã¦ã€é€²æ—çŠ¶æ³ã«åŸºã¥ããƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚° UI ã‚’è¡¨ç¤ºã§ãã¾ã™ã€‚

```dart
loadingBuilder: (context, child, loadingProgress) {
  if (loadingProgress == null) {
    return child;
  }
  return Center(
    child: CircularProgressIndicator(
      value: loadingProgress.expectedTotalBytes != null
          ? loadingProgress.cumulativeBytesLoaded /
              (loadingProgress.expectedTotalBytes ?? 1)
          : null,
    ),
  );
},
```

### 2. **ã‚¨ãƒ©ãƒ¼æç”»ã®å•é¡Œ**
- `errorBuilder` ã¯é€šå¸¸æ­£ã—ãå‹•ä½œã—ã¾ã™ãŒã€ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã™ã‚‹å ´åˆã¯ `error` ã¨ `stackTrace` ã‚’ãƒ‡ãƒãƒƒã‚°ã«å½¹ç«‹ã¦ã‚‰ã‚Œã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚

```dart
errorBuilder: (context, error, stackTrace) {
  debugPrint('Image loading error: $error');
  return const Center(
    child: Icon(Icons.error, color: Colors.red),
  );
},
```

### 3. **`UriExtensions.randomImageUrl` ã®å‹•ä½œç¢ºèª**
`UriExtensions.randomImageUrl` ãŒæ­£ã—ã„ç”»åƒ URL ã‚’ç”Ÿæˆã—ã¦ã„ã‚‹ã‹ç¢ºèªã—ã¦ãã ã•ã„ã€‚`toString()` ã®å‘¼ã³å‡ºã—ã«å•é¡ŒãŒã‚ã‚‹å ´åˆã€ä»¥ä¸‹ã®ã‚ˆã†ã«ãƒ‡ãƒãƒƒã‚°ã—ã¦ç¢ºèªã—ã¾ã™ã€‚

```dart
final imageUrl = UriExtensions.randomImageUrl.toString();
debugPrint('Generated imageUrl: $imageUrl');
```

### 4. **ç”»åƒã‚µã‚¤ã‚ºã®æŒ‡å®š**
`Image.network` ã‚’ä½¿ç”¨ã™ã‚‹å ´åˆã€`width` ã¨ `height` ãŒè¦ªã‚³ãƒ³ãƒ†ãƒŠã«ä¾å­˜ã™ã‚‹ãŸã‚ã€`double.infinity` ãŒæ­£ã—ãè§£é‡ˆã•ã‚Œã¦ã„ãªã„å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚`BoxConstraints` ã‚’ç¢ºèªã—ã€ã‚µã‚¤ã‚ºãŒæ„å›³é€šã‚Šã‹ç¢ºã‹ã‚ã¾ã™ã€‚

ä¿®æ­£å¾Œã®å‹•ä½œã‚’ç¢ºèªã—ã¦ã€å•é¡ŒãŒè§£æ¶ˆã•ã‚Œã‚‹ã‹è©¦ã—ã¦ãã ã•ã„ã€‚ãã‚Œã§ã‚‚è§£æ±ºã—ãªã„å ´åˆã€ç”Ÿæˆã•ã‚Œã‚‹ç”»åƒ URL ã‚„ãƒ‡ãƒãƒƒã‚°ãƒ­ã‚°ã‚’å…ƒã«ã•ã‚‰ã«èª¿æŸ»ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

---
