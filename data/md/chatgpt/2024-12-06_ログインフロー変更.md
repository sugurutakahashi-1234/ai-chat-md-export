# ログインフロー変更

日付: 2024-12-06

---

## 👤 ユーザー
*2024/12/6 15:40:53*

以下に login\_validate\_page を加えてlogin\_page -&gt; login\_validate\_page -&gt; tab\_page にしてほしい

import 'package:go\_router/go\_router.dart';
import 'pages/login\_page.dart';
import 'pages/tab\_page.dart';
import 'pages/map\_page.dart';
import 'pages/guild\_page.dart';

final GoRouter router = GoRouter(
  initialLocation: '/login',
  routes: \[
    // ログインページ
    GoRoute(
      path: '/login',
      builder: (context, state) =&gt; const LoginPage(),
    ),
    // タブページ
    StatefulShellRoute.indexedStack(
      builder: (context, state, navigationShell) =&gt; TabPage(navigationShell: navigationShell),
      branches: \[
        StatefulShellBranch(
          routes: \[
            GoRoute(
              path: '/map',
              builder: (context, state) =&gt; const MapPage(),
            ),
          \],
        ),
        StatefulShellBranch(
          routes: \[
            GoRoute(
              path: '/guild',
              builder: (context, state) =&gt; const GuildPage(),
            ),
          \],
        ),
      \],
    ),
  \],
);

import 'package:flutter/material.dart';
import 'package:go\_router/go\_router.dart';

class LoginPage extends StatelessWidget {
  const LoginPage({super.key});

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(title: const Text('Login')),
      body: Center(
        child: ElevatedButton(
          onPressed: () {
            // ログイン成功後、タブページへ遷移
            context.go('/map');
          },
          child: const Text('Login'),
        ),
      ),
    );
  }
}

---

## 🤖 アシスタント
*2024/12/6 15:41:07*

以下のように `login_validate_page` を追加し、ルート構成を `login_page -> login_validate_page -> tab_page` に変更します。

```dart
import 'package:go_router/go_router.dart';
import 'pages/login_page.dart';
import 'pages/login_validate_page.dart';
import 'pages/tab_page.dart';
import 'pages/map_page.dart';
import 'pages/guild_page.dart';

final GoRouter router = GoRouter(
  initialLocation: '/login',
  routes: [
    // ログインページ
    GoRoute(
      path: '/login',
      builder: (context, state) => const LoginPage(),
    ),
    // ログインバリデートページ
    GoRoute(
      path: '/login_validate',
      builder: (context, state) => const LoginValidatePage(),
    ),
    // タブページ
    StatefulShellRoute.indexedStack(
      builder: (context, state, navigationShell) => TabPage(navigationShell: navigationShell),
      branches: [
        StatefulShellBranch(
          routes: [
            GoRoute(
              path: '/map',
              builder: (context, state) => const MapPage(),
            ),
          ],
        ),
        StatefulShellBranch(
          routes: [
            GoRoute(
              path: '/guild',
              builder: (context, state) => const GuildPage(),
            ),
          ],
        ),
      ],
    ),
  ],
);
```

`LoginPage` から `LoginValidatePage` へ遷移するために `LoginPage` を更新します：

```dart
import 'package:flutter/material.dart';
import 'package:go_router/go_router.dart';

class LoginPage extends StatelessWidget {
  const LoginPage({super.key});

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(title: const Text('Login')),
      body: Center(
        child: ElevatedButton(
          onPressed: () {
            // ログイン成功後、バリデーションページへ遷移
            context.go('/login_validate');
          },
          child: const Text('Login'),
        ),
      ),
    );
  }
}
```

新しい `LoginValidatePage` のコードを追加します：

```dart
import 'package:flutter/material.dart';
import 'package:go_router/go_router.dart';

class LoginValidatePage extends StatelessWidget {
  const LoginValidatePage({super.key});

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(title: const Text('Login Validation')),
      body: Center(
        child: ElevatedButton(
          onPressed: () {
            // バリデーション成功後、タブページへ遷移
            context.go('/map');
          },
          child: const Text('Validate'),
        ),
      ),
    );
  }
}
```

この変更により、`login_page -> login_validate_page -> tab_page` の順に遷移するようになります。

---
