# API初回取得とページング

Date: 2024-09-26

---

## 👤 User
*2024-09-26 15:31:33*

データ取得APIで初回取得とページング取得でインターフェスを分けたい

---

## 🤖 Assistant
*2024-09-26 15:31:46*

初回取得とページング取得のためにインターフェースを分ける場合、それぞれに応じた専用のプロトコルを定義することで、柔軟かつ明確な設計が可能です。以下はその例です。

### 1. 初回取得のインターフェース
初回取得は最初のデータセットを取得するためのもので、通常ページ情報は必要ありません。

```swift
protocol InitialFetchUseCase {
    func fetchInitialData() async throws -> [YourDataModel]
}
```

### 2. ページング取得のインターフェース
ページング取得では、ページ情報やカーソルを扱う必要があります。

```swift
protocol PagingFetchUseCase {
    func fetchPagedData(cursor: String?) async throws -> (data: [YourDataModel], nextCursor: String?)
}
```

### 3. 使い分け
`ViewModel`や`Controller`で初回取得とページング取得を明確に分けて使用することが可能です。例えば、初回取得では`InitialFetchUseCase`のみを呼び出し、ページング取得時は`PagingFetchUseCase`を呼び出します。

```swift
class YourViewModel {
    private let initialFetchUseCase: InitialFetchUseCase
    private let pagingFetchUseCase: PagingFetchUseCase
    private var currentCursor: String?
    
    init(initialFetchUseCase: InitialFetchUseCase, pagingFetchUseCase: PagingFetchUseCase) {
        self.initialFetchUseCase = initialFetchUseCase
        self.pagingFetchUseCase = pagingFetchUseCase
    }

    func loadInitialData() async {
        do {
            let data = try await initialFetchUseCase.fetchInitialData()
            // 初回データの処理
        } catch {
            // エラーハンドリング
        }
    }

    func loadMoreData() async {
        do {
            let result = try await pagingFetchUseCase.fetchPagedData(cursor: currentCursor)
            currentCursor = result.nextCursor
            // ページングデータの処理
        } catch {
            // エラーハンドリング
        }
    }
}
```

この設計により、初回取得とページング取得を明確に分離し、責任を適切に管理できます。

---
