# APIåˆå›å–å¾—ã¨ãƒšãƒ¼ã‚¸ãƒ³ã‚°

Date: 2024-09-26

---

## ğŸ‘¤ User
*2024-09-26 15:31:33*

ãƒ‡ãƒ¼ã‚¿å–å¾—APIã§åˆå›å–å¾—ã¨ãƒšãƒ¼ã‚¸ãƒ³ã‚°å–å¾—ã§ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¹ã‚’åˆ†ã‘ãŸã„

---

## ğŸ¤– Assistant
*2024-09-26 15:31:46*

åˆå›å–å¾—ã¨ãƒšãƒ¼ã‚¸ãƒ³ã‚°å–å¾—ã®ãŸã‚ã«ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’åˆ†ã‘ã‚‹å ´åˆã€ãã‚Œãã‚Œã«å¿œã˜ãŸå°‚ç”¨ã®ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚’å®šç¾©ã™ã‚‹ã“ã¨ã§ã€æŸ”è»Ÿã‹ã¤æ˜ç¢ºãªè¨­è¨ˆãŒå¯èƒ½ã§ã™ã€‚ä»¥ä¸‹ã¯ãã®ä¾‹ã§ã™ã€‚

### 1. åˆå›å–å¾—ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
åˆå›å–å¾—ã¯æœ€åˆã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’å–å¾—ã™ã‚‹ãŸã‚ã®ã‚‚ã®ã§ã€é€šå¸¸ãƒšãƒ¼ã‚¸æƒ…å ±ã¯å¿…è¦ã‚ã‚Šã¾ã›ã‚“ã€‚

```swift
protocol InitialFetchUseCase {
    func fetchInitialData() async throws -> [YourDataModel]
}
```

### 2. ãƒšãƒ¼ã‚¸ãƒ³ã‚°å–å¾—ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
ãƒšãƒ¼ã‚¸ãƒ³ã‚°å–å¾—ã§ã¯ã€ãƒšãƒ¼ã‚¸æƒ…å ±ã‚„ã‚«ãƒ¼ã‚½ãƒ«ã‚’æ‰±ã†å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

```swift
protocol PagingFetchUseCase {
    func fetchPagedData(cursor: String?) async throws -> (data: [YourDataModel], nextCursor: String?)
}
```

### 3. ä½¿ã„åˆ†ã‘
`ViewModel`ã‚„`Controller`ã§åˆå›å–å¾—ã¨ãƒšãƒ¼ã‚¸ãƒ³ã‚°å–å¾—ã‚’æ˜ç¢ºã«åˆ†ã‘ã¦ä½¿ç”¨ã™ã‚‹ã“ã¨ãŒå¯èƒ½ã§ã™ã€‚ä¾‹ãˆã°ã€åˆå›å–å¾—ã§ã¯`InitialFetchUseCase`ã®ã¿ã‚’å‘¼ã³å‡ºã—ã€ãƒšãƒ¼ã‚¸ãƒ³ã‚°å–å¾—æ™‚ã¯`PagingFetchUseCase`ã‚’å‘¼ã³å‡ºã—ã¾ã™ã€‚

```swift
class YourViewModel {
    private let initialFetchUseCase: InitialFetchUseCase
    private let pagingFetchUseCase: PagingFetchUseCase
    private var currentCursor: String?
    
    init(initialFetchUseCase: InitialFetchUseCase, pagingFetchUseCase: PagingFetchUseCase) {
        self.initialFetchUseCase = initialFetchUseCase
        self.pagingFetchUseCase = pagingFetchUseCase
    }

    func loadInitialData() async {
        do {
            let data = try await initialFetchUseCase.fetchInitialData()
            // åˆå›ãƒ‡ãƒ¼ã‚¿ã®å‡¦ç†
        } catch {
            // ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
        }
    }

    func loadMoreData() async {
        do {
            let result = try await pagingFetchUseCase.fetchPagedData(cursor: currentCursor)
            currentCursor = result.nextCursor
            // ãƒšãƒ¼ã‚¸ãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿ã®å‡¦ç†
        } catch {
            // ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
        }
    }
}
```

ã“ã®è¨­è¨ˆã«ã‚ˆã‚Šã€åˆå›å–å¾—ã¨ãƒšãƒ¼ã‚¸ãƒ³ã‚°å–å¾—ã‚’æ˜ç¢ºã«åˆ†é›¢ã—ã€è²¬ä»»ã‚’é©åˆ‡ã«ç®¡ç†ã§ãã¾ã™ã€‚

---
