# User情報の渡し方

日付: 2024-12-06

---

## 👤 ユーザー
*2024/12/6 18:38:49*

userを取り回して、user.nameをmap画面に表示したい

import 'package:flutter/material.dart';
import 'package:go\_router/go\_router.dart';
import 'package:openapi/openapi.dart';

class LoginPage extends StatelessWidget {
  const LoginPage({super.key});

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(title: const Text('Login')),
      body: Center(
        child: ElevatedButton(
          onPressed: () {
            // ログイン成功後、タブページへ遷移
            context.go('/map');
          },
          child: const Text('Login'),
        ),
      ),
    );
  }

  Future&lt;User&gt; fetchRandomUser() async {
    final api = Openapi().getDefaultApi();
    try {
      final response = await api.getUsers();
      if (response.data == null) {
        throw Exception('Response data is null.');
      }

      final users = response.data!.toList();
      if (users.isEmpty) {
        throw Exception('No users available.');
      }

      users.shuffle();
      return users.first;
    } catch (e, stackTrace) {
      debugPrint('Error fetching users: $e');
      debugPrint('Stack trace: $stackTrace');
      rethrow;
    }
  }
}

import 'package:flutter/material.dart';

class MapPage extends StatelessWidget {
  const MapPage({super.key});

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(title: const Text('Map')),
      body: const Center(child: Text('Map Page Content')),
    );
  }
}

---

## 🤖 アシスタント
*2024/12/6 18:39:01*

`user`を取り回して`user.name`を`MapPage`に表示するには、Flutterの状態管理を活用する方法が便利です。ここでは、`GoRouter`の`GoRouterState`を活用してユーザー情報を渡す方法を例に解説します。

以下の手順で実装します：

### 1. ログイン成功時に`user`を渡す
`fetchRandomUser`で取得した`user`を`context.go`にパラメータとして渡します。

### 2. ルート定義を更新
`GoRouter`で`MapPage`に`user`を渡すための仕組みを追加します。

### 3. `MapPage`で`user.name`を表示
`GoRouter`から渡された`user`を受け取り、画面に表示します。

以下は、コード全体の例です：

#### ルート設定
```dart
import 'package:flutter/material.dart';
import 'package:go_router/go_router.dart';
import 'package:openapi/openapi.dart';

void main() {
  runApp(MyApp());
}

class MyApp extends StatelessWidget {
  final GoRouter _router = GoRouter(
    routes: [
      GoRoute(
        path: '/',

---
