# ãƒ­ã‚°å‡ºåŠ›ã®æ”¹å–„

Date: 2023-06-15

---

## ğŸ‘¤ User
*2023-06-16 01:55:52*

configurationã‚¨ãƒ©ãƒ¼ã®ã‚ˆã†ã«ä»–ã®ã‚‚ã®ã‚‚ã‚¨ãƒ©ãƒ¼å†…å®¹ã‚’å‡ºåŠ›ã™ã‚‹ã‚ˆã†ã«ã—ã¦

public func signIn(emailAddress: LoginForm.EmailAddress, password: LoginForm.Password) async throws {
        do {
            let authSignInResult = try await Amplify.Auth.signIn(username: emailAddress.value, password: password.value)
            AppLogger.debugLog("Sign in succeeded with result: \(authSignInResult)", category: .network)
        } catch let error as AuthError {
            switch error {
            case .configuration(let errorDescription, let recoverySuggestion, let error):
                AppLogger.debugLog("Sign in failed configuration: \(errorDescription), \(recoverySuggestion), \(String(describing: error))", category: .network, level: .error)
            case .service(_, _, _):
                AppLogger.debugLog("Sign in failed \(error)", category: .network, level: .error)
            case .unknown(_, _):
                AppLogger.debugLog("Sign in failed \(error)", category: .network, level: .error)
            case .validation(_, _, _, _):
                AppLogger.debugLog("Sign in failed \(error)", category: .network, level: .error)
            case .notAuthorized(_, _, _):
                AppLogger.debugLog("Sign in failed \(error)", category: .network, level: .error)
            case .invalidState(_, _, _):
                AppLogger.debugLog("Sign in failed \(error)", category: .network, level: .error)
            case .signedOut(_, _, _):
                AppLogger.debugLog("Sign in failed \(error)", category: .network, level: .error)
            case .sessionExpired(_, _, _):
                AppLogger.debugLog("Sign in failed \(error)", category: .network, level: .error)
            }
            throw error
        } catch {
            AppLogger.debugLog("Unexpected error: \(error)", category: .network, level: .error)
            throw error
        }
    }

---

## ğŸ¤– Assistant
*2023-06-16 01:56:56*

æ—¢å­˜ã®ã‚³ãƒ¼ãƒ‰ã§ãƒ­ã‚°å‡ºåŠ›éƒ¨åˆ†ã‚’å¤‰æ›´ã™ã‚‹ã¨ã€å…·ä½“çš„ãªã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ãƒ­ã‚°ã«å«ã‚ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ãã‚Œãã‚Œã®ã‚¨ãƒ©ãƒ¼ã‚±ãƒ¼ã‚¹ã§ã®èª¬æ˜ã€å›å¾©ã®ææ¡ˆã€ã‚¨ãƒ©ãƒ¼ã®åŸå› ã‚’å‡ºåŠ›ã™ã‚‹ã‚ˆã†ã«å¤‰æ›´ã—ã¾ã™ã€‚ä»¥ä¸‹ã®ã‚ˆã†ã«ã‚³ãƒ¼ãƒ‰ã‚’ä¿®æ­£ã—ã¦ã¿ã¦ãã ã•ã„ã€‚

```swift
public func signIn(emailAddress: LoginForm.EmailAddress, password: LoginForm.Password) async throws {
    do {
        let authSignInResult = try await Amplify.Auth.signIn(username: emailAddress.value, password: password.value)
        AppLogger.debugLog("Sign in succeeded with result: \(authSignInResult)", category: .network)
    } catch let error as AuthError {
        switch error {
        case .configuration(let errorDescription, let recoverySuggestion, let error):
            AppLogger.debugLog("Sign in failed configuration: \(errorDescription), \(recoverySuggestion), \(String(describing: error))", category: .network, level: .error)
        case .service(let errorDescription, let recoverySuggestion, let error):
            AppLogger.debugLog("Sign in failed service: \(errorDescription), \(recoverySuggestion), \(String(describing: error))", category: .network, level: .error)
        case .unknown(let errorDescription, let recoverySuggestion, let error):
            AppLogger.debugLog("Sign in failed unknown: \(errorDescription), \(recoverySuggestion), \(String(describing: error))", category: .network, level: .error)
        case .validation(let errorDescription, let recoverySuggestion, let error):
            AppLogger.debugLog("Sign in failed validation: \(errorDescription), \(recoverySuggestion), \(String(describing: error))", category: .network, level: .error)
        case .notAuthorized(let errorDescription, let recoverySuggestion, let error):
            AppLogger.debugLog("Sign in failed notAuthorized: \(errorDescription), \(recoverySuggestion), \(String(describing: error))", category: .network, level: .error)
        case .invalidState(let errorDescription, let recoverySuggestion, let error):
            AppLogger.debugLog("Sign in failed invalidState: \(errorDescription), \(recoverySuggestion), \(String(describing: error))", category: .network, level: .error)
        case .signedOut(let errorDescription, let recoverySuggestion, let error):
            AppLogger.debugLog("Sign in failed signedOut: \(errorDescription), \(recoverySuggestion), \(String(describing: error))", category: .network, level: .error)
        case .sessionExpired(let errorDescription, let recoverySuggestion, let error):
            AppLogger.debugLog("Sign in failed sessionExpired: \(errorDescription), \(recoverySuggestion), \(String(describing: error))", category: .network, level: .error)
        }
        throw error
    } catch {
        AppLogger.debugLog("Unexpected error: \(error)", category: .network, level: .error)
        throw error
    }
}
```

ãŸã ã—ã€ä¸Šè¨˜ã®ã‚³ãƒ¼ãƒ‰ã¯AuthErrorã®å„ã‚±ãƒ¼ã‚¹ãŒerrorDescription, recoverySuggestion, errorã¨ã„ã†3ã¤ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’æŒã¤ã¨ä»®å®šã—ã¦ã„ã¾ã™ã€‚å®Ÿéš›ã®AuthErrorã®å®šç¾©ã«ã‚ˆã£ã¦ã¯ã€ã“ã‚Œã‚‰ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒå­˜åœ¨ã—ãªã„ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚ãã®å ´åˆã¯é©å®œã‚³ãƒ¼ãƒ‰ã‚’ä¿®æ­£ã—ã¦ãã ã•ã„ã€‚

---

## ğŸ‘¤ User
*2023-06-16 01:58:12*

ã”ã‚ã‚“ä»¥ä¸‹ã®å®šç¾©ã«ã‚ã‚ã›ã¦ã—ã‚…ã†ã›ã„ã—ã¦ã»ã—ã„

public enum AuthError {

    /// Caused by issue in the way auth category is configured
    case configuration(ErrorDescription, RecoverySuggestion, Error? = nil)

    /// Caused by some error in the underlying service. Check the associated error for more details.
    case service(ErrorDescription, RecoverySuggestion, Error? = nil)

    /// Caused by an unknown reason
    case unknown(ErrorDescription, Error? = nil)

    /// Caused when one of the input field is invalid
    case validation(Field, ErrorDescription, RecoverySuggestion, Error? = nil)

    /// Caused when the current session is not authorized to perform an operation
    case notAuthorized(ErrorDescription, RecoverySuggestion, Error? = nil)

    /// Caused when an operation is not valid with the current state of Auth category
    case invalidState(ErrorDescription, RecoverySuggestion, Error? = nil)

    /// Caused when an operation needs the user to be in signedIn state
    case signedOut(ErrorDescription, RecoverySuggestion, Error? = nil)

    /// Caused when a session is expired and needs the user to be re-authenticated
    case sessionExpired(ErrorDescription, RecoverySuggestion, Error? = nil)
}

---

## ğŸ¤– Assistant
*2023-06-16 01:59:17*

AuthErrorã®å„ã‚±ãƒ¼ã‚¹ã®å®šç¾©ã«å¾“ã£ã¦ã€ã‚¨ãƒ©ãƒ¼ã®è©³ç´°ã‚’ãƒ­ã‚°ã«å‡ºåŠ›ã™ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’ä¿®æ­£ã—ã¾ã™ã€‚ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã‚’ã”è¦§ãã ã•ã„ã€‚

```swift
public func signIn(emailAddress: LoginForm.EmailAddress, password: LoginForm.Password) async throws {
    do {
        let authSignInResult = try await Amplify.Auth.signIn(username: emailAddress.value, password: password.value)
        AppLogger.debugLog("Sign in succeeded with result: \(authSignInResult)", category: .network)
    } catch let error as AuthError {
        switch error {
        case .configuration(let errorDescription, let recoverySuggestion, let error):
            AppLogger.debugLog("Sign in failed configuration: \(errorDescription), \(recoverySuggestion), \(String(describing: error))", category: .network, level: .error)
        case .service(let errorDescription, let recoverySuggestion, let error):
            AppLogger.debugLog("Sign in failed service: \(errorDescription), \(recoverySuggestion), \(String(describing: error))", category: .network, level: .error)
        case .unknown(let errorDescription, let error):
            AppLogger.debugLog("Sign in failed unknown: \(errorDescription), \(String(describing: error))", category: .network, level: .error)
        case .validation(let field, let errorDescription, let recoverySuggestion, let error):
            AppLogger.debugLog("Sign in failed validation on \(field): \(errorDescription), \(recoverySuggestion), \(String(describing: error))", category: .network, level: .error)
        case .notAuthorized(let errorDescription, let recoverySuggestion, let error):
            AppLogger.debugLog("Sign in failed notAuthorized: \(errorDescription), \(recoverySuggestion), \(String(describing: error))", category: .network, level: .error)
        case .invalidState(let errorDescription, let recoverySuggestion, let error):
            AppLogger.debugLog("Sign in failed invalidState: \(errorDescription), \(recoverySuggestion), \(String(describing: error))", category: .network, level: .error)
        case .signedOut(let errorDescription, let recoverySuggestion, let error):
            AppLogger.debugLog("Sign in failed signedOut: \(errorDescription), \(recoverySuggestion), \(String(describing: error))", category: .network, level: .error)
        case .sessionExpired(let errorDescription, let recoverySuggestion, let error):
            AppLogger.debugLog("Sign in failed sessionExpired: \(errorDescription), \(recoverySuggestion), \(String(describing: error))", category: .network, level: .error)
        }
        throw error
    } catch {
        AppLogger.debugLog("Unexpected error: \(error)", category: .network, level: .error)
        throw error
    }
}
```
ã“ã‚Œã«ã‚ˆã‚Šã€ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸå ´åˆã«ã‚¨ãƒ©ãƒ¼ã®ç¨®é¡ã€èª¬æ˜ã€å›å¾©ææ¡ˆã€ãŠã‚ˆã³ã‚¨ãƒ©ãƒ¼ã®è©³ç´°ãŒãƒ­ã‚°ã«å‡ºåŠ›ã•ã‚Œã¾ã™ã€‚ãŸã ã—ã€ä¸Šè¨˜ã®ã‚³ãƒ¼ãƒ‰ã¯`validation`ã®å ´åˆã§`field`ãŒ`CustomStringConvertible`ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚’æº–æ‹ ã—ã¦ã„ã‚‹ã“ã¨ã‚’å‰æã¨ã—ã¦ã„ã¾ã™ã€‚ã‚‚ã—æº–æ‹ ã—ã¦ã„ãªã„å ´åˆã¯ã€é©åˆ‡ã«ã‚¨ãƒ©ãƒ¼æƒ…å ±ã‚’å‡ºåŠ›ã™ã‚‹ãŸã‚ã«ã‚³ãƒ¼ãƒ‰ã‚’ä¿®æ­£ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

---

## ğŸ‘¤ User
*2023-06-16 02:04:45*

ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¨ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã®çµ„ã¿åˆã‚ã›ãŒé–“é•ã£ã¦ã„ã‚‹å ´åˆã®ã‚¨ãƒ©ãƒ¼å®šç¾©ã‚’è¿½åŠ ã—ã¦ã€‚å‘½åã‚’è¿·ã£ã¦ã„ã‚‹

public enum AppAuthError: Error {
    case unexpectedError
}

---

## ğŸ¤– Assistant
*2023-06-16 02:05:07*

ã‚¨ãƒ©ãƒ¼ã®ç¨®é¡ã‚’è¡¨ç¾ã™ã‚‹ãŸã‚ã«ã€ã‚¨ãƒ©ãƒ¼å®šç¾©ã«æ–°ãŸãªã‚±ãƒ¼ã‚¹ã‚’è¿½åŠ ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚å…·ä½“çš„ãªã‚¨ãƒ©ãƒ¼å†…å®¹ã‚’è¡¨ã™ãŸã‚ã®åå‰ã«ã¤ã„ã¦ã¯ã€`invalidCredentials`ã‚„`wrongCredentials`ã¨ã„ã£ãŸã‚‚ã®ãŒè€ƒãˆã‚‰ã‚Œã¾ã™ã€‚ã“ã‚Œã‚‰ã®åå‰ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæä¾›ã—ãŸãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã®çµ„ã¿åˆã‚ã›ãŒç„¡åŠ¹ã§ã‚ã‚‹ã“ã¨ã‚’æ˜ç¢ºã«è¡¨ç¾ã—ã¦ã„ã¾ã™ã€‚ä»¥ä¸‹ã®ã‚ˆã†ã«å®šç¾©ã™ã‚‹ã¨è‰¯ã„ã§ã—ã‚‡ã†ï¼š

```swift
public enum AppAuthError: Error {
    case unexpectedError
    case invalidCredentials
}
```

ã“ã®æ–°ãŸãªã‚¨ãƒ©ãƒ¼å®šç¾©ã‚’signInãƒ¡ã‚½ãƒƒãƒ‰ã§åˆ©ç”¨ã™ã‚‹å ´åˆã€ãƒ¡ã‚½ãƒƒãƒ‰å†…ã§é©åˆ‡ãªæ¡ä»¶ã‚’ãƒã‚§ãƒƒã‚¯ã—ã€ç„¡åŠ¹ãªã‚¯ãƒ¬ãƒ‡ãƒ³ã‚·ãƒ£ãƒ«ãŒæä¾›ã•ã‚ŒãŸå ´åˆã«ã“ã®ã‚¨ãƒ©ãƒ¼ã‚’ã‚¹ãƒ­ãƒ¼ã™ã‚‹ã‚ˆã†ã«ã‚³ãƒ¼ãƒ‰ã‚’ä¿®æ­£ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

---
