# SwiftUI 角丸設定方法

日付: 2024-09-26

---

## 👤 ユーザー
*2024/09/26 10:03:47*

.clipShape(.rect(cornerRadius: をbottomだけに設定したｑ

---

## 🤖 アシスタント
*2024/09/26 10:03:58*

SwiftUIの`clipShape`では、直接四隅のうち特定の角だけに角丸を設定することはできません。しかし、`clipShape`にカスタムの`RoundedCorner`構造体を使用することで、特定の角（例えば、下側だけ）に角丸を適用することが可能です。以下のように実装できます。

まず、`RoundedCorner`というカスタムシェイプを作成します。

```swift
import SwiftUI

struct RoundedCorner: Shape {
    var radius: CGFloat = .infinity
    var corners: UIRectCorner = .allCorners

    func path(in rect: CGRect) -> Path {
        let path = UIBezierPath(roundedRect: rect, byRoundingCorners: corners, cornerRadii: CGSize(width: radius, height: radius))
        return Path(path.cgPath)
    }
}
```

次に、このカスタムシェイプを使用して、例えば下側の角だけに角丸を設定できます。

```swift
struct ContentView: View {
    var body: some View {
        Rectangle()
            .fill(Color.blue)
            .frame(width: 200, height: 100)
            .clipShape(RoundedCorner(radius: 20, corners: [.bottomLeft, .bottomRight]))
    }
}
```

これで、下側の角だけに角丸を適用することができます。このような方法で柔軟に角丸の適用範囲を調整できます。

---

## 👤 ユーザー
*2024/09/26 10:06:52*

もっと特定の簡単に四隅のどれかを選択して丸くする方法はないのか？

---

## 🤖 アシスタント
*2024/09/26 10:07:03*

現時点では、SwiftUIの標準機能として、簡単に特定の角だけを丸くする直接的なAPIは提供されていませんが、シンプルな方法として、`mask`を使うことで特定の角だけに角丸を適用することができます。以下のように特定の角を丸くするための方法を紹介します。

SwiftUIでは`mask`を使って、カスタムシェイプのマスクをビューに適用できます。これにより、`clipShape`よりも柔軟に角丸を設定することが可能です。シンプルな方法で四隅のどれかを選択して丸くする例を紹介します。

### シンプルな実装例：

```swift
import SwiftUI

struct ContentView: View {
    var body: some View {
        Rectangle()
            .fill(Color.blue)
            .frame(width: 200, height: 100)
            .cornerRadius(20, corners: [.bottomLeft, .bottomRight]) // 下だけ角丸
    }
}

struct RoundedCorner: Shape {
    var radius: CGFloat = .infinity
    var corners: UIRectCorner = .allCorners

    func path(in rect: CGRect) -> Path {
        let path = UIBezierPath(roundedRect: rect, byRoundingCorners: corners, cornerRadii: CGSize(width: radius, height: radius))
        return Path(path.cgPath)
    }
}

extension View {
    func cornerRadius(_ radius: CGFloat, corners: UIRectCorner) -> some View {
        clipShape(RoundedCorner(radius: radius, corners: corners))
    }
}
```

### 説明：
- `RoundedCorner`シェイプを使って特定の角だけに角丸を適用します。
- `cornerRadius(_:corners:)`というカスタム修飾子を作成し、簡単に角丸を指定できるようにしています。

これで、特定の角だけに角丸を付けることが可能です。たとえば、上記では `.bottomLeft` と `.bottomRight` だけに角丸が適用されていますが、`.topLeft` や `.topRight` など他の組み合わせにも簡単に適用できます。

---

## 👤 ユーザー
*2024/09/26 10:07:48*

以下はできたりしないの

.clipShape(
    .rect(
        topLeadingRadius: 0,
        bottomLeadingRadius: 20,
        bottomTrailingRadius: 0,
        topTrailingRadius: 20
    )
)

---

## 🤖 アシスタント
*2024/09/26 10:08:10*

残念ながら、現在のSwiftUIの`clipShape`メソッドでは、直接的に個々の角の半径を指定するような方法は提供されていません。つまり、`.clipShape`の中に`rect`のようなオプションを使用して個々の角を指定する構文は存在しません。

しかし、カスタムのシェイプを作成することで、指定された各角に異なる半径を持たせることはできます。例えば、`topLeadingRadius`や`bottomLeadingRadius`などのように各角に異なる半径を適用するカスタムシェイプを作成できます。

以下は、指定した各角に異なる半径を持たせる方法です：

### カスタムシェイプを使用した実装

```swift
import SwiftUI

struct CustomRoundedCorner: Shape {
    var topLeadingRadius: CGFloat
    var topTrailingRadius: CGFloat
    var bottomLeadingRadius: CGFloat
    var bottomTrailingRadius: CGFloat

    func path(in rect: CGRect) -> Path {
        let path = UIBezierPath()
        
        // Top left corner
        path.move(to: CGPoint(x: rect.minX, y: rect.minY + topLeadingRadius))
        path.addArc(withCenter: CGPoint(x: rect.minX + topLeadingRadius, y: rect.minY + topLeadingRadius),
                    radius: topLeadingRadius,
                    startAngle: .pi,
                    endAngle: 3 * .pi / 2,
                    clockwise: true)
        
        // Top right corner
        path.addLine(to: CGPoint(x: rect.maxX - topTrailingRadius, y: rect.minY))
        path.addArc(withCenter: CGPoint(x: rect.maxX - topTrailingRadius, y: rect.minY + topTrailingRadius),
                    radius: topTrailingRadius,
                    startAngle: 3 * .pi / 2,
                    endAngle: 0,
                    clockwise: true)
        
        // Bottom right corner
        path.addLine(to: CGPoint(x: rect.maxX, y: rect.maxY - bottomTrailingRadius))
        path.addArc(withCenter: CGPoint(x: rect.maxX - bottomTrailingRadius, y: rect.maxY - bottomTrailingRadius),
                    radius: bottomTrailingRadius,
                    startAngle: 0,
                    endAngle: .pi / 2,
                    clockwise: true)
        
        // Bottom left corner
        path.addLine(to: CGPoint(x: rect.minX + bottomLeadingRadius, y: rect.maxY))
        path.addArc(withCenter: CGPoint(x: rect.minX + bottomLeadingRadius, y: rect.maxY - bottomLeadingRadius),
                    radius: bottomLeadingRadius,
                    startAngle: .pi / 2,
                    endAngle: .pi,
                    clockwise: true)
        
        path.close()
        
        return Path(path.cgPath)
    }
}
```

### 使用方法

次に、このカスタムシェイプを`clipShape`に適用することで、個別の角の丸みを指定できます。

```swift
struct ContentView: View {
    var body: some View {
        Rectangle()
            .fill(Color.blue)
            .frame(width: 200, height: 100)
            .clipShape(
                CustomRoundedCorner(
                    topLeadingRadius: 0,
                    topTrailingRadius: 20,
                    bottomLeadingRadius: 20,
                    bottomTrailingRadius: 0
                )
            )
    }
}
```

### 結果:
- 左上 (`topLeadingRadius`) は `0` のまま。
- 右上 (`topTrailingRadius`) には `20` の半径の角丸が適用されます。
- 左下 (`bottomLeadingRadius`) には `20` の半径の角丸が適用されます。
- 右下 (`bottomTrailingRadius`) には `0` の角丸が適用されます。

このようにカスタムシェイプを作成することで、`clipShape`を用いて特定の角にだけ丸みを適用することができます。

---

## 👤 ユーザー
*2024/09/26 10:09:02*

public static func rect(topLeadingRadius: CGFloat = 0, bottomLeadingRadius: CGFloat = 0, bottomTrailingRadius: CGFloat = 0, topTrailingRadius: CGFloat = 0, style: RoundedCornerStyle = .continuous) -&gt; Self

---

## 🤖 アシスタント
*2024/09/26 10:09:19*

`rect`メソッドを実装して、個々の角に異なる角丸を適用するような構造体を作成することは可能です。しかし、SwiftUIの標準ライブラリではこの形式の`rect`メソッドは提供されていません。ですので、カスタムな形でこのようなメソッドを提供する形を考える必要があります。

以下は、Swiftの静的メソッドを使って、`rect`メソッドを実装し、各角に異なる丸みを適用する例です。

```swift
import SwiftUI

struct CustomRoundedRectangle: Shape {
    var topLeadingRadius: CGFloat
    var bottomLeadingRadius: CGFloat
    var bottomTrailingRadius: CGFloat
    var topTrailingRadius: CGFloat
    var style: RoundedCornerStyle

    func path(in rect: CGRect) -&gt; Path {
        let path = UIBezierPath()
        
        // Top left corner
        path.move(to: CGPoint(x: rect.minX, y: rect.minY + topLeadingRadius))
        path.addArc(withCenter: CGPoint(x: rect.minX + topLeadingRadius, y: rect.minY + topLeadingRadius),
                    radius: topLeadingRadius,
                    startAngle: .pi,
                    endAngle: 3 * .pi / 2,
                    clockwise: true)
        
        // Top right corner
        path.addLine(to: CGPoint(x: rect.maxX - topTrailingRadius, y: rect.minY))
        path.addArc(withCenter: CGPoint(x: rect.maxX - topTrailingRadius, y: rect.minY + topTrailingRadius),
                    radius: topTrailingRadius,
                    startAngle: 3 * .pi / 2,
                    endAngle: 0,
                    clockwise: true)
        
        // Bottom right corner
        path.addLine(to: CGPoint(x: rect.maxX, y: rect.maxY - bottomTrailingRadius))
        path.addArc(withCenter: CGPoint(x: rect.maxX - bottomTrailingRadius, y: rect.maxY - bottomTrailingRadius),
                    radius: bottomTrailingRadius,
                    startAngle: 0,
                    endAngle: .pi / 2,
                    clockwise: true)
        
        // Bottom left corner
        path.addLine(to: CGPoint(x: rect.minX + bottomLeadingRadius, y: rect.maxY))
        path.addArc(withCenter: CGPoint(x: rect.minX + bottomLeadingRadius, y: rect.maxY - bottomLeadingRadius),
                    radius: bottomLeadingRadius,
                    startAngle: .pi / 2,
                    endAngle: .pi,
                    clockwise: true)
        
        path.close()
        
        return Path(path.cgPath)
    }
    
    // 静的メソッドでカスタムShapeを作成
    public static func rect(
        topLeadingRadius: CGFloat = 0,
        bottomLeadingRadius: CGFloat = 0,
        bottomTrailingRadius: CGFloat = 0,
        topTrailingRadius: CGFloat = 0,
        style: RoundedCornerStyle = .continuous
    ) -&gt; Self {
        return CustomRoundedRectangle(
            topLeadingRadius: topLeadingRadius,
            bottomLeadingRadius:

---

## 🤖 アシスタント
*2024/09/26 10:09:38*

はい、iOS 16からSwiftUIに新しく提供されている機能として、`RoundedRectangle`には各コーナーに個別の角丸を指定できるAPIが追加されています。これを使うことで、より簡単に四隅のどれかを選択して丸くすることが可能です。

iOS 16以降では、次のように`RoundedRectangle`を使って個々の角に異なる半径を指定することができます。

### iOS 16以降での簡単な実装例

```swift
import SwiftUI

struct ContentView: View {
    var body: some View {
        Rectangle()
            .fill(Color.blue)
            .frame(width: 200, height: 100)
            .clipShape(
                RoundedRectangle(cornerSize: CGSize(width: 20, height: 20), style: .continuous)
                    .path(in: CGRect(x: 0, y: 0, width: 200, height: 100))
                    .byRoundingCorners(.topLeading, .bottomTrailing)
            )
    }
}
```

### より簡単に四隅に異なる角丸を設定する場合

iOS 16では`RoundedRectangle`や`CornerRadiusStyle`のAPIが改善されていますが、すべての四隅に異なる半径を設定するためには、次のようなiOS 16の新しいAPIで対応できます。

#### SwiftUI 4（iOS 16以降）で角丸指定:

```swift
import SwiftUI

struct ContentView: View {
    var body: some View {
        RoundedRectangle(cornerSize: CGSize(width: 20, height: 20), style: .continuous)
            .cornerRadius(20, corners: [.topLeading, .bottomTrailing]) // ここで特定の角に角丸を指定
            .frame(width: 200, height: 100)
            .foregroundColor(.blue)
    }
}

extension View {
    // 便利なコーナーラディウス修飾子を拡張として追加
    func cornerRadius(_ radius: CGFloat, corners: UIRectCorner) -> some View {
        clipShape(RoundedCorner(radius: radius, corners: corners))
    }
}

struct RoundedCorner: Shape {
    var radius: CGFloat = .infinity
    var corners: UIRectCorner = .allCorners

    func path(in rect: CGRect) -> Path {
        let path = UIBezierPath(roundedRect: rect, byRoundingCorners: corners, cornerRadii: CGSize(width: radius, height: radius))
        return Path(path.cgPath)
    }
}
```

このように、iOS 16からはより簡単に各角に異なる半径の角丸を設定できるようになっています。

---

## 👤 ユーザー
*2024/09/26 10:11:56*

enum で top bottom テーリング, リーディングを指定して、そこの角度まるくするような拡張を書いてほしい

@available(iOS 16.0, macOS 13.0, tvOS 16.0, watchOS 9.0, *)
extension Shape where Self == UnevenRoundedRectangle {

    /// A rectangular shape with rounded corners with different values, aligned
    /// inside the frame of the view containing it.
    public static func rect(cornerRadii: RectangleCornerRadii, style: RoundedCornerStyle = .continuous) -&gt; Self

    /// A rectangular shape with rounded corners with different values, aligned
    /// inside the frame of the view containing it.
    public static func rect(topLeadingRadius: CGFloat = 0, bottomLeadingRadius: CGFloat = 0, bottomTrailingRadius: CGFloat = 0, topTrailingRadius: CGFloat = 0, style: RoundedCornerStyle = .continuous) -&gt; Self
}

---

## 🤖 アシスタント
*2024/09/26 10:12:20*

以下のようなSwiftの`enum`を使って、`top`, `bottom`, `leading`, `trailing`ごとに角を丸くする拡張を実装できます。さらに、`Shape`の拡張として`UnevenRoundedRectangle`を用いた実装を記述しました。

### Enumによる角の指定とShape拡張

まず、角の指定を行うために`enum`を定義します。

```swift
import SwiftUI

// 角の指定用のEnum
enum CornerPosition {
    case topLeading
    case topTrailing
    case bottomLeading
    case bottomTrailing
}

// 角の半径を格納する構造体
struct RectangleCornerRadii {
    var topLeading: CGFloat = 0
    var topTrailing: CGFloat = 0
    var bottomLeading: CGFloat = 0
    var bottomTrailing: CGFloat = 0
}
```

次に、指定した各角の半径を適用できるカスタムシェイプ`UnevenRoundedRectangle`を定義します。これを使って、異なる角に異なる角丸を設定することができます。

```swift
import SwiftUI

// カスタムな角丸シェイプ
struct UnevenRoundedRectangle: Shape {
    var cornerRadii: RectangleCornerRadii
    var style: RoundedCornerStyle = .continuous

    func path(in rect: CGRect) -> Path {
        let path = UIBezierPath(
            roundedRect: rect,
            byRoundingCorners: [
                cornerRadii.topLeading > 0 ? .topLeft : [],
                cornerRadii.topTrailing > 0 ? .topRight : [],
                cornerRadii.bottomLeading > 0 ? .bottomLeft : [],
                cornerRadii.bottomTrailing > 0 ? .bottomRight : []
            ],
            cornerRadii: CGSize(
                width: rect.width,
                height: rect.height
            )
        )
        return Path(path.cgPath)
    }
}

@available(iOS 16.0, macOS 13.0, tvOS 16.0, watchOS 9.0, *)
extension Shape where Self == UnevenRoundedRectangle {

    // RectangleCornerRadiiを使った拡張
    public static func rect(cornerRadii: RectangleCornerRadii, style: RoundedCornerStyle = .continuous) -> Self {
        return UnevenRoundedRectangle(cornerRadii: cornerRadii, style: style)
    }

    // 各角のradiusを直接指定できる拡張
    public static func rect(
        topLeadingRadius: CGFloat = 0,
        bottomLeadingRadius: CGFloat = 0,
        bottomTrailingRadius: CGFloat = 0,
        topTrailingRadius: CGFloat = 0,
        style: RoundedCornerStyle = .continuous
    ) -> Self {
        return UnevenRoundedRectangle(
            cornerRadii: RectangleCornerRadii(
                topLeading: topLeadingRadius,
                bottomLeading: bottomLeadingRadius,
                bottomTrailing: bottomTrailingRadius,
                topTrailing: topTrailingRadius
            ),
            style: style
        )
    }
}
```

### 使用方法

このカスタム拡張を使って、指定した角にだけ角丸を適用することができます。例えば、`topLeading`と`bottomTrailing`にだけ角丸を適用するコードは次のようになります。

```swift
struct ContentView: View {
    var body: some View {
        UnevenRoundedRectangle
            .rect(topLeadingRadius: 20, bottomTrailingRadius: 20)
            .fill(Color.blue)
            .frame(width: 200, height: 100)
    }
}
```

これで、`topLeading`と`bottomTrailing`にだけ角丸が適用された矩形が表示されます。`rect(cornerRadii:style:)`を使えば、`RectangleCornerRadii`構造体を使って角の半径をまとめて設定することもできます。

---
