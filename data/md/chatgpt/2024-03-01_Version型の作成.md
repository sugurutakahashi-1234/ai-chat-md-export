# Version型の作成

日付: 2024-03-01

---

## 👤 ユーザー
*2024/3/1 16:22:09*

SwiftでコンペアブルVersionという型を作って、

---

## 🤖 アシスタント
*2024/3/1 16:23:39*

Swiftで`Comparable`プロトコルを満たす`Version`型を作成することは、バージョン番号の比較などに便利です。以下はその一例です。

```swift
struct Version: Comparable {
    let major: Int
    let minor: Int
    let patch: Int

    init?(_ versionString: String) {
        let components = versionString.split(separator: ".")
        guard components.count <= 3 else { return nil }
        
        let numbers = components.map { Int($0) }
        guard numbers.allSatisfy({ $0 != nil }) else { return nil }
        
        self.major = numbers[0] ?? 0
        self.minor = numbers.count > 1 ? numbers[1] ?? 0 : 0
        self.patch = numbers.count > 2 ? numbers[2] ?? 0 : 0
    }

    static func < (lhs: Version, rhs: Version) -> Bool {
        if lhs.major != rhs.major {
            return lhs.major < rhs.major
        } else if lhs.minor != rhs.minor {
            return lhs.minor < rhs.minor
        } else {
            return lhs.patch < rhs.patch
        }
    }

    static func == (lhs: Version, rhs: Version) -> Bool {
        return lhs.major == rhs.major && lhs.minor == rhs.minor && lhs.patch == rhs.patch
    }
}

// 使用例
let version1 = Version("1.2.3")!
let version2 = Version("1.2.4")!

print(version1 < version2)  // true
print(version1 == version2) // false
```

この`Version`型では、バージョン番号を`major.minor.patch`の形式で扱います。`Comparable`プロトコルを満たすためには、`<`と`==`演算子を実装する必要があります。この例では、まずメジャーバージョンを比較し、それが同じであればマイナーバージョン、それも同じであればパッチバージョンを比較しています。

`init?(_ versionString: String)`イニシャライザは、文字列からバージョン情報をパースします。このイニシャライザは、不正な形式のバージョン文字列が与えられた場合に`nil`を返すようになっています。

この実装では、バージョン番号の各部分が整数であることを想定しています。また、バージョン文字列が正しい形式であること（例えば、"1.2.3"のようにピリオドで区切られた3つの数字）を前提としています。不正な形式や、想定外の値（例えば、負の数や非数値）が含まれている場合には、イニシャライザは`nil`を返します。

---
