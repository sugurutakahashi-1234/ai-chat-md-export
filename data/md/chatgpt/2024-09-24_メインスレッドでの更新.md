# ãƒ¡ã‚¤ãƒ³ã‚¹ãƒ¬ãƒƒãƒ‰ã§ã®æ›´æ–°

æ—¥ä»˜: 2024-09-24

---

## ğŸ‘¤ ãƒ¦ãƒ¼ã‚¶ãƒ¼
*2024/09/24 12:37:57*

videoAspect ã®æ›´æ–°ã ã‘ãƒ¡ã‚¤ãƒ³ã‚¹ãƒ¬ãƒƒãƒ‰ã§ã—ãŸãŠ

Task.detached {
                        guard let videoTrack = try await player.currentItem?.asset.loadTracks(withMediaType: .video).first else {
                            print("Video track not found")
                            return
                        }
                        let videoSize = try await videoTrack.load(.naturalSize)
                        videoAspect = videoSize.width / videoSize.height
                    }

---

## ğŸ¤– ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ
*2024/09/24 12:38:05*

`videoAspect` ã®æ›´æ–°ã¯ãƒ¡ã‚¤ãƒ³ã‚¹ãƒ¬ãƒƒãƒ‰ã§è¡Œã†å¿…è¦ãŒã‚ã‚Šã¾ã™ã®ã§ã€æ¬¡ã®ã‚ˆã†ã«ãƒ¡ã‚¤ãƒ³ã‚¹ãƒ¬ãƒƒãƒ‰ã§ã®æ›´æ–°ã‚’ `DispatchQueue.main.async` ã§è¡Œã†ã¨è‰¯ã„ã§ã—ã‚‡ã†ï¼š

```swift
Task.detached {
    guard let videoTrack = try await player.currentItem?.asset.loadTracks(withMediaType: .video).first else {
        print("Video track not found")
        return
    }
    let videoSize = try await videoTrack.load(.naturalSize)
    
    // ãƒ¡ã‚¤ãƒ³ã‚¹ãƒ¬ãƒƒãƒ‰ã§ videoAspect ã‚’æ›´æ–°ã™ã‚‹
    DispatchQueue.main.async {
        videoAspect = videoSize.width / videoSize.height
    }
}
```

ã“ã®ã‚ˆã†ã« `DispatchQueue.main.async` ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã€éåŒæœŸå‡¦ç†ã®ä¸­ã§ `videoAspect` ã‚’ãƒ¡ã‚¤ãƒ³ã‚¹ãƒ¬ãƒƒãƒ‰ã§å®‰å…¨ã«æ›´æ–°ã§ãã¾ã™ã€‚

---

## ğŸ‘¤ ãƒ¦ãƒ¼ã‚¶ãƒ¼
*2024/09/24 12:38:15*

DispatchQueue.main.async ã§ã¯ãªãã¦ã€Swift Concurrencyã§è¨˜è¿°ã—ãŸã„

---

## ğŸ¤– ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ
*2024/09/24 12:38:27*

Swift Concurrency ã‚’ä½¿ã£ã¦ãƒ¡ã‚¤ãƒ³ã‚¹ãƒ¬ãƒƒãƒ‰ã§ `videoAspect` ã‚’æ›´æ–°ã—ãŸã„å ´åˆã€`@MainActor` ã‚’ä½¿ã†ã¨ç°¡æ½”ã«è¨˜è¿°ã§ãã¾ã™ã€‚ä»¥ä¸‹ã®ã‚ˆã†ã«æ›¸ãç›´ã™ã¨ã€ãƒ¡ã‚¤ãƒ³ã‚¹ãƒ¬ãƒƒãƒ‰ã§ã®æ›´æ–°ã‚’è‡ªå‹•çš„ã«å‡¦ç†ã—ã¦ãã‚Œã¾ã™ï¼š

```swift
Task.detached {
    guard let videoTrack = try await player.currentItem?.asset.loadTracks(withMediaType: .video).first else {
        print("Video track not found")
        return
    }
    let videoSize = try await videoTrack.load(.naturalSize)
    
    await MainActor.run {
        videoAspect = videoSize.width / videoSize.height
    }
}
```

`MainActor.run` ã‚’ä½¿ã†ã“ã¨ã§ã€ãƒ¡ã‚¤ãƒ³ã‚¹ãƒ¬ãƒƒãƒ‰ä¸Šã§å‡¦ç†ã‚’è¡Œã†ã“ã¨ãŒä¿è¨¼ã•ã‚Œã¾ã™ã€‚ã“ã®æ–¹æ³•ã§ Swift Concurrency ã«çµ±ä¸€ã—ãŸå½¢ã§è¨˜è¿°ã§ãã¾ã™ã‚ˆã€‚

---
