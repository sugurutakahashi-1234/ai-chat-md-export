# MySQL クリエイト文自動化

Date: 2024-05-27

---

## 👤 User
*2024-05-27 10:12:55*

mysql の クリエイト文 を GitHub Actions によってドキュメント化したい。
最新の情報から候補をいくつか探してほしい

---

## 🤖 Assistant
*2024-05-27 10:13:21*

To document MySQL `CREATE` statements using GitHub Actions, you can follow these steps to set up and automate the process effectively. Here are some methods and examples to guide you:

1. **Setting Up MySQL Service in GitHub Actions**:
   You can define a MySQL service in your GitHub Actions workflow file to run a MySQL database in a Docker container. This setup can include environment variables for the root password, database name, user, and password. Here's an example configuration:

    ```yaml
    name: CI

    on: [push, pull_request]

    jobs:
      build:
        runs-on: ubuntu-latest

        services:
          mysql:
            image: mysql:latest
            env:
              MYSQL_ROOT_PASSWORD: ${{ secrets.MYSQL_ROOT_PASSWORD }}
              MYSQL_DATABASE: test_db
              MYSQL_USER: test_user
              MYSQL_PASSWORD: ${{ secrets.MYSQL_PASSWORD }}
            ports:
              - 3306:3306
            options: >-
              --health-cmd="mysqladmin ping"
              --health-interval=10s
              --health-timeout=5s
              --health-retries=3

        steps:
          - name: Checkout code
            uses: actions/checkout@v2

          - name: Set up MySQL
            run: |
              mysql --host=127.0.0.1 --user=${{ secrets.MYSQL_USER }} --password=${{ secrets.MYSQL_PASSWORD }} ${{ secrets.MYSQL_DATABASE }} <<SQL
              CREATE TABLE example (
                  id INT AUTO_INCREMENT PRIMARY KEY,
                  name VARCHAR(100) NOT NULL
              );
              SHOW CREATE TABLE example;
              SQL
    ```

    This workflow sets up a MySQL service, creates a database, and executes a `CREATE TABLE` statement, showing the resulting table structure.

2. **Automating Schema Migrations**:
   Using tools like Skeema, you can automate MySQL schema migrations and generate SQL statements to transition from one schema state to another. Integrating Skeema with GitHub Actions allows you to automate this process during pull requests, ensuring schema changes are tracked and reviewed properly.

    ```yaml
    name: Schema Diff

    on: pull_request

    jobs:
      diff:
        runs-on: ubuntu-latest

        steps:
          - name: Checkout code
            uses: actions/checkout@v2

          - name: Install Skeema
            run: |
              wget https://github.com/skeema/skeema/releases/download/v1.5.1/skeema_linux_amd64.tar.gz
              tar -xzf skeema_linux_amd64.tar.gz
              sudo mv skeema /usr/local/bin

          - name: Run Skeema Diff
            run: |
              skeema diff
    ```

    This example shows how to set up Skeema to generate and review schema differences automatically as part of your CI/CD process【6†source】【8†source】.

3. **Using GitHub Actions to Verify MySQL Connections**:
   Ensure that your MySQL service is ready before running tests by adding health checks and waiting for the service to become available:

    ```yaml
    - name: Verify MySQL connection
      run: |
        while ! mysqladmin ping -h"127.0.0.1" --silent; do
          sleep 1
        done
    ```

    This step ensures that the MySQL server is up and running before proceeding with the next steps in your workflow【9†source】【10†source】.

By using these methods, you can document and automate MySQL `CREATE` statements within your GitHub Actions workflows, ensuring that database changes are consistently applied and reviewed. For detailed examples and further customization, refer to the sources provided.

---
