# ãƒ‡ãƒã‚¤ã‚¹æƒ…å ±ã‚’JSONã‚³ãƒ”ãƒ¼

æ—¥ä»˜: 2024-06-11

---

## ğŸ‘¤ ãƒ¦ãƒ¼ã‚¶ãƒ¼
*2024/06/12 08:54:36*

ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒ¼ã®å³ä¸Šã«JSONã½ãå†…å®¹ã‚’ã‚³ãƒ”ãƒ¼ã™ã‚‹ãƒœã‚¿ãƒ³ã‚’è¨­ã‘ãŸã„

// MARK: - View

@MainActor
public struct DeviceInfoView&lt;Dependency: RootDIContainerDependency&gt;: View {
    private let dependency: Dependency
    @StateObject private var presenter: DeviceInfoPresenter&lt;Dependency&gt;

    public init(dependency: Dependency) {
        self.dependency = dependency
        _presenter = .init(wrappedValue: DeviceInfoPresenter(dependency: dependency))
    }

    public var body: some View {
        List {
            Section("") {
                ForEach(DeviceInfoType.allCases) { deviceInfoType in
                    Button {
                        presenter.onTapDeviceInfo(deviceInfoType)
                    } label: {
                        HStack {
                            Text(deviceInfoType.name)
                            Spacer()
                            Text(presenter.getDeviceInfoValue(deviceInfoType))
                                .lineLimit(1)
                                .minimumScaleFactor(0.1)
                        }
                    }
                }
            }
        }
        .navigationTitle("ãƒ‡ãƒã‚¤ã‚¹æƒ…å ±")
        .alert(presenter.copiedAlertTitle, isPresented: $presenter.showCopyAlert) {
            Button("OK", action: {})
        }
        .task {
            await presenter.onAppear()
        }
        .onDisappear {
            presenter.onDisappear()
        }
    }
}

// MARK: - Domain

extension DeviceInfoType: Identifiable {
    public var id: String {
        name
    }

    var name: String {
        switch self {
        case .osVersion:
            "OS Version"
        default:
            "\(self)".camelCaseToSpaces.initialUppercased
        }
    }
}
â€¨
@MainActor
final class DeviceInfoPresenter&lt;Dependency: DeviceInfoPresenterDependency&gt;: ObservableObject {
    @Published var showCopyAlert: Bool = false
    @Published private(set) var selectedDeviceInfoType: DeviceInfoType?

    /// UseCase ã® Mock ã‚’ä½¿ç”¨ã™ã‚‹å ´åˆã¯ã“ã“ã‚’æ›¸ãæ›ãˆã‚‹ï¼ˆDI ã®ã‚³ãƒ¼ãƒ‰ã¯æ›¸ãæ›ãˆãš Presenter ã§ç›´æ¥æŒ‡å®šã™ã‚‹ï¼‰
    private let deviceInfoUseCase: DeviceInfoInteractor&lt;Dependency&gt;
    private let dependency: Dependency

    var copiedAlertTitle: String {
        guard let selectedDeviceInfoType else {
            return ""
        }
        return "Copied \"\(getDeviceInfoValue(selectedDeviceInfoType))\""
    }

    init(dependency: Dependency) {
        dependency.logDriver.initLog()

        self.dependency = dependency
        deviceInfoUseCase = DeviceInfoInteractor(dependency: dependency)
    }

    deinit {
        OSLogger.deinitLog()
    }

    func onAppear() async {
        dependency.logDriver.onAppearLog()
    }

    func onDisappear() {
        dependency.logDriver.onDisappearLog()
    }

    func onTapDeviceInfo(_ deviceInfoType: DeviceInfoType) {
        selectedDeviceInfoType = deviceInfoType
        dependency.clipboardDriver.copy(deviceInfoUseCase.getDeviceInfoValue(deviceInfoType))
        showCopyAlert = true
    }

    func getDeviceInfoValue(_ deviceInfoType: DeviceInfoType) -&gt; String {
        deviceInfoUseCase.getDeviceInfoValue(deviceInfoType)
    }
}


@MainActor
public final class DeviceInfoInteractor&lt;Dependency: DeviceInfoInteractorDependency&gt;: DeviceInfoUseCase {
    private let dependency: Dependency

    public init(dependency: Dependency) {
        dependency.logDriver.initLog()

        self.dependency = dependency
    }

    public func getDeviceInfoValue(_ deviceInfoType: DeviceInfoType) -&gt; String {
        switch deviceInfoType {
        case .appVersion:
            "\(dependency.deviceInfoDriver.appVersion) (\(dependency.deviceInfoDriver.appBuildNumber))"
        case .buildScheme:
            dependency.buildEnvDriver.buildScheme.name
        case .buildConfiguration:
            dependency.buildEnvDriver.buildConfiguration.name
        case .deviceIdentifier:
            dependency.deviceInfoDriver.deviceIdentifier
        case .bundleId:
            dependency.deviceInfoDriver.bundleId
        case .deviceName:
            dependency.deviceInfoDriver.deviceName
        case .isSimulator:
            "\(dependency.deviceInfoDriver.isSimulator)"
        case .isPreview:
            "\(dependency.deviceInfoDriver.isPreview)"
        case .osVersion:
            "\(dependency.deviceInfoDriver.osType) \(dependency.deviceInfoDriver.osVersion)"
        case .timezone:
            dependency.deviceInfoDriver.timezone
        case .preferredLanguages:
            dependency.deviceInfoDriver.preferredLanguages
        case .language:
            dependency.deviceInfoDriver.language
        case .launchAppCount:
            "\(dependency.localDataStoreDriver.launchAppCount)"
        case .apnsToken:
            "\(dependency.localDataStoreDriver.apnsToken?.deviceTokenHexString ?? "not set")"
        }
    }
}

private extension BuildScheme {
    var name: String {
        "\(self)".camelCaseToSpaces.localizedCapitalized
    }
}

private extension BuildConfiguration {
    var name: String {
        "\(self)".camelCaseToSpaces.localizedCapitalized
    }
}

---

## ğŸ¤– ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ
*2024/06/12 08:54:58*

ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒ¼ã®å³ä¸Šã«JSONé¢¨ã®å†…å®¹ã‚’ã‚³ãƒ”ãƒ¼ã™ã‚‹ãƒœã‚¿ãƒ³ã‚’è¨­ã‘ã‚‹ãŸã‚ã«ã€ä»¥ä¸‹ã®ã‚ˆã†ã«å¤‰æ›´ã‚’åŠ ãˆã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã¾ãšã€ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒ¼ã«ã‚«ã‚¹ã‚¿ãƒ ãƒœã‚¿ãƒ³ã‚’è¿½åŠ ã—ã€ãã®ãƒœã‚¿ãƒ³ãŒæŠ¼ã•ã‚ŒãŸã¨ãã«ç¾åœ¨ã®ãƒ‡ãƒã‚¤ã‚¹æƒ…å ±ã‚’JSONå½¢å¼ã§ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã™ã‚‹å‡¦ç†ã‚’è¿½åŠ ã—ã¾ã™ã€‚

ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã‚’ä¿®æ­£ã—ã¾ã™ã€‚

### DeviceInfoView

```swift
// MARK: - View

@MainActor
public struct DeviceInfoView<Dependency: RootDIContainerDependency>: View {
    private let dependency: Dependency
    @StateObject private var presenter: DeviceInfoPresenter<Dependency>

    public init(dependency: Dependency) {
        self.dependency = dependency
        _presenter = .init(wrappedValue: DeviceInfoPresenter(dependency: dependency))
    }

    public var body: some View {
        List {
            Section("") {
                ForEach(DeviceInfoType.allCases) { deviceInfoType in
                    Button {
                        presenter.onTapDeviceInfo(deviceInfoType)
                    } label: {
                        HStack {
                            Text(deviceInfoType.name)
                            Spacer()
                            Text(presenter.getDeviceInfoValue(deviceInfoType))
                                .lineLimit(1)
                                .minimumScaleFactor(0.1)
                        }
                    }
                }
            }
        }
        .navigationTitle("ãƒ‡ãƒã‚¤ã‚¹æƒ…å ±")
        .navigationBarItems(trailing: Button(action: {
            presenter.copyAllDeviceInfoAsJSON()
        }) {
            Image(systemName: "doc.on.doc")
        })
        .alert(presenter.copiedAlertTitle, isPresented: $presenter.showCopyAlert) {
            Button("OK", action: {})
        }
        .task {
            await presenter.onAppear()
        }
        .onDisappear {
            presenter.onDisappear()
        }
    }
}
```

### DeviceInfoPresenter

æ¬¡ã«ã€Presenterã‚¯ãƒ©ã‚¹ã«ã™ã¹ã¦ã®ãƒ‡ãƒã‚¤ã‚¹æƒ…å ±ã‚’JSONå½¢å¼ã§ã‚³ãƒ”ãƒ¼ã™ã‚‹é–¢æ•°ã‚’è¿½åŠ ã—ã¾ã™ã€‚

```swift
@MainActor
final class DeviceInfoPresenter<Dependency: DeviceInfoPresenterDependency>: ObservableObject {
    @Published var showCopyAlert: Bool = false
    @Published private(set) var selectedDeviceInfoType: DeviceInfoType?

    /// UseCase ã® Mock ã‚’ä½¿ç”¨ã™ã‚‹å ´åˆã¯ã“ã“ã‚’æ›¸ãæ›ãˆã‚‹ï¼ˆDI ã®ã‚³ãƒ¼ãƒ‰ã¯æ›¸ãæ›ãˆãš Presenter ã§ç›´æ¥æŒ‡å®šã™ã‚‹ï¼‰
    private let deviceInfoUseCase: DeviceInfoInteractor<Dependency>
    private let dependency: Dependency

    var copiedAlertTitle: String {
        guard let selectedDeviceInfoType else {
            return "Copied All Device Info as JSON"
        }
        return "Copied \"\(getDeviceInfoValue(selectedDeviceInfoType))\""
    }

    init(dependency: Dependency) {
        dependency.logDriver.initLog()

        self.dependency = dependency
        deviceInfoUseCase = DeviceInfoInteractor(dependency: dependency)
    }

    deinit {
        OSLogger.deinitLog()
    }

    func onAppear() async {
        dependency.logDriver.onAppearLog()
    }

    func onDisappear() {
        dependency.logDriver.onDisappearLog()
    }

    func onTapDeviceInfo(_ deviceInfoType: DeviceInfoType) {
        selectedDeviceInfoType = deviceInfoType
        dependency.clipboardDriver.copy(deviceInfoUseCase.getDeviceInfoValue(deviceInfoType))
        showCopyAlert = true
    }

    func getDeviceInfoValue(_ deviceInfoType: DeviceInfoType) -> String {
        deviceInfoUseCase.getDeviceInfoValue(deviceInfoType)
    }

    func copyAllDeviceInfoAsJSON() {
        let allDeviceInfo = DeviceInfoType.allCases.reduce(into: [String: String]()) { result, deviceInfoType in
            result[deviceInfoType.name] = getDeviceInfoValue(deviceInfoType)
        }
        if let jsonData = try? JSONSerialization.data(withJSONObject: allDeviceInfo, options: .prettyPrinted),
           let jsonString = String(data: jsonData, encoding: .utf8) {
            dependency.clipboardDriver.copy(jsonString)
            showCopyAlert = true
        }
    }
}
```

ã“ã®ä¿®æ­£ã«ã‚ˆã‚Šã€ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒ¼ã®å³ä¸Šã«JSONå½¢å¼ã®å†…å®¹ã‚’ã‚³ãƒ”ãƒ¼ã™ã‚‹ãƒœã‚¿ãƒ³ãŒè¿½åŠ ã•ã‚Œã¾ã™ã€‚ã“ã®ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã¨ã€ç¾åœ¨è¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ã™ã¹ã¦ã®ãƒ‡ãƒã‚¤ã‚¹æƒ…å ±ãŒJSONå½¢å¼ã§ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã•ã‚Œã€ã‚¢ãƒ©ãƒ¼ãƒˆãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

---

## ğŸ‘¤ ãƒ¦ãƒ¼ã‚¶ãƒ¼
*2024/06/12 08:55:47*

Codableã‚’ä½¿ã†ã®ã¨ã©ã¡ã‚‰ãŒã„ã„ã‹ï¼Ÿ

---

## ğŸ¤– ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ
*2024/06/12 08:56:20*

Codableã‚’ä½¿ã£ã¦ãƒ‡ãƒã‚¤ã‚¹æƒ…å ±ã‚’JSONå½¢å¼ã«å¤‰æ›ã™ã‚‹ã®ã¯ã€å‹å®‰å…¨ã§èª­ã¿ã‚„ã™ãã€ã‚¨ãƒ©ãƒ¼å‡¦ç†ã‚‚ã—ã‚„ã™ã„ãŸã‚ã€æ¨å¥¨ã•ã‚Œã‚‹æ–¹æ³•ã§ã™ã€‚ä»¥ä¸‹ã«ã€Codableã‚’ä½¿ã£ãŸå®Ÿè£…ä¾‹ã‚’ç¤ºã—ã¾ã™ã€‚

ã¾ãšã€ãƒ‡ãƒã‚¤ã‚¹æƒ…å ±ã‚’ä¿æŒã™ã‚‹æ§‹é€ ä½“ã‚’ä½œæˆã—ã€Codableã«æº–æ‹ ã•ã›ã¾ã™ã€‚

### DeviceInfo

```swift
struct DeviceInfo: Codable {
    let appVersion: String
    let buildScheme: String
    let buildConfiguration: String
    let deviceIdentifier: String
    let bundleId: String
    let deviceName: String
    let isSimulator: Bool
    let isPreview: Bool
    let osVersion: String
    let timezone: String
    let preferredLanguages: String
    let language: String
    let launchAppCount: Int
    let apnsToken: String?
    
    init(dependency: Dependency) {
        self.appVersion = "\(dependency.deviceInfoDriver.appVersion) (\(dependency.deviceInfoDriver.appBuildNumber))"
        self.buildScheme = dependency.buildEnvDriver.buildScheme.name
        self.buildConfiguration = dependency.buildEnvDriver.buildConfiguration.name
        self.deviceIdentifier = dependency.deviceInfoDriver.deviceIdentifier
        self.bundleId = dependency.deviceInfoDriver.bundleId
        self.deviceName = dependency.deviceInfoDriver.deviceName
        self.isSimulator = dependency.deviceInfoDriver.isSimulator
        self.isPreview = dependency.deviceInfoDriver.isPreview
        self.osVersion = "\(dependency.deviceInfoDriver.osType) \(dependency.deviceInfoDriver.osVersion)"
        self.timezone = dependency.deviceInfoDriver.timezone
        self.preferredLanguages = dependency.deviceInfoDriver.preferredLanguages
        self.language = dependency.deviceInfoDriver.language
        self.launchAppCount = dependency.localDataStoreDriver.launchAppCount
        self.apnsToken = dependency.localDataStoreDriver.apnsToken?.deviceTokenHexString
    }
}
```

### DeviceInfoPresenter

æ¬¡ã«ã€Presenterã‚¯ãƒ©ã‚¹ã«ã™ã¹ã¦ã®ãƒ‡ãƒã‚¤ã‚¹æƒ…å ±ã‚’å–å¾—ã—ã€JSONå½¢å¼ã§ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã™ã‚‹é–¢æ•°ã‚’è¿½åŠ ã—ã¾ã™ã€‚

```swift
@MainActor
final class DeviceInfoPresenter<Dependency: DeviceInfoPresenterDependency>: ObservableObject {
    @Published var showCopyAlert: Bool = false
    @Published private(set) var selectedDeviceInfoType: DeviceInfoType?

    private let deviceInfoUseCase: DeviceInfoInteractor<Dependency>
    private let dependency: Dependency

    var copiedAlertTitle: String {
        guard let selectedDeviceInfoType else {
            return "Copied All Device Info as JSON"
        }
        return "Copied \"\(getDeviceInfoValue(selectedDeviceInfoType))\""
    }

    init(dependency: Dependency) {
        dependency.logDriver.initLog()

        self.dependency = dependency
        deviceInfoUseCase = DeviceInfoInteractor(dependency: dependency)
    }

    deinit {
        OSLogger.deinitLog()
    }

    func onAppear() async {
        dependency.logDriver.onAppearLog()
    }

    func onDisappear() {
        dependency.logDriver.onDisappearLog()
    }

    func onTapDeviceInfo(_ deviceInfoType: DeviceInfoType) {
        selectedDeviceInfoType = deviceInfoType
        dependency.clipboardDriver.copy(deviceInfoUseCase.getDeviceInfoValue(deviceInfoType))
        showCopyAlert = true
    }

    func getDeviceInfoValue(_ deviceInfoType: DeviceInfoType) -> String {
        deviceInfoUseCase.getDeviceInfoValue(deviceInfoType)
    }

    func copyAllDeviceInfoAsJSON() {
        let deviceInfo = DeviceInfo(dependency: dependency)
        if let jsonData = try? JSONEncoder().encode(deviceInfo),
           let jsonString = String(data: jsonData, encoding: .utf8) {
            dependency.clipboardDriver.copy(jsonString)
            showCopyAlert = true
        }
    }
}
```

### DeviceInfoView

æœ€å¾Œã«ã€Viewã‚’æ›´æ–°ã—ã¦ãƒœã‚¿ãƒ³ã‚’è¿½åŠ ã—ã¾ã™ã€‚

```swift
// MARK: - View

@MainActor
public struct DeviceInfoView<Dependency: RootDIContainerDependency>: View {
    private let dependency: Dependency
    @StateObject private var presenter: DeviceInfoPresenter<Dependency>

    public init(dependency: Dependency) {
        self.dependency = dependency
        _presenter = .init(wrappedValue: DeviceInfoPresenter(dependency: dependency))
    }

    public var body: some View {
        List {
            Section("") {
                ForEach(DeviceInfoType.allCases) { deviceInfoType in
                    Button {
                        presenter.onTapDeviceInfo(deviceInfoType)
                    } label: {
                        HStack {
                            Text(deviceInfoType.name)
                            Spacer()
                            Text(presenter.getDeviceInfoValue(deviceInfoType))
                                .lineLimit(1)
                                .minimumScaleFactor(0.1)
                        }
                    }
                }
            }
        }
        .navigationTitle("ãƒ‡ãƒã‚¤ã‚¹æƒ…å ±")
        .navigationBarItems(trailing: Button(action: {
            presenter.copyAllDeviceInfoAsJSON()
        }) {
            Image(systemName: "doc.on.doc")
        })
        .alert(presenter.copiedAlertTitle, isPresented: $presenter.showCopyAlert) {
            Button("OK", action: {})
        }
        .task {
            await presenter.onAppear()
        }
        .onDisappear {
            presenter.onDisappear()
        }
    }
}
```

ã“ã®ä¿®æ­£ã«ã‚ˆã‚Šã€ãƒ‡ãƒã‚¤ã‚¹æƒ…å ±ã‚’æ§‹é€ ä½“ã«ã¾ã¨ã‚ã¦Codableã‚’ä½¿ã£ã¦JSONå½¢å¼ã«å¤‰æ›ã—ã€ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒ¼ã®ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã¨ãã®å†…å®¹ã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚Codableã‚’ä½¿ã†ã“ã¨ã§ã€å‹å®‰å…¨æ€§ãŒå‘ä¸Šã—ã€ã‚¨ãƒ©ãƒ¼å‡¦ç†ã‚‚ç°¡å˜ã«ãªã‚Šã¾ã™ã€‚

---

## ğŸ‘¤ ãƒ¦ãƒ¼ã‚¶ãƒ¼
*2024/06/12 08:57:29*

ã§ã‚‚ã“ã†ã™ã‚‹ã¨presenterã«å€¤ã‚’æŒãŸãªã‘ã‚Œã°ã„ã‘ãªããªã‚‹ã®ã§ã‚„ã ãªã€‚ãªã‚‹ã¹ããƒ—ãƒ¬ã‚¼ãƒ³ã‚¿ãƒ¼ã«å€¤ã‚’ä¿æŒã—ãŸããªã„ã‚“ã ã€‚ä»¥ä¸‹ã®ã‚ˆã†ãªå®šç¾©ãŒå­˜åœ¨ã™ã‚‹ã®ã§ã†ã¾ãæ´»ç”¨ã—ãŸã„ã€‚

public enum DeviceInfoType: Sendable {
    case appVersion
    case osVersion
    case buildScheme
    case buildConfiguration
    case bundleId
    case isSimulator
    case isPreview
    case deviceName
    case deviceIdentifier
    case timezone
    case preferredLanguages
    case language
    case launchAppCount
    case apnsToken
}

---

## ğŸ¤– ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ
*2024/06/12 08:57:59*

User prefers not to hold values in the presenter and wants to utilize the existing definition of `DeviceInfoType`.

---

## ğŸ”§ ãƒ„ãƒ¼ãƒ«
*2024/06/12 08:57:59*

Model set context updated.

---

## ğŸ¤– ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ
*2024/06/12 08:57:59*

ãªã‚‹ã¹ããƒ—ãƒ¬ã‚¼ãƒ³ã‚¿ãƒ¼ã«å€¤ã‚’ä¿æŒã•ã›ãšã«ã€æ—¢å­˜ã® `DeviceInfoType` ã‚’æ´»ç”¨ã™ã‚‹æ–¹æ³•ã¨ã—ã¦ã€ãƒ‡ãƒã‚¤ã‚¹æƒ…å ±ã‚’ç›´æ¥å–å¾—ã—ã¦JSONå½¢å¼ã«å¤‰æ›ã™ã‚‹é–¢æ•°ã‚’ãƒ—ãƒ¬ã‚¼ãƒ³ã‚¿ãƒ¼ã«è¿½åŠ ã—ã€ãƒœã‚¿ãƒ³ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã§ãã®é–¢æ•°ã‚’å‘¼ã³å‡ºã™ã‚ˆã†ã«ã—ã¾ã™ã€‚ä»¥ä¸‹ã«ãã®æ–¹æ³•ã‚’ç¤ºã—ã¾ã™ã€‚

### DeviceInfoPresenter

ãƒ—ãƒ¬ã‚¼ãƒ³ã‚¿ãƒ¼ã« `copyAllDeviceInfoAsJSON` é–¢æ•°ã‚’è¿½åŠ ã—ã¾ã™ã€‚ã“ã®é–¢æ•°ã¯ã€ãƒ‡ãƒã‚¤ã‚¹æƒ…å ±ã‚’å‹•çš„ã«å–å¾—ã—ã¦JSONå½¢å¼ã«å¤‰æ›ã—ã€ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã—ã¾ã™ã€‚

```swift
@MainActor
final class DeviceInfoPresenter<Dependency: DeviceInfoPresenterDependency>: ObservableObject {
    @Published var showCopyAlert: Bool = false
    @Published private(set) var selectedDeviceInfoType: DeviceInfoType?

    private let deviceInfoUseCase: DeviceInfoInteractor<Dependency>
    private let dependency: Dependency

    var copiedAlertTitle: String {
        guard let selectedDeviceInfoType else {
            return "Copied All Device Info as JSON"
        }
        return "Copied \"\(getDeviceInfoValue(selectedDeviceInfoType))\""
    }

    init(dependency: Dependency) {
        dependency.logDriver.initLog()

        self.dependency = dependency
        deviceInfoUseCase = DeviceInfoInteractor(dependency: dependency)
    }

    deinit {
        OSLogger.deinitLog()
    }

    func onAppear() async {
        dependency.logDriver.onAppearLog()
    }

    func onDisappear() {
        dependency.logDriver.onDisappearLog()
    }

    func onTapDeviceInfo(_ deviceInfoType: DeviceInfoType) {
        selectedDeviceInfoType = deviceInfoType
        dependency.clipboardDriver.copy(deviceInfoUseCase.getDeviceInfoValue(deviceInfoType))
        showCopyAlert = true
    }

    func getDeviceInfoValue(_ deviceInfoType: DeviceInfoType) -> String {
        deviceInfoUseCase.getDeviceInfoValue(deviceInfoType)
    }

    func copyAllDeviceInfoAsJSON() {
        let allDeviceInfo = DeviceInfoType.allCases.reduce(into: [String: String]()) { result, deviceInfoType in
            result[deviceInfoType.name] = getDeviceInfoValue(deviceInfoType)
        }
        if let jsonData = try? JSONSerialization.data(withJSONObject: allDeviceInfo, options: .prettyPrinted),
           let jsonString = String(data: jsonData, encoding: .utf8) {
            dependency.clipboardDriver.copy(jsonString)
            showCopyAlert = true
        }
    }
}
```

### DeviceInfoView

Viewã«ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒ¼ã®ãƒœã‚¿ãƒ³ã‚’è¿½åŠ ã—ã¾ã™ã€‚

```swift
// MARK: - View

@MainActor
public struct DeviceInfoView<Dependency: RootDIContainerDependency>: View {
    private let dependency: Dependency
    @StateObject private var presenter: DeviceInfoPresenter<Dependency>

    public init(dependency: Dependency) {
        self.dependency = dependency
        _presenter = .init(wrappedValue: DeviceInfoPresenter(dependency: dependency))
    }

    public var body: some View {
        List {
            Section("") {
                ForEach(DeviceInfoType.allCases) { deviceInfoType in
                    Button {
                        presenter.onTapDeviceInfo(deviceInfoType)
                    } label: {
                        HStack {
                            Text(deviceInfoType.name)
                            Spacer()
                            Text(presenter.getDeviceInfoValue(deviceInfoType))
                                .lineLimit(1)
                                .minimumScaleFactor(0.1)
                        }
                    }
                }
            }
        }
        .navigationTitle("ãƒ‡ãƒã‚¤ã‚¹æƒ…å ±")
        .navigationBarItems(trailing: Button(action: {
            presenter.copyAllDeviceInfoAsJSON()
        }) {
            Image(systemName: "doc.on.doc")
        })
        .alert(presenter.copiedAlertTitle, isPresented: $presenter.showCopyAlert) {
            Button("OK", action: {})
        }
        .task {
            await presenter.onAppear()
        }
        .onDisappear {
            presenter.onDisappear()
        }
    }
}
```

### DeviceInfoTypeã®æ‹¡å¼µ

`DeviceInfoType` ã«åå‰ã‚’å–å¾—ã™ã‚‹ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’è¿½åŠ ã—ã¾ã™ã€‚

```swift
extension DeviceInfoType: Identifiable {
    public var id: String {
        name
    }

    var name: String {
        switch self {
        case .appVersion:
            return "App Version"
        case .osVersion:
            return "OS Version"
        case .buildScheme:
            return "Build Scheme"
        case .buildConfiguration:
            return "Build Configuration"
        case .bundleId:
            return "Bundle ID"
        case .isSimulator:
            return "Is Simulator"
        case .isPreview:
            return "Is Preview"
        case .deviceName:
            return "Device Name"
        case .deviceIdentifier:
            return "Device Identifier"
        case .timezone:
            return "Timezone"
        case .preferredLanguages:
            return "Preferred Languages"
        case .language:
            return "Language"
        case .launchAppCount:
            return "Launch App Count"
        case .apnsToken:
            return "APNs Token"
        }
    }
}
```

ã“ã®æ–¹æ³•ã§ã¯ã€ãƒ—ãƒ¬ã‚¼ãƒ³ã‚¿ãƒ¼ã«å€¤ã‚’ä¿æŒã™ã‚‹å¿…è¦ã¯ãªãã€å‹•çš„ã«ãƒ‡ãƒã‚¤ã‚¹æƒ…å ±ã‚’å–å¾—ã—ã¦JSONå½¢å¼ã«å¤‰æ›ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ã‚¯ãƒªãƒ¼ãƒ³ã§ç®¡ç†ã—ã‚„ã™ã„ã‚³ãƒ¼ãƒ‰ã‚’ç¶­æŒã§ãã¾ã™ã€‚

---

## ğŸ‘¤ ãƒ¦ãƒ¼ã‚¶ãƒ¼
*2024/06/12 09:28:47*

guardæ–‡ã«å¤‰ãˆã¦ã»ã—ã„

let allDeviceInfo = DeviceInfoType.allCases.reduce(into: [String: String]()) { result, deviceInfoType in
            result[deviceInfoType.name] = getDeviceInfoValue(deviceInfoType)
        }
        if let jsonData = try? JSONSerialization.data(withJSONObject: allDeviceInfo, options: .prettyPrinted),
           let jsonString = String(data: jsonData, encoding: .utf8) {
            dependency.clipboardDriver.copy(jsonString)
            showCopyAlert = true
        }

---

## ğŸ¤– ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ
*2024/06/12 09:28:52*

ä»¥ä¸‹ã®ã‚ˆã†ã« `guard` æ–‡ã‚’ä½¿ç”¨ã—ã¦æ›¸ãæ›ãˆã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

```swift
func copyAllDeviceInfoAsJSON() {
    let allDeviceInfo = DeviceInfoType.allCases.reduce(into: [String: String]()) { result, deviceInfoType in
        result[deviceInfoType.name] = getDeviceInfoValue(deviceInfoType)
    }
    guard let jsonData = try? JSONSerialization.data(withJSONObject: allDeviceInfo, options: .prettyPrinted),
          let jsonString = String(data: jsonData, encoding: .utf8) else {
        return
    }
    dependency.clipboardDriver.copy(jsonString)
    showCopyAlert = true
}
```

ã“ã®ã‚ˆã†ã« `guard` æ–‡ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã€ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸå ´åˆã«æ—©æœŸãƒªã‚¿ãƒ¼ãƒ³ã™ã‚‹ã“ã¨ãŒã§ãã€å¯èª­æ€§ãŒå‘ä¸Šã—ã¾ã™ã€‚

---

## ğŸ‘¤ ãƒ¦ãƒ¼ã‚¶ãƒ¼
*2024/06/12 09:30:42*

ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã£ãŸã€‚æ¯å›é †ç•ªã‚’å›ºå®šã«ã—ã¦ã»ã—ã„

{
  "OS Version" : "iOS 17.5",
  "Device Name" : "Simulator (iPhone 15 Pro)",
  "Device Identifier" : "iPhone16,1",
  "Language" : "language",
  "App Version" : "0.1.0 (1)",
  "Build Configuration" : "Debug",
  "Preferred Languages" : "[\"ja-JP\", \"en-JP\"]",
  "Launch App Count" : "6",
  "Timezone" : "Asia\/Tokyo",
  "Apns Token" : "not set",
  "Is Preview" : "false",
  "Build Scheme" : "Staging",
  "Is Simulator" : "true",
  "Bundle Id" : "jp.co.crage.small-talk.staging"
}

---

## ğŸ¤– ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ
*2024/06/12 09:30:58*

é †ç•ªã‚’å›ºå®šã™ã‚‹ãŸã‚ã«ã¯ã€DeviceInfoTypeã«è¡¨ç¤ºé †åºã‚’æŒ‡å®šã™ã‚‹ãŸã‚ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’è¿½åŠ ã—ã€ãã®é †åºã«å¾“ã£ã¦æƒ…å ±ã‚’å–å¾—ã™ã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚

ã¾ãšã€DeviceInfoTypeã«é †åºã‚’æŒ‡å®šã™ã‚‹ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’è¿½åŠ ã—ã¾ã™ã€‚

```swift
public enum DeviceInfoType: Sendable, CaseIterable {
    case appVersion
    case osVersion
    case buildScheme
    case buildConfiguration
    case bundleId
    case isSimulator
    case isPreview
    case deviceName
    case deviceIdentifier
    case timezone
    case preferredLanguages
    case language
    case launchAppCount
    case apnsToken

    var displayOrder: Int {
        switch self {
        case .osVersion:
            return 0
        case .deviceName:
            return 1
        case .deviceIdentifier:
            return 2
        case .language:
            return 3
        case .appVersion:
            return 4
        case .buildConfiguration:
            return 5
        case .preferredLanguages:
            return 6
        case .launchAppCount:
            return 7
        case .timezone:
            return 8
        case .apnsToken:
            return 9
        case .isPreview:
            return 10
        case .buildScheme:
            return 11
        case .isSimulator:
            return 12
        case .bundleId:
            return 13
        }
    }
}
```

æ¬¡ã«ã€`copyAllDeviceInfoAsJSON` é–¢æ•°ã‚’é †åºã«å¾“ã£ã¦æƒ…å ±ã‚’å–å¾—ã™ã‚‹ã‚ˆã†ã«ä¿®æ­£ã—ã¾ã™ã€‚

```swift
func copyAllDeviceInfoAsJSON() {
    let allDeviceInfo = DeviceInfoType.allCases
        .sorted { $0.displayOrder < $1.displayOrder }
        .reduce(into: [String: String]()) { result, deviceInfoType in
            result[deviceInfoType.name] = getDeviceInfoValue(deviceInfoType)
        }
    guard let jsonData = try? JSONSerialization.data(withJSONObject: allDeviceInfo, options: .prettyPrinted),
          let jsonString = String(data: jsonData, encoding: .utf8) else {
        return
    }
    dependency.clipboardDriver.copy(jsonString)
    showCopyAlert = true
}
```

ã“ã®ä¿®æ­£ã«ã‚ˆã‚Šã€JSONã«å«ã¾ã‚Œã‚‹ãƒ‡ãƒã‚¤ã‚¹æƒ…å ±ã®é †åºãŒå›ºå®šã•ã‚Œã¾ã™ã€‚

---

## ğŸ‘¤ ãƒ¦ãƒ¼ã‚¶ãƒ¼
*2024/06/12 09:31:10*

ãã‚“ãªã“ã¨ã¯ã—ãŸã„ããªã„ã€‚ã‚‚ã£ã¨ã‚¹ãƒãƒ¼ãƒˆãªæ–¹æ³•ã¯ãªã„ã‹ï¼Ÿ

---

## ğŸ¤– ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ
*2024/06/12 09:31:27*

ã‚‚ã£ã¨ã‚¹ãƒãƒ¼ãƒˆãªæ–¹æ³•ã¨ã—ã¦ã€`DeviceInfoType` ã‚’é…åˆ—ã«ã—ã¦é †åºã‚’ä¿æŒã™ã‚‹æ–¹æ³•ãŒã‚ã‚Šã¾ã™ã€‚ã“ã®é…åˆ—ã«å¾“ã£ã¦ãƒ‡ãƒã‚¤ã‚¹æƒ…å ±ã‚’å–å¾—ã—ã€JSONå½¢å¼ã«å¤‰æ›ã—ã¾ã™ã€‚

### DeviceInfoPresenter

`copyAllDeviceInfoAsJSON` é–¢æ•°ã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«ä¿®æ­£ã—ã¾ã™ã€‚

```swift
func copyAllDeviceInfoAsJSON() {
    let orderedDeviceInfoTypes: [DeviceInfoType] = [
        .osVersion,
        .deviceName,
        .deviceIdentifier,
        .language,
        .appVersion,
        .buildConfiguration,
        .preferredLanguages,
        .launchAppCount,
        .timezone,
        .apnsToken,
        .isPreview,
        .buildScheme,
        .isSimulator,
        .bundleId
    ]

    let allDeviceInfo = orderedDeviceInfoTypes.reduce(into: [String: String]()) { result, deviceInfoType in
        result[deviceInfoType.name] = getDeviceInfoValue(deviceInfoType)
    }

    guard let jsonData = try? JSONSerialization.data(withJSONObject: allDeviceInfo, options: .prettyPrinted),
          let jsonString = String(data: jsonData, encoding: .utf8) else {
        return
    }
    dependency.clipboardDriver.copy(jsonString)
    showCopyAlert = true
}
```

### DeviceInfoTypeã®æ‹¡å¼µ

`DeviceInfoType` ã«åå‰ã‚’å–å¾—ã™ã‚‹ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’è¿½åŠ ã—ã¾ã™ã€‚

```swift
extension DeviceInfoType: Identifiable {
    public var id: String {
        name
    }

    var name: String {
        switch self {
        case .appVersion:
            return "App Version"
        case .osVersion:
            return "OS Version"
        case .buildScheme:
            return "Build Scheme"
        case .buildConfiguration:
            return "Build Configuration"
        case .bundleId:
            return "Bundle ID"
        case .isSimulator:
            return "Is Simulator"
        case .isPreview:
            return "Is Preview"
        case .deviceName:
            return "Device Name"
        case .deviceIdentifier:
            return "Device Identifier"
        case .timezone:
            return "Timezone"
        case .preferredLanguages:
            return "Preferred Languages"
        case .language:
            return "Language"
        case .launchAppCount:
            return "Launch App Count"
        case .apnsToken:
            return "APNs Token"
        }
    }
}
```

ã“ã®æ–¹æ³•ã«ã‚ˆã‚Šã€`DeviceInfoType` ã®é †åºã‚’æŒ‡å®šã™ã‚‹å¿…è¦ãŒãªãã€`copyAllDeviceInfoAsJSON` é–¢æ•°å†…ã§é †åºä»˜ã‘ã‚’è¡Œã†ã ã‘ã§æ¸ˆã¿ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ã‚³ãƒ¼ãƒ‰ãŒã‚·ãƒ³ãƒ—ãƒ«ã§ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã—ã‚„ã™ããªã‚Šã¾ã™ã€‚

---

## ğŸ‘¤ ãƒ¦ãƒ¼ã‚¶ãƒ¼
*2024/06/12 09:31:59*

JSONSerialization ã® ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã«ãªã„ã®ã‹ï¼Ÿ

---

## ğŸ¤– ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ
*2024/06/12 09:32:15*

`JSONSerialization` ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã«ã€ã‚­ãƒ¼ã®é †åºã‚’æŒ‡å®šã™ã‚‹æ©Ÿèƒ½ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ã—ã‹ã—ã€ã‚­ãƒ¼ã‚’ç‰¹å®šã®é †åºã§è¿½åŠ ã™ã‚‹ã“ã¨ã§ã€é †åºã‚’ç¶­æŒã—ãŸJSONã‚’ç”Ÿæˆã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã¯ã€ãã®æ–¹æ³•ã‚’å®Ÿè£…ã—ã¦ã„ã¾ã™ã€‚

### DeviceInfoPresenter

`copyAllDeviceInfoAsJSON` é–¢æ•°ã‚’ä¿®æ­£ã—ã¦ã€ã‚­ãƒ¼ã®é †åºã‚’ç¶­æŒã™ã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚

```swift
func copyAllDeviceInfoAsJSON() {
    let orderedDeviceInfoTypes: [DeviceInfoType] = [
        .osVersion,
        .deviceName,
        .deviceIdentifier,
        .language,
        .appVersion,
        .buildConfiguration,
        .preferredLanguages,
        .launchAppCount,
        .timezone,
        .apnsToken,
        .isPreview,
        .buildScheme,
        .isSimulator,
        .bundleId
    ]

    var allDeviceInfo: [String: String] = [:]
    for deviceInfoType in orderedDeviceInfoTypes {
        allDeviceInfo[deviceInfoType.name] = getDeviceInfoValue(deviceInfoType)
    }

    guard let jsonData = try? JSONSerialization.data(withJSONObject: allDeviceInfo, options: .prettyPrinted),
          let jsonString = String(data: jsonData, encoding: .utf8) else {
        return
    }
    dependency.clipboardDriver.copy(jsonString)
    showCopyAlert = true
}
```

### DeviceInfoTypeã®æ‹¡å¼µ

`DeviceInfoType` ã«åå‰ã‚’å–å¾—ã™ã‚‹ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’è¿½åŠ ã—ã¾ã™ã€‚

```swift
extension DeviceInfoType: Identifiable {
    public var id: String {
        name
    }

    var name: String {
        switch self {
        case .appVersion:
            return "App Version"
        case .osVersion:
            return "OS Version"
        case .buildScheme:
            return "Build Scheme"
        case .buildConfiguration:
            return "Build Configuration"
        case .bundleId:
            return "Bundle ID"
        case .isSimulator:
            return "Is Simulator"
        case .isPreview:
            return "Is Preview"
        case .deviceName:
            return "Device Name"
        case .deviceIdentifier:
            return "Device Identifier"
        case .timezone:
            return "Timezone"
        case .preferredLanguages:
            return "Preferred Languages"
        case .language:
            return "Language"
        case .launchAppCount:
            return "Launch App Count"
        case .apnsToken:
            return "APNs Token"
        }
    }
}
```

ã“ã®æ–¹æ³•ã«ã‚ˆã‚Šã€æŒ‡å®šã—ãŸé †åºã§ã‚­ãƒ¼ã‚’è¿½åŠ ã—ã€é †åºã‚’ç¶­æŒã—ãŸJSONã‚’ç”Ÿæˆã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

---

## ğŸ‘¤ ãƒ¦ãƒ¼ã‚¶ãƒ¼
*2024/06/12 09:32:30*

sortedKeys ã¯ï¼Ÿ

---

## ğŸ¤– ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ
*2024/06/12 09:32:46*

`JSONSerialization`è‡ªä½“ã«ã¯ã‚­ãƒ¼ã®é †åºã‚’åˆ¶å¾¡ã™ã‚‹ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¯ã‚ã‚Šã¾ã›ã‚“ãŒã€Swiftã®æ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã£ã¦é †åºä»˜ã‘ã‚‰ã‚ŒãŸã‚­ãƒ¼ã‚’æ‰‹å‹•ã§è¿½åŠ ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ä»¥ä¸‹ã«ç¤ºã™æ–¹æ³•ã§ã€`sortedKeys`ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ä½¿ç”¨ã—ã¦JSONã®ã‚­ãƒ¼ã®é †åºã‚’ç¶­æŒã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

```swift
func copyAllDeviceInfoAsJSON() {
    let orderedDeviceInfoTypes: [DeviceInfoType] = [
        .osVersion,
        .deviceName,
        .deviceIdentifier,
        .language,
        .appVersion,
        .buildConfiguration,
        .preferredLanguages,
        .launchAppCount,
        .timezone,
        .apnsToken,
        .isPreview,
        .buildScheme,
        .isSimulator,
        .bundleId
    ]

    var allDeviceInfo: [String: String] = [:]
    for deviceInfoType in orderedDeviceInfoTypes {
        allDeviceInfo[deviceInfoType.name] = getDeviceInfoValue(deviceInfoType)
    }

    guard let jsonData = try? JSONSerialization.data(withJSONObject: allDeviceInfo, options: [.prettyPrinted, .sortedKeys]),
          let jsonString = String(data: jsonData, encoding: .utf8) else {
        return
    }
    dependency.clipboardDriver.copy(jsonString)
    showCopyAlert = true
}
```

### DeviceInfoTypeã®æ‹¡å¼µ

æ—¢å­˜ã®`DeviceInfoType`ã®æ‹¡å¼µã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

```swift
extension DeviceInfoType: Identifiable {
    public var id: String {
        name
    }

    var name: String {
        switch self {
        case .appVersion:
            return "App Version"
        case .osVersion:
            return "OS Version"
        case .buildScheme:
            return "Build Scheme"
        case .buildConfiguration:
            return "Build Configuration"
        case .bundleId:
            return "Bundle ID"
        case .isSimulator:
            return "Is Simulator"
        case .isPreview:
            return "Is Preview"
        case .deviceName:
            return "Device Name"
        case .deviceIdentifier:
            return "Device Identifier"
        case .timezone:
            return "Timezone"
        case .preferredLanguages:
            return "Preferred Languages"
        case .language:
            return "Language"
        case .launchAppCount:
            return "Launch App Count"
        case .apnsToken:
            return "APNs Token"
        }
    }
}
```

ã“ã®æ–¹æ³•ã§ã¯ã€`.sortedKeys`ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ä½¿ç”¨ã—ã¦ã€è¾æ›¸ã®ã‚­ãƒ¼ã‚’ã‚¢ãƒ«ãƒ•ã‚¡ãƒ™ãƒƒãƒˆé †ã«ã‚½ãƒ¼ãƒˆã—ã¦JSONã«å¤‰æ›ã™ã‚‹ãŸã‚ã€ã‚­ãƒ¼ã®é †åºãŒå›ºå®šã•ã‚Œã¾ã™ã€‚ã“ã‚Œã¯éå¸¸ã«ã‚¹ãƒãƒ¼ãƒˆãªæ–¹æ³•ã§ã™ãŒã€ã‚­ãƒ¼ã®é †åºãŒç‰¹å®šã®é †åºï¼ˆã‚¢ãƒ«ãƒ•ã‚¡ãƒ™ãƒƒãƒˆé †ï¼‰ã«ä¾å­˜ã™ã‚‹ã“ã¨ã«æ³¨æ„ãŒå¿…è¦ã§ã™ã€‚ã‚‚ã—ç‰¹å®šã®é †åºã‚’ç¶­æŒã—ãŸã„å ´åˆã€å…ˆã»ã©ã®æ–¹æ³•ã®ã‚ˆã†ã«é †åºä»˜ã‘ã‚‰ã‚ŒãŸé…åˆ—ã‚’ä½¿ç”¨ã™ã‚‹æ–¹æ³•ã‚‚ä¸€ã¤ã®æ‰‹ã§ã™ã€‚

---

## ğŸ‘¤ ãƒ¦ãƒ¼ã‚¶ãƒ¼
*2024/06/12 09:34:27*

ã“ã®4ã¤ã ã‘ã»ã—ã„

App Version
Build Scheme
Device Name
OS Version

---

## ğŸ¤– ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ
*2024/06/12 09:34:41*

ç‰¹å®šã®4ã¤ã®ãƒ‡ãƒã‚¤ã‚¹æƒ…å ±ã®ã¿ã‚’JSONã«å«ã‚ã€é †åºã‚’å›ºå®šã™ã‚‹ãŸã‚ã«ã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ã«å®Ÿè£…ã§ãã¾ã™ã€‚

### DeviceInfoPresenter

`copyAllDeviceInfoAsJSON` é–¢æ•°ã‚’ä¿®æ­£ã—ã¦ã€å¿…è¦ãªãƒ‡ãƒã‚¤ã‚¹æƒ…å ±ã®ã¿ã‚’å–å¾—ã—ã€é †åºã‚’å›ºå®šã—ã¾ã™ã€‚

```swift
func copyAllDeviceInfoAsJSON() {
    let orderedDeviceInfoTypes: [DeviceInfoType] = [
        .appVersion,
        .buildScheme,
        .deviceName,
        .osVersion
    ]

    var allDeviceInfo: [String: String] = [:]
    for deviceInfoType in orderedDeviceInfoTypes {
        allDeviceInfo[deviceInfoType.name] = getDeviceInfoValue(deviceInfoType)
    }

    guard let jsonData = try? JSONSerialization.data(withJSONObject: allDeviceInfo, options: .prettyPrinted),
          let jsonString = String(data: jsonData, encoding: .utf8) else {
        return
    }
    dependency.clipboardDriver.copy(jsonString)
    showCopyAlert = true
}
```

### DeviceInfoTypeã®æ‹¡å¼µ

æ—¢å­˜ã® `DeviceInfoType` ã®æ‹¡å¼µã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

```swift
extension DeviceInfoType: Identifiable {
    public var id: String {
        name
    }

    var name: String {
        switch self {
        case .appVersion:
            return "App Version"
        case .osVersion:
            return "OS Version"
        case .buildScheme:
            return "Build Scheme"
        case .buildConfiguration:
            return "Build Configuration"
        case .bundleId:
            return "Bundle ID"
        case .isSimulator:
            return "Is Simulator"
        case .isPreview:
            return "Is Preview"
        case .deviceName:
            return "Device Name"
        case .deviceIdentifier:
            return "Device Identifier"
        case .timezone:
            return "Timezone"
        case .preferredLanguages:
            return "Preferred Languages"
        case .language:
            return "Language"
        case .launchAppCount:
            return "Launch App Count"
        case .apnsToken:
            return "APNs Token"
        }
    }
}
```

ã“ã®ã‚³ãƒ¼ãƒ‰ã«ã‚ˆã‚Šã€æŒ‡å®šã•ã‚ŒãŸ4ã¤ã®ãƒ‡ãƒã‚¤ã‚¹æƒ…å ±ã®ã¿ãŒé †åºä»˜ã‘ã‚‰ã‚Œã¦JSONå½¢å¼ã§ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã•ã‚Œã¾ã™ã€‚ã“ã‚Œã§å¿…è¦ãªæƒ…å ±ã®ã¿ãŒå«ã¾ã‚Œã€é †åºã‚‚æŒ‡å®šé€šã‚Šã«å›ºå®šã•ã‚Œã¾ã™ã€‚

---

## ğŸ‘¤ ãƒ¦ãƒ¼ã‚¶ãƒ¼
*2024/06/12 09:37:27*

orderedDeviceInfoTypes ã§ã¯ãªãã¦ã€ã‚³ãƒ”ãƒ¼ã™ã¹ãã¨ã„ã†æ„å‘³åˆã„ã®å¤‰æ•°åã‚’æ•™ãˆã¦ã»ã—ã„ã€‚boolãŒã„ã„


extension DeviceInfoType {
    var isNeedDebug: Bool {
        self {
        case .appVersion, .buildScheme, .deviceName, .osVersion:
            true
        default:
            false
        }
    }
}

---

## ğŸ¤– ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ
*2024/06/12 09:37:38*

`isNeedDebug` ã®ä»£ã‚ã‚Šã«ã€`isCopyRequired` ã¨ã„ã†å¤‰æ•°åã‚’ææ¡ˆã—ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ã“ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãŒã‚³ãƒ”ãƒ¼ã™ã¹ãæƒ…å ±ã‹ã©ã†ã‹ã‚’ç¤ºã—ã¦ã„ã‚‹ã“ã¨ãŒæ˜ç¢ºã«ãªã‚Šã¾ã™ã€‚

### DeviceInfoTypeã®æ‹¡å¼µ

```swift
extension DeviceInfoType {
    var isCopyRequired: Bool {
        switch self {
        case .appVersion, .buildScheme, .deviceName, .osVersion:
            return true
        default:
            return false
        }
    }
}
```

### DeviceInfoPresenter

`copyAllDeviceInfoAsJSON` é–¢æ•°ã‚’ä¿®æ­£ã—ã¦ã€`isCopyRequired` ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’ä½¿ç”¨ã™ã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚

```swift
func copyAllDeviceInfoAsJSON() {
    let allDeviceInfo = DeviceInfoType.allCases
        .filter { $0.isCopyRequired }
        .reduce(into: [String: String]()) { result, deviceInfoType in
            result[deviceInfoType.name] = getDeviceInfoValue(deviceInfoType)
        }

    guard let jsonData = try? JSONSerialization.data(withJSONObject: allDeviceInfo, options: .prettyPrinted),
          let jsonString = String(data: jsonData, encoding: .utf8) else {
        return
    }
    dependency.clipboardDriver.copy(jsonString)
    showCopyAlert = true
}
```

ã“ã®æ–¹æ³•ã«ã‚ˆã‚Šã€ã‚³ãƒ”ãƒ¼ã™ã¹ãæƒ…å ±ã®ã¿ã‚’å«ã‚ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚`isCopyRequired` ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’ä½¿ã£ã¦ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã—ã€æŒ‡å®šã•ã‚ŒãŸ4ã¤ã®ãƒ‡ãƒã‚¤ã‚¹æƒ…å ±ã®ã¿ãŒJSONã«å«ã¾ã‚Œã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚

---
