# Êàª„ÇãÊôÇ„ÅÆ„ÉÄ„Ç§„Ç¢„É≠„Ç∞

Êó•‰ªò: 2025-01-24

---

## üë§ „É¶„Éº„Ç∂„Éº
*2025/1/24 23:38:11*

{
  "content_type": "image_asset_pointer",
  "asset_pointer": "file-service://file-2CKh4MsMU7bKyw9mw4FhCZ",
  "size_bytes": 97774,
  "width": 354,
  "height": 774,
  "fovea": null,
  "metadata": {
    "dalle": null,
    "gizmo": null,
    "generation": null,
    "container_pixel_height": null,
    "container_pixel_width": null,
    "emu_omit_glimpse_image": null,
    "emu_patches_override": null,
    "sanitized": true,
    "asset_pointer_link": null,
    "watermarked_asset_pointer": null
  }
}
{
  "content_type": "image_asset_pointer",
  "asset_pointer": "file-service://file-QcyUs1vBCsAecce1abNXyF",
  "size_bytes": 75901,
  "width": 360,
  "height": 784,
  "fovea": null,
  "metadata": {
    "dalle": null,
    "gizmo": null,
    "generation": null,
    "container_pixel_height": null,
    "container_pixel_width": null,
    "emu_omit_glimpse_image": null,
    "emu_patches_override": null,
    "sanitized": true,
    "asset_pointer_link": null,
    "watermarked_asset_pointer": null
  }
}
„Åì„ÅÆÁîªÈù¢„Åã„ÇâÊàª„ÇãÊôÇ„Å´editingCameraListState„ÅÆÂàùÊúüÂÄ§„Å®Â§âÊõ¥„Åå„ÅÇ„Çã„Å®„Åç„Å´„ÉÄ„Ç§„Ç¢„É≠„Ç∞„ÇíË°®Á§∫„Åï„Åõ„Åü„ÅÑ

„Åæ„Åü„ÄÅÔºëÊûöÁõÆ„ÅÆ„Çà„ÅÜ„Å´ÈÖçÁΩÆ„Å´„Ç®„É©„Éº„ÅåÁô∫Áîü„Åó„Å¶„ÅÑ„Çã„ÅÆ„Åß„ÄÅÔºíÊûöÁõÆ„ÅÆ„Çà„ÅÜ„Å´Âèé„Åæ„Çã„Çà„ÅÜ„Å´„Åó„Åü„ÅÑ

import 'package:flutter/material.dart';
import 'package:go_router/go_router.dart';
import 'package:hooks_riverpod/hooks_riverpod.dart';
import 'package:snpit_guild_app/domain/design/color_pallet.dart';
import 'package:snpit_guild_app/domain/design/color_token.dart';
import 'package:snpit_guild_app/infrastructure/entities/extensions/camera_dto_x.dart';
import 'package:snpit_guild_app/presentation/pages/camera_list_page.dart';
import 'package:snpit_guild_app/presentation/providers/api_client/decks/create_deck.dart';
import 'package:snpit_guild_app/presentation/providers/api_client/decks/update_deck.dart';
import 'package:snpit_guild_app/presentation/providers/editing_camera_list.dart';
import 'package:snpit_guild_app/presentation/widgets/parameters_bar_column.dart';
import 'package:snpit_guild_app/presentation/widgets/square_image.dart';
import 'package:snpit_guild_app/presentation/widgets/total_parameters_row.dart';
import 'package:snpit_guild_app/utils/snack_bar_utils.dart';

class DeckDetailPage extends HookConsumerWidget {
  const DeckDetailPage({super.key, required this.deckId});
  final String? deckId;

  @override
  Widget build(BuildContext context, WidgetRef ref) {
    final editingCameraListState = ref.watch(editingCameraListNotifierProvider);

    void showCameraListBottomSheet() {
      showModalBottomSheet&lt;void&gt;(
        context: context,
        isScrollControlled: true,
        builder: (context) {
          return const FractionallySizedBox(
            heightFactor: 0.7,
            child: ClipRRect(
              borderRadius: BorderRadius.vertical(top: Radius.circular(16)),
              child: CameraListPage(),
            ),
          );
        },
      );
    }

    Future&lt;void&gt; onTapDeleteCamera(String cameraId) async {
      ref
          .read(editingCameraListNotifierProvider.notifier)
          .deleteCameraById(cameraId);
    }

    Future&lt;void&gt; onTapPutCamera() async {
      showCameraListBottomSheet();
    }

    Future&lt;void&gt; onTapSave() async {
      try {
        final cameraIds = ref
            .read(editingCameraListNotifierProvider)
            .where((camera) =&gt; camera.cameraId != null)
            .map((camera) =&gt; camera.cameraId.toString())
            .toList();
        if (deckId != null) {
          await ref
              .read(updateDeckNotifierProvider.notifier)
              .updateDeck(deckId!, cameraIds);
        } else {
          await ref.read(createDeckNotifierProvider.notifier).createDeck(
                cameraIds,
              );
        }
        if (context.mounted) {
          context.pop();
        }
      } on Exception catch (error) {
        if (context.mounted) {
          showErrorSnackBar(context, error);
        }
      }
    }

    return Scaffold(
      appBar: AppBar(
        title: const Text('Edit Deck'),
      ),
      body: SingleChildScrollView(
        child: Padding(
          padding: const EdgeInsets.all(16),

          // Cmaera Total Status
          child: DecoratedBox(
            decoration: BoxDecoration(
              color: ColorToken.bg,
              borderRadius: BorderRadius.circular(8),
              border: Border.all(
                color: ColorToken.border,
              ),
            ),
            child: Column(
              children: [
                Padding(
                  padding: const EdgeInsets.all(16),
                  child: TotalParametersRow(
                    searchValue: editingCameraListState.totalSearchQ,
                    attackValue: editingCameraListState.totalAttackE,
                    luckValue: editingCameraListState.totalLuckL,
                    defenceValue: editingCameraListState.totalDefenseB,
                  ),
                ),

                // „Éà„Éº„Çø„É´„Éë„É©„É°„Éº„Çø„Å®„Ç´„É°„É©‰∏ÄË¶ß„ÅÆÈñì„Å´Âå∫Âàá„ÇäÁ∑ö
                Container(
                  height: 1,
                  color: ColorToken.border,
                ),

                // Camera list
                Column(
                  children: editingCameraListState.asMap().entries.map((entry) {
                    final index = entry.key;
                    final camera = entry.value;

                    return Column(
                      children: [
                        Padding(
                          padding: const EdgeInsets.all(16),
                          child: Row(
                            children: [
                              // Left
                              Expanded(
                                child: Row(
                                  crossAxisAlignment: CrossAxisAlignment.start,
                                  children: [
                                    ClipRRect(
                                      borderRadius: BorderRadius.circular(4),
                                      child: SquareImage(
                                        imageUrl: camera.cameraUrl,
                                        size: 78,
                                      ),
                                    ),
                                    const SizedBox(width: 8),
                                    Column(
                                      crossAxisAlignment:
                                          CrossAxisAlignment.start,
                                      children: [
                                        Text(
                                          camera.rarity ?? '',
                                          style: const TextStyle(
                                            fontSize: 12,
                                          ),
                                        ),
                                        const SizedBox(height: 8),
                                        Text(
                                          'Lv.${camera.level}',
                                          style: const TextStyle(
                                            fontSize: 12,
                                          ),
                                        ),
                                      ],
                                    ),
                                  ],
                                ),
                              ),
                              // Right
                              Expanded(
                                child: ParametersBarColumn(
                                  searchValue: camera.searchQ ?? 100,
                                  attackValue: camera.attackE ?? 10,
                                  luckValue: camera.luckL ?? 0,
                                  defenceValue: camera.defenseB ?? 0,
                                ),
                              ),
                              // Delete button
                              IconButton(
                                icon: const Icon(
                                  Icons.remove_circle_outline,
                                  size: 24,
                                  color: ColorPallet.red400,
                                ),
                                onPressed: () async {
                                  await onTapDeleteCamera(camera.cameraId!);
                                },
                              ),
                            ],
                          ),
                        ),
                        if (index &lt; editingCameraListState.length - 1)
                          Container(
                            height: 1,
                            color: ColorToken.border,
                          ),
                      ],
                    );
                  }).toList(),
                ),

                Container(
                  height: 1,
                  color: ColorToken.border,
                ),

                // Put camera button
                if (editingCameraListState.length &lt; 4)
                  Padding(
                    padding: const EdgeInsets.all(16),
                    child: OutlinedButton(
                      child: const Stack(
                        alignment: Alignment.centerLeft,
                        children: [
                          Positioned(
                            child: Icon(
                              Icons.add,
                              size: 24,
                              color: ColorToken.text,
                            ),
                          ),
                          Center(
                            child: Text(
                              'Put camera',
                            ),
                          ),
                        ],
                      ),
                      onPressed: () async {
                        await onTapPutCamera();
                      },
                    ),
                  ),
              ],
            ),
          ),
        ),
      ),
      bottomNavigationBar: SafeArea(
        child: Padding(
          padding: const EdgeInsets.all(16),
          child: ElevatedButton(
            onPressed: () async {
              await onTapSave();
            },
            child: const Text('Save'),
          ),
        ),
      ),
    );
  }
}

import 'package:riverpod_annotation/riverpod_annotation.dart';
import 'package:snpit_guild_app/infrastructure/entities/extensions/camera_dto_x.dart';
import 'package:snpit_guild_app/infrastructure/snapit_guild_api/snapit_guild_api.openapi.dart';

part 'editing_camera_list.g.dart';

@Riverpod(keepAlive: true)
class EditingCameraListNotifier extends _$EditingCameraListNotifier {
  @override
  List&lt;CameraDTO&gt; build() =&gt; [];

  void setCameraList(List&lt;CameraDTO&gt; newCameraList) {
    state = newCameraList.sorted();
  }

  void addCamera(CameraDTO camera) {
    if (state.length &lt; 4) {
      state = [...state, camera].sorted();
    }
  }

  void deleteCameraById(String cameraId) {
    state =
        state.where((camera) =&gt; camera.cameraId != cameraId).toList().sorted();
  }
}

---

## ü§ñ „Ç¢„Ç∑„Çπ„Çø„É≥„Éà
*2025/1/24 23:40:04*

‰∏ãË®ò„ÅÆ„Çà„ÅÜ„Å´„Éù„Ç§„É≥„Éà„ÅØÂ§ß„Åç„Åè2„Å§„ÅÇ„Çä„Åæ„Åô„ÄÇ

1. **Á∑®ÈõÜÂâç„Å®Á∑®ÈõÜÂæå„ÅÆÂ∑ÆÂàÜ„ÉÅ„Çß„ÉÉ„ÇØ„Çí„Åó„Å¶„ÄÅÊàª„ÇãÔºàpopÔºâÊôÇ„Å´„ÉÄ„Ç§„Ç¢„É≠„Ç∞„ÇíË°®Á§∫„Åô„Çã**  
2. **Row „ÅÆ„É¨„Ç§„Ç¢„Ç¶„Éà„ÇíË™øÊï¥„Åó„Å¶„ÄÅ1ÊûöÁõÆ„ÅÆ„Çà„ÅÜ„Å´„ÉÜ„Ç≠„Çπ„Éà„ÅåÂ¥©„Çå„Å™„ÅÑ„Çà„ÅÜ„Å´„Åô„Çã**

---

## 1. „ÄåÊàª„Çã„ÄçÊôÇ„ÅÆ„ÉÄ„Ç§„Ç¢„É≠„Ç∞Ë°®Á§∫

`Scaffold` „Çí„Åù„ÅÆ„Åæ„Åæ `WillPopScope` „Åß„É©„ÉÉ„Éó„Åó„Å¶„ÄÅ`onWillPop` „ÅÆ‰∏≠„Åß  
„ÄåÁ∑®ÈõÜÂâç„Å®Á∑®ÈõÜÂæå„ÅßÂ∑ÆÂàÜ„Åå„ÅÇ„Çã„Åã„Å©„ÅÜ„Åã„Äç„Çí„ÉÅ„Çß„ÉÉ„ÇØ„Åô„Çã„Çà„ÅÜ„Å´„Åó„Åæ„Åô„ÄÇ  
„ÇÇ„ÅóÂ∑ÆÂàÜ„Åå„ÅÇ„Çå„Å∞„ÉÄ„Ç§„Ç¢„É≠„Ç∞„ÇíË°®Á§∫„Åó„ÄÅ„ÄåÁ†¥Ê£Ñ„Åó„Å¶Êàª„ÇãÔºè„Ç≠„É£„É≥„Çª„É´„Äç„Çí„É¶„Éº„Ç∂„Éº„Å´ÈÅ∏„Å∞„Åõ„Åæ„Åô„ÄÇ

„Åü„Å®„Åà„Å∞‰ª•‰∏ã„ÅÆ„Çà„ÅÜ„Å´ÂÆüË£Ö„Åß„Åç„Åæ„ÅôÔºà‰æã„Å®„Åó„Å¶ StateNotifier Á≠â„ÅØÁúÅÁï•„Åó„ÄÅË¶ÅÁÇπ„ÅÆ„ÅøÁ§∫„Åó„Åæ„ÅôÔºâ„ÄÇ

```dart
class DeckDetailPage extends HookConsumerWidget {
  const DeckDetailPage({super.key, required this.deckId});
  final String? deckId;

  @override
  Widget build(BuildContext context, WidgetRef ref) {
    // Á∑®ÈõÜ‰∏≠„ÅÆÁä∂ÊÖã
    final editingCameraListState = ref.watch(editingCameraListNotifierProvider);

    // ÁîªÈù¢„ÇíÂàùÊúüË°®Á§∫„Åó„ÅüÊôÇÁÇπ„ÅÆ„É™„Çπ„Éà„Çí„Ç≥„Éî„Éº„Åó„Å¶„Åä„Åè
    // Ôºà„ÅÇ„Çã„ÅÑ„ÅØ„ÄÅÂàùÊúü„ÅÆ„É™„Çπ„Éà„ÇíÂà•„ÅÆ„Éó„É≠„Éê„Ç§„ÉÄÁ≠â„Åß‰øùÊåÅ„Åó„Å¶„ÇÇ„Çà„ÅÑÔºâ
    final initialCameraList = useMemoized(
      () => List<CameraDTO>.from(editingCameraListState),
      // ÊØîËºÉ„ÅÆ„Åü„ÇÅ„Å´„ÅØ cameraId „Å™„Å©„ÅåÂêå„Åò„Åã„Å©„ÅÜ„ÅãÂà§ÂÆö„ÅåÂøÖË¶Å
      // „Åñ„Å£„Åè„Çä„Äå„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„ÅÆ„É™„Çπ„Éà„Åå„Ç§„Ç≥„Éº„É´„Åã„Äç„ÅßÂà§Êñ≠„Åó„Åü„ÅÑ„Å™„Çâ equals/hash „ÇíÊåÅ„Åü„Åõ„Çã
    );

    Future<bool> _onWillPop() async {
      // Â∑ÆÂàÜ„Åå„ÅÇ„Çã„Åã„Å©„ÅÜ„Åã„ÇíÂà§ÂÆö
      final hasChanged = _isDifferent(initialCameraList, editingCameraListState);

      if (!hasChanged) {
        // Â§âÊõ¥„Å™„Åó„Å™„Çâ„Åù„ÅÆ„Åæ„ÅæÊàª„Çã
        return true;
      }

      // Â§âÊõ¥„Åå„ÅÇ„ÇãÂ†¥Âêà„ÅØ„ÉÄ„Ç§„Ç¢„É≠„Ç∞„ÇíÂá∫„Åô
      final result = await showDialog<bool>(
        context: context,
        builder: (_) {
          return AlertDialog(
            title: const Text('Á†¥Ê£Ñ„Åó„Åæ„Åô„ÅãÔºü'),
            content: const Text('Á∑®ÈõÜÂÜÖÂÆπ„Åå‰øùÂ≠ò„Åï„Çå„Å¶„ÅÑ„Åæ„Åõ„Çì„ÄÇÁ†¥Ê£Ñ„Åó„Å¶Êàª„Çä„Åæ„Åô„ÅãÔºü'),
            actions: [
              TextButton(
                onPressed: () => Navigator.of(context).pop(false),
                child: const Text('„Ç≠„É£„É≥„Çª„É´'),
              ),
              TextButton(
                onPressed: () => Navigator.of(context).pop(true),
                child: const Text('Á†¥Ê£Ñ„Åô„Çã'),
              ),
            ],
          );
        },
      );

      // „ÉÄ„Ç§„Ç¢„É≠„Ç∞„ÅÆÁµêÊûú„Åå true „ÅÆÂ†¥Âêà„ÅÆ„Åø pop „ÇíË®±ÂèØ
      return result ?? false;
    }

    return WillPopScope(
      onWillPop: _onWillPop,
      child: Scaffold(
        appBar: AppBar(title: const Text('Edit Deck')),
        // ‰ª•‰∏ã„ÅØÂÖÉ„ÅÆÂÆüË£Ö
        body: ...,
      ),
    );
  }

  /// Â∑ÆÂàÜ„ÉÅ„Çß„ÉÉ„ÇØÁî®„ÅÆÈñ¢Êï∞Ôºà‰æãÔºâ
  bool _isDifferent(List<CameraDTO> initialList, List<CameraDTO> currentList) {
    if (initialList.length != currentList.length) {
      return true;
    }
    // cameraId „Éô„Éº„Çπ„ÅßÊØîËºÉ„Åó„Å¶„Åø„Çã„Å™„Å©
    for (int i = 0; i < initialList.length; i++) {
      if (initialList[i].cameraId != currentList[i].cameraId) {
        return true;
      }
      // „É¨„Éô„É´„ÇÑ„Éë„É©„É°„Éº„Çø„ÅåÂ§âÊõ¥„Åï„Çå„Åü„Åã„Å©„ÅÜ„Åã„ÉÅ„Çß„ÉÉ„ÇØ„Åô„Çã„Å™„Çâ„Åì„Åì„ÅßË¶ã„Çã
      // if (initialList[i].level != currentList[i].level) return true;
      // ...
    }
    return false;
  }
}
```

### Ë£úË∂≥
- `useMemoized` „ÅØÊúÄÂàù„ÅÆ build „Çø„Ç§„Éü„É≥„Ç∞„Åß `editingCameraListState` „Çí„Ç≥„Éî„Éº„Åó„ÄÅ„É™„Éì„É´„ÉâÊôÇ„Å´„ÅØÂÜçË©ï‰æ°„Åï„Çå„Å™„ÅÑ„Çà„ÅÜ„Å´„Åô„Çã„Åü„ÇÅ„ÅÆ HookÔºà`flutter_hooks`Ôºâ„Åß„Åô„ÄÇ  
- Riverpod „Çí‰Ωø„Å£„Å¶„ÅÑ„ÇãÂ†¥Âêà„ÄÅÁîªÈù¢ÊúÄÂàù„Å´ÂèñÂæó„Åó„Åü„Éá„Éº„ÇøÔºà‚âí„Çµ„Éº„Éê„Éº„Åã„ÇâÂèñÂæó„Åó„Åü„Éá„ÉÉ„Ç≠„ÅÆÁä∂ÊÖãÔºâ„Çí„Å©„Åì„Åã„Åß‰∏ÄÂ∫¶„Å†„Åë‰øùÊåÅ„Åó„Å¶„Åä„Åç„ÄÅ„Åù„Çå„Çí„ÄåÂàùÊúüÁä∂ÊÖã„Äç„Å®„Åó„Å¶ÊØîËºÉ„Åô„ÇãË®≠Ë®à„Åß„ÇÇ OK „Åß„Åô„ÄÇ  
- Â∑ÆÂàÜ„ÉÅ„Çß„ÉÉ„ÇØ„ÅÆ„É≠„Ç∏„ÉÉ„ÇØ„ÅØ„ÄÅ„Ç´„É°„É©Êï∞„ÇÑ `cameraId`„ÄÅ„ÇÇ„Åó„Åè„ÅØ„É¨„Éô„É´„Å™„Å©„ÄÅÂøÖË¶Å„Å™„ÇÇ„ÅÆ„ÇíÊØîËºÉ„Åô„ÇãÂΩ¢„Å´Â§âÊõ¥„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ

---

## 2. „É¨„Ç§„Ç¢„Ç¶„Éà„ÅÆÂ¥©„Çå„ÇíÁõ¥„Åô

`Row` „Å´ `Expanded` „Çí2„Å§‰ª•‰∏äÂÖ•„Çå„Å¶„ÅÑ„ÇãÂ†¥Âêà„ÄÅÊ®™ÂπÖ„Çí 1:1 „ÅßÂàÜÂâ≤„Åó„Å¶„Åó„Åæ„ÅÜ„Åü„ÇÅ„ÄÅ  
„ÉÜ„Ç≠„Çπ„ÉàÈáè„ÇÑÁîªÈù¢ÂπÖ„Å´„Çà„Å£„Å¶„ÅØ„É¨„Ç§„Ç¢„Ç¶„Éà„ÅåÁ™ÆÂ±à„Å´„Å™„Çä„Åæ„Åô„ÄÇ  
„Åæ„Åü„ÄÅË§áÊï∞„ÅÆ `Expanded` „Çí‰Ωø„ÅÜ„Å®„ÄÅ„É¨„Ç§„Ç¢„Ç¶„Éà„ÅåÊÑèÂõ≥„Åõ„ÅöÂúßÁ∏Æ„Åï„Çå„Çã„Åì„Å®„ÇÇ„ÅÇ„Çä„Åæ„Åô„ÄÇ

1ÊûöÁõÆ„ÅÆ„Ç≥„Éº„Éâ„Åß„ÅØ„ÄÅ„Ç´„É°„É©ÊÉÖÂ†±ÔºàÁîªÂÉè + Rarity/LevelÔºâ„Å®„ÄÅ  
„Çπ„ÉÜ„Éº„Çø„ÇπÔºà`ParametersBarColumn`Ôºâ„Åå„Åù„Çå„Åû„Çå `Expanded` „Å´„Å™„Å£„Å¶„ÅÑ„Åæ„Åô„ÄÇ  
„Åü„Å®„Åà„Å∞Ê¨°„ÅÆ„Çà„ÅÜ„Å´Êõ∏„ÅçÊèõ„Åà„Çã„Å®„ÄÅÂ∑¶ÂÅ¥Ôºà„Ç´„É°„É©ÊÉÖÂ†±Ôºâ„ÅØÂøÖË¶Å„Å™„Å†„Åë„ÅÆÂπÖ„ÇíÂèñ„Çä„ÄÅ  
‰∏≠Â§ÆÔΩûÂè≥ÂÅ¥Ôºà„Çπ„ÉÜ„Éº„Çø„ÇπÔºãÂâäÈô§„Éú„Çø„É≥Ôºâ„ÅØÊÆã„Çä„ÅÆ„Çπ„Éö„Éº„Çπ„Çí‰Ωø„ÅÜ„Çà„ÅÜ„Å´„Å™„Çä„ÄÅ  
„ÉÜ„Ç≠„Çπ„ÉàÂ¥©„Çå„ÇíÈÅø„Åë„Çâ„Çå„Çã„Åì„Å®„ÅåÂ§ö„ÅÑ„Åß„Åô„ÄÇ

```dart
Row(
  crossAxisAlignment: CrossAxisAlignment.start,
  children: [
    // ----- Â∑¶Ôºö„Ç´„É°„É©ÁîªÂÉè„Å® Rarity / Level -----
    // Expanded „Åß„ÅØ„Å™„Åè„ÄÅÂ≠êË¶ÅÁ¥†„Åå„Åù„ÅÆ„Åæ„Åæ„ÅÆ„Çµ„Ç§„Ç∫„Çí„Å®„Çã„Çà„ÅÜ„Å´„Åô„Çã
    Row(
      mainAxisSize: MainAxisSize.min,
      crossAxisAlignment: CrossAxisAlignment.start,
      children: [
        ClipRRect(
          borderRadius: BorderRadius.circular(4),
          child: SquareImage(
            imageUrl: camera.cameraUrl,
            size: 78,
          ),
        ),
        const SizedBox(width: 8),
        Column(
          crossAxisAlignment: CrossAxisAlignment.start,
          children: [
            Text(
              camera.rarity ?? '',
              style: const TextStyle(fontSize: 12),
            ),
            const SizedBox(height: 8),
            Text(
              'Lv.${camera.level}',
              style: const TextStyle(fontSize: 12),
            ),
          ],
        ),
      ],
    ),

    const SizedBox(width: 16),

    // ----- ‰∏≠Â§ÆÔΩûÂè≥Ôºö„Çπ„ÉÜ„Éº„Çø„ÇπË°®Á§∫„Å®ÂâäÈô§„Ç¢„Ç§„Ç≥„É≥ -----
    // „Åì„Åì„ÅØÂ§ß„Åç„ÅèÂπÖ„Çí‰Ωø„ÅÜ„Çà„ÅÜ„Å´ Expanded „Çí‰Ωø„ÅÜ
    Expanded(
      child: Row(
        crossAxisAlignment: CrossAxisAlignment.start,
        children: [
          // „Çπ„ÉÜ„Éº„Çø„Çπ
          Expanded(
            child: ParametersBarColumn(
              searchValue: camera.searchQ ?? 100,
              attackValue: camera.attackE ?? 10,
              luckValue: camera.luckL ?? 0,
              defenceValue: camera.defenseB ?? 0,
            ),
          ),
          // ÂâäÈô§„Éú„Çø„É≥
          IconButton(
            icon: const Icon(
              Icons.remove_circle_outline,
              size: 24,
              color: ColorPallet.red400,
            ),
            onPressed: () async {
              await onTapDeleteCamera(camera.cameraId!);
            },
          ),
        ],
      ),
    ),
  ],
);
```

„Åì„ÅÜ„Åô„Çã„Åì„Å®„Åß„ÄÅ

- **Â∑¶„ÅÆ„Ç´„É°„É©ÊÉÖÂ†±**„ÅØÂøÖË¶Å„Å™Ê®™ÂπÖ„Å†„ÅëÁ¢∫‰øù
- Áúü„Çì‰∏≠ÔΩûÂè≥„Çí**1„Å§„ÅÆ `Expanded`** „ÅßÊâ±„ÅÑ„ÄÅ  
  „Åù„Åì„Å´„Çπ„ÉÜ„Éº„Çø„ÇπÔºà`ParametersBarColumn`Ôºâ„Å®ÂâäÈô§„Éú„Çø„É≥„ÇíÊ®™‰∏¶„Å≥„Å´„Åô„Çã

„Å®„ÅÑ„ÅÜÊßãÊàê„Å´„Å™„Çä„ÄÅ1ÊûöÁõÆ„ÅÆ„Çπ„ÇØ„É™„Éº„É≥„Ç∑„Éß„ÉÉ„Éà„ÅÆ„Çà„ÅÜ„Å´  
„ÉÜ„Ç≠„Çπ„Éà„ÅåÈáç„Å™„Å£„Å¶„Åó„Åæ„ÅÜ/Âè≥„Å´„ÅØ„ÅøÂá∫„Å¶„Åó„Åæ„ÅÜÁ≠â„ÅÆ‰∏çÂÖ∑Âêà„ÅåËµ∑„Åç„Å´„Åè„Åè„Å™„Çä„Åæ„Åô„ÄÇ

---

## „Åæ„Å®„ÇÅ

- ÁîªÈù¢„ÇíÈñâ„Åò„ÇãÂâç„Å´Â∑ÆÂàÜ„Çí„ÉÅ„Çß„ÉÉ„ÇØ„Åó„Åü„ÅÑÂ†¥Âêà„ÅØ„ÄÅ`WillPopScope` + „ÉÄ„Ç§„Ç¢„É≠„Ç∞„Åß„ÄåÊú¨ÂΩì„Å´Á†¥Ê£Ñ„Åó„Å¶„ÇÇ„Çà„ÅÑ„Åã„Äç„ÇíÁ¢∫Ë™ç„Åô„ÇãÂÆüË£Ö„ÇíÂÖ•„Çå„Çã„ÄÇ  
- „É¨„Ç§„Ç¢„Ç¶„Éà„ÅåÂ¥©„Çå„ÇãÂ†¥Âêà„ÅØ„ÄÅ`Row` „ÅßË§áÊï∞„ÅÆ `Expanded` „Çí‰Ωø„ÅÑ„Åô„Åé„Å¶„ÅÑ„Å™„ÅÑ„ÅãÁ¢∫Ë™ç„Åó„ÄÅÂøÖË¶Å„Å´Âøú„Åò„Å¶ `mainAxisSize: MainAxisSize.min` „ÇÑ `SizedBox`„Éª`Expanded` „ÅÆ‰Ωø„ÅÑÊñπ„ÇíÂ∑•Â§´„Åô„Çã„ÄÇ  

„Åì„Çå„Çâ„ÇíÈÅ©Áî®„Åô„Çã„Å®„ÄÅ  
- „ÄåÂ§âÊõ¥„Åå„ÅÇ„Å£„Åü„Å®„Åç„Å´„ÅØÊàª„ÇãÈöõ„Å´Ë≠¶Âëä„ÉÄ„Ç§„Ç¢„É≠„Ç∞„Äç  
- „ÄåUI „ÅÆÂ¥©„Çå‰øÆÊ≠£„Äç  
„Åå„Åß„Åç„Çã„Çà„ÅÜ„Å´„Å™„Çä„Åæ„Åô„ÄÇ„Åú„Å≤„ÅäË©¶„Åó„Åè„Å†„Åï„ÅÑ„ÄÇ

---

## üë§ „É¶„Éº„Ç∂„Éº
*2025/1/24 23:50:23*

„Åì„ÅÆ„Çà„ÅÜ„Å™„Ç§„É≥„Çø„Éº„Éï„Çß„Éº„Çπ„Å´Â§â„Çè„Å£„Åü„Åø„Åü„ÅÑÂØæÂøú„Åó„Å¶„Åª„Åó„ÅÑ

PopScope(
      canPop: false,
      onPopInvokedWithResult: (didPop, result) async {
        if (didPop) {
          return;
        }
        ...
      },
      child: Scaffold(

---

## ü§ñ „Ç¢„Ç∑„Çπ„Çø„É≥„Éà
*2025/1/24 23:51:16*

Flutter 3.10 ‰ª•Èôç„ÅßËøΩÂä†„Åï„Çå„Åü `PopScope` „Ç¶„Ç£„Ç∏„Çß„ÉÉ„ÉàÔºà[ÂÖ¨Âºè„Éâ„Ç≠„É•„É°„É≥„Éà](https://api.flutter.dev/flutter/widgets/PopScope-class.html)Ôºâ„ÇíÂà©Áî®„Åô„ÇãÂ†¥Âêà„ÅØ„ÄÅ`WillPopScope` Áõ∏ÂΩì„ÅÆ„É≠„Ç∏„ÉÉ„ÇØ„Çí `onPopInvokedWithResult` „ÅÆ„Ç≥„Éº„É´„Éê„ÉÉ„ÇØ„ÅßÂÆüË£Ö„Åô„Çã„Åì„Å®„Å´„Å™„Çä„Åæ„Åô„ÄÇ

„Éù„Ç§„É≥„Éà„Å®„Åó„Å¶„ÅØ„ÄÅ

1. **`canPop: false` „Å´„Åô„Çã„Åì„Å®„Åß„ÄÅÊ®ôÊ∫ñ„ÅÆ„Éù„ÉÉ„ÉóÂãï‰Ωú„ÇíÊäëÊ≠¢**  
2. **`onPopInvokedWithResult`** „ÅÆ„Ç≥„Éº„É´„Éê„ÉÉ„ÇØ„ÅåÂëº„Å∞„Çå„ÅüÈöõ„Å´„ÄÅ  
   - `didPop == true` „Å™„ÇâÊó¢„Å´„Éù„ÉÉ„ÉóÂá¶ÁêÜ„ÅåÂÆå‰∫Ü„Åó„Å¶„ÅÑ„Çã  
   - `didPop == false` „Å™„Çâ„Éù„ÉÉ„Éó„Åï„Çå„Å™„Åã„Å£„ÅüÔºà„Åì„Å°„Çâ„ÅßÂà∂Âæ°ÂèØËÉΩÔºâ  
3. `didPop == false` „ÅÆÂ†¥Âêà„Å´„ÉÄ„Ç§„Ç¢„É≠„Ç∞„ÇíË°®Á§∫„Åó„ÄÅ„ÄåÁ†¥Ê£Ñ„Åó„Å¶Êàª„Çã„Äç„Åã„Äå„Ç≠„É£„É≥„Çª„É´„Åô„Çã„Äç„Åã„Çí„É¶„Éº„Ç∂„Éº„Å´ÈÅ∏„Å∞„Åõ„Çã

„Å®„ÅÑ„ÅÜÊµÅ„Çå„Åß„Åô„ÄÇ

‰ª•‰∏ã„ÅØ„ÄÅ„ÄåÁ∑®ÈõÜÂâç„Å®Á∑®ÈõÜÂæå„ÅßÂ∑ÆÂàÜ„Åå„ÅÇ„ÇãÂ†¥Âêà„ÅØ„ÉÄ„Ç§„Ç¢„É≠„Ç∞„ÅßÁ¢∫Ë™ç„Åó„ÄÅ`OK` „Å™„Çâ pop „Åô„Çã„Äç„É≠„Ç∏„ÉÉ„ÇØ„ÅÆ„Çµ„É≥„Éó„É´„Åß„Åô„ÄÇ  
„Å™„Åä„ÄÅ`_isDifferent`ÔºàÂ∑ÆÂàÜ„ÉÅ„Çß„ÉÉ„ÇØÔºâ„ÅØ„ÅîËá™Ë∫´„ÅÆ„É≠„Ç∏„ÉÉ„ÇØ„Å´Âêà„Çè„Åõ„Å¶Êõ∏„ÅçÊèõ„Åà„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ

```dart
import 'package:flutter/material.dart';
import 'package:flutter_hooks/flutter_hooks.dart';
import 'package:hooks_riverpod/hooks_riverpod.dart';

class DeckDetailPage extends HookConsumerWidget {
  const DeckDetailPage({super.key, required this.deckId});
  final String? deckId;

  @override
  Widget build(BuildContext context, WidgetRef ref) {
    // Á∑®ÈõÜ‰∏≠„ÅÆ„É™„Çπ„Éà„ÇíÁõ£Ë¶ñÔºà‰æãÔºâ
    final editingCameraListState = ref.watch(editingCameraListNotifierProvider);

    // ÁîªÈù¢ÂàùÊúü„É≠„Éº„ÉâÊôÇÁÇπ„ÅÆ„É™„Çπ„Éà„Çí‰øùÊåÅÔºàÂ∑ÆÂàÜ„ÉÅ„Çß„ÉÉ„ÇØÁî®Ôºâ
    final initialCameraList = useMemoized(
      () => List<CameraDTO>.from(editingCameraListState),
      // „Åì„Åì„ÅØ„Ç´„É°„É©„ÅÆID/„É¨„Éô„É´„Å™„Å©„ÄÅÊØîËºÉ„Åó„Åü„ÅÑ„ÇÇ„ÅÆ„Çí„Åæ„Å®„ÇÅ„Å¶ÊåÅ„Å§ÂΩ¢„Åß„ÇÇOK
    );

    // Â∑ÆÂàÜ„Åå„ÅÇ„Çã„Åã„Å©„ÅÜ„Åã„ÇíÂà§ÂÆö„Åô„ÇãÈñ¢Êï∞Ôºà‰æãÔºâ
    bool _isDifferent(
      List<CameraDTO> initialList,
      List<CameraDTO> currentList,
    ) {
      if (initialList.length != currentList.length) {
        return true;
      }
      for (var i = 0; i < initialList.length; i++) {
        // ‰æã„Å®„Åó„Å¶ cameraId „Å†„Åë„ÉÅ„Çß„ÉÉ„ÇØ„Åô„Çã
        if (initialList[i].cameraId != currentList[i].cameraId) {
          return true;
        }
        // ÂøÖË¶Å„Å´Âøú„Åò„Å¶ level / rarity / parameter „Å™„Å©„ÇÇÊØîËºÉ
        // if (initialList[i].level != currentList[i].level) return true;
      }
      return false;
    }

    return PopScope(
      // `canPop: false` „Å´„Åô„Çã„Å®„ÄÅËá™Ââç„ÅÆ `onPopInvokedWithResult` „Å´„Çà„ÇãÂà∂Âæ°„Å´‰ªª„Åõ„Çã
      canPop: false,
      onPopInvokedWithResult: (didPop, result) async {
        // „Åô„Åß„Å´pop„Åï„Çå„Å¶„ÅÑ„ÇãÂ†¥Âêà„ÅØ‰Ωï„ÇÇ„Åó„Å™„ÅÑ
        if (didPop) {
          return;
        }

        // Â∑ÆÂàÜ„ÉÅ„Çß„ÉÉ„ÇØ
        final hasChanged = _isDifferent(initialCameraList, editingCameraListState);

        if (!hasChanged) {
          // Â§âÊõ¥„Åå„Å™„Åë„Çå„Å∞„Åù„ÅÆ„Åæ„Åæpop
          Navigator.of(context).pop();
          return;
        }

        // Â§âÊõ¥„Åå„ÅÇ„ÇãÂ†¥Âêà„ÅØ„ÉÄ„Ç§„Ç¢„É≠„Ç∞„ÅßÁ¢∫Ë™ç
        final discard = await showDialog<bool>(
          context: context,
          builder: (_) {
            return AlertDialog(
              title: const Text('Á†¥Ê£Ñ„Åó„Åæ„Åô„ÅãÔºü'),
              content: const Text('Á∑®ÈõÜ‰∏≠„ÅÆÂÜÖÂÆπ„Åå‰øùÂ≠ò„Åï„Çå„Å¶„ÅÑ„Åæ„Åõ„Çì„ÄÇÁ†¥Ê£Ñ„Åó„Å¶Êàª„Çä„Åæ„Åô„ÅãÔºü'),
              actions: [
                TextButton(
                  onPressed: () => Navigator.of(context).pop(false),
                  child: const Text('„Ç≠„É£„É≥„Çª„É´'),
                ),
                TextButton(
                  onPressed: () => Navigator.of(context).pop(true),
                  child: const Text('Á†¥Ê£Ñ„Åô„Çã'),
                ),
              ],
            );
          },
        );

        // „ÉÄ„Ç§„Ç¢„É≠„Ç∞ÁµêÊûú„Åå true(Á†¥Ê£Ñ) „Å™„Çâ pop
        if (discard == true) {
          Navigator.of(context).pop();
        }
      },

      child: Scaffold(
        appBar: AppBar(
          title: const Text('Edit Deck'),
        ),
        body: const Center(
          child: Text('Á∑®ÈõÜÁîªÈù¢„Ç≥„É≥„ÉÜ„É≥„ÉÑ'),
        ),
      ),
    );
  }
}
```

### „Éù„Ç§„É≥„Éà„Åæ„Å®„ÇÅ

1. `PopScope` „ÅØ `canPop` „Å® `onPopInvokedWithResult` „Åß„Éê„ÉÉ„ÇØ„Ç≠„Éº„ÇÑ Navigator.pop „Å™„Å©„ÅÆÂãï„Åç„Çí„Éï„ÉÉ„ÇØ„Åô„Çã„ÄÇ  
2. `didPop == false` „Åß„ÅÇ„Çå„Å∞„ÄÅ„ÄåFlutter „Åå„Éá„Éï„Ç©„É´„Éà„Åß„ÅØÊàª„Å£„Å¶„ÅÑ„Å™„ÅÑ„ÄçÁä∂ÊÖã„Å™„ÅÆ„Åß„ÄÅ„Åù„Åì„Åã„ÇâËá™Áî±„Å´„ÉÄ„Ç§„Ç¢„É≠„Ç∞Ë°®Á§∫„Å™„Å©„ÇíË°å„ÅÑ„ÄÅÂøÖË¶Å„Å´Âøú„Åò„Å¶ `Navigator.of(context).pop()` „ÇíÂëº„Çì„ÅßÊòéÁ§∫ÁöÑ„Å´Êàª„Åô„ÄÇ  
3. ‰ª•Ââç„ÅÆ `WillPopScope` „Å®Âêå„Åò„Åè„ÄÅ**„ÄåÁ∑®ÈõÜÂÜÖÂÆπ„Å´Â§âÂåñ„Åå„ÅÇ„Çã„ÅãÔºü„Äç„ÇíÂà§ÂÆö ‚Üí „ÉÄ„Ç§„Ç¢„É≠„Ç∞Ë°®Á§∫ ‚Üí OK „ÅÆÂ†¥Âêà„Å†„ÅëÊàª„Çã** „Å®„ÅÑ„Å£„ÅüÂÆüË£Ö„ÅåÂèØËÉΩ„ÄÇ  

„Åì„ÅÆ„Çà„ÅÜ„Å´Êõ∏„ÅçÊèõ„Åà„Çã„Åì„Å®„Åß„ÄÅ`PopScope` „Çí‰Ωø„Å£„ÅüÊñ∞„Åó„ÅÑ„Ç§„É≥„Çø„Éº„Éï„Çß„Éº„Çπ„Åß„ÇÇ„ÄåÂ§âÊõ¥„Åå„ÅÇ„Å£„Åü„Çâ„ÉÄ„Ç§„Ç¢„É≠„Ç∞„ÇíÂá∫„Åô„ÄçÊåôÂãï„ÇíÂÆüË£Ö„Åß„Åç„Åæ„Åô„ÄÇ

---
