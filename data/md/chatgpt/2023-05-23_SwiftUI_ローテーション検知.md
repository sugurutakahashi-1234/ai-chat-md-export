# SwiftUI ローテーション検知

日付: 2023-05-23

---

## 👤 ユーザー
*2023/5/24 2:21:44*

SwiftUI ローテーションを検知する

---

## 🤖 アシスタント
*2023/5/24 2:22:44*

SwiftUIでは、画面の向き（ローテーション）を直接的に検出する組み込みのメカニズムはありません。ただし、`GeometryReader`を使うことで、ビューのサイズや形状の変更を検出し、それを使用して間接的に画面の向きを判定することができます。以下にその例を示します。

```swift
struct ContentView: View {
    @State private var orientation: Orientation = .portrait

    var body: some View {
        GeometryReader { geometry in
            // update the orientation when the geometry changes
            DispatchQueue.main.async {
                self.orientation = geometry.size.width > geometry.size.height ? .landscape : .portrait
            }
            // your actual UI goes here, using the 'orientation' as needed
        }
    }
}

enum Orientation {
    case portrait
    case landscape
}
```

上記のコードでは、ビューの幅と高さを比較して、画面がポートレートモードかランドスケープモードかを判定しています。この情報は`orientation`変数に保持され、UIの構築に利用されます。

この情報を用いて、例えば画面の向きに応じて異なるビューを表示するようなことが可能になります。

注意しなければならないのは、`GeometryReader`が提供するジオメトリデータはビューのレイアウトの一部であるため、これを使ってビューの状態を更新するときは非同期で行う必要があることです。上記のコードでは`DispatchQueue.main.async`を使用しています。これにより、レイアウトと状態の更新が同時に行われることを防いでいます。

しかし、これはあくまで一時的な解決策であり、Appleが公式に提供するローテーション検知のためのSwiftUI APIが出た場合にはそれを使用するべきです。

---
