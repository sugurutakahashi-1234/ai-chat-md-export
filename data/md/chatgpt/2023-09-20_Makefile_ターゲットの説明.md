# Makefile ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã®èª¬æ˜

æ—¥ä»˜: 2023-09-20

---

## ğŸ‘¤ ãƒ¦ãƒ¼ã‚¶ãƒ¼
*2023/9/20 10:45:33*

makefileã®ãƒ˜ãƒ«ãƒ—ã‚³ãƒãƒ³ãƒ‰ã«ã¤ã„ã¦

.PHONY: help
help:
	@grep "^\[a-zA-Z\\-\]\*:" Makefile | grep -v "grep" | sed -e 's/^/make /' | sed -e 's/://'

.PHONY: open
open:
	open `find . -maxdepth 1 -mindepth 1 -iname "\*.xcworkspace"`

.PHONY: setup-githooks
setup-githooks:
	git config --local core.hooksPath .githooks

.PHONY: teardown-githooks
teardown-githooks:
	git config --local --unset core.hooksPath .githooks

.PHONY: swiftformat-run
swiftformat-run:
	swift run --package-path EmomilToolsPackage swiftformat .

.PHONY: swiftformat-lint
swiftformat-lint:
	swift run --package-path EmomilToolsPackage swiftformat --lint .

.PHONY: setup
setup: setup-githooks open

.PHONY: swiftgen-run
swiftgen-run:
	swift package --package-path EmomilPackage --allow-writing-to-package-directory generate-code-for-resources


$ make help                                                                                                    +\[feature/731\]
make help
make open
make setup-githooks
make teardown-githooks
make swiftformat-run
make swiftformat-lint
make setup setup-githooks open
make swiftgen-run

make setup setup-githooks open ã‚’ make setup ã«ã—ãŸã„ã€‚helpã‚³ãƒãƒ³ãƒ‰ã‚’ä¿®æ­£ã—ï½“ã¦ã»ã—ã„

---

## ğŸ¤– ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ
*2023/9/20 10:46:46*

`make setup setup-githooks open` ã¨ã„ã†è¡Œã¯ã€`setup` ã‚¿ãƒ¼ã‚²ãƒƒãƒˆãŒä»–ã®ã‚¿ãƒ¼ã‚²ãƒƒãƒˆï¼ˆ`setup-githooks`ã¨`open`ï¼‰ã«ä¾å­˜ã—ã¦ã„ã‚‹ãŸã‚ã«è¡¨ç¤ºã•ã‚Œã¦ã„ã¾ã™ã€‚`help` ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚’å¤‰æ›´ã—ã¦ã€ã“ã®ã‚ˆã†ãªä¾å­˜é–¢ä¿‚ã‚’æŒã¤ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚’ã‚·ãƒ³ãƒ—ãƒ«ã«è¡¨ç¤ºã™ã‚‹ã‚ˆã†ã«ä¿®æ­£ã—ã¾ã™ã€‚

æ¬¡ã®ä¿®æ­£ã‚’`help`ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã«é©ç”¨ã—ã¦ãã ã•ã„ï¼š

```makefile
.PHONY: help
help:
	@awk 'BEGIN {FS = ":.*?## "} /^[a-zA-Z0-9_-]+:.*?## / {printf "\033[36m%-30s\033[0m %s\n", $$1, $$2}' $(MAKEFILE_LIST) | sort
```

æ¬¡ã«ã€å„ã‚³ãƒãƒ³ãƒ‰ã®å¾Œã« `##` ã¨ãã®ã‚³ãƒãƒ³ãƒ‰ã®èª¬æ˜ã‚’è¿½åŠ ã—ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€`make help` ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€ã‚³ãƒãƒ³ãƒ‰ã¨ãã®èª¬æ˜ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

```makefile
.PHONY: help
help:
	@awk 'BEGIN {FS = ":.*?## "} /^[a-zA-Z0-9_-]+:.*?## / {printf "\033[36m%-30s\033[0m %s\n", $$1, $$2}' $(MAKEFILE_LIST) | sort

.PHONY: open
open: ## Open the .xcworkspace file
	open `find . -maxdepth 1 -mindepth 1 -iname "*.xcworkspace"`

.PHONY: setup-githooks
setup-githooks: ## Set up git hooks
	git config --local core.hooksPath .githooks

.PHONY: teardown-githooks
teardown-githooks: ## Tear down git hooks
	git config --local --unset core.hooksPath .githooks

.PHONY: swiftformat-run
swiftformat-run: ## Run swiftformat
	swift run --package-path EmomilToolsPackage swiftformat .

.PHONY: swiftformat-lint
swiftformat-lint: ## Lint using swiftformat
	swift run --package-path EmomilToolsPackage swiftformat --lint .

.PHONY: setup
setup: setup-githooks open ## Set up the environment

.PHONY: swiftgen-run
swiftgen-run: ## Run swiftgen
	swift package --package-path EmomilPackage --allow-writing-to-package-directory generate-code-for-resources
```

ã“ã‚Œã§ã€`make help`ã‚’å®Ÿè¡Œã™ã‚‹ã¨ä»¥ä¸‹ã®ã‚ˆã†ã«ã‚·ãƒ³ãƒ—ãƒ«ã«è¡¨ç¤ºã•ã‚Œã¾ã™ï¼š

```
make help                           Show this help
make open                           Open the .xcworkspace file
make setup-githooks                 Set up git hooks
make teardown-githooks              Tear down git hooks
make swiftformat-run                Run swiftformat
make swiftformat-lint               Lint using swiftformat
make setup                          Set up the environment
make swiftgen-run                   Run swiftgen
```

ã“ã®æ–¹æ³•ã§ã€å„ã‚³ãƒãƒ³ãƒ‰ã¨ãã®èª¬æ˜ã‚’ãã‚Œã„ã«è¡¨ç¤ºã§ãã¾ã™ã€‚

---

## ğŸ‘¤ ãƒ¦ãƒ¼ã‚¶ãƒ¼
*2023/9/20 10:47:02*

## ã®èª¬æ˜æ–‡ãªãã¦ã‚‚ã„ã„ã‚“ã 

---

## ğŸ¤– ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ
*2023/9/20 10:47:30*

äº†è§£ã—ã¾ã—ãŸã€‚èª¬æ˜æ–‡ãŒä¸è¦ãªå ´åˆã€`help` ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚’å˜ç´”åŒ–ã—ã¦ã€ä¾å­˜é–¢ä¿‚ã‚’æŒã¤ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚’é™¤å¤–ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

æ¬¡ã®ã‚ˆã†ã« `help` ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚’ä¿®æ­£ã—ã¦ãã ã•ã„ï¼š

```makefile
.PHONY: help
help:
	@awk 'BEGIN {FS = ":"} /^[a-zA-Z0-9_-]+:.*$$/ {print $$1}' $(MAKEFILE_LIST) | grep -v -e '^$@' | sort
```

ã“ã®ä¿®æ­£ã‚’é©ç”¨ã™ã‚‹ã¨ã€`make help`ã‚’å®Ÿè¡Œã™ã‚‹ã¨ä»¥ä¸‹ã®ã‚ˆã†ã«è¡¨ç¤ºã•ã‚Œã¾ã™ï¼š

```
help
open
setup-githooks
teardown-githooks
swiftformat-run
swiftformat-lint
setup
swiftgen-run
```

ã“ã®æ–¹æ³•ã§ã€å„ã‚³ãƒãƒ³ãƒ‰ã®ã¿ãŒè¡¨ç¤ºã•ã‚Œã€ä¾å­˜é–¢ä¿‚ã‚’æŒã¤ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã®ãƒªã‚¹ãƒˆã¯è¡¨ç¤ºã•ã‚Œã¾ã›ã‚“ã€‚

---

## ğŸ‘¤ ãƒ¦ãƒ¼ã‚¶ãƒ¼
*2023/9/20 10:56:05*

å‡ºåŠ›ãŒã§ãªã‹ã£ãŸ ## ãªãã¦ã‚‚å‡ºåŠ›ãŒã‚ã‚‹ã‚ˆã†ã«ã—ã¦æ¬²ã—ã„

---

## ğŸ¤– ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ
*2023/9/20 10:56:27*

äº†è§£ã—ã¾ã—ãŸã€‚å„ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚’ãƒªã‚¹ãƒˆã«ã—ã¦ã€ãã®ä¾å­˜é–¢ä¿‚ã‚’é™¤å¤–ã—ãŸã„ã¨ã„ã†ã“ã¨ã§ã™ã­ã€‚ãã‚Œã§ã¯ã€æ¬¡ã®æ–¹æ³•ã§ `help` ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚’å¤‰æ›´ã—ã¾ã™ã€‚

```makefile
.PHONY: help
help:
	@awk 'BEGIN {FS = ":"} /^[a-zA-Z0-9_-]+:/ {if ($$2 == "") print $$1}' Makefile
```

ã“ã®æ–¹æ³•ã§ã€`help` ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã¯ã€ä¾å­˜é–¢ä¿‚ã‚’æŒãŸãªã„ã‚¿ãƒ¼ã‚²ãƒƒãƒˆåã®ã¿ã‚’å‡ºåŠ›ã—ã¾ã™ã€‚ã‚¿ãƒ¼ã‚²ãƒƒãƒˆãŒä»–ã®ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã«ä¾å­˜ã—ã¦ã„ã‚‹å ´åˆã€ãã‚Œã¯ãƒªã‚¹ãƒˆã«è¡¨ç¤ºã•ã‚Œã¾ã›ã‚“ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›ãŒå¾—ã‚‰ã‚Œã¾ã™ã€‚

---

## ğŸ‘¤ ãƒ¦ãƒ¼ã‚¶ãƒ¼
*2023/9/20 10:56:55*

å‡ºåŠ›ã®ä¸€è¦§ã«make ã‚’ã¤ã‘ã¦ã»ã—ã„

---

## ğŸ¤– ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ
*2023/9/20 10:57:11*

äº†è§£ã—ã¾ã—ãŸã€‚ä»¥ä¸‹ã®ã‚ˆã†ã« `help` ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚’ä¿®æ­£ã—ã¦ã€å„ã‚¿ãƒ¼ã‚²ãƒƒãƒˆåã®å‰ã« `make` ã‚’ä»˜ã‘ã¾ã™ã€‚

```makefile
.PHONY: help
help:
	@awk 'BEGIN {FS = ":"} /^[a-zA-Z0-9_-]+:/ {if ($$2 == "") print "make " $$1}' Makefile
```

ã“ã®ã‚³ãƒãƒ³ãƒ‰ã¯ã€ã‚¿ãƒ¼ã‚²ãƒƒãƒˆãŒä¾å­˜é–¢ä¿‚ã‚’æŒãŸãªã„å ´åˆã«ã€`make` ã¨ãã®ã‚¿ãƒ¼ã‚²ãƒƒãƒˆåã‚’å‡ºåŠ›ã—ã¾ã™ã€‚

---

## ğŸ‘¤ ãƒ¦ãƒ¼ã‚¶ãƒ¼
*2023/9/20 14:49:17*

setupãŒå®Ÿè¡Œã§ããªã‹ã£ãŸä¿®æ­£ã—ã¦æ¬²ã—ã„

.PHONY: help
help:
	@awk 'BEGIN {FS = ":"} /^\[a-zA-Z0-9\_-\]+:/ {if ($$2 == "") print "make " $$1}' Makefile

.PHONY: open
open:
	open `find . -maxdepth 1 -mindepth 1 -iname "\*.xcworkspace"`

.PHONY: setup-githooks
setup-githooks:
	git config --local core.hooksPath .githooks

.PHONY: teardown-githooks
teardown-githooks:
	git config --local --unset core.hooksPath .githooks

.PHONY: swiftformat-run
swiftformat-run:
	swift run --package-path EmomilToolsPackage swiftformat .

.PHONY: swiftformat-lint
swiftformat-lint:
	swift run --package-path EmomilToolsPackage swiftformat --lint .

.PHONY: setup
setup:
	setup-githooks open

.PHONY: cleanup
cleanup:
	make teardown-githooks

.PHONY: swiftgen-run
swiftgen-run:
	swift package --package-path EmomilPackage --allow-writing-to-package-directory generate-code-for-resources

---

## ğŸ¤– ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ
*2023/9/20 14:49:45*

`setup` ã‚¿ãƒ¼ã‚²ãƒƒãƒˆãŒæ­£ã—ãå®Ÿè¡Œã•ã‚Œãªã„åŸå› ã¯ã€`setup-githooks` ã¨ `open` ãŒã‚³ãƒãƒ³ãƒ‰ã¨ã—ã¦å®Ÿè¡Œã•ã‚Œã¦ã„ã‚‹ãŸã‚ã§ã™ã€‚Makefile å†…ã§ä»–ã®ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚’ä¾å­˜é–¢ä¿‚ã¨ã—ã¦å®Ÿè¡Œã™ã‚‹ã«ã¯ã€ã‚¿ãƒ¼ã‚²ãƒƒãƒˆåã®å‰ã« `$` ã‚’ä»˜ã‘ã¦å®Ÿè¡Œã—ã¾ã™ã€‚

ä»¥ä¸‹ã®ã‚ˆã†ã« `setup` ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚’ä¿®æ­£ã—ã¾ã™ï¼š

```makefile
.PHONY: setup
setup:
	$(MAKE) setup-githooks
	$(MAKE) open
```

ã¾ãŸã€`cleanup` ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚‚åŒã˜ã‚ˆã†ã«ä¿®æ­£ã—ã¾ã™ï¼š

```makefile
.PHONY: cleanup
cleanup:
	$(MAKE) teardown-githooks
```

ä¸Šè¨˜ã®ä¿®æ­£ã«ã‚ˆã‚Šã€`setup` ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã¨ `cleanup` ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã¯æ­£ã—ãå‹•ä½œã™ã‚‹ã¯ãšã§ã™ã€‚

---

## ğŸ‘¤ ãƒ¦ãƒ¼ã‚¶ãƒ¼
*2023/9/20 14:50:07*

$(MAKE) ã¨ã¯ãªã‚“ã§ã™ã‹ï¼Ÿ

---

## ğŸ¤– ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ
*2023/9/20 14:50:59*

`$(MAKE)` ã¯ Makefile å†…ã§ã®ç‰¹æ®Šãªå¤‰æ•°ã§ã€`make` ã‚³ãƒãƒ³ãƒ‰è‡ªä½“ã‚’å‚ç…§ã—ã¾ã™ã€‚ã“ã®å¤‰æ•°ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€Makefile å†…ã§ä»–ã®ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚’å‘¼ã³å‡ºã™ã“ã¨ãŒã§ãã¾ã™ã€‚

ä»¥ä¸‹ã®ç‚¹ãŒ `$(MAKE)` ã®ä½¿ç”¨ã®ä¸»ãªç†ç”±ã¨ãªã‚Šã¾ã™ï¼š

1. \*\*å†å¸°çš„ãª make ã®å‘¼ã³å‡ºã—\*\*: Makefile å†…ã§ç›´æ¥ä»–ã®ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚’å‘¼ã³å‡ºã™å ´åˆã«ã¯ã€`$(MAKE)` ã‚’ä½¿ç”¨ã—ã¦ã€ãã®ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚’å®Ÿè¡Œã—ã¾ã™ã€‚

2. \*\*å¼•æ•°ã®ç¶™æ‰¿\*\*: ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã‹ã‚‰ä¸ãˆã‚‰ã‚ŒãŸå¤‰æ•°ã‚„ãƒ•ãƒ©ã‚°ï¼ˆä¾‹ãˆã°ã€`-j` ãªã©ã®ä¸¦åˆ—å®Ÿè¡Œã‚’åˆ¶å¾¡ã™ã‚‹ã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰ãŒã€`$(MAKE)` ã‚’ä½¿ç”¨ã—ã¦å‘¼ã³å‡ºã•ã‚Œã‚‹ä¸‹ä½ã® `make` ã‚³ãƒãƒ³ãƒ‰ã«ã‚‚é©ç”¨ã•ã‚Œã¾ã™ã€‚

3. \*\*ãƒãƒ¼ã‚¿ãƒ“ãƒªãƒ†ã‚£\*\*: ä¸€éƒ¨ã®ã‚·ã‚¹ãƒ†ãƒ ã§ã¯ `make` ãŒç•°ãªã‚‹åå‰ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã‹ã€ç•°ãªã‚‹ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã® `make` ãŒä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚`$(MAKE)` ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€Makefile ãŒå®Ÿè¡Œã•ã‚ŒãŸã¨ãã«ä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹å…·ä½“çš„ãª `make` ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚„åå‰ã«é–¢ä¿‚ãªãã€é©åˆ‡ãª `make` ã‚³ãƒãƒ³ãƒ‰ãŒå‘¼ã³å‡ºã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

ãã®ãŸã‚ã€Makefile å†…ã§ä»–ã®ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚„Makefileã‚’å†å¸°çš„ã«å‘¼ã³å‡ºã™å ´åˆã«ã¯ã€`$(MAKE)` ã‚’ä½¿ç”¨ã™ã‚‹ã®ãŒä¸€èˆ¬çš„ãªæ…£ç¿’ã¨ãªã£ã¦ã„ã¾ã™ã€‚

---
