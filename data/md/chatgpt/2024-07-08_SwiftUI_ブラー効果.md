# SwiftUI ブラー効果

日付: 2024-07-08

---

## 👤 ユーザー
*2024/07/08 17:34:20*

SwiftUIで画像の上で半透明でブラーをかかってような表現

---

## 🤖 アシスタント
*2024/07/08 17:34:30*

SwiftUIで画像の上に半透明でブラー効果をかけるには、`VisualEffectBlur` を使用して実現できます。`VisualEffectBlur` は、`UIVisualEffectView` を SwiftUI と組み合わせて使用するカスタムビューです。以下にその例を示します。

まず、`VisualEffectBlur` のカスタムビューを作成します。

```swift
import SwiftUI

struct VisualEffectBlur<Content: View>: UIViewRepresentable {
    var blurStyle: UIBlurEffect.Style
    var vibrancyStyle: UIVibrancyEffectStyle?
    var content: () -> Content

    init(blurStyle: UIBlurEffect.Style, vibrancyStyle: UIVibrancyEffectStyle? = nil, @ViewBuilder content: @escaping () -> Content) {
        self.blurStyle = blurStyle
        self.vibrancyStyle = vibrancyStyle
        self.content = content
    }

    func makeUIView(context: Context) -> UIVisualEffectView {
        let view = UIVisualEffectView(effect: UIBlurEffect(style: blurStyle))
        if let vibrancyStyle = vibrancyStyle {
            let vibrancyEffect = UIVibrancyEffect(blurEffect: UIBlurEffect(style: blurStyle), style: vibrancyStyle)
            let vibrancyView = UIVisualEffectView(effect: vibrancyEffect)
            vibrancyView.contentView.addSubview(HostingController(rootView: content()).view)
            vibrancyView.contentView.translatesAutoresizingMaskIntoConstraints = false
            NSLayoutConstraint.activate([
                vibrancyView.contentView.leadingAnchor.constraint(equalTo: vibrancyView.leadingAnchor),
                vibrancyView.contentView.trailingAnchor.constraint(equalTo: vibrancyView.trailingAnchor),
                vibrancyView.contentView.topAnchor.constraint(equalTo: vibrancyView.topAnchor),
                vibrancyView.contentView.bottomAnchor.constraint(equalTo: vibrancyView.bottomAnchor)
            ])
            view.contentView.addSubview(vibrancyView)
            vibrancyView.translatesAutoresizingMaskIntoConstraints = false
            NSLayoutConstraint.activate([
                vibrancyView.leadingAnchor.constraint(equalTo: view.leadingAnchor),
                vibrancyView.trailingAnchor.constraint(equalTo: view.trailingAnchor),
                vibrancyView.topAnchor.constraint(equalTo: view.topAnchor),
                vibrancyView.bottomAnchor.constraint(equalTo: view.bottomAnchor)
            ])
        } else {
            view.contentView.addSubview(HostingController(rootView: content()).view)
            view.contentView.translatesAutoresizingMaskIntoConstraints = false
            NSLayoutConstraint.activate([
                view.contentView.leadingAnchor.constraint(equalTo: view.leadingAnchor),
                view.contentView.trailingAnchor.constraint(equalTo: view.trailingAnchor),
                view.contentView.topAnchor.constraint(equalTo: view.topAnchor),
                view.contentView.bottomAnchor.constraint(equalTo: view.bottomAnchor)
            ])
        }
        return view
    }

    func updateUIView(_ uiView: UIVisualEffectView, context: Context) {
        uiView.effect = UIBlurEffect(style: blurStyle)
    }
}

class HostingController<Content: View>: UIHostingController<Content> {
    override func viewDidLoad() {
        super.viewDidLoad()
        view.backgroundColor = .clear
    }
}
```

次に、このカスタムビューを使用して、画像の上にブラー効果を追加します。

```swift
import SwiftUI

struct ContentView: View {
    var body: some View {
        ZStack {
            Image("your_image_name")
                .resizable()
                .aspectRatio(contentMode: .fill)
                .edgesIgnoringSafeArea(.all)
            
            VisualEffectBlur(blurStyle: .systemMaterialDark) {
                VStack {
                    Text("Your Text")
                        .font(.largeTitle)
                        .foregroundColor(.white)
                    Text("Additional content can go here")
                        .font(.body)
                        .foregroundColor(.white)
                }
                .padding()
            }
            .frame(width: 300, height: 200)
            .cornerRadius(10)
        }
    }
}

struct ContentView_Previews: PreviewProvider {
    static var previews: some View {
        ContentView()
    }
}
```

このコードでは、`VisualEffectBlur` カスタムビューを使用して画像の上に半透明のブラー効果を追加しています。`blurStyle` パラメータでブラーのスタイルを指定でき、`content` クロージャでブラー効果の上に表示するコンテンツを指定できます。

---
