# サブスクリプションステータスの定義

Date: 2024-10-11

---

## 👤 User
*2024-10-11 14:02:56*

Swift で SubscriptionStatus の struct を定義してほしい。
Subscription という型も定義して配列で持ってほしい

{
  "active": true,
  "active_subscription_info": [
    {
      "type": "corporate",
      "id": "1",
      "startAt": "2024-10-06T15:00:00.000000Z",
      "endAt": "2024-10-08T15:00:00.000000Z",
      "cancelAt": null
    }
  ]
}

---

## 🤖 Assistant
*2024-10-11 14:03:03*

以下のように `SubscriptionStatus` と `Subscription` の struct を定義しました。 `SubscriptionStatus` は `active` フラグと `activeSubscriptionInfo` 配列を持ち、配列の要素は `Subscription` 型になっています。

```swift
import Foundation

struct SubscriptionStatus {
    let active: Bool
    let activeSubscriptionInfo: [Subscription]
}

struct Subscription {
    let type: String
    let id: String
    let startAt: Date
    let endAt: Date
    let cancelAt: Date?
}

// 日付フォーマット用の関数
func parseDate(from string: String) -> Date? {
    let formatter = ISO8601DateFormatter()
    return formatter.date(from: string)
}

// 例データの使用
let subscriptionData = SubscriptionStatus(
    active: true,
    activeSubscriptionInfo: [
        Subscription(
            type: "corporate",
            id: "1",
            startAt: parseDate(from: "2024-10-06T15:00:00.000000Z")!,
            endAt: parseDate(from: "2024-10-08T15:00:00.000000Z")!,
            cancelAt: nil
        )
    ]
)
```

### 解説
- `SubscriptionStatus` struct には `active` (購読がアクティブかどうか) と `activeSubscriptionInfo` (現在のアクティブなサブスクリプション情報) を含んでいます。
- `Subscription` struct にはサブスクリプションの詳細 (`type`, `id`, `startAt`, `endAt`, `cancelAt`) を持っています。
- `parseDate(from:)` で ISO8601 フォーマットの日付文字列を `Date` に変換しています。

これで、JSON データをこの構造体にマッピングして扱うことができます。

---

## 👤 User
*2024-10-11 14:03:28*

active の bool 値いらない気がしてきた

---

## 🤖 Assistant
*2024-10-11 14:03:35*

User prefers to remove the `active` bool value from the `SubscriptionStatus` struct.

---

## 🔧 Tool
*2024-10-11 14:03:35*

Model set context updated.

---

## 🤖 Assistant
*2024-10-11 14:03:35*

`active` の bool 値を削除した新しい `SubscriptionStatus` 構造体を以下のように定義します。

```swift
import Foundation

struct SubscriptionStatus {
    let activeSubscriptionInfo: [Subscription]
}

struct Subscription {
    let type: String
    let id: String
    let startAt: Date
    let endAt: Date
    let cancelAt: Date?
}

// 日付フォーマット用の関数
func parseDate(from string: String) -> Date? {
    let formatter = ISO8601DateFormatter()
    return formatter.date(from: string)
}

// 例データの使用
let subscriptionData = SubscriptionStatus(
    activeSubscriptionInfo: [
        Subscription(
            type: "corporate",
            id: "1",
            startAt: parseDate(from: "2024-10-06T15:00:00.000000Z")!,
            endAt: parseDate(from: "2024-10-08T15:00:00.000000Z")!,
            cancelAt: nil
        )
    ]
)
```

これで、`active` フラグを削除したバージョンの `SubscriptionStatus` となります。

---
