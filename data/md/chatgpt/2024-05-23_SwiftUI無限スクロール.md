# SwiftUIç„¡é™ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«

æ—¥ä»˜: 2024-05-23

---

## ğŸ‘¤ ãƒ¦ãƒ¼ã‚¶ãƒ¼
*2024/05/23 14:43:17*

SwiftUI ã§ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ« View ã§ refreshable ã®ã‚ˆã†ã«ãƒœãƒˆãƒ ãŒè¡¨ç¤ºã•ã‚ŒãŸã‚‰ç„¡é™ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã«ã™ã‚‹æ–¹æ³•

---

## ğŸ¤– ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ
*2024/05/23 14:43:30*

SwiftUIã§ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«Viewã«ãŠã„ã¦ã€ãƒœãƒˆãƒ ãŒè¡¨ç¤ºã•ã‚ŒãŸã‚‰ç„¡é™ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã‚’å®Ÿç¾ã™ã‚‹æ–¹æ³•ã®ä¸€ä¾‹ã‚’ã”ç´¹ä»‹ã—ã¾ã™ã€‚ã“ã®æ–¹æ³•ã§ã¯ã€`ScrollView`ã¨`GeometryReader`ã‚’ä½¿ç”¨ã—ã¦ã€ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã®çµ‚ã‚ã‚Šã‚’æ¤œçŸ¥ã—ã€ãƒ‡ãƒ¼ã‚¿ã‚’è¿½åŠ ãƒ­ãƒ¼ãƒ‰ã—ã¾ã™ã€‚

ä»¥ä¸‹ã«ã€å…·ä½“çš„ãªã‚³ãƒ¼ãƒ‰ä¾‹ã‚’ç¤ºã—ã¾ã™ï¼š

```swift
import SwiftUI

struct InfiniteScrollView: View {
    @State private var items: [String] = Array(1...20).map { "Item \($0)" }
    @State private var isLoading: Bool = false
    
    var body: some View {
        ScrollView {
            LazyVStack {
                ForEach(items, id: \.self) { item in
                    Text(item)
                        .padding()
                        .background(Color.gray.opacity(0.1))
                        .cornerRadius(8)
                }
                
                if isLoading {
                    ProgressView()
                        .padding()
                } else {
                    GeometryReader { geometry in
                        Color.clear
                            .onAppear {
                                if geometry.frame(in: .global).maxY < UIScreen.main.bounds.height {
                                    loadMoreData()
                                }
                            }
                    }
                    .frame(height: 50)
                }
            }
            .padding()
        }
    }
    
    private func loadMoreData() {
        guard !isLoading else { return }
        
        isLoading = true
        
        DispatchQueue.main.asyncAfter(deadline: .now() + 2) {
            let newItems = items.count + 1...items.count + 20
            items.append(contentsOf: newItems.map { "Item \($0)" })
            isLoading = false
        }
    }
}

struct InfiniteScrollView_Previews: PreviewProvider {
    static var previews: some View {
        InfiniteScrollView()
    }
}
```

### è§£èª¬

1. **Stateã®å®šç¾©**:
    - `items`ã«ã¯ãƒªã‚¹ãƒˆè¡¨ç¤ºã™ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚’æ ¼ç´ã—ã¾ã™ã€‚
    - `isLoading`ã¯ãƒ‡ãƒ¼ã‚¿ã®ãƒ­ãƒ¼ãƒ‰çŠ¶æ…‹ã‚’ç®¡ç†ã—ã¾ã™ã€‚

2. **ScrollViewã¨LazyVStackã®ä½¿ç”¨**:
    - `ScrollView`å†…ã«`LazyVStack`ã‚’é…ç½®ã—ã€å„`item`ã‚’ãƒªã‚¹ãƒˆè¡¨ç¤ºã—ã¾ã™ã€‚

3. **GeometryReaderã«ã‚ˆã‚‹ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã®çµ‚ã‚ã‚Šã®æ¤œçŸ¥**:
    - `GeometryReader`ã‚’ä½¿ç”¨ã—ã¦ã€ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ãŒãƒœãƒˆãƒ ã«é”ã—ãŸã“ã¨ã‚’æ¤œçŸ¥ã—ã¾ã™ã€‚
    - `GeometryReader`ã®`onAppear`ä¿®é£¾å­ã‚’ä½¿ã„ã€è¡¨ç¤ºä½ç½®ã‚’ç¢ºèªã—ã¾ã™ã€‚ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ä½ç½®ãŒãƒœãƒˆãƒ è¿‘ãã«ãªã£ãŸå ´åˆã«`loadMoreData()`ã‚’å‘¼ã³å‡ºã—ã¾ã™ã€‚

4. **ãƒ‡ãƒ¼ã‚¿ã®è¿½åŠ ãƒ­ãƒ¼ãƒ‰**:
    - `loadMoreData()`é–¢æ•°ã§ã€ãƒ‡ãƒ¼ã‚¿ã®è¿½åŠ ãƒ­ãƒ¼ãƒ‰ã‚’è¡Œã„ã¾ã™ã€‚ãƒ‡ãƒ¼ã‚¿ã®ãƒ­ãƒ¼ãƒ‰ãŒçµ‚ã‚ã‚‹ã¾ã§`isLoading`ã‚’`true`ã«è¨­å®šã—ã€ãƒ­ãƒ¼ãƒ‰å®Œäº†å¾Œã«`false`ã«æˆ»ã—ã¾ã™ã€‚

ã“ã®æ–¹æ³•ã«ã‚ˆã‚Šã€ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã®çµ‚ã‚ã‚Šã«è‡ªå‹•çš„ã«ãƒ‡ãƒ¼ã‚¿ã‚’è¿½åŠ ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ç„¡é™ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã‚’å®Ÿç¾ã§ãã¾ã™ã€‚

---
