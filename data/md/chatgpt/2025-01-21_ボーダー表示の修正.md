# ボーダー表示の修正

日付: 2025-01-21

---

## 👤 ユーザー
*2025/1/21 20:08:34*

{
  "content_type": "image_asset_pointer",
  "asset_pointer": "file-service://file-H8j34zVvg58BSJ4UeQVT2U",
  "size_bytes": 29238,
  "width": 134,
  "height": 128,
  "fovea": null,
  "metadata": {
    "dalle": null,
    "gizmo": null,
    "generation": null,
    "container_pixel_height": null,
    "container_pixel_width": null,
    "emu_omit_glimpse_image": null,
    "emu_patches_override": null,
    "sanitized": true,
    "asset_pointer_link": null,
    "watermarked_asset_pointer": null
  }
}
{
  "content_type": "image_asset_pointer",
  "asset_pointer": "file-service://file-3LPz5oEmCkrcwY5gb6szx9",
  "size_bytes": 131182,
  "width": 273,
  "height": 297,
  "fovea": null,
  "metadata": {
    "dalle": null,
    "gizmo": null,
    "generation": null,
    "container_pixel_height": null,
    "container_pixel_width": null,
    "emu_omit_glimpse_image": null,
    "emu_patches_override": null,
    "sanitized": true,
    "asset_pointer_link": null,
    "watermarked_asset_pointer": null
  }
}
Flutter のコードについてこの実装を２枚目のようにしたいが、１枚目のようにボーダーの左側と上側が正しく表示されていない。修正してほしい                      // Spot リスト
                    spotListState.when(
                      data: (spotList) {
                        return SizedBox(
                          width: 48,
                          height: 48,
                          child: FloatingActionButton(
                            backgroundColor: Colors.transparent,
                            shape: const RoundedRectangleBorder(
                              side: BorderSide(
                                color: Colors.transparent,
                              ),
                            ),
                            onPressed: () async {
                              await onTapSpotList();
                            },
                            child: Stack(
                              alignment: Alignment.bottomRight,
                              children: [
                                for (var i = 0; i &lt; 2; i++)
                                  if (spotList != null && i &lt; spotList.length)
                                    Positioned(
                                      left: i * -4.0,
                                      top: i * -4.0,
                                      child: SizedBox(
                                        width: 44,
                                        height: 44,
                                        child: DecoratedBox(
                                          decoration: BoxDecoration(
                                            border: Border.all(
                                              color: ColorToken.bgWhite,
                                              width: 2,
                                            ),
                                            borderRadius:
                                                BorderRadius.circular(4),
                                          ),
                                          child: Padding(
                                            padding: const EdgeInsets.all(2),
                                            child: ClipRRect(
                                              borderRadius:
                                                  BorderRadius.circular(4),
                                              child: Image.network(
                                                spotList[i].photoUrl ?? '',
                                                width: 44,
                                                height: 44,
                                                fit: BoxFit.cover,
                                                errorBuilder: (
                                                  context,
                                                  error,
                                                  stackTrace,
                                                ) {
                                                  return const ColoredBox(
                                                    color: ColorToken.bgDark,
                                                    child: Icon(
                                                      Icons
                                                          .broken_image_outlined,
                                                      size: 44,
                                                      color: ColorToken.text,
                                                    ),
                                                  );
                                                },
                                              ),
                                            ),
                                          ),
                                        ),
                                      ),
                                    ),
                              ],
                            ),
                          ),
                        );
                      },
                      loading: () =&gt; const SizedBox.shrink(),
                      error: (error, stack) =&gt; SizedBox(
                        width: 48,
                        height: 48,
                        child: FloatingActionButton(
                          heroTag: 'ErrorShowSpotListButton',
                          onPressed: () async {
                            await onTapSpotList();
                          },
                          child: const Icon(
                            Icons.photo,
                            size: 24,
                            color: ColorToken.secondaryDark,
                          ),
                        ),
                      ),
                    ),

---

## 🤖 アシスタント
*2025/1/21 20:09:39*

原因は、`SizedBox` と `FloatingActionButton` のサイズがぴったり 48×48 になっているところへ、画像を負のオフセット (`left: i * -4.0, top: i * -4.0`) で配置しているため、左上部分が親の領域からはみ出してクリップされていることが多いです。  
以下のように **Stack 側の `clipBehavior` を `Clip.none` にする**か、あるいは **親のサイズを少し大きめにとる（はみ出す分だけ余白を増やす）** 等を行うと、左上のボーダーが見切れずに表示されます。

例としては、次のように `Stack` に `clipBehavior: Clip.none` を設定し、`SizedBox` を少し大きくしてみてください:

```dart
SizedBox(
  width: 56,
  height: 56,
  child: FloatingActionButton(
    backgroundColor: Colors.transparent,
    shape: RoundedRectangleBorder(
      borderRadius: BorderRadius.circular(4),
      side: const BorderSide(color: Colors.transparent),
    ),
    onPressed: onTapSpotList,
    child: Stack(
      // クリッピングをしない
      clipBehavior: Clip.none,
      alignment: Alignment.bottomRight,
      children: [
        for (var i = 0; i < 2; i++)
          if (spotList != null && i < spotList.length)
            Positioned(
              left: i * -4.0,
              top: i * -4.0,
              child: SizedBox(
                width: 44,
                height: 44,
                child: DecoratedBox(
                  decoration: BoxDecoration(
                    border: Border.all(
                      color: ColorToken.bgWhite,
                      width: 2,
                    ),
                    borderRadius: BorderRadius.circular(4),
                  ),
                  child: Padding(
                    padding: const EdgeInsets.all(2),
                    child: ClipRRect(
                      borderRadius: BorderRadius.circular(4),
                      child: Image.network(
                        spotList[i].photoUrl ?? '',
                        width: 44,
                        height: 44,
                        fit: BoxFit.cover,
                        errorBuilder: (context, error, stackTrace) {
                          return const ColoredBox(
                            color: ColorToken.bgDark,
                            child: Icon(
                              Icons.broken_image_outlined,
                              size: 44,
                              color: ColorToken.text,
                            ),
                          );
                        },
                      ),
                    ),
                  ),
                ),
              ),
            ),
      ],
    ),
  ),
);
```

- **clipBehavior: Clip.none**  
  Positioned ウィジェットを負の座標に置いても、はみ出した部分をクリップしないようになります。  
- **SizedBox のサイズを大きめに**  
  画像やボーダーがはみ出す分だけ親ウィジェットを広げておくと安全です（上では 48→56 にしてありますが、調整してみてください）。  
- **FloatingActionButton の shape**  
  デフォルトが円形なので、矩形で使いたい場合は `RoundedRectangleBorder` の `borderRadius` を適宜設定しておきます。

このようにすることで、左上のボーダーも含め、狙い通りのレイアウトになるはずです。

---
