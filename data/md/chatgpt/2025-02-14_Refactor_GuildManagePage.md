# Refactor GuildManagePage

Êó•‰ªò: 2025-02-14

---

## üë§ „É¶„Éº„Ç∂„Éº
*2025/2/14 15:42:02*

\_buildRequestedMembers„Å® \_buildGuildManagementContent „ÅØÂà•„Ç¶„Ç£„Ç∏„Çß„ÉÉ„Éà„Å´ÂàÜ„Åë„Çã„ÅÆ„Åß„ÅØ„Å™„Åè„ÄÅGuildManagePage„Å´ÂàÜ„Åë„Åö„Å´Êõ∏„ÅÑ„Å¶„ÅÑ„Åç„Åü„ÅÑ„ÄÇ
‚Ä®‚Ä®import 'dart:io';
import 'package:flutter/material.dart';
import 'package:flutter\_hooks/flutter\_hooks.dart';
import 'package:go\_router/go\_router.dart';
import 'package:hooks\_riverpod/hooks\_riverpod.dart';
import 'package:image\_cropper/image\_cropper.dart';
import 'package:image\_picker/image\_picker.dart';
import 'package:permission\_handler/permission\_handler.dart';
import 'package:snpit\_guild\_app/domain/design/color\_pallet.dart';
import 'package:snpit\_guild\_app/domain/design/color\_token.dart';
import 'package:snpit\_guild\_app/domain/screen.dart';
import 'package:snpit\_guild\_app/infrastructure/entities/extensions/camera\_dto\_x.dart';
import 'package:snpit\_guild\_app/infrastructure/snapit\_guild\_api/snapit\_guild\_api.openapi.dart';
import 'package:snpit\_guild\_app/presentation/providers/api\_client/guilds/delete\_guild.dart';
import 'package:snpit\_guild\_app/presentation/providers/api\_client/guilds/get\_guild.dart';
import 'package:snpit\_guild\_app/presentation/providers/api\_client/guilds/update\_guild.dart';
import 'package:snpit\_guild\_app/presentation/providers/api\_client/guilds/update\_guild\_member.dart';
import 'package:snpit\_guild\_app/presentation/router/router.dart';
import 'package:snpit\_guild\_app/presentation/widgets/dialogs/delete\_guild\_dialog.dart';
import 'package:snpit\_guild\_app/presentation/widgets/guild\_icon.dart';
import 'package:snpit\_guild\_app/presentation/widgets/guild\_member\_column.dart';
import 'package:snpit\_guild\_app/presentation/widgets/parameters\_bar\_column.dart';
import 'package:snpit\_guild\_app/utils/extensions/uri\_extensions.dart';
import 'package:snpit\_guild\_app/utils/snack\_bar\_utils.dart';

class GuildManagePage extends HookConsumerWidget {
  const GuildManagePage({super.key});

  @override
  Widget build(BuildContext context, WidgetRef ref) {
    final picker = useMemoized(ImagePicker.new);
    final imageFileState = useState&lt;File?&gt;(null);
    final myGuildAsyncValue = ref.watch(getMyGuildNotifierProvider);
    final isLoadingState = useState(false);

    Future&lt;void&gt; onRefresh() async {
      try {
        await ref.read(getMyGuildNotifierProvider.notifier).getMyGuild();
      } on Exception catch (error) {
        if (context.mounted) {
          showErrorSnackBar(context, error);
        }
      }
    }

    Future&lt;void&gt; onTapDeleteGuild() async {
      final confirm = await showDialog&lt;bool&gt;(
        context: context,
        builder: (context) =&gt; const DeleteGuildDialog(),
      );

      if (confirm != true) {
        return;
      }

      try {
        await ref.read(deleteGuildNotifierProvider.notifier).deleteGuild();
        await onRefresh();

        if (context.mounted) {
          ScaffoldMessenger.of(context).showSnackBar(
            const SnackBar(
              content: Text('Guild deleted successfully.'),
            ),
          );
        }

        if (context.mounted) {
          context.pop();
        }
      } on Exception catch (error) {
        if (context.mounted) {
          showErrorSnackBar(context, error);
        }
      }
    }

    Future&lt;void&gt; pickAndCropImage() async {
      final pickedFile = await picker.pickImage(source: ImageSource.gallery);
      if (pickedFile == null) {
        debugPrint('Image selection cancelled');
        return;
      }

      final croppedFile = await ImageCropper().cropImage(
        sourcePath: pickedFile.path,
        aspectRatio: const CropAspectRatio(ratioX: 1, ratioY: 1),
        uiSettings: \[
          AndroidUiSettings(
            hideBottomControls: true,
            lockAspectRatio: true,
          ),
          IOSUiSettings(
            aspectRatioLockEnabled: true,
          ),
        \],
      );

      if (croppedFile == null) {
        debugPrint('Cropping cancelled');
        return;
      }

      if (!context.mounted) {
        return;
      }

      imageFileState.value = File(croppedFile.path);
      debugPrint('Cropped image path: ${imageFileState.value!.path}');

      try {
        // TODO: \[„Éï„Çß„Éº„Ç∫2\] ÁîªÂÉè„Ç¢„ÉÉ„Éó„É≠„Éº„Éâ„Å™„Å©ÈÅ©Âàá„Å™ API Âëº„Å≥Âá∫„Åó
        await ref.read(updateGuildNotifierProvider.notifier).updateGuildAvatar(
              UriExtensions.randomImageUrlWithTitle(
                // ignore: use\_build\_context\_synchronously
                TimeOfDay.now().format(context),
              ).toString(),
            );

        if (context.mounted) {
          ScaffoldMessenger.of(context).showSnackBar(
            const SnackBar(
              content: Text('Updated Successfully'),
            ),
          );
        }

        await onRefresh();
      } on Exception catch (error) {
        if (context.mounted) {
          showErrorSnackBar(context, error);
        }
      }
    }

    Future&lt;void&gt; onTapGuildPhoto() async {
      await showDialog&lt;void&gt;(
        context: context,
        builder: (context) =&gt; AlertDialog(
          insetPadding: const EdgeInsets.symmetric(horizontal: 16),
          shape: RoundedRectangleBorder(
            borderRadius: BorderRadius.circular(8),
          ),
          backgroundColor: ColorPallet.gray800,
          title: const Text('Guild Icon Editor'),
          content: const Text(
            'Coming Soon!',
          ),
          actions: \[
            TextButton(
              onPressed: () =&gt; context.pop(),
              child: const Text('OK'),
            ),
          \],
        ),
      );

      return;

      // TODO: \[„Éï„Çß„Éº„Ç∫2\] ÁîªÂÉè„Ç¢„ÉÉ„Éó„É≠„Éº„ÉâÊ©üËÉΩ„ÇíÂÆüË£Ö„Åô„Çã
      // ignore: dead\_code, use\_build\_context\_synchronously
      final hasPermission = await \_hasPhotoPermission(context);
      if (hasPermission) {
        await pickAndCropImage();
      }
    }

    Future&lt;void&gt; onTapSave(String updatedText, String guildName) async {
      try {
        if (updatedText.isNotEmpty && updatedText != guildName) {
          await ref
              .read(updateGuildNotifierProvider.notifier)
              .updateGuildName(updatedText);

          // Refresh guild information
          await onRefresh();

          // show snackbar
          if (context.mounted) {
            ScaffoldMessenger.of(context).showSnackBar(
              SnackBar(
                content: Text('Guild name updated to $updatedText'),
              ),
            );
          }
        }
      } on Exception catch (error) {
        if (context.mounted) {
          showErrorSnackBar(context, error);
        }
      }
    }

    Future&lt;void&gt; onTapReject({
      required String guildId,
      required String userId,
      required String userName,
    }) async {
      try {
        await ref
            .read(rejectGuildNotifierProvider.notifier)
            .rejectGuild(guildId: guildId, userId: userId);

        // „ÇÆ„É´„ÉâÊÉÖÂ†±„Çí„É™„Éï„É¨„ÉÉ„Ç∑„É•
        await onRefresh();

        if (context.mounted) {
          ScaffoldMessenger.of(context).showSnackBar(
            SnackBar(
              content: Text('Rejected $userName'),
            ),
          );
        }
      } on Exception catch (error) {
        if (context.mounted) {
          showErrorSnackBar(context, error);
        }
      }
    }

    Future&lt;void&gt; onTapApprove({
      required String guildId,
      required String userId,
      required String userName,
    }) async {
      try {
        await ref
            .read(approveGuildNotifierProvider.notifier)
            .approveGuild(guildId: guildId, userId: userId);

        // „ÇÆ„É´„ÉâÊÉÖÂ†±„Çí„É™„Éï„É¨„ÉÉ„Ç∑„É•
        await onRefresh();

        if (context.mounted) {
          ScaffoldMessenger.of(context).showSnackBar(
            SnackBar(
              content: Text('Approved $userName'),
            ),
          );
        }
      } on Exception catch (error) {
        if (context.mounted) {
          showErrorSnackBar(context, error);
        }
      }
    }

    useEffect(
      () {
        Future.microtask(() async {
          await onRefresh();
        });
        return null;
      },
      \[\],
    );

    return Scaffold(
      appBar: AppBar(
        title: const Text('Guild management'),
      ),
      body: RefreshIndicator(
        onRefresh: () async {
          await onRefresh();
        },
        color: ColorToken.primary,
        backgroundColor: ColorToken.bgLight,
        child: myGuildAsyncValue.when(
          data: (guild) {
            if (guild == null) {
              return const SizedBox.shrink();
            }

            final guildId = guild.guildId ?? 'Unknown';
            final guildName = guild.guildName ?? 'No Name';
            final guildAvatar = guild.guildAvatar ?? '';
            final guildMembers = guild.guildMembers ?? &lt;GuildMemberDto&gt;\[\];

            return SingleChildScrollView(
              physics: const AlwaysScrollableScrollPhysics(),
              child: Padding(
                padding: const EdgeInsets.symmetric(horizontal: 20),
                child: \_buildGuildManagementContent(
                  context: context,
                  ref: ref,
                  guildId: guildId,
                  guildName: guildName,
                  guildAvatar: guildAvatar,
                  guildMembers: guildMembers,
                  pickAndCropImage: pickAndCropImage,
                  onTapSave: onTapSave,
                  onTapGuildPhoto: onTapGuildPhoto,
                  onTapReject: onTapReject,
                  onTapApprove: onTapApprove,
                ),
              ),
            );
          },
          loading: () {
            return const Center(child: CircularProgressIndicator());
          },
          error: (error, \_) {
            return Center(child: Text('Error: $error'));
          },
        ),
      ),
    );
  }

  /// GuildInfoResponseDtoData „ÅÆ‰∏≠„ÅÆÂøÖË¶Å„Éá„Éº„Çø„ÇíÈùû„Ç™„Éó„Ç∑„Éß„Éä„É´„ÅßÂèó„ÅëÂèñ„Çä„ÄÅÂÆâÂÖ®„Å™„Éá„Éï„Ç©„É´„Éà„Çí‰Ωø„ÅÜ
  Widget \_buildGuildManagementContent({
    required BuildContext context,
    required WidgetRef ref,
    required String guildId,
    required String guildName,
    required String guildAvatar,
    required List&lt;GuildMemberDto&gt; guildMembers,
    required Future&lt;void&gt; Function() pickAndCropImage,
    required Future&lt;void&gt; Function(String updatedText, String guildName)
        onTapSave,
    required Future&lt;void&gt; Function() onTapGuildPhoto,
    required Future&lt;void&gt; Function({
      required String guildId,
      required String userId,
      required String userName,
    }) onTapReject,
    required Future&lt;void&gt; Function({
      required String guildId,
      required String userId,
      required String userName,
    }) onTapApprove,
  }) {
    return Column(
      crossAxisAlignment: CrossAxisAlignment.start,
      children: \[
        const SizedBox(height: 32),
        // „ÇÆ„É´„Éâ„ÅÆ„Ç¢„Éê„Çø„Éº(ÂÜôÁúü)
        Center(
          child: GestureDetector(
            onTap: () async {
              await onTapGuildPhoto();
            },
            child: Stack(
              alignment: Alignment.center,
              children: \[
                GuildIcon(
                  guildId: guildId,
                  guildAvatar: guildAvatar,
                ),
                Container(
                  width: 64,
                  height: 64,
                  decoration: BoxDecoration(
                    color: Colors.black.withAlpha(180),
                    borderRadius: BorderRadius.circular(8),
                  ),
                ),
                const Icon(
                  Icons.camera\_alt,
                  size: 24,
                  color: Colors.white,
                ),
              \],
            ),
          ),
        ),
        const SizedBox(height: 32),
        // „ÇÆ„É´„ÉâÂêçÁ∑®ÈõÜÈÉ®ÂàÜ
        Material(
          color: Colors.transparent,
          child: InkWell(
            onTap: () {
              context.push(
                Screen.textEditing.path,
                extra: TextEditingPageArgs(
                  title: 'Name',
                  text: guildName,
                  hintText: 'Enter guild name',
                  onSave: (updatedText) async {
                    await onTapSave(updatedText, guildName);
                  },
                ),
              );
            },
            borderRadius: BorderRadius.circular(8),
            child: Container(
              padding: const EdgeInsets.symmetric(vertical: 8),
              child: Row(
                mainAxisAlignment: MainAxisAlignment.spaceBetween,
                children: \[
                  const Text(
                    'Name',
                    style: TextStyle(
                      fontSize: 16,
                      color: ColorPallet.gray300,
                    ),
                  ),
                  const SizedBox(
                    width: 8,
                  ),
                  Flexible(
                    child: Row(
                      mainAxisSize: MainAxisSize.min,
                      children: \[
                        Flexible(
                          child: Text(
                            guildName,
                            style: const TextStyle(fontSize: 16),
                            maxLines: 1,
                            overflow: TextOverflow.ellipsis,
                          ),
                        ),
                        const SizedBox(width: 8),
                        const Icon(
                          Icons.chevron\_right,
                          color: ColorToken.text,
                          size: 20,
                        ),
                      \],
                    ),
                  ),
                \],
              ),
            ),
          ),
        ),
        const SizedBox(height: 32),
        const Divider(
          color: ColorToken.secondary,
        ),
        const SizedBox(height: 32),
        // „É°„É≥„Éê„ÉºÁî≥Ë´ã‰∏ÄË¶ß
        \_buildRequestedMembers(
          context: context,
          ref: ref,
          guildId: guildId,
          guildMembers: guildMembers,
          onTapReject: onTapReject,
          onTapApprove: onTapApprove,
        ),

        // Padding(
        //   padding: const EdgeInsets.only(top: 24, bottom: 24),
        //   child: OutlinedButton(
        //     onPressed: isLoadingState.value
        //         ? null
        //         : () async {
        //             await onTapDeleteGuild();
        //           },
        //     child: const Text('Delete this guild'),
        //   ),
        // ),
      \],
    );
  }

  /// Áî≥Ë´ã‰∏≠„É°„É≥„Éê„Éº‰∏ÄË¶ßË°®Á§∫
  Widget \_buildRequestedMembers({
    required BuildContext context,
    required WidgetRef ref,
    required String guildId,
    required List&lt;GuildMemberDto&gt; guildMembers,
    required Future&lt;void&gt; Function({
      required String guildId,
      required String userId,
      required String userName,
    }) onTapReject,
    required Future&lt;void&gt; Function({
      required String guildId,
      required String userId,
      required String userName,
    }) onTapApprove,
  }) {
    // guildMembers „ÅÆ‰∏≠„Åß„ÄÅ`memberStatus` „Åå REQUESTED „ÅÆ„ÇÇ„ÅÆ„Å†„Åë„ÇíÊäΩÂá∫
    final requestedMembers = guildMembers
        .where(
          (member) =&gt;
              member.memberStatus == GuildMemberDtoMemberStatus.REQUESTED,
        )
        .toList();

    // Áî≥Ë´ã‰∏≠„É°„É≥„Éê„Éº„Åå„ÅÑ„Å™„ÅÑÂ†¥Âêà
    if (requestedMembers.isEmpty) {
      return const Center(
        child: Padding(
          // pulll-to-refresh „Åß„Çπ„ÇØ„É≠„Éº„É´„Åô„Çã„Åü„ÇÅ„ÅÆ‰ΩôÁôΩ„ÇíËøΩÂä†
          padding: EdgeInsets.only(bottom: 180),
          child: Text('No members requesting to join.'),
        ),
      );
    }

    return Padding(
      // pulll-to-refresh „Åß„Çπ„ÇØ„É≠„Éº„É´„Åô„Çã„Åü„ÇÅ„ÅÆ‰ΩôÁôΩ„ÇíËøΩÂä†
      padding: const EdgeInsets.only(bottom: 180),
      child: ListView.builder(
        shrinkWrap: true,
        physics: const NeverScrollableScrollPhysics(),
        itemCount: requestedMembers.length,
        itemBuilder: (context, index) {
          final member = requestedMembers\[index\];
          final userId = member.userId ?? '';
          final userName = member.username ?? '';
          final avatarUrl = member.avatar;
          final cameraList =
              member.decks?.firstOrNull?.deckCameras?.sorted() ?? \[\];

          return Padding(
            padding: const EdgeInsets.only(bottom: 8),
            child: DecoratedBox(
              decoration: BoxDecoration(
                color: ColorToken.bg,
                borderRadius: BorderRadius.circular(4),
                border: Border.all(
                  color: ColorToken.defaultBorder,
                ),
              ),
              child: Padding(
                padding: const EdgeInsets.all(16),
                child: Column(
                  children: \[
                    // „É¶„Éº„Ç∂„ÉºÊÉÖÂ†±ÈÉ®ÂàÜ
                    Row(
                      children: \[
                        // Â∑¶ÂÅ¥Ôºö„Ç¢„Éê„Çø„Éº + „É¶„Éº„Ç∂„ÉºÂêç
                        Expanded(
                          child: GuildMemberColumn(
                            userName: userName,
                            isGuildOwner: false,
                            userPhotoUrl: avatarUrl,
                            cameraList: cameraList,
                          ),
                        ),
                        // Âè≥ÂÅ¥ÔºöÂêÑÁ®Æ„Çπ„ÉÜ„Éº„Çø„Çπ (Q, E, L, B „Å™„Å©)
                        Expanded(
                          child: ParametersBarColumn(
                            searchQ: member.decks?.firstOrNull?.searchQ ?? 0,
                            attackE: member.decks?.firstOrNull?.attackE ?? 0,
                            luckL: member.decks?.firstOrNull?.luckL ?? 0,
                            defenseB: member.decks?.firstOrNull?.defenseB ?? 0,
                          ),
                        ),
                      \],
                    ),
                    const SizedBox(height: 16),
                    // ÊâøË™ç„ÉªÂç¥‰∏ã„Éú„Çø„É≥
                    Row(
                      mainAxisAlignment: MainAxisAlignment.spaceBetween,
                      children: \[
                        Flexible(
                          child: OutlinedButton(
                            onPressed: () async {
                              await onTapReject(
                                guildId: guildId,
                                userId: userId,
                                userName: userName,
                              );
                            },
                            style: OutlinedButton.styleFrom(
                              minimumSize: const Size.fromHeight(32),
                            ),
                            child: const Text(
                              'Reject',
                              style: TextStyle(fontSize: 12),
                            ),
                          ),
                        ),
                        const SizedBox(width: 12),
                        Flexible(
                          child: ElevatedButton(
                            onPressed: () async {
                              await onTapApprove(
                                guildId: guildId,
                                userId: userId,
                                userName: userName,
                              );
                            },
                            style: OutlinedButton.styleFrom(
                              minimumSize: const Size.fromHeight(32),
                            ),
                            child: const Text(
                              'Approve',
                              style: TextStyle(fontSize: 12),
                            ),
                          ),
                        ),
                      \],
                    ),
                  \],
                ),
              ),
            ),
          );
        },
      ),
    );
  }

  /// ÂÜôÁúü„ÅÆÊ®©Èôê„Çí„ÉÅ„Çß„ÉÉ„ÇØ„Åó„Å¶„ÄÅÊ®©Èôê„Åå„ÅÇ„Çå„Å∞ true „ÇíËøî„Åô
  Future&lt;bool&gt; \_hasPhotoPermission(BuildContext context) async {
    final status = await Permission.photos.request();

    switch (status) {
      case PermissionStatus.granted:
      case PermissionStatus.limited:
        // Ë®±ÂèØÊ∏à„Åø
        return true;
      case PermissionStatus.permanentlyDenied:
        // Ê∞∏‰πÖ„Å´ÊãíÂê¶„Åï„Çå„Å¶„ÅÑ„ÇãÂ†¥Âêà
        if (context.mounted) {
          \_showPermissionDialog(context);
        }
        return false;
      case PermissionStatus.denied:
      case PermissionStatus.restricted:
      case PermissionStatus.provisional:
        // „Åù„ÅÆ‰ªñ„ÅÆÂ†¥Âêà
        if (context.mounted) {
          ScaffoldMessenger.of(context).showSnackBar(
            const SnackBar(content: Text('Access to photos is not granted.')),
          );
        }
        return false;
    }
  }

  /// Ë®≠ÂÆöÁîªÈù¢„Å∏ÈÅ∑Áßª„Åï„Åõ„Çã„ÉÄ„Ç§„Ç¢„É≠„Ç∞„ÇíË°®Á§∫
  void \_showPermissionDialog(BuildContext context) {
    showDialog&lt;void&gt;(
      context: context,
      builder: (context) =&gt; AlertDialog(
        insetPadding: const EdgeInsets.symmetric(horizontal: 16),
        shape: RoundedRectangleBorder(
          borderRadius: BorderRadius.circular(8),
        ),
        backgroundColor: ColorPallet.gray800,
        title: const Text(
          'Permission to access photos is required',
        ),
        content: const Text(
          'Enable photo access in settings to select a photo.',
        ),
        actions: \[
          TextButton(
            onPressed: () async {
              context.pop();
            },
            child: const Text('Cancel'),
          ),
          TextButton(
            onPressed: () async {
              await openAppSettings();
            },
            child: const Text('Open Settings'),
          ),
        \],
      ),
    );
  }
}

---

## üîß „ÉÑ„Éº„É´
*2025/2/14 15:42:56*

\*\*Êï¥ÁêÜ‰∏≠\*\*

„É¶„Éº„Ç∂„Éº„ÅØ`\_buildRequestedMembers`„Å®`\_buildGuildManagementContent`„ÇíÂêå„Åò„Éï„Ç°„Ç§„É´ÂÜÖ„Å´ÊÆã„Åó„Åü„ÅÑ„Å®ËÄÉ„Åà„Å¶„ÅÑ„Åæ„Åô„Åå„ÄÅÂà•„ÄÖ„ÅÆ„Ç¶„Ç£„Ç∏„Çß„ÉÉ„Éà„Å®„Åó„Å¶„Åß„ÅØ„Å™„Åè„ÄÅ`GuildManagePage`ÂÜÖ„Å´ÊÆã„ÅôÊñπÊ≥ï„ÇíÊ®°Á¥¢‰∏≠„Åß„Åô„ÄÇ

\*\*Êé¢„ÇãÈÅ∏ÊäûËÇ¢\*\*

`\_buildRequestedMembers`„Å®`\_buildGuildManagementContent`„Çí„Éà„ÉÉ„Éó„É¨„Éô„É´„ÅÆ„Éó„É©„Ç§„Éô„Éº„ÉàÈñ¢Êï∞„Åæ„Åü„ÅØ„Éó„É©„Ç§„Éô„Éº„ÉàÊã°Âºµ„É°„ÇΩ„ÉÉ„Éâ„Å®„Åó„Å¶ÂÆöÁæ©„Åô„ÇãÊñπÊ≥ï„ÇíÊ®°Á¥¢‰∏≠„ÄÇ

\*\*„Éà„ÉÉ„Éó„É¨„Éô„É´„ÅÆ„Éó„É©„Ç§„Éô„Éº„ÉàÈñ¢Êï∞„Å®„Åó„Å¶‰øùÂ≠ò\*\*

„É¶„Éº„Ç∂„Éº„Åå`\_buildRequestedMembers`„Å®`\_buildGuildManagementContent`„Çí„Éï„Ç°„Ç§„É´ÂÜÖ„Å´‰øù„Å§ÊñπÊ≥ï„ÇíÊé¢„Çã‰∏≠„Åß„ÄÅ„Åì„Çå„Çâ„Çí„Éà„ÉÉ„Éó„É¨„Éô„É´„ÅÆ„Éó„É©„Ç§„Éô„Éº„ÉàÈñ¢Êï∞„Å®„Åó„Å¶Ë®òËø∞„Åô„Çã„Åì„Å®„ÅåÊúâÂäπ„Å†„Å®Ê∞ó„Å•„Åè„ÄÇ

\*\*„Éà„ÉÉ„Éó„É¨„Éô„É´„ÅÆ„Éó„É©„Ç§„Éô„Éº„ÉàÈñ¢Êï∞„ÇíÊé¢„Çã\*\*

`\_buildGuildManagementContent`„Å®`\_buildRequestedMembers`„Çí„Éï„Ç°„Ç§„É´ÂÜÖ„ÅÆ„Éà„ÉÉ„Éó„É¨„Éô„É´„ÅÆ„Éó„É©„Ç§„Éô„Éº„ÉàÈñ¢Êï∞„Å®„Åó„Å¶ÂÆöÁæ©„Åó„ÄÅ`GuildManagePage.build`„É°„ÇΩ„ÉÉ„Éâ„Åã„ÇâÂëº„Å≥Âá∫„ÅôÊñπÊ≥ï„ÇíÊ§úË®é„Åó„Å¶„ÅÑ„Çã„ÄÇ

\*\*„Éà„ÉÉ„Éó„É¨„Éô„É´„ÅÆ„Éó„É©„Ç§„Éô„Éº„ÉàÈñ¢Êï∞„Çí‰ΩøÁî®\*\*

`GuildManagePage`„ÇØ„É©„ÇπÂÜÖ„ÅÆ`\_buildGuildManagementContent`„Å®`\_buildRequestedMembers`„ÇíÂ§ñ„Åó„ÄÅ„Éï„Ç°„Ç§„É´ÂÜÖ„ÅÆ„Éà„ÉÉ„Éó„É¨„Éô„É´„ÅÆ„Éó„É©„Ç§„Éô„Éº„ÉàÈñ¢Êï∞„Å®„Åó„Å¶ÂÆöÁæ©„Åô„ÇãÈÄ≤Â±ï„ÇíË¶ã„Å¶„ÅÑ„Çã„ÄÇ

---

## ü§ñ „Ç¢„Ç∑„Çπ„Çø„É≥„Éà
*2025/2/14 15:42:56*

‰ª•‰∏ã„ÅÆ„Çµ„É≥„Éó„É´„ÅÆ„Çà„ÅÜ„Å´ **„Éà„ÉÉ„Éó„É¨„Éô„É´Èñ¢Êï∞**„Å®„Åó„Å¶ `_buildGuildManagementContent` „Å® `_buildRequestedMembers` „ÇíÂàá„ÇäÂá∫„ÅôÊñπÊ≥ï„ÅåÊúÄ„ÇÇ„Ç∑„É≥„Éó„É´„Åã„Å®ÊÄù„ÅÑ„Åæ„Åô„ÄÇ  
„ÄåÂà•„Ç¶„Ç£„Ç∏„Çß„ÉÉ„ÉàÔºà„ÇØ„É©„ÇπÔºâ„Å®„Åó„Å¶Âàá„ÇäÂá∫„Åô„Äç„Çè„Åë„Åß„ÅØ„Å™„Åè„ÄÅ„Äå`GuildManagePage` „ÇØ„É©„Çπ„ÅÆ‰∏≠„Åã„ÇâÂàá„ÇäÂá∫„Åô„Äç„Å†„Åë„Å™„ÅÆ„Åß„ÄÅ**Âêå„Åò„Éï„Ç°„Ç§„É´**„Å´„Éà„ÉÉ„Éó„É¨„Éô„É´Èñ¢Êï∞„Å®„Åó„Å¶ÁΩÆ„ÅÑ„Å¶„Åä„Åç„ÄÅ`GuildManagePage.build` „ÅÆ‰∏≠„ÅßÂëº„Å≥Âá∫„Åô„Çà„ÅÜ„Å´„Åô„Çå„Å∞OK„Åß„Åô„ÄÇ

```dart
import 'dart:io';
import 'package:flutter/material.dart';
import 'package:flutter_hooks/flutter_hooks.dart';
import 'package:go_router/go_router.dart';
import 'package:hooks_riverpod/hooks_riverpod.dart';
import 'package:image_cropper/image_cropper.dart';
import 'package:image_picker/image_picker.dart';
import 'package:permission_handler/permission_handler.dart';
import 'package:snpit_guild_app/domain/design/color_pallet.dart';
import 'package:snpit_guild_app/domain/design/color_token.dart';
import 'package:snpit_guild_app/domain/screen.dart';
import 'package:snpit_guild_app/infrastructure/entities/extensions/camera_dto_x.dart';
import 'package:snpit_guild_app/infrastructure/snapit_guild_api/snapit_guild_api.openapi.dart';
import 'package:snpit_guild_app/presentation/providers/api_client/guilds/delete_guild.dart';
import 'package:snpit_guild_app/presentation/providers/api_client/guilds/get_guild.dart';
import 'package:snpit_guild_app/presentation/providers/api_client/guilds/update_guild.dart';
import 'package:snpit_guild_app/presentation/providers/api_client/guilds/update_guild_member.dart';
import 'package:snpit_guild_app/presentation/router/router.dart';
import 'package:snpit_guild_app/presentation/widgets/dialogs/delete_guild_dialog.dart';
import 'package:snpit_guild_app/presentation/widgets/guild_icon.dart';
import 'package:snpit_guild_app/presentation/widgets/guild_member_column.dart';
import 'package:snpit_guild_app/presentation/widgets/parameters_bar_column.dart';
import 'package:snpit_guild_app/utils/extensions/uri_extensions.dart';
import 'package:snpit_guild_app/utils/snack_bar_utils.dart';

class GuildManagePage extends HookConsumerWidget {
  const GuildManagePage({super.key});

  @override
  Widget build(BuildContext context, WidgetRef ref) {
    final picker = useMemoized(ImagePicker.new);
    final imageFileState = useState<File?>(null);
    final myGuildAsyncValue = ref.watch(getMyGuildNotifierProvider);
    final isLoadingState = useState(false);

    Future<void> onRefresh() async {
      try {
        await ref.read(getMyGuildNotifierProvider.notifier).getMyGuild();
      } on Exception catch (error) {
        if (context.mounted) {
          showErrorSnackBar(context, error);
        }
      }
    }

    Future<void> onTapDeleteGuild() async {
      final confirm = await showDialog<bool>(
        context: context,
        builder: (context) => const DeleteGuildDialog(),
      );

      if (confirm != true) {
        return;
      }

      try {
        await ref.read(deleteGuildNotifierProvider.notifier).deleteGuild();
        await onRefresh();

        if (context.mounted) {
          ScaffoldMessenger.of(context).showSnackBar(
            const SnackBar(
              content: Text('Guild deleted successfully.'),
            ),
          );
          context.pop();
        }
      } on Exception catch (error) {
        if (context.mounted) {
          showErrorSnackBar(context, error);
        }
      }
    }

    Future<void> pickAndCropImage() async {
      final pickedFile = await picker.pickImage(source: ImageSource.gallery);
      if (pickedFile == null) {
        debugPrint('Image selection cancelled');
        return;
      }

      final croppedFile = await ImageCropper().cropImage(
        sourcePath: pickedFile.path,
        aspectRatio: const CropAspectRatio(ratioX: 1, ratioY: 1),
        uiSettings: [
          AndroidUiSettings(
            hideBottomControls: true,
            lockAspectRatio: true,
          ),
          IOSUiSettings(
            aspectRatioLockEnabled: true,
          ),
        ],
      );

      if (croppedFile == null) {
        debugPrint('Cropping cancelled');
        return;
      }

      if (!context.mounted) {
        return;
      }

      imageFileState.value = File(croppedFile.path);
      debugPrint('Cropped image path: ${imageFileState.value!.path}');

      try {
        // TODO: [„Éï„Çß„Éº„Ç∫2] ÁîªÂÉè„Ç¢„ÉÉ„Éó„É≠„Éº„Éâ„Å™„Å©ÈÅ©Âàá„Å™ API Âëº„Å≥Âá∫„Åó
        await ref.read(updateGuildNotifierProvider.notifier).updateGuildAvatar(
              UriExtensions.randomImageUrlWithTitle(
                TimeOfDay.now().format(context),
              ).toString(),
            );

        if (context.mounted) {
          ScaffoldMessenger.of(context).showSnackBar(
            const SnackBar(
              content: Text('Updated Successfully'),
            ),
          );
        }

        await onRefresh();
      } on Exception catch (error) {
        if (context.mounted) {
          showErrorSnackBar(context, error);
        }
      }
    }

    Future<void> onTapGuildPhoto() async {
      await showDialog<void>(
        context: context,
        builder: (context) => AlertDialog(
          insetPadding: const EdgeInsets.symmetric(horizontal: 16),
          shape: RoundedRectangleBorder(
            borderRadius: BorderRadius.circular(8),
          ),
          backgroundColor: ColorPallet.gray800,
          title: const Text('Guild Icon Editor'),
          content: const Text(
            'Coming Soon!',
          ),
          actions: [
            TextButton(
              onPressed: () => context.pop(),
              child: const Text('OK'),
            ),
          ],
        ),
      );

      return;

      // TODO: [„Éï„Çß„Éº„Ç∫2] ÁîªÂÉè„Ç¢„ÉÉ„Éó„É≠„Éº„ÉâÊ©üËÉΩ„ÇíÂÆüË£Ö„Åô„Çã
      // ignore: dead_code, use_build_context_synchronously
      final hasPermission = await _hasPhotoPermission(context);
      if (hasPermission) {
        await pickAndCropImage();
      }
    }

    Future<void> onTapSave(String updatedText, String guildName) async {
      try {
        if (updatedText.isNotEmpty && updatedText != guildName) {
          await ref
              .read(updateGuildNotifierProvider.notifier)
              .updateGuildName(updatedText);

          // Refresh guild information
          await onRefresh();

          // show snackbar
          if (context.mounted) {
            ScaffoldMessenger.of(context).showSnackBar(
              SnackBar(
                content: Text('Guild name updated to $updatedText'),
              ),
            );
          }
        }
      } on Exception catch (error) {
        if (context.mounted) {
          showErrorSnackBar(context, error);
        }
      }
    }

    Future<void> onTapReject({
      required String guildId,
      required String userId,
      required String userName,
    }) async {
      try {
        await ref
            .read(rejectGuildNotifierProvider.notifier)
            .rejectGuild(guildId: guildId, userId: userId);

        await onRefresh();
        if (context.mounted) {
          ScaffoldMessenger.of(context).showSnackBar(
            SnackBar(
              content: Text('Rejected $userName'),
            ),
          );
        }
      } on Exception catch (error) {
        if (context.mounted) {
          showErrorSnackBar(context, error);
        }
      }
    }

    Future<void> onTapApprove({
      required String guildId,
      required String userId,
      required String userName,
    }) async {
      try {
        await ref
            .read(approveGuildNotifierProvider.notifier)
            .approveGuild(guildId: guildId, userId: userId);

        await onRefresh();
        if (context.mounted) {
          ScaffoldMessenger.of(context).showSnackBar(
            SnackBar(
              content: Text('Approved $userName'),
            ),
          );
        }
      } on Exception catch (error) {
        if (context.mounted) {
          showErrorSnackBar(context, error);
        }
      }
    }

    useEffect(
      () {
        Future.microtask(() async {
          await onRefresh();
        });
        return null;
      },
      [],
    );

    return Scaffold(
      appBar: AppBar(
        title: const Text('Guild management'),
      ),
      body: RefreshIndicator(
        onRefresh: onRefresh,
        color: ColorToken.primary,
        backgroundColor: ColorToken.bgLight,
        child: myGuildAsyncValue.when(
          data: (guild) {
            if (guild == null) {
              return const SizedBox.shrink();
            }

            final guildId = guild.guildId ?? 'Unknown';
            final guildName = guild.guildName ?? 'No Name';
            final guildAvatar = guild.guildAvatar ?? '';
            final guildMembers = guild.guildMembers ?? <GuildMemberDto>[];

            // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
            // „Åì„Åì„Åß„Éà„ÉÉ„Éó„É¨„Éô„É´Èñ¢Êï∞„ÇíÂëº„Å≥Âá∫„Åô
            // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
            return SingleChildScrollView(
              physics: const AlwaysScrollableScrollPhysics(),
              child: Padding(
                padding: const EdgeInsets.symmetric(horizontal: 20),
                child: _buildGuildManagementContent(
                  context: context,
                  ref: ref,
                  guildId: guildId,
                  guildName: guildName,
                  guildAvatar: guildAvatar,
                  guildMembers: guildMembers,
                  onTapGuildPhoto: onTapGuildPhoto,
                  pickAndCropImage: pickAndCropImage,
                  onTapSave: onTapSave,
                  onTapReject: onTapReject,
                  onTapApprove: onTapApprove,
                ),
              ),
            );
          },
          loading: () => const Center(child: CircularProgressIndicator()),
          error: (error, _) => Center(child: Text('Error: $error')),
        ),
      ),
    );
  }

  /// ÂÜôÁúü„ÅÆÊ®©Èôê„Çí„ÉÅ„Çß„ÉÉ„ÇØ„Åó„Å¶„ÄÅÊ®©Èôê„Åå„ÅÇ„Çå„Å∞ true „ÇíËøî„Åô
  Future<bool> _hasPhotoPermission(BuildContext context) async {
    final status = await Permission.photos.request();

    switch (status) {
      case PermissionStatus.granted:
      case PermissionStatus.limited:
        // Ë®±ÂèØÊ∏à„Åø
        return true;
      case PermissionStatus.permanentlyDenied:
        // Ê∞∏‰πÖ„Å´ÊãíÂê¶„Åï„Çå„Å¶„ÅÑ„ÇãÂ†¥Âêà
        if (context.mounted) {
          _showPermissionDialog(context);
        }
        return false;
      case PermissionStatus.denied:
      case PermissionStatus.restricted:
      case PermissionStatus.provisional:
        // „Åù„ÅÆ‰ªñ„ÅÆÂ†¥Âêà
        if (context.mounted) {
          ScaffoldMessenger.of(context).showSnackBar(
            const SnackBar(content: Text('Access to photos is not granted.')),
          );
        }
        return false;
    }
  }

  /// Ë®≠ÂÆöÁîªÈù¢„Å∏ÈÅ∑Áßª„Åï„Åõ„Çã„ÉÄ„Ç§„Ç¢„É≠„Ç∞„ÇíË°®Á§∫
  void _showPermissionDialog(BuildContext context) {
    showDialog<void>(
      context: context,
      builder: (context) => AlertDialog(
        insetPadding: const EdgeInsets.symmetric(horizontal: 16),
        shape: RoundedRectangleBorder(
          borderRadius: BorderRadius.circular(8),
        ),
        backgroundColor: ColorPallet.gray800,
        title: const Text(
          'Permission to access photos is required',
        ),
        content: const Text(
          'Enable photo access in settings to select a photo.',
        ),
        actions: [
          TextButton(
            onPressed: () => context.pop(),
            child: const Text('Cancel'),
          ),
          TextButton(
            onPressed: () async {
              await openAppSettings();
            },
            child: const Text('Open Settings'),
          ),
        ],
      ),
    );
  }
}

///
/// „Éà„ÉÉ„Éó„É¨„Éô„É´Èñ¢Êï∞„Å®„Åó„Å¶Âàá„ÇäÂá∫„Åó„Åü‰æã
/// 

/// „ÇÆ„É´„ÉâÁÆ°ÁêÜUIÂÖ®‰Ωì„Çí„Éì„É´„Éâ„Åô„ÇãÈñ¢Êï∞
Widget _buildGuildManagementContent({
  required BuildContext context,
  required WidgetRef ref,
  required String guildId,
  required String guildName,
  required String guildAvatar,
  required List<GuildMemberDto> guildMembers,
  required Future<void> Function() pickAndCropImage,
  required Future<void> Function(String updatedText, String guildName) onTapSave,
  required Future<void> Function() onTapGuildPhoto,
  required Future<void> Function({
    required String guildId,
    required String userId,
    required String userName,
  }) onTapReject,
  required Future<void> Function({
    required String guildId,
    required String userId,
    required String userName,
  }) onTapApprove,
}) {
  return Column(
    crossAxisAlignment: CrossAxisAlignment.start,
    children: [
      const SizedBox(height: 32),
      // „ÇÆ„É´„Éâ„ÅÆ„Ç¢„Éê„Çø„Éº
      Center(
        child: GestureDetector(
          onTap: onTapGuildPhoto,
          child: Stack(
            alignment: Alignment.center,
            children: [
              GuildIcon(
                guildId: guildId,
                guildAvatar: guildAvatar,
              ),
              Container(
                width: 64,
                height: 64,
                decoration: BoxDecoration(
                  color: Colors.black.withAlpha(180),
                  borderRadius: BorderRadius.circular(8),
                ),
              ),
              const Icon(
                Icons.camera_alt,
                size: 24,
                color: Colors.white,
              ),
            ],
          ),
        ),
      ),
      const SizedBox(height: 32),
      // „ÇÆ„É´„ÉâÂêçÁ∑®ÈõÜÈÉ®ÂàÜ
      Material(
        color: Colors.transparent,
        child: InkWell(
          onTap: () {
            context.push(
              Screen.textEditing.path,
              extra: TextEditingPageArgs(
                title: 'Name',
                text: guildName,
                hintText: 'Enter guild name',
                onSave: (updatedText) async {
                  await onTapSave(updatedText, guildName);
                },
              ),
            );
          },
          borderRadius: BorderRadius.circular(8),
          child: Container(
            padding: const EdgeInsets.symmetric(vertical: 8),
            child: Row(
              mainAxisAlignment: MainAxisAlignment.spaceBetween,
              children: [
                const Text(
                  'Name',
                  style: TextStyle(
                    fontSize: 16,
                    color: ColorPallet.gray300,
                  ),
                ),
                const SizedBox(width: 8),
                Flexible(
                  child: Row(
                    mainAxisSize: MainAxisSize.min,
                    children: [
                      Flexible(
                        child: Text(
                          guildName,
                          style: const TextStyle(fontSize: 16),
                          maxLines: 1,
                          overflow: TextOverflow.ellipsis,
                        ),
                      ),
                      const SizedBox(width: 8),
                      const Icon(
                        Icons.chevron_right,
                        color: ColorToken.text,
                        size: 20,
                      ),
                    ],
                  ),
                ),
              ],
            ),
          ),
        ),
      ),
      const SizedBox(height: 32),
      const Divider(color: ColorToken.secondary),
      const SizedBox(height: 32),
      // Áî≥Ë´ã‰∏≠„É°„É≥„Éê„ÉºË°®Á§∫
      _buildRequestedMembers(
        context: context,
        guildId: guildId,
        guildMembers: guildMembers,
        onTapReject: onTapReject,
        onTapApprove: onTapApprove,
      ),
      // „ÇÆ„É´„ÉâÂâäÈô§„Éú„Çø„É≥„Å™„Å©ÂøÖË¶Å„Åå„ÅÇ„Çå„Å∞ËøΩÂä†...
      // ‰æã:
      // Padding(
      //   padding: const EdgeInsets.only(top: 24, bottom: 24),
      //   child: OutlinedButton(
      //     onPressed: () => ...
      //     child: const Text('Delete this guild'),
      //   ),
      // ),
    ],
  );
}

/// Áî≥Ë´ã‰∏≠„É°„É≥„Éê„Éº‰∏ÄË¶ßË°®Á§∫Áî®„ÅÆÈñ¢Êï∞
Widget _buildRequestedMembers({
  required BuildContext context,
  required String guildId,
  required List<GuildMemberDto> guildMembers,
  required Future<void> Function({
    required String guildId,
    required String userId,
    required String userName,
  }) onTapReject,
  required Future<void> Function({
    required String guildId,
    required String userId,
    required String userName,
  }) onTapApprove,
}) {
  final requestedMembers = guildMembers
      .where(
        (member) =>
            member.memberStatus == GuildMemberDtoMemberStatus.REQUESTED,
      )
      .toList();

  if (requestedMembers.isEmpty) {
    return const Center(
      child: Padding(
        padding: EdgeInsets.only(bottom: 180),
        child: Text('No members requesting to join.'),
      ),
    );
  }

  return Padding(
    padding: const EdgeInsets.only(bottom: 180),
    child: ListView.builder(
      shrinkWrap: true,
      physics: const NeverScrollableScrollPhysics(),
      itemCount: requestedMembers.length,
      itemBuilder: (context, index) {
        final member = requestedMembers[index];
        final userId = member.userId ?? '';
        final userName = member.username ?? '';
        final avatarUrl = member.avatar;
        final cameraList = member.decks?.firstOrNull?.deckCameras?.sorted() ?? [];

        return Padding(
          padding: const EdgeInsets.only(bottom: 8),
          child: DecoratedBox(
            decoration: BoxDecoration(
              color: ColorToken.bg,
              borderRadius: BorderRadius.circular(4),
              border: Border.all(
                color: ColorToken.defaultBorder,
              ),
            ),
            child: Padding(
              padding: const EdgeInsets.all(16),
              child: Column(
                children: [
                  // „É¶„Éº„Ç∂„ÉºÊÉÖÂ†±ÈÉ®ÂàÜ
                  Row(
                    children: [
                      Expanded(
                        child: GuildMemberColumn(
                          userName: userName,
                          isGuildOwner: false,
                          userPhotoUrl: avatarUrl,
                          cameraList: cameraList,
                        ),
                      ),
                      Expanded(
                        child: ParametersBarColumn(
                          searchQ: member.decks?.firstOrNull?.searchQ ?? 0,
                          attackE: member.decks?.firstOrNull?.attackE ?? 0,
                          luckL: member.decks?.firstOrNull?.luckL ?? 0,
                          defenseB: member.decks?.firstOrNull?.defenseB ?? 0,
                        ),
                      ),
                    ],
                  ),
                  const SizedBox(height: 16),
                  // ÊâøË™ç„ÉªÂç¥‰∏ã„Éú„Çø„É≥
                  Row(
                    mainAxisAlignment: MainAxisAlignment.spaceBetween,
                    children: [
                      Flexible(
                        child: OutlinedButton(
                          onPressed: () async {
                            await onTapReject(
                              guildId: guildId,
                              userId: userId,
                              userName: userName,
                            );
                          },
                          style: OutlinedButton.styleFrom(
                            minimumSize: const Size.fromHeight(32),
                          ),
                          child: const Text(
                            'Reject',
                            style: TextStyle(fontSize: 12),
                          ),
                        ),
                      ),
                      const SizedBox(width: 12),
                      Flexible(
                        child: ElevatedButton(
                          onPressed: () async {
                            await onTapApprove(
                              guildId: guildId,
                              userId: userId,
                              userName: userName,
                            );
                          },
                          style: OutlinedButton.styleFrom(
                            minimumSize: const Size.fromHeight(32),
                          ),
                          child: const Text(
                            'Approve',
                            style: TextStyle(fontSize: 12),
                          ),
                        ),
                      ),
                    ],
                  ),
                ],
              ),
            ),
          ),
        );
      },
    ),
  );
}
```

---

### „Éù„Ç§„É≥„Éà

1. `GuildManagePage` „ÇØ„É©„Çπ„ÅÆ‰∏≠„Å´„ÅÇ„Å£„Åü `_buildXXX` Á≥ª„É°„ÇΩ„ÉÉ„Éâ„Çí„ÄÅ**„ÇØ„É©„ÇπÂ§ñ„ÅÆ„Éà„ÉÉ„Éó„É¨„Éô„É´Èñ¢Êï∞**ÔºàÂêå„Éï„Ç°„Ç§„É´ÂÜÖÔºâ„Å®„Åó„Å¶ÁßªÂãï„Åó„Å¶„ÅÑ„Åæ„Åô„ÄÇ  
   - ÂºïÊï∞„Å´ `BuildContext` „ÇÑÂøÖË¶Å„Å™„Éë„É©„É°„Éº„Çø„ÇíÊ∏°„Åó„ÄÅÊàª„ÇäÂÄ§„Å®„Åó„Å¶ `Widget` „ÇíËøî„Åô„Åã„Åü„Å°„Å´„Åô„Çã„Å®„Ç∑„É≥„Éó„É´„Åß„Åô„ÄÇ
   - ‰ªäÂõû„ÅØ„ÄåÂà•„Ç¶„Ç£„Ç∏„Çß„ÉÉ„Éà„ÅÆ„ÇØ„É©„Çπ„Çí‰Ωú„Çã„Äç„Çè„Åë„Åß„ÅØ„Å™„Åè„ÄÅ„ÅÇ„Åè„Åæ„ÅßÈñ¢Êï∞„Å®„Åó„Å¶ UI „ÇíÁµÑ„ÅøÁ´ã„Å¶„Å¶„ÅÑ„Åæ„Åô„ÄÇ

2. `GuildManagePage` „ÇØ„É©„Çπ„Åã„Çâ„ÅØ„ÄÅ
   ```dart
   child: _buildGuildManagementContent(
     context: context,
     ref: ref,
     guildId: guildId,
     ...
   )
   ```
   „Å®„ÅÑ„Å£„ÅüÂΩ¢„ÅßÂëº„Å≥Âá∫„Åô„Å†„Åë„Å´„Åô„Çã„Åì„Å®„Åß„ÄÅ`GuildManagePage` „ÅÆ `build` „Åå„Åô„Å£„Åç„Çä„Åó„Åæ„Åô„ÄÇ

3. ÂÆåÂÖ®„Å´„ÄåÂà•„Éï„Ç°„Ç§„É´„Äç„Å´Âàá„ÇäÂá∫„Åó„Åü„ÅÑÂ†¥Âêà„Åß„ÇÇ„ÄÅ„ÇÑ„ÇäÊñπ„ÅØ„Åª„ÅºÂêå„Åò„Åß„Åô„ÄÇ  
   - „Åü„Å†„ÅóÂà•„Éï„Ç°„Ç§„É´„Å´ÁßªÂãï„Åô„Çã„Å®„Åç„ÅØ„ÄÅÈñ¢Êï∞„ÇÑ„ÇØ„É©„Çπ„Åå„Ç¢„ÇØ„Çª„Çπ„Åô„Çã„Éó„É≠„Éë„ÉÜ„Ç£„ÅÆÂèØË¶ñÊÄßÔºàpublic/privateÔºâ„Å´Ê∞ó„Çí„Å§„Åë„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ
   - „ÄåÂêå„Éï„Ç°„Ç§„É´„Åß„Çà„ÅÑ„Äç„ÅÆ„Åß„ÅÇ„Çå„Å∞„Åù„ÅÆ„Åæ„Åæ„Éà„ÉÉ„Éó„É¨„Éô„É´Èñ¢Êï∞„Å®„Åó„Å¶ÁΩÆ„ÅÑ„Å¶„Åä„Åè„ÅÆ„ÅåÊâãËªΩ„Åß„Åô„ÄÇ

„Åì„Çå„Å´„Çà„Çä„ÄÅ**„ÄåÂà•„Ç¶„Ç£„Ç∏„Çß„ÉÉ„Éà„Å®„Åó„Å¶„ÇØ„É©„Çπ„ÇíÂàÜÂâ≤„ÅØ„Åõ„Åö„Äç„Åã„Å§„Äå`GuildManagePage` „ÅÆ‰∏≠„Å´„ÅØÊõ∏„Åã„Åö„Å´Â§ñ„Å´Âá∫„Åó„Å¶„Åä„Åè„Äç**„Å®„ÅÑ„ÅÜË¶ÅÊúõ„ÇíÊ∫Ä„Åü„Åó„Å§„Å§„ÄÅ„Ç≥„Éº„Éâ„ÅÆË¶ãÈÄö„Åó„ÇíËâØ„Åè„Åß„Åç„Åæ„Åô„ÄÇ

---
