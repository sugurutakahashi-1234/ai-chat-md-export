# SwiftUI 複数ビュー戻る

日付: 2024-08-16

---

## 👤 ユーザー
*2024/08/16 19:09:27*

SwiftUIで2個先のPush遷移から一気に2つ戻す

---

## 🤖 アシスタント
*2024/08/16 19:09:45*

SwiftUIで2つ先のPush遷移から一気に2つ戻るには、`NavigationStack`や`NavigationPath`を使用することで実現できます。具体的には、`NavigationPath`を使って現在のナビゲーションパスを管理し、戻りたい場所までパスを変更することで、複数のビューを一気に戻ることができます。

以下はその例です：

```swift
import SwiftUI

struct ContentView: View {
    @State private var navigationPath = NavigationPath()

    var body: some View {
        NavigationStack(path: $navigationPath) {
            VStack {
                Text("First View")
                Button("Go to Second View") {
                    navigationPath.append("SecondView")
                }
            }
            .navigationDestination(for: String.self) { value in
                if value == "SecondView" {
                    SecondView(navigationPath: $navigationPath)
                } else if value == "ThirdView" {
                    ThirdView(navigationPath: $navigationPath)
                }
            }
        }
    }
}

struct SecondView: View {
    @Binding var navigationPath: NavigationPath

    var body: some View {
        VStack {
            Text("Second View")
            Button("Go to Third View") {
                navigationPath.append("ThirdView")
            }
        }
    }
}

struct ThirdView: View {
    @Binding var navigationPath: NavigationPath

    var body: some View {
        VStack {
            Text("Third View")
            Button("Go back to First View") {
                // パスの状態を2つ前に戻す
                navigationPath.removeLast(2)
            }
        }
    }
}

struct ContentView_Previews: PreviewProvider {
    static var previews: some View {
        ContentView()
    }
}
```

### 説明
- `NavigationStack` と `NavigationPath` を使うことで、ナビゲーションのパスをプログラムで操作できます。
- `ThirdView` の「Go back to First View」ボタンを押すと、`navigationPath.removeLast(2)` により、ナビゲーションスタックの2つ前に戻ります。
  
このようにすることで、SwiftUIで複数のビューを一気に戻ることが可能です。

---

## 👤 ユーザー
*2024/08/16 19:10:10*

NavigationStack は使っているのだけれど、NavigationPathは使いたくない

---

## 🤖 アシスタント
*2024/08/16 19:10:20*

User prefers not to use `NavigationPath` in their SwiftUI implementations, even when using `NavigationStack`.

---

## 🔧 ツール
*2024/08/16 19:10:20*

Model set context updated.

---

## 🤖 アシスタント
*2024/08/16 19:10:20*

`NavigationPath`を使わずに、`NavigationStack`で2つ戻る遷移を実現するには、`dismiss`を2回呼び出す方法があります。具体的には、以下のようにカスタムバックボタンを使って、2つのビューを一気に戻ることができます。

以下に例を示します：

```swift
import SwiftUI

struct ContentView: View {
    var body: some View {
        NavigationStack {
            FirstView()
        }
    }
}

struct FirstView: View {
    var body: some View {
        VStack {
            Text("First View")
            NavigationLink("Go to Second View", destination: SecondView())
        }
    }
}

struct SecondView: View {
    var body: some View {
        VStack {
            Text("Second View")
            NavigationLink("Go to Third View", destination: ThirdView())
        }
    }
}

struct ThirdView: View {
    @Environment(\.dismiss) private var dismiss

    var body: some View {
        VStack {
            Text("Third View")
            Button("Go back to First View") {
                dismiss() // SecondViewに戻る
                dismiss() // FirstViewに戻る
            }
        }
    }
}

struct ContentView_Previews: PreviewProvider {
    static var previews: some View {
        ContentView()
    }
}
```

### 説明
- `ThirdView`で`@Environment(\.dismiss)`を使用して、`dismiss()`を2回呼び出すことで、2つ前のビューまで一気に戻ります。
- この方法では`NavigationPath`を使わずに、`NavigationStack`の中で複数のビューを一度に戻すことが可能です。

このアプローチで、複数のビューをスムーズに戻ることができるでしょう。

---
