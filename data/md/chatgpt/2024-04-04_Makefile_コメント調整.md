# Makefile ã‚³ãƒ¡ãƒ³ãƒˆèª¿æ•´

æ—¥ä»˜: 2024-04-04

---

## ğŸ‘¤ ãƒ¦ãƒ¼ã‚¶ãƒ¼
*2024/04/04 12:47:06*

```Makefile
PACKAGE_NAME := ./DISampleAppPackage
MOCKOLO_SCAN_PATH := ./$(PACKAGE_NAME)/Sources
MOCKOLO_OUTPUT_PATH := ./$(PACKAGE_NAME)/Sources/Presentation/Domain/Entity/Mocks.swift

.PHONY: help
help:
	@awk 'BEGIN {FS = ":"} /^[a-zA-Z0-9_-]+:/ {if ($$2 == "") print "make " $$1}' Makefile

.PHONY: mint-bootstrap
mint-bootstrap:
	swift run --package-path $(PACKAGE_NAME) mint bootstrap

.PHONY: githooks-setup
githooks-setup:
	git config --local core.hooksPath .githooks

.PHONY: githooks-cleanup
githooks-cleanup:
	git config --local --unset core.hooksPath .githooks

.PHONY: swiftformat-run
swiftformat-run:
	swift run --package-path $(PACKAGE_NAME) mint run swiftformat .

.PHONY: swiftformat-lint
swiftformat-lint:
	swift run --package-path $(PACKAGE_NAME) mint run swiftformat --lint .

.PHONY: mockolo-run
mockolo-run:
	swift run --package-path $(PACKAGE_NAME) mint run mockolo -s $(MOCKOLO_SCAN_PATH) -d $(MOCKOLO_OUTPUT_PATH) --custom-imports DomainLayer Combine -x Images Strings --mock-final

.PHONY: sourcery-presentation-code-gen
sourcery-presentation-code-gen:
	./sourcery/script/presentation_code_gen.sh $(VIEW) $(ROUTER)

.PHONY: presentation-code-gen
presentation-code-gen:
	$(MAKE) sourcery-presentation-code-gen
	$(MAKE) mockolo-run

.PHONY: sourcery-driver-code-gen
sourcery-driver-code-gen:
	./sourcery/script/driver_code_gen.sh $(DRIVER)

.PHONY: driver-code-gen
driver-code-gen:
	$(MAKE) sourcery-driver-code-gen
	$(MAKE) mockolo-run

.PHONY: sourcery-use-case-code-gen
sourcery-use-case-code-gen:
	./sourcery/script/use_case_code_gen.sh $(USECASE)

.PHONY: use-case-code-gen
use-case-code-gen:
	$(MAKE) sourcery-use-case-code-gen
	$(MAKE) mockolo-run

.PHONY: swift-docc-gen
swift-docc-gen:
	./swift_docc/script/docc_gen.sh $(PACKAGE_NAME)

.PHONY: periphery-scan
periphery-scan:
	./periphery/script/periphery_scan.sh $(CURDIR)

.PHONY: spm-dependencies-mermaid-gen
spm-dependencies-mermaid-gen:
	./depermaid/script/spm_dependencies_mermaid_gen.sh

.PHONY: document-update
document-update:
	$(MAKE) swift-docc-gen
	$(MAKE) periphery-scan
	$(MAKE) spm-dependencies-mermaid-gen

.PHONY: setup
setup:
	$(MAKE) mint-bootstrap
	$(MAKE) githooks-setup
	$(MAKE) open

.PHONY: cleanup
cleanup:
	$(MAKE) githooks-cleanup
```

make help ã‚’å®Ÿè¡Œã™ã‚‹ã¨ä»¥ä¸‹ã®ã‚ˆã†ãªå‡ºåŠ›ã«ãªã‚‹

make help
make mint-bootstrap
make githooks-setup
make githooks-cleanup
make swiftformat-run
make swiftformat-lint
make mockolo-run
make sourcery-presentation-code-gen
make presentation-code-gen
make sourcery-driver-code-gen
make driver-code-gen
make sourcery-use-case-code-gen
make use-case-code-gen
make swift-docc-gen
make periphery-scan
make spm-dependencies-mermaid-gen
make document-update
make setup
make cleanup

ã•ã‚‰ã«Makefileã«ã‚³ãƒ¡ãƒ³ãƒˆã‚’åŠ ãˆã¦ã€ä¾‹ãˆã°ä»¥ä¸‹ã®ã‚ˆã†ã«ã‚³ãƒ¡ãƒ³ãƒˆã‚’å…¥ã‚ŒãŸå ´åˆã«

.PHONY: help #hogehoge

make help               hogehoge

ã®ã‚ˆã†ãªå‡ºåŠ›ã«ãªã‚‹ã‚ˆã†ã«ã—ã¦ã»ã—ã„ã€‚
ãã®ã¨ãã«ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆãŒæƒã†ã‚ˆã†ã«ã—ã¦ã»ã—ã„ã€‚

---

## ğŸ¤– ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ
*2024/04/04 12:47:37*

Makefileã‚’ä¿®æ­£ã—ã¦ã€`make help`ã‚’å®Ÿè¡Œã—ãŸéš›ã«å„ã‚³ãƒãƒ³ãƒ‰ã®ã‚³ãƒ¡ãƒ³ãƒˆã‚’è¡¨ç¤ºã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ãŸã‚ã«ã¯ã€`awk`ã‚³ãƒãƒ³ãƒ‰ã‚’åˆ©ç”¨ã—ã¦ãƒ‘ãƒ¼ã‚¹ã—ã€å„ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã®å¾Œã«ã‚³ãƒ¡ãƒ³ãƒˆã‚’è¡¨ç¤ºã™ã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚`awk`ã®`FS`ï¼ˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚»ãƒ‘ãƒ¬ãƒ¼ã‚¿ï¼‰ã‚’èª¿æ•´ã—ã€`#`ä»¥é™ã®ã‚³ãƒ¡ãƒ³ãƒˆã‚’å–å¾—ã—ã¦è¡¨ç¤ºã™ã‚‹ã‚ˆã†ã«å¤‰æ›´ã—ã¾ã™ã€‚ã¾ãŸã€ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã‚’æƒãˆã‚‹ãŸã‚ã«ã€å‡ºåŠ›ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã‚’èª¿æ•´ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

ä»¥ä¸‹ã®`help`ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã®`awk`ã‚³ãƒãƒ³ãƒ‰ã‚’å¤‰æ›´ã—ãŸä¾‹ã‚’è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ã€‚ã“ã“ã§ã¯ã€å„ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã®ã‚³ãƒ¡ãƒ³ãƒˆã‚’å–å¾—ã—ã€`make`ã‚³ãƒãƒ³ãƒ‰ã®å‡ºåŠ›ã¨ã¨ã‚‚ã«è¡¨ç¤ºã™ã‚‹ã‚ˆã†ã«ã—ã¦ã„ã¾ã™ã€‚ã¾ãŸã€ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã®èª¿æ•´ã«ã¯`printf`ã‚’ä½¿ç”¨ã—ã¦ã€ä¸€å®šã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã«å¾“ã£ã¦å‡ºåŠ›ã‚’æ•´å½¢ã—ã¦ã„ã¾ã™ã€‚

```Makefile
.PHONY: help
help:
	@awk 'BEGIN {FS = ":.*?##"; printf "Usage:\n"} /^[a-zA-Z0-9_-]+:.*?##/ { printf "  %-30s %s\n", $$1, $$2 }' $(MAKEFILE_LIST)
```

ã—ã‹ã—ã€ä¸Šè¨˜ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯`##`ã‚’ãƒ‡ãƒªãƒŸã‚¿ã¨ã—ã¦ä½¿ç”¨ã—ã¦ã„ã‚‹ãŸã‚ã€ã‚³ãƒ¡ãƒ³ãƒˆãŒ`##`ã§å§‹ã¾ã‚‹ã“ã¨ã‚’å‰æã¨ã—ã¦ã„ã¾ã™ã€‚Makefileå†…ã®ã‚³ãƒ¡ãƒ³ãƒˆãŒå˜ä¸€ã®`#`ã§å§‹ã¾ã‚‹å ´åˆã¯ã€ã“ã‚Œã‚’é©åˆ‡ã«èª¿æ•´ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

Makefileã®ã‚³ãƒ¡ãƒ³ãƒˆãŒ`#`ã§å§‹ã¾ã‚‹å ´åˆã€ä»¥ä¸‹ã®ã‚ˆã†ã«ä¿®æ­£ã—ã¦ãã ã•ã„ï¼š

```Makefile
.PHONY: help
help:
	@awk 'BEGIN {FS = ":.*?#"; printf "Usage:\n"} /^[a-zA-Z0-9_-]+:.*?#/ { gsub(/^[ \t]+/, "", $$2); printf "  %-30s %s\n", $$1, $$2 }' $(MAKEFILE_LIST)
```

ã“ã“ã§ã€`gsub(/^[ \t]+/, "", $$2);`ã‚’ä½¿ç”¨ã—ã¦ã€ã‚³ãƒ¡ãƒ³ãƒˆã®å…ˆé ­ã«ã‚ã‚‹ã‚¹ãƒšãƒ¼ã‚¹ã‚„ã‚¿ãƒ–ã‚’å‰Šé™¤ã—ã€ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã‚’æƒãˆã¦ã„ã¾ã™ã€‚ã¾ãŸã€`printf`é–¢æ•°ã‚’ä½¿ç”¨ã—ã¦ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã‚’æ•´ãˆã¦ã„ã¾ã™ã€‚`%-30s`ã¯ã€ã‚³ãƒãƒ³ãƒ‰åãŒ30æ–‡å­—ã®å¹…ã‚’æŒã¡ã€å·¦æƒãˆã§è¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ã‚’æ„å‘³ã—ã¦ãŠã‚Šã€ã“ã‚Œã«ã‚ˆã‚Šã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆãŒæƒã„ã¾ã™ã€‚

ã“ã®ä¿®æ­£ã‚’é©ç”¨ã™ã‚‹ã“ã¨ã§ã€`make help`ã‚’å®Ÿè¡Œã—ãŸéš›ã«å„ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã®ã‚³ãƒ¡ãƒ³ãƒˆãŒé©åˆ‡ã«è¡¨ç¤ºã•ã‚Œã€ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã‚‚æƒã†ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

---

## ğŸ‘¤ ãƒ¦ãƒ¼ã‚¶ãƒ¼
*2024/04/04 12:48:36*

PACKAGE_NAME := ./DISampleAppPackage
MOCKOLO_SCAN_PATH := ./$(PACKAGE_NAME)/Sources
MOCKOLO_OUTPUT_PATH := ./$(PACKAGE_NAME)/Sources/Presentation/Domain/Entity/Mocks.swift

.PHONY: help #hoge
help:
	@awk 'BEGIN {FS = ":.*?#"; printf "Usage:\n"} /^[a-zA-Z0-9_-]+:.*?#/ { gsub(/^[ \t]+/, "", $$2); printf "  %-30s %s\n", $$1, $$2 }' $(MAKEFILE_LIST)

.PHONY: mint-bootstrap #moge
mint-bootstrap:
	swift run --package-path $(PACKAGE_NAME) mint bootstrap
de

---

## ğŸ¤– ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ
*2024/04/04 12:48:52*

Your Makefile snippet now includes the adjusted `help` target with an `awk` command designed to parse and display comments next to each target name when `make help` is executed. However, your code snippet seems to end abruptly. Assuming you're looking for a continuation or verification that your approach is correct, here's a clarification:

Your adjusted `help` target with the `awk` script will read through the Makefile, looking for target names followed by comments marked with `#`. It then formats these names and their corresponding comments into a neatly aligned output. This is a smart way to make your Makefile more user-friendly, allowing other developers to quickly understand what each target does.

If you intended to ask how to ensure that this approach correctly formats and displays all your Makefile targets with their comments, it looks like you're on the right path. The key points in your script are:

- **FS = ":.*?#";** This sets the field separator to a pattern that matches a colon followed by any characters and then a `#`, effectively separating target names from their comments.
- **gsub(/^[ \t]+/, "", $$2);** This removes leading whitespace from the comment portion, ensuring that the output is neatly aligned.
- **printf "  %-30s %s\n", $$1, $$2;** This formats

---
