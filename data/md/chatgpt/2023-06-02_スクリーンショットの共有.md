# ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã®å…±æœ‰

Date: 2023-06-02

---

## ğŸ‘¤ User
*2023-06-02 13:22:25*

SwiftUIã‚¢ãƒ—ãƒªã®æ©Ÿèƒ½ã§ç”»é¢ã‚’ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã—ãŸç”»åƒã‚’ã‚·ã‚§ã‚¢ã™ã‚‹ã“ã¨ã¯ã§ãã‚‹ã®ã‹

---

## ğŸ¤– Assistant
*2023-06-02 13:22:58*

SwiftUIã‚’ä½¿ç”¨ã—ã¦ã‚¢ãƒ—ãƒªã®ç”»é¢ã®ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã‚’æ’®ã‚Šã€ãã®ç”»åƒã‚’ã‚·ã‚§ã‚¢ã™ã‚‹ã“ã¨ã¯å¯èƒ½ã§ã™ã€‚ä»¥ä¸‹ã«ä¸€èˆ¬çš„ãªæ‰‹é †ã‚’ç¤ºã—ã¾ã™ã€‚

1. **ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã®å–å¾—**: ã¾ãšã€ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã‚’å–ã‚‹ãŸã‚ã®ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãå¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã¯Swiftã®UIKitãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯å†…ã®`UIGraphicsImageRenderer`ã‚’ä½¿ç”¨ã—ã¦è¡Œã†ã“ã¨ãŒã§ãã¾ã™ã€‚

    ```swift
    func captureScreenshot(view: UIView) -> UIImage {
        let renderer = UIGraphicsImageRenderer(size: view.bounds.size)
        let image = renderer.image { ctx in
            view.drawHierarchy(in: view.bounds, afterScreenUpdates: true)
        }
        return image
    }
    ```
2. **ã‚·ã‚§ã‚¢æ©Ÿèƒ½ã®å®Ÿè£…**: æ¬¡ã«ã€å–å¾—ã—ãŸã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã‚’ã‚·ã‚§ã‚¢ã™ã‚‹æ©Ÿèƒ½ã‚’ä½œæˆã—ã¾ã™ã€‚ã“ã‚Œã«ã¯ã€Swiftã®`UIActivityViewController`ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

    ```swift
    func shareScreenshot(image: UIImage) {
        let activityViewController = UIActivityViewController(activityItems: [image], applicationActivities: nil)
        UIApplication.shared.windows.first?.rootViewController?.present(activityViewController, animated: true, completion: nil)
    }
    ```
3. **SwiftUIã¨ã®çµ±åˆ**: ä¸Šè¨˜ã®ã‚³ãƒ¼ãƒ‰ã¯ä¸»ã«UIKitã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚ã“ã‚Œã‚’SwiftUIã®ã‚¢ãƒ—ãƒªã«é©å¿œã™ã‚‹ã«ã¯ã€`UIViewControllerRepresentable`ã‚’ä½¿ç”¨ã—ã¦UIKitã®ViewControllerã‚’SwiftUIã«ãƒ©ãƒƒãƒ—ã™ã‚‹ã‹ã€ã‚ã‚‹ã„ã¯`UIViewRepresentable`ã‚’ä½¿ç”¨ã—ã¦UIViewã‚’ãƒ©ãƒƒãƒ—ã™ã‚‹æ–¹æ³•ãŒã‚ã‚Šã¾ã™ã€‚

ãªãŠã€ç”»é¢å…¨ä½“ã®ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã‚’å–å¾—ã—ãŸã„å ´åˆã¯ã€ã“ã®ã‚³ãƒ¼ãƒ‰ã‚’ã©ã“ã§ã‚‚å‘¼ã³å‡ºã™ã“ã¨ãŒã§ãã¾ã™ã€‚ã—ã‹ã—ã€ç‰¹å®šã®SwiftUIãƒ“ãƒ¥ãƒ¼ã®ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã‚’å–å¾—ã—ãŸã„å ´åˆã¯ã€ãã®ãƒ“ãƒ¥ãƒ¼ã‚’UIViewã¨ã—ã¦æç”»ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã¾ãŸã€ã“ã®æ“ä½œã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ã«å½±éŸ¿ã‚’åŠã¼ã™å¯èƒ½æ€§ãŒã‚ã‚‹ãŸã‚ã€é©åˆ‡ãªãƒ¦ãƒ¼ã‚¶ãƒ¼è¨±å¯ã‚’å–å¾—ã—ã€ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼ã‚’éµå®ˆã™ã‚‹ã“ã¨ãŒé‡è¦ã§ã™ã€‚

---

## ğŸ‘¤ User
*2023-06-02 13:25:23*

SwiftUIã®Viewã§ã‚³ãƒ³ãƒãƒ¼ãƒˆã‚’ä½œã£ã¦shereã—ãŸã„

---

## ğŸ¤– Assistant
*2023-06-02 13:26:01*

SwiftUIã®Viewã®ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã‚’å–å¾—ã—ã¦ã€ãã‚Œã‚’ã‚·ã‚§ã‚¢ã™ã‚‹ã“ã¨ã‚‚å¯èƒ½ã§ã™ã€‚ã—ã‹ã—ã€ãã®ãŸã‚ã«ã¯å°‘ã—ãƒˆãƒªãƒƒã‚­ãƒ¼ãªæ‰‹é †ãŒå¿…è¦ã§ã™ã€‚ãã®ç†ç”±ã¯ã€SwiftUIã®ViewãŒç›´æ¥ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ããªã„ã‹ã‚‰ã§ã™ã€‚ã—ãŸãŒã£ã¦ã€ã‚ã‚‹ç‰¹å®šã®SwiftUI Viewã‹ã‚‰ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã‚’å–å¾—ã™ã‚‹ãŸã‚ã«ã¯ã€ãã®Viewã‚’ã¾ãšUIViewã«å¤‰æ›ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

ä»¥ä¸‹ã«SwiftUIã®Viewã‹ã‚‰ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã‚’å–å¾—ã—ã€ãã‚Œã‚’ã‚·ã‚§ã‚¢ã™ã‚‹æ‰‹é †ã‚’ç¤ºã—ã¾ã™ã€‚

ã¾ãšã€SwiftUIã®Viewã‚’æç”»ã—ã€ãã®çµæœã‚’UIImageã¨ã—ã¦è¿”ã™æ‹¡å¼µé–¢æ•°ã‚’ä½œæˆã—ã¾ã™ã€‚

```swift
extension View {
    func snapshot() -> UIImage {
        let controller = UIHostingController(rootView: self)
        let view = controller.view

        let targetSize = controller.view.intrinsicContentSize
        view.bounds = CGRect(origin: .zero, size: targetSize)
        view.backgroundColor = .clear

        let rendererFormat = UIGraphicsImageRendererFormat.default()
        rendererFormat.opaque = false
        let renderer = UIGraphicsImageRenderer(size: targetSize, format: rendererFormat)

        return renderer.image { _ in
            view.drawHierarchy(in: controller.view.bounds, afterScreenUpdates: true)
        }
    }
}
```

æ¬¡ã«ã€UIActivityViewControllerã‚’ãƒ©ãƒƒãƒ—ã—ã¦SwiftUI Viewã¨ã—ã¦è¡¨ç¤ºã™ã‚‹æ–°ã—ã„structã‚’ä½œæˆã—ã¾ã™ã€‚

```swift
struct ActivityViewController: UIViewControllerRepresentable {
    let activityItems: [Any]
    let applicationActivities: [UIActivity]? = nil

    func makeUIViewController(context: UIViewControllerRepresentableContext<ActivityViewController>) -> UIActivityViewController {
        let controller = UIActivityViewController(activityItems: activityItems, applicationActivities: applicationActivities)
        return controller
    }

    func updateUIViewController(_ uiViewController: UIActivityViewController, context: UIViewControllerRepresentableContext<ActivityViewController>) {}
}
```

ã“ã‚Œã§SwiftUIã®Viewã‚’ã‚·ã‚§ã‚¢ã™ã‚‹æº–å‚™ãŒã§ãã¾ã—ãŸã€‚ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã‚’æ’®ã‚ŠãŸã„Viewã‚’é¸æŠã—ã€ãã®snapshotã‚’å–å¾—ã—ã€ActivityViewControllerã‚’è¡¨ç¤ºã—ã¾ã™ã€‚ä»¥ä¸‹ã«ãã®ä¾‹ã‚’ç¤ºã—ã¾ã™ã€‚

```swift
struct ContentView: View {
    @State private var isShareSheetShowing = false
    @State private var screenshot: UIImage? = nil

    var body: some View {
        VStack {
            Text("Hello, world!")
                .padding()
            Button("Share Screenshot") {
                self.screenshot = self.snapshot()
                self.isShareSheetShowing = true
            }
        }
        .sheet(isPresented: $isShareSheetShowing) {
            ActivityViewController(activityItems: [self.screenshot as Any])
        }
    }
}
```

ã“ã®ã‚³ãƒ¼ãƒ‰ã¯ã€ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã‚’ã‚·ã‚§ã‚¢ã™ã‚‹ãƒœã‚¿ãƒ³ã‚’æŒã¤å˜ç´”ãªSwiftUI Viewã‚’ä½œæˆã—ã¾ã™ã€‚ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã¨ã€ãã®Viewã®ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆãŒå–å¾—ã•ã‚Œã€ã‚·ã‚§ã‚¢ã‚·ãƒ¼ãƒˆãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

---
