# コード簡略化提案

Date: 2024-12-18

---

## 👤 User
*2024-12-18 15:59:05*

もっと省略してかけないか

import 'package:riverpod_annotation/riverpod_annotation.dart';

import 'package:snpit_guild_app/lib/infrastructure/snapit_guild_api/snapit_guild_api.openapi.dart';
import 'package:snpit_guild_app/presentation/providers/api_client/guild_api_provider.dart';

part 'get_guild_info.g.dart';

@riverpod
class GetGuildInfoNotifier extends _$GetGuildInfoNotifier {
  @override
  Future&lt;GuildInfoResponseDto?&gt; build() async {
    return null;
  }

  Future&lt;void&gt; fetchGuildInfo() async {
    state = const AsyncValue.loading();
    try {
      final api = ref.read(guildApiProvider);
      final response = await api.guildControllerGetGuildInfo();
      state = AsyncValue.data(response.data);
    } on Exception catch (e, stackTrace) {
      state = AsyncValue.error(e, stackTrace);
    }
  }
}

---

## 🤖 Assistant
*2024-12-18 15:59:20*

コードを省略して書く方法を考えると、特にインポートや繰り返し部分を簡潔にすることができます。ただし、可読性を損なわない範囲での省略が重要です。以下に省略版を示します。

```dart
import 'package:riverpod_annotation/riverpod_annotation.dart';
import 'guild_api_provider.dart';
part 'get_guild_info.g.dart';

@riverpod
class GetGuildInfoNotifier extends _$GetGuildInfoNotifier {
  @override
  Future<GuildInfoResponseDto?> build() async => null;

  Future<void> fetchGuildInfo() async {
    state = const AsyncValue.loading();
    try {
      state = AsyncValue.data(
        await ref.read(guildApiProvider).guildControllerGetGuildInfo().then((res) => res.data),
      );
    } catch (e, stackTrace) {
      state = AsyncValue.error(e, stackTrace);
    }
  }
}
```

### 修正点:
1. **インポートの簡略化**:
   - よく使うプロジェクト内のパス部分（例: `infrastructure/snapit_guild_api/snapit_guild_api.openapi.dart`）を省略。
   - これには `guild_api_provider.dart` の相対パスに依存します。

2. **`build` の簡略化**:
   - シンプルな `Future` を矢印関数で表現。

3. **`fetchGuildInfo` 内の `api` 変数削除**:
   - API コールを直接一行で書く。

4. **リーダブルなラムダ式使用**:
   - `then` を利用して非同期結果を直接 `state` に設定。

これでコード量を減らしつつ、機能性や読みやすさを保つことができます。

---
