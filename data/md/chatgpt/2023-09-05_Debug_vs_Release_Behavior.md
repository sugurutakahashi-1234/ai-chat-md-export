# Debug vs Release Behavior

Date: 2023-09-05

---

## 👤 User
*2023-09-06 03:08:44*

SwiftでassertionFailureとは逆でリリース時はクラッシュして欲しいけどテスト時は通過してほしいときはどうすればいいの？

---

## 🤖 Assistant
*2023-09-06 03:09:33*

`assertionFailure`は、デバッグ時にアサーションが失敗した場合にクラッシュさせるもので、リリースビルドではそのクラッシュは無効になります。逆の動作をさせたい場合、つまりリリース時にクラッシュし、デバッグ時にはクラッシュしないようにしたい場合は、ビルド設定をカスタマイズすることで実現できます。

以下は、そのための方法の一例です：

1. **新しいビルド設定を追加する**

   Xcodeでプロジェクトの設定に移動し、ビルド設定を編集します。ここで新しいビルド設定のフラグを作成します。例えば、`RELEASE_CRASH_ON_ASSERT`という名前で新しいフラグを定義することができます。

2. **コード内での条件付きクラッシュ**

   ビルド設定で定義したフラグを使用して、コード内で条件付きのクラッシュを書きます。以下のような方法で書くことができます：

   ```swift
   #if RELEASE_CRASH_ON_ASSERT
       fatalError("This should crash on release build.")
   #else
       print("This should only log on debug build.")
   #endif
   ```

3. **リリースビルドの設定**

   リリースビルドの設定で、先ほど追加した`RELEASE_CRASH_ON_ASSERT`フラグを有効にします。これにより、リリースビルド時には`fatalError`が実行され、デバッグ時には実行されません。

4. **テスト設定の調整**

   もしあなたが自動テストを実行する場合、テスト環境でこのフラグを無効にすることで、テスト時にクラッシュを回避することができます。

この方法を用いることで、リリースビルドでのみクラッシュする動作と、デバッグビルドやテスト実行時にはクラッシュしない動作を切り替えることができます。

---
