# 削除処理の追加

日付: 2024-12-24

---

## 👤 ユーザー
*2024/12/24 15:11:38*

import 'package:flutter/foundation.dart';
import 'package:riverpod_annotation/riverpod_annotation.dart';

import 'package:snpit_guild_app/presentation/providers/api_client/guild_api_provider.dart';

part 'delete_guild.g.dart';

@riverpod
class DeleteGuildNotifier extends _$DeleteGuildNotifier {
  @override
  Future&lt;String?&gt; build() async =&gt; null;

  Future&lt;void&gt; executeRequest(String guildId) async {
    state = const AsyncValue.loading();
    try {
      final api = await ref.watch(guildApiProvider.future);
      final response = await api.guildControllerDeleteGuild(guildId: guildId);
      debugPrint('Response Body: ${response.data}');
      state = AsyncValue.data(response.data?.data);
    } on Exception catch (e, stackTrace) {
      debugPrint('Error: $e');
      debugPrint('StackTrace: $stackTrace');
      state = AsyncValue.error(e, stackTrace);
    }
  }
}

import 'package:flutter/foundation.dart';
import 'package:riverpod_annotation/riverpod_annotation.dart';

import 'package:snpit_guild_app/presentation/providers/api_client/guild_api_provider.dart';

part 'delete_guild.g.dart';

@riverpod
class DeleteGuildNotifier extends _$DeleteGuildNotifier {
  @override
  Future&lt;String?&gt; build() async =&gt; null;

  Future&lt;void&gt; executeRequest(String guildId) async {
    state = const AsyncValue.loading();
    try {
      final api = await ref.watch(guildApiProvider.future);
      final response = await api.guildControllerDeleteGuild(guildId: guildId);
      debugPrint('Response Body: ${response.data}');
      state = AsyncValue.data(response.data?.data);
    } on Exception catch (e, stackTrace) {
      debugPrint('Error: $e');
      debugPrint('StackTrace: $stackTrace');
      state = AsyncValue.error(e, stackTrace);
    }
  }
}

削除処理を入れて欲しい

---

## 🤖 アシスタント
*2024/12/24 15:11:49*

削除処理を追加するには、`executeRequest`メソッド内で削除処理が成功した場合に、何かしらのロジック（例えばリストから削除されたデータを除外するなど）を実行する必要があります。

以下のコードは、削除処理の結果を適切に反映するための変更を含んでいます：

```dart
import 'package:flutter/foundation.dart';
import 'package:riverpod_annotation/riverpod_annotation.dart';

import 'package:snpit_guild_app/presentation/providers/api_client/guild_api_provider.dart';

part 'delete_guild.g.dart';

@riverpod
class DeleteGuildNotifier extends _$DeleteGuildNotifier {
  @override
  Future&lt;String?&gt; build() async =&gt; null;

  Future&lt;void&gt; executeRequest(String guildId) async {
    state = const AsyncValue.loading(); // 状態をロード中に設定
    try {
      final api = await ref.watch(guildApiProvider.future);
      final response = await api.guildControllerDeleteGuild(guildId: guildId);

      // 削除成功時のデバッグ出力
      debugPrint('Response Body: ${response.data}');

      // 状態をデータで更新
      state = AsyncValue.data(response.data?.data);

      // 必要に応じてローカルで削除処理を追加
      await _removeFromLocalCache(guildId);
    } on Exception catch (e, stackTrace) {
      debugPrint('Error: $e'); // エラーのデバッグ出力
      debugPrint('StackTrace: $stackTrace');
      state = AsyncValue.error(e, stackTrace); // 状態をエラーに設定
    }
  }

  // ローカルキャッシュから削除する処理（例）
  Future&lt;void&gt; _removeFromLocalCache(String guildId) async {
    // 削除後のリスト更新などのロジックを記述
    debugPrint('Removing guildId: $guildId from local cache.');
    // 必要ならデータストアやプロバイダを更新

---
