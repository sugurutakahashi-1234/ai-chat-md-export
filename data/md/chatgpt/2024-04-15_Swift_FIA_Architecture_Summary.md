# Swift FIA Architecture Summary

日付: 2024-04-15

---

## 👤 ユーザー
*2024/4/15 20:38:04*

{
  "content_type": "image_asset_pointer",
  "asset_pointer": "file-service://file-PVkYjFNEs7x9N45eVE8lsaSc",
  "size_bytes": 219121,
  "width": 794,
  "height": 1524,
  "fovea": null,
  "metadata": null
}
Framework-Independent Architecture (FIA) という私の考えたアーキテクチャの解説するGitHubのReadmeを記述している。

説明の構成だったり、日本語の修正であったり、3つの図を表示する位置だったり、追加した方が良さそうなことを考えてほしい。


## Framework-Independent Architecture (FIA)

### 概要

「Framework-Independent Architecture (FIA)」は、Swift でのアプリ開発において、Swift Package Manager を利用したマルチモジュール、マルチプロジェクト構成を採用し、Clean Architecture の設計概念を取り入れたアーキテクチャです。

FIA の目的は、Clean Architecture がもたらす独立性やテスタビリティといったメリットを活かしつつ、特に Xcode でのビルド時間を短縮することにあります。

FIA では、依存性の注入をプロジェクトでのアプリケーションのエントリーポイントで行い、プレゼンテーション層だけでなくアプリケーション層もクリーンな領域を保持します。これにより、フレームワーク層に依存しない状態でアプリケーションの高速ビルドが実現されます。

その結果、Xcode で行われる頻繁なビルド作業の時間が短縮され、全体の開発体験が向上します。

### ｘｘｘｘ

Swfit Package Manager の登場によって、[isowords](https://github.com/pointfreeco/isowords) を例にするように、自身のアプリケーションを容易にマルチモジュール、マルチプロジェクト構成を採用することができるようになりました。

一般的な Swfit Package Manager のモジュールの分割は、機能単位（Feature 単位）モジュールでの分割になりますが、FIA では、Clean Architecture でのレイヤー単位でモジュールを分割を採用しています。

また、モジュールの依存関係を `Package.Swift` に記述することで容易に管理できる Swfit Package Manager は、依存の方向が重要となる Clean Architecture と非常に相性がよく、 Swfit Package Manager と Clean Architecture の組み合わせの採用が容易になったと言えます。

さらに、FIA では依存性注入をプロジェクトでのアプリケーションのエントリーポイントで行い、DIコンテナとしてモックを設定することで、プロジェクトから参照する Frameworks and Librararies の項目からフレームワーク層のモジュールの依存しない開発・検証用のプロジェクトを用意することが可能にして、アプリケーションのビルドの際に Firebase に代表されるような依存するとビルドに大幅な時間がかかってしまう外部ライブラリからをビルド対象に含まなくなるため、高速なビルドができます。

これは Xcode Previews のビルドについても、フレームワーク層に依存されないためビルドの高速化が可能になります。

### FIA のメリットデメリット

#### メリット

- ビルド時間短縮：
- 独立性：フレームワークに依存しない設計により、ニーズの変化や新しい技術の出現に伴って異なるフレームワークや技術への移行が容易になります。
- テスタビリティ：関心の分離が明確でフレームワークからの分離があるため、コードの単位を独立してテストすることができ、包括的な単体テストとTDD（テスト駆動開発）を容易にします。
- メンテナビリティ：一つの層での変更が他の層に影響を与えないことが多く、コードベースの保守と進化を容易にします。
- 再利用性：
- スケーラビリティ：各層を独立してスケールアウトできるため、ターゲットとする最適化が可能になります。

#### デメリット

- 複雑性：複数の層と抽象化により、アーキテクチャが追加の複雑さをもたらすことがあり、これは単純なアプリケーションには過剰かもしれません。
- 学習曲線：開発者はアーキテクチャに慣れ、層間の相互作用を理解するために時間がかかるかもしれません。
- 開発時間：層間でのインターフェイスの定義と依存性注入メカニズムの設定が必要なため、アプリケーションの設定と開発に時間がかかることがあります。

### 実装

#### 実装コード

...あとで記述する

### テスタビリティ

FIA では Clean Architecture をベースとしているため、サードパーティー製のライブラリや、外部の API との疎通の処理をモックに差し替える依存性の注入の仕組みによって、各レイヤーの独立したテストコードが記述が可能です。

以下は、FIA によって可能なテストの種類と、そのテストによって担保されるテスト対象を示した表になります。

| テストの種類              |    Driver     | テスト対象: |      |           |            |        |
| ------------------------- | :-----------: | :---------: | :--: | :-------: | :--------: | :----: |
|                           |               |   Router    | View | Presenter | Interactor | Driver |
| App UI テスト (XCUITest)  | Actual / Mock |      ◎      |  ◯   |     ◯     |     ◯      | ◯ / -  |
| Xcode Previews            |     Mock      |      -      |  ◎   |     ◯     |     ◯      |   -    |
| Presenter ユニットテスト  | Actual / Mock |      -      |  -   |     ◎     |     ◯      | ◯ / -  |
| Interactor ユニットテスト | Actual / Mock |      -      |  -   |     -     |     ◎      | ◯ / -  |
| Driver ユニットテスト     |    Actual     |      -      |  -   |     -     |     -      |   ◎    |

※ ◎ : テスト対象、◯ : 付随的にテストされる対象

この表を念頭に置くことで、各テストで担保しなければならない範囲が明確になり、記述するテストコードの価値を高めることに繋がります。

---

## 🤖 アシスタント
*2024/4/15 20:40:36*

GitHubのReadmeは、プロジェクトの説明、利用方法、貢献ガイドラインなど、プロジェクトに関連する重要な情報を含む文書です。Readmeは通常、Markdown形式で記述されます。プロジェクトの「Framework-Independent Architecture (FIA)」に関して、以下のように構成を提案し、日本語の文章を少し修正します。

---

## Framework-Independent Architecture (FIA)

### 概要

「Framework-Independent Architecture (FIA)」は、Swiftでのアプリ開発においてSwift Package Managerを利用したマルチモジュール、マルチプロジェクト構成を採用し、Clean Architectureの設計概念を取り入れたアーキテクチャです。

FIAの主な目的は、Clean Architectureがもたらす独立性やテスタビリティのメリットを活かしながら、特にXcodeでのビルド時間を短縮することです。

FIAでは、プロジェクトのアプリケーションエントリーポイントで依存性の注入を行い、プレゼンテーション層だけでなくアプリケーション層もクリーンな領域を維持します。これにより、フレームワーク層に依存しない状態でのアプリケーション高速ビルドが実現されます。

その結果、Xcodeでの頻繁なビルド作業の時間が短縮され、開発体験全体が向上します。

### FIAの採用背景

Swift Package Managerの登場により、isowordsのようなアプリケーションを容易にマルチモジュール、マルチプロジェクト構成にできるようになりました。

一般的なSwift Package Managerのモジュール分割は機能単位（Feature単位）ですが、FIAではClean Architectureのレイヤー単位でのモジュール分割を採用しています。

`Package.swift`にモジュールの依存関係を記述することで容易に管理できるSwift Package Managerは、依存の方向が重要なClean Architectureと非常に相性が良いため、その組み合わせが容易になります。

FIAでは、DIコンテナとしてモックを設定することで、プロジェクトから参照するFrameworks and Librariesからフレームワーク層モジュールの依存を排除し、Firebaseなどの外部ライブラリに依存することで生じるビルド時間の増大を避け、高速なビルドを実現します。

また、Xcode Previewsのビルドもフレームワーク層に依存しないため、ビルドの高速化が可能です。

### FIAのメリットとデメリット

#### メリット

- ビルド時間の短縮
- 独立性：フレームワークに依存しない設計により、異なるフレームワークや新技術への移行が容易
- テスタビリティ：関心の分離とフレームワークからの独立が明確であり、単位テストとTDDを容易にする
- メンテナビリティ：層間の変更が他の層に影響を与えにくく、コードベースの保守と進化を容易

---

## 🤖 アシスタント
*2024/4/15 20:42:51*

にする
- 再利用性：コンポーネントの独立性が高いため、再利用が容易
- スケーラビリティ：各層を独立してスケールアウトできるため、最適化をターゲットにすることが可能

#### デメリット

- 複雑性：多層構造と抽象化により、アーキテクチャには複雑さが増す
- 学習曲線：アーキテクチャへの慣れと層間の相互作用の理解には時間が必要
- 開発時間：層間のインターフェース定義と依存性注入の設定には時間がかかる

### 実装

#### 実装コードの例

...あとで記述する

### テスタビリティ

FIAはClean Architectureを基盤としているため、サードパーティ製のライブラリや外部APIとの通信処理をモックに置き換える依存性注入の仕組みを使用し、各レイヤーの独立したテストコードを記述可能です。

以下はFIAによって可能なテストの種類と、それぞれのテストが担保する領域を示す表です。

// ここにテーブルを挿入 //

この表を参照することで、各テストの担保範囲が明確になり、テストコードの価値が向上します。

### 図表

- **図1**: Framework-Independent Architecture (FIA) - 概要
- **図2**: Framework-Independent Architecture (FIA) - サークル
- **図3**: Framework-Independent Architecture (FIA) - 詳細

// 図表の位置を示し、必要であれば画像ファイルのリンクを提供 //

---

#### 追加で良さそうな内容：

1. **コードスニペット**: 実際のプロジェクトでの使用例を示すコードスニペットを追加すると、理解を助けます。
2. **セットアップガイド**: 初めての利用者がFIAを簡単に導入できるよう、セットアップガイドを追加します。
3. **貢献ガイドライン**: 他の開発者がプロジェクトに貢献できるよう、ガイドラインを設けます。
4. **ライセンス情報**: プロジェクトのライセンスを明記し、他者がプロジェクトを使用する際の条件を設定します。

#### 図の配置：

GitHubのMarkdownで直接画像を配置する際は、以下のフォーマットを使用します：

```markdown
![代替テキスト](画像のURL)
```

画像はプロジェクトのリポジトリ内に置き、相対パスでリンクするのが一般的です。

#### 日本語の修正：

- 原文をより自然な日本語に修正しました。
- 技術的な用語を適切に使用し、読みやすさを向上させました。
- 説明を簡潔にし、冗長な表現を避けました。

上記の内容を踏まえて、Readmeの記述を進めてください。必要に応じて、具体的なコード例や画像リンクを追加してください。

---

## 👤 ユーザー
*2024/4/15 20:44:09*

図を挿入する適切な場所だったりを考案してほしい。

図1: Framework-Independent Architecture (FIA) - 概要
図2: Framework-Independent Architecture (FIA) - サークル
図3: Framework-Independent Architecture (FIA) - 詳細

また、それらを配置する章だったり、段落を作ってもらっても構わない。

足りていない文言があれば追加してほしい。今の章の構成がベストだと思っていない。

以下は追加の予定はない。

コードスニペット: 実際のプロジェクトでの使用例を示すコードスニペットを追加すると、理解を助けます。
セットアップガイド: 初めての利用者がFIAを簡単に導入できるよう、セットアップガイドを追加します。
貢献ガイドライン: 他の開発者がプロジェクトに貢献できるよう、ガイドラインを設けます。
ライセンス情報: プロジェクトのライセンスを明記し、他者がプロジェクトを使用する際の条件を設定します。

---

## 🤖 アシスタント
*2024/4/15 20:46:03*

GitHubのReadmeに図を挿入する場所は、読者がテキスト情報を処理した後で視覚的な補足として理解を助けるためのものです。理想的には、図は関連するテキストの直後に配置するべきです。以下は、提案された章の構成と、それぞれの図を挿入する場所です。

---

# Framework-Independent Architecture (FIA)

## 目次

- [概要](#概要)
- [FIAの採用背景](#FIAの採用背景)
- [FIAのメリットとデメリット](#FIAのメリットとデメリット)
- [アーキテクチャの構造](#アーキテクチャの構造)
- [実装](#実装)
- [テスタビリティ](#テスタビリティ)

## 概要

「Framework-Independent Architecture (FIA)」は、Swiftでのアプリ開発においてSwift Package Managerを利用したマルチモジュール、マルチプロジェクト構成を採用し、Clean Architectureの設計概念を取り入れたアーキテクチャです。

### 図1: Framework-Independent Architecture (FIA) - 概要

// 図1を挿入 //

FIAの主な目的は、ビルド時間の短縮と開発体験の向上です。...

## FIAの採用背景

Swift Package Managerの登場により、...

### 図2: Framework-Independent Architecture (FIA) - サークル

// 図2を挿入 //

このサークル図は、FIAの各レイヤーがどのように相互作用するかを示しています。...

## FIAのメリットとデメリット

ここで、FIAの利点と潜在的な欠点について詳しく説明します。

### メリット

1. ビルド時間の短縮...
2. 独立性...
3. ...

### デメリット

1. 複雑性...
2. 学習曲線...
3. ...

## アーキテクチャの構造

FIAのアーキテクチャは、以下の主要な構造に分けられます。...

### 図3: Framework-Independent Architecture (FIA) - 詳細

// 図3を挿入 //

この詳細図は、FIAの各コンポーネントとその関連性を深く掘り下げています。...

## 実装

#### 実装コードの例

実装コードについての説明は、あとで記述されます。

## テスタビリティ

FIAはClean Architectureを基盤としており、テストの容易性を提供します。...

---

この構成では、図がその直前のセクションの内容を補足するように配置されています。それぞれのセクションの終わりに図を挿入することで、読者は視覚的に情報を関連付けやすくなります。

また、各図にはその内容を簡潔に説明するキャプションを付けることが重要です。これにより、読者が図の目的を理解しやすくなります。図は技術的なReadmeで強力なツールですが、彼らがテキストを補足し、理解を促進する方法で使用されるべきです。

---

## 👤 ユーザー
*2024/4/16 8:23:22*

図1 と 図2 は同じ意味の図を表している。特に図2はClean Architectureのサークルの図をFIAで表現したものである。

それを

---

## 🤖 アシスタント
*2024/4/16 8:23:27*

了解しました。図

---
