# デバイス情報とアプリ情報

Date: 2025-01-28

---

## 👤 User
*2025-01-28 21:36:22*

Listをタップしたらバリューをクリップボードにコピーできるようにしたい。スナックバーでも表示したい。
また、アプリバージョンやビルド番号なども取れるようにしたい。
バンドルIDやそれにそうとうするIDなども取れるようにしたい。
import 'package:device_info_plus/device_info_plus.dart';
import 'package:flutter/material.dart';

class DebugDeviceInfoPage extends StatelessWidget {
  const DebugDeviceInfoPage({super.key});

  Future&lt;Map&lt;String, dynamic&gt;&gt; _getDeviceInfo() async {
    final deviceInfoPlugin = DeviceInfoPlugin();
    final deviceInfo = await deviceInfoPlugin.deviceInfo;
    return deviceInfo.data;
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(title: const Text('Device Info')),
      body: FutureBuilder&lt;Map&lt;String, dynamic&gt;&gt;(
        future: _getDeviceInfo(),
        builder: (context, snapshot) {
          if (snapshot.connectionState == ConnectionState.waiting) {
            return const Center(child: CircularProgressIndicator());
          } else if (snapshot.hasError) {
            return Center(child: Text('Error: ${snapshot.error}'));
          } else if (!snapshot.hasData) {
            return const Center(child: Text('No device info available.'));
          }

          final deviceInfo = snapshot.data!;
          return ListView(
            children: deviceInfo.entries.map((entry) {
              return ListTile(
                title: Text(entry.key),
                subtitle: Text(entry.value.toString()),
              );
            }).toList(),
          );
        },
      ),
    );
  }
}

---

## 🔧 Tool
*2025-01-28 21:37:27*

**Advancing the app features**

I’m setting up an app to copy tile values to the clipboard, show a success snack bar, and include app version info from package_info_plus.

**Enhancing app details**

I’m combining device and package info in a single method, adding clipboard functionality and a snackbar for copying ListTile, and including app name, package name, version, and build number.

---

## 🤖 Assistant
*2025-01-28 21:37:27*

以下の例では、  
- `device_info_plus` から取得したデバイス情報に加えて、`package_info_plus` を利用してアプリバージョンやビルド番号、パッケージ名(バンドルID)などを取得しています。  
- `ListTile` をタップすると、サブタイトル部分の値がクリップボードにコピーされ、スナックバーが表示されます。

```dart
import 'package:device_info_plus/device_info_plus.dart';
import 'package:flutter/material.dart';
import 'package:flutter/services.dart'; // Clipboardを使うため
import 'package:package_info_plus/package_info_plus.dart'; // アプリ情報を取得するため

class DebugDeviceInfoPage extends StatelessWidget {
  const DebugDeviceInfoPage({super.key});

  Future<Map<String, dynamic>> _getDeviceAndAppInfo() async {
    final deviceInfoPlugin = DeviceInfoPlugin();
    // デバイス情報を取得
    final deviceInfo = await deviceInfoPlugin.deviceInfo;
    final deviceData = deviceInfo.data;

    // アプリ情報を取得
    final packageInfo = await PackageInfo.fromPlatform();

    // デバイス情報 + アプリ情報を1つのMapにまとめる
    return {
      ...deviceData,
      'App Name': packageInfo.appName,
      'Package Name': packageInfo.packageName, // iOSではBundle IDに相当
      'Version': packageInfo.version,
      'Build Number': packageInfo.buildNumber,
    };
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(title: const Text('Device Info')),
      body: FutureBuilder<Map<String, dynamic>>(
        future: _getDeviceAndAppInfo(),
        builder: (context, snapshot) {
          if (snapshot.connectionState == ConnectionState.waiting) {
            return const Center(child: CircularProgressIndicator());
          } else if (snapshot.hasError) {
            return Center(child: Text('Error: ${snapshot.error}'));
          } else if (!snapshot.hasData) {
            return const Center(child: Text('No device info available.'));
          }

          final deviceInfo = snapshot.data!;
          return ListView(
            children: deviceInfo.entries.map((entry) {
              return ListTile(
                title: Text(entry.key),
                subtitle: Text(entry.value.toString()),
                // タップでクリップボードにコピーし、スナックバーを表示
                onTap: () async {
                  final copyText = entry.value.toString();
                  await Clipboard.setData(ClipboardData(text: copyText));
                  ScaffoldMessenger.of(context).showSnackBar(
                    SnackBar(content: Text('Copied: $copyText')),
                  );
                },
              );
            }).toList(),
          );
        },
      ),
    );
  }
}
```

### 解説

1. **`package_info_plus`の導入**  
   - pubspec.yaml に次を追加  
     ```yaml
     dependencies:
       package_info_plus: ^1.4.2
     ```
   - 実際のバージョンは最新版を利用してください。
   - `import 'package:package_info_plus/package_info_plus.dart';` によって使用可能になります。

2. **アプリ情報の取得**  
   - `PackageInfo` クラスの `fromPlatform()` メソッドを使って、以下の項目を取得できます。
     - `appName` : アプリ名
     - `packageName` : アプリのパッケージ名 (iOSではBundle IDに相当)
     - `version` : アプリのバージョン
     - `buildNumber` : アプリのビルド番号

3. **デバイス情報 + アプリ情報の結合**  
   - `_getDeviceAndAppInfo()` メソッド内で、`device_info_plus` によるデバイス情報と `package_info_plus` によるアプリ情報を1つの `Map` としてまとめています。  
   - こうしておくと、1回の `FutureBuilder` でまとめて表示できます。

4. **クリップボードにコピー**  
   - `flutter/services.dart` の `Clipboard` を利用して、`Clipboard.setData(ClipboardData(text: 文字列))` でコピーが可能です。
   - コピーが完了したら `ScaffoldMessenger.of(context).showSnackBar(...)` でスナックバーを表示しています。 

このようにすることで、デバイス情報だけでなくアプリのビルド情報やバージョン、バンドルIDなどを簡単に確認でき、タップでクリップボードにもコピーできるようになります。

---
