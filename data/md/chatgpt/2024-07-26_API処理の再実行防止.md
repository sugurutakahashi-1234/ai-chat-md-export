# APIå‡¦ç†ã®å†å®Ÿè¡Œé˜²æ­¢

æ—¥ä»˜: 2024-07-26

---

## ğŸ‘¤ ãƒ¦ãƒ¼ã‚¶ãƒ¼
*2024/7/26 15:27:38*

SwiftUIã§Pushé·ç§»ã‹ã‚‰æˆ»ã£ã¦ããŸæ™‚ã«taskã§å®Ÿè¡Œã—ã¦ã„ã‚‹APIå–å¾—ã™ã‚‹å‡¦ç†ã‚’å®Ÿè¡Œã—ã¦ã»ã—ããªã„

---

## ğŸ¤– ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ
*2024/7/26 15:27:50*

SwiftUIã§ã€Pushé·ç§»ã‹ã‚‰æˆ»ã£ã¦ããŸæ™‚ã«`task`ã§å®Ÿè¡Œã—ã¦ã„ã‚‹APIå–å¾—å‡¦ç†ã‚’å†åº¦å®Ÿè¡Œã—ãªã„ã‚ˆã†ã«ã™ã‚‹ãŸã‚ã«ã¯ã€é·ç§»æ™‚ã®çŠ¶æ…‹ã‚’ç®¡ç†ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ä»¥ä¸‹ã®æ–¹æ³•ã§å®Ÿç¾ã§ãã¾ã™ã€‚

1. **é·ç§»çŠ¶æ…‹ã‚’ç®¡ç†ã™ã‚‹ãŸã‚ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’è¿½åŠ ã™ã‚‹**  
   `@State`ã¾ãŸã¯`@Environment`ã§é·ç§»çŠ¶æ…‹ã‚’ç®¡ç†ã—ã¾ã™ã€‚

2. **Viewã®è¡¨ç¤ºæ™‚ã«ã®ã¿APIå–å¾—å‡¦ç†ã‚’å®Ÿè¡Œã™ã‚‹**  
   `onAppear`ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨ã—ã¦ã€æœ€åˆã«ViewãŒè¡¨ç¤ºã•ã‚Œã‚‹éš›ã®ã¿APIå–å¾—å‡¦ç†ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚

ä»¥ä¸‹ã«å…·ä½“çš„ãªä¾‹ã‚’ç¤ºã—ã¾ã™ï¼š

```swift
import SwiftUI

struct ContentView: View {
    @State private var isFirstAppearance = true
    @State private var data: String = ""

    var body: some View {
        NavigationView {
            VStack {
                Text(data)
                NavigationLink("Detail", destination: DetailView())
            }
            .onAppear {
                if isFirstAppearance {
                    isFirstAppearance = false
                    fetchData()
                }
            }
        }
    }

    func fetchData() {
        // APIå–å¾—å‡¦ç†ã‚’ã“ã“ã«è¨˜è¿°
        data = "Fetched Data"
    }
}

struct DetailView: View {
    var body: some View {
        Text("Detail View")
    }
}

struct ContentView_Previews: PreviewProvider {
    static var previews: some View {
        ContentView()
    }
}
```

ã“ã®ã‚³ãƒ¼ãƒ‰ã§ã¯ã€`isFirstAppearance`ãƒ•ãƒ©ã‚°ã‚’ä½¿ç”¨ã—ã¦ã€`ContentView`ãŒåˆã‚ã¦è¡¨ç¤ºã•ã‚ŒãŸæ™‚ã«ã®ã¿APIå–å¾—å‡¦ç†ã‚’å®Ÿè¡Œã—ã€ãã‚Œä»¥é™ã¯å†åº¦å®Ÿè¡Œã—ãªã„ã‚ˆã†ã«ã—ã¦ã„ã¾ã™ã€‚

### ãƒã‚¤ãƒ³ãƒˆ
- **`@State`** ã§ `isFirstAppearance` ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’ç®¡ç†ã—ã€Viewã®æœ€åˆã®è¡¨ç¤ºæ™‚ã«ã®ã¿APIå–å¾—å‡¦ç†ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚
- **`onAppear`** ã‚’ä½¿ç”¨ã—ã¦ViewãŒè¡¨ç¤ºã•ã‚ŒãŸæ™‚ã®å‡¦ç†ã‚’è¨˜è¿°ã—ã¾ã™ã€‚

ã“ã‚Œã«ã‚ˆã‚Šã€Pushé·ç§»ã‹ã‚‰æˆ»ã£ã¦ããŸæ™‚ã«ä¸è¦ãªAPIå–å¾—å‡¦ç†ãŒå®Ÿè¡Œã•ã‚Œãªããªã‚Šã¾ã™ã€‚

---

## ğŸ‘¤ ãƒ¦ãƒ¼ã‚¶ãƒ¼
*2024/7/26 15:28:51*

å†èª­ã¿è¾¼ã¿ã™ã‚‹æˆ»ã‚Šæ–¹ã¨å†èª­ã¿è¾¼ã¿ã—ãªã„æˆ»ã‚Šæ–¹ã®ä¸¡æ–¹ã‚’å®Ÿç¾ã—ãŸã„

---

## ğŸ¤– ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ
*2024/7/26 15:29:12*

å†èª­ã¿è¾¼ã¿ã™ã‚‹æˆ»ã‚Šæ–¹ã¨å†èª­ã¿è¾¼ã¿ã—ãªã„æˆ»ã‚Šæ–¹ã®ä¸¡æ–¹ã‚’å®Ÿç¾ã™ã‚‹ã«ã¯ã€ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒªãƒ³ã‚¯ã‹ã‚‰æˆ»ã‚‹æ–¹æ³•ã«å¿œã˜ã¦APIå–å¾—å‡¦ç†ã‚’å®Ÿè¡Œã™ã‚‹ã‹ã©ã†ã‹ã‚’åˆ¶å¾¡ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã‚’å®Ÿç¾ã™ã‚‹ãŸã‚ã«ã¯ã€ä»¥ä¸‹ã®ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã‚’å–ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

1. **Boolå€¤ã‚’æ¸¡ã—ã¦åˆ¶å¾¡ã™ã‚‹**  
   å­Viewã‹ã‚‰è¦ªViewã«æˆ»ã‚‹éš›ã«Boolå€¤ã‚’æ¸¡ã—ã€å†èª­ã¿è¾¼ã¿ã™ã‚‹ã‹ã©ã†ã‹ã‚’åˆ¶å¾¡ã—ã¾ã™ã€‚

2. **ç’°å¢ƒã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½¿ç”¨ã™ã‚‹**  
   è¤‡æ•°ã®Viewé–“ã§çŠ¶æ…‹ã‚’å…±æœ‰ã™ã‚‹ãŸã‚ã«ã€`@EnvironmentObject`ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

ä»¥ä¸‹ã«ã€ä¸¡æ–¹ã®æ–¹æ³•ã‚’ç¤ºã—ã¾ã™ã€‚

### æ–¹æ³• 1: Boolå€¤ã‚’æ¸¡ã—ã¦åˆ¶å¾¡ã™ã‚‹
```swift
import SwiftUI

struct ContentView: View {
    @State private var isFirstAppearance = true
    @State private var data: String = ""
    @State private var shouldReload = false

    var body: some View {
        NavigationView {
            VStack {
                Text(data)
                NavigationLink(destination: DetailView(shouldReload: $shouldReload)) {
                    Text("Detail")
                }
            }
            .onAppear {
                if isFirstAppearance || shouldReload {
                    isFirstAppearance = false
                    shouldReload = false
                    fetchData()
                }
            }
        }
    }

    func fetchData() {
        // APIå–å¾—å‡¦ç†ã‚’ã“ã“ã«è¨˜è¿°
        data = "Fetched Data at \(Date())"
    }
}

struct DetailView: View {
    @Binding var shouldReload: Bool

    var body: some View {
        VStack {
            Text("Detail View")
            Button("Go Back without Reloading") {
                shouldReload = false
                // ã“ã“ã§Navigationãƒªãƒ³ã‚¯ã‚’è§£é™¤ã™ã‚‹ãŸã‚ã®ã‚³ãƒ¼ãƒ‰ã‚’è¿½åŠ 
            }
            Button("Go Back with Reloading") {
                shouldReload = true
                // ã“ã“ã§Navigationãƒªãƒ³ã‚¯ã‚’è§£é™¤ã™ã‚‹ãŸã‚ã®ã‚³ãƒ¼ãƒ‰ã‚’è¿½åŠ 
            }
        }
    }
}

struct ContentView_Previews: PreviewProvider {
    static var previews: some View {
        ContentView()
    }
}
```

### æ–¹æ³• 2: ç’°å¢ƒã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½¿ç”¨ã™ã‚‹
```swift
import SwiftUI

class ReloadState: ObservableObject {
    @Published var shouldReload: Bool = false
}

struct ContentView: View {
    @State private var isFirstAppearance = true
    @State private var data: String = ""
    @StateObject private var reloadState = ReloadState()

    var body: some View {
        NavigationView {
            VStack {
                Text(data)
                NavigationLink(destination: DetailView().environmentObject(reloadState)) {
                    Text("Detail")
                }
            }
            .onAppear {
                if isFirstAppearance || reloadState.shouldReload {
                    isFirstAppearance = false
                    reloadState.shouldReload = false
                    fetchData()
                }
            }
        }
    }

    func fetchData() {
        // APIå–å¾—å‡¦ç†ã‚’ã“ã“ã«è¨˜è¿°
        data = "Fetched Data at \(Date())"
    }
}

struct DetailView: View {
    @EnvironmentObject var reloadState: ReloadState

    var body: some View {
        VStack {
            Text("Detail View")
            Button("Go Back without Reloading") {
                reloadState.shouldReload = false
                // ã“ã“ã§Navigationãƒªãƒ³ã‚¯ã‚’è§£é™¤ã™ã‚‹ãŸã‚ã®ã‚³ãƒ¼ãƒ‰ã‚’è¿½åŠ 
            }
            Button("Go Back with Reloading") {
                reloadState.shouldReload = true
                // ã“ã“ã§Navigationãƒªãƒ³ã‚¯ã‚’è§£é™¤ã™ã‚‹ãŸã‚ã®ã‚³ãƒ¼ãƒ‰ã‚’è¿½åŠ 
            }
        }
    }
}

struct ContentView_Previews: PreviewProvider {
    static var previews: some View {
        ContentView()
    }
}
```

ã©ã¡ã‚‰ã®æ–¹æ³•ã§ã‚‚ã€å­Viewã‹ã‚‰è¦ªViewã«æˆ»ã‚‹éš›ã«å†èª­ã¿è¾¼ã¿ã®æœ‰ç„¡ã‚’åˆ¶å¾¡ã§ãã¾ã™ã€‚ä½¿ç”¨ã™ã‚‹æ–¹æ³•ã¯ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®æ§‹é€ ã‚„çŠ¶æ…‹ç®¡ç†ã®å¥½ã¿ã«ã‚ˆã‚Šã¾ã™ã€‚

---
