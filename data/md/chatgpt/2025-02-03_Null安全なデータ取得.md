# Null安全なデータ取得

日付: 2025-02-03

---

## 👤 ユーザー
*2025/2/3 19:55:50*

fisrtがない場合にエラーになりたくない

    return ListView.builder(
      itemCount: filteredGuildMemberList.length,
      itemBuilder: (context, index) {
        final guildMember = filteredGuildMemberList\[index\];
        final userName = guildMember.username ?? '';
        final userPhotoUrl = guildMember.avatar;
        final searchQ = guildMember.decks?.first.searchQ ?? 0;
        final attackE = guildMember.decks?.first.attackE ?? 0;
        final luckL = guildMember.decks?.first.luckL ?? 0;
        final defenseB = guildMember.decks?.first.defenseB ?? 0;
        final cameraList = guildMember.decks?.first.deckCameras?.sorted() ?? \[\];

---

## 🤖 アシスタント
*2025/2/3 19:56:13*

`first`がない場合（つまり、`guildMember.decks`が `null` または空のリストの場合）にエラーにならないようにするには、`firstOrNull` を使うか、`?.isNotEmpty == true` で確認してから `first` を使う方法があります。

### 修正案
```dart
return ListView.builder(
  itemCount: filteredGuildMemberList.length,
  itemBuilder: (context, index) {
    final guildMember = filteredGuildMemberList[index];
    final userName = guildMember.username ?? '';
    final userPhotoUrl = guildMember.avatar;
    final deck = guildMember.decks?.isNotEmpty == true ? guildMember.decks!.first : null;

    final searchQ = deck?.searchQ ?? 0;
    final attackE = deck?.attackE ?? 0;
    final luckL = deck?.luckL ?? 0;
    final defenseB = deck?.defenseB ?? 0;
    final cameraList = deck?.deckCameras?.sorted() ?? [];

    return YourListItemWidget(
      userName: userName,
      userPhotoUrl: userPhotoUrl,
      searchQ: searchQ,
      attackE: attackE,
      luckL: luckL,
      defenseB: defenseB,
      cameraList: cameraList,
    );
  },
);
```

### 修正ポイント
1. `guildMember.decks?.isNotEmpty == true` を使って、リストが空でないかをチェック。
2. 空でない場合のみ `first` を取得し、それ以外は `null` を代入。
3. `deck` が `null` だった場合でも `?.` を使って安全にアクセス。

これで `first` がない場合でもエラーにならず、デフォルト値（`0` や `[]`）がセットされるようになります。

---
