# Makefile で引数を設定

日付: 2024-02-26

---

## 👤 ユーザー
*2024/2/27 1:50:54*

Makefile で 引数を設定したい。

PACKAGE\_NAME := DISampleAppPackage
MOCKOLO\_SCAN\_PATH := ./$(PACKAGE\_NAME)/Sources/Domain
MOCKOLO\_OUTPUT\_PATH := ./$(PACKAGE\_NAME)/Sources/Presentation/TestTool/DomainLayerMocks.swift

.PHONY: help
help:
	@awk 'BEGIN {FS = ":"} /^\[a-zA-Z0-9\_-\]+:/ {if ($$2 == "") print "make " $$1}' Makefile

.PHONY: mockolo-run
mockolo-run:
	swift run --package-path $(PACKAGE\_NAME) mockolo -s $(MOCKOLO\_SCAN\_PATH) -d $(MOCKOLO\_OUTPUT\_PATH) --custom-imports DomainLayer -x Images Strings --mock-final

.PHONY: presentation-code-gen
presentation-code-gen:
	./Sourcery/Script/presentation\_code\_gen.sh


このとき

make presentation-code-gen Hoge    

としたい。

---

## 🤖 アシスタント
*2024/2/27 1:51:41*

`make` コマンドで引数を設定するには、`make` の実行時に変数を指定することで行えます。ただし、`make` コマンド自体が直接コマンドライン引数をスクリプトやコマンドに渡す機能は持っていません。代わりに、変数を使って間接的に値を渡すことができます。

例えば、`presentation-code-gen` ターゲットに引数を渡したい場合、`Makefile` を以下のように変更することで、コマンドラインから変数を設定してその値をスクリプトに渡すことができます。

```makefile
PACKAGE_NAME := DISampleAppPackage
MOCKOLO_SCAN_PATH := ./$(PACKAGE_NAME)/Sources/Domain
MOCKOLO_OUTPUT_PATH := ./$(PACKAGE_NAME)/Sources/Presentation/TestTool/DomainLayerMocks.swift

.PHONY: help
help:
	@awk 'BEGIN {FS = ":"} /^[a-zA-Z0-9_-]+:/ {if ($$2 == "") print "make " $$1}' Makefile

.PHONY: mockolo-run
mockolo-run:
	swift run --package-path $(PACKAGE_NAME) mockolo -s $(MOCKOLO_SCAN_PATH) -d $(MOCKOLO_OUTPUT_PATH) --custom-imports DomainLayer -x Images Strings --mock-final

.PHONY: presentation-code-gen
presentation-code-gen:
	./Sourcery/Script/presentation_code_gen.sh $(ARG)

```

この変更により、`make presentation-code-gen ARG=Hoge` のようにして `presentation_code_gen.sh` スクリプトに `Hoge` という引数を渡すことができます。`$(ARG)` は `Makefile` 内で定義された `ARG` 変数を参照しており、この変数は `make` コマンド実行時にコマンドラインから設定することができます。

コマンドを実行する際には、次のようにします：

```bash
make presentation-code-gen ARG=Hoge
```

これにより、`ARG` 変数に設定された値が `presentation_code_gen.sh` スクリプトに渡されます。スクリプト側ではこの引数を適切に処理する必要があります。スクリプトが引数を受け取るようになっていない場合は、スクリプトを引数を受け取れるように修正する必要があります。

---

## 👤 ユーザー
*2024/2/27 2:01:01*

makeコマンドって引数を設定できないの？

---

## 🤖 アシスタント
*2024/2/27 2:02:09*

`make` コマンド自体は、UnixやLinuxのビルド自動化ツールとして設計されており、主に`Makefile`内で定義されたターゲット（ルール）を実行するために使用されます。これらのターゲットは、ファイル生成やコマンド実行などのアクションを自動化するために設定されます。`make` コマンドは、コマンドライン引数としてターゲット名を受け取り、そのターゲットに関連付けられたコマンドを実行します。

しかし、`make` コマンドがコマンドライン引数を直接スクリプトやコマンドに渡す機能は本来持っていません。代わりに、`make` コマンドを実行する際に変数を設定し、これらの変数を`Makefile`内で参照することで、間接的にスクリプトやコマンドに"引数"を渡すことができます。

### 例

```bash
make some-target VAR=value
```

このコマンドは、`Makefile`内で`some-target`ターゲットを実行する際に、`VAR`変数に`value`を設定します。`Makefile`内でこの変数を参照することで、その値をスクリプトやコマンドに渡すことが可能です。

### `Makefile`内での変数使用例

```makefile
some-target:
    @echo $(VAR)
```

この例では、`some-target`ターゲットが実行されると、設定された`VAR`変数の値が出力されます。

### 結論

`make` コマンドで直接的にコマンドライン引数をスクリプトやコマンドに渡すことはできませんが、変数を介して間接的に値を渡すことは可能です。これにより、`make` コマンドを非常に柔軟に使用することができ、様々な自動化タスクに対応することが可能になります。

---
