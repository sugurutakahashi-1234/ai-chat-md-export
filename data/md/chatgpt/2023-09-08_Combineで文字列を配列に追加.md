# Combineã§æ–‡å­—åˆ—ã‚’é…åˆ—ã«è¿½åŠ 

Date: 2023-09-08

---

## ğŸ‘¤ User
*2023-09-08 20:53:31*

Swift ã® Combine ã§æµã‚Œã¦ãã‚‹æ–‡å­—åˆ—ã®ã‚¹ãƒˆãƒªãƒ¼ãƒ ã‚’åˆ¥ã®æ–‡å­—åˆ—ã®é…åˆ—ã«ã©ã‚“ã©ã‚“è¿½åŠ ã—ã¦ã„ãå‡¦ç†ã‚’æ›¸ããŸã„

---

## ğŸ¤– Assistant
*2023-09-08 20:54:17*

Combine ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã‚’ä½¿ç”¨ã—ã¦ã€æµã‚Œã¦ãã‚‹æ–‡å­—åˆ—ã®ã‚¹ãƒˆãƒªãƒ¼ãƒ ã‚’åˆ¥ã®æ–‡å­—åˆ—ã®é…åˆ—ã«è¿½åŠ ã™ã‚‹å‡¦ç†ã‚’è¡Œã„ãŸã„å ´åˆã€ä»¥ä¸‹ã®ã‚¹ãƒ†ãƒƒãƒ—ã«å¾“ã£ã¦ãã ã•ã„ã€‚

1. å¿…è¦ãª Combine ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¾ã™ã€‚
2. PassthroughSubject ã‚’ä½¿ç”¨ã—ã¦ã€æ–°ãŸãªæ–‡å­—åˆ—ã®ã‚¹ãƒˆãƒªãƒ¼ãƒ ã‚’è¡¨ã™ã‚µãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã—ã¾ã™ã€‚
3. scan æ¼”ç®—å­ã‚’ä½¿ç”¨ã—ã¦ã€ã‚µãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‹ã‚‰æµã‚Œã¦ãã‚‹æ–‡å­—åˆ—ã‚’é…åˆ—ã«è¿½åŠ ã—ã¾ã™ã€‚

ä»¥ä¸‹ã¯ãã®ä¾‹ã§ã™:

```swift
import Combine

// 1. æ–‡å­—åˆ—ã®ã‚¹ãƒˆãƒªãƒ¼ãƒ ã‚’å—ã‘å–ã‚‹ã‚µãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆ
let subject = PassthroughSubject<String, Never>()

// é…åˆ—ã‚’ç®¡ç†ã™ã‚‹ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’ä½œæˆ (ã“ã®ä¾‹ã§ã¯ã€åˆæœŸçŠ¶æ…‹ã¨ã—ã¦ç©ºã®é…åˆ—ã‚’è¨­å®š)
var stringsArray: [String] = []

// 2. `scan` æ¼”ç®—å­ã‚’ä½¿ç”¨ã—ã¦ã€æ–°ã—ã„æ–‡å­—åˆ—ã‚’é…åˆ—ã«è¿½åŠ 
let cancellable = subject
    .scan([], { (accumulatedStrings, newValue) -> [String] in
        return accumulatedStrings + [newValue]
    })
    .sink(receiveValue: { updatedArray in
        stringsArray = updatedArray
        print(stringsArray)
    })

// ãƒ†ã‚¹ãƒˆ
subject.send("Hello")
subject.send("World")
subject.send("Combine")

// å‡ºåŠ›:
// ["Hello"]
// ["Hello", "World"]
// ["Hello", "World", "Combine"]

cancellable.cancel()  // å¾Œå‡¦ç†ã¨ã—ã¦ã€cancellable ã‚’ã‚­ãƒ£ãƒ³ã‚»ãƒ«
```

ã“ã®ã‚³ãƒ¼ãƒ‰ã¯ã€æ–°ã—ã„æ–‡å­—åˆ—ãŒ `subject` ã«é€ä¿¡ã•ã‚Œã‚‹ãŸã³ã«ã€ãã®æ–‡å­—åˆ—ã‚’ `stringsArray` ã«è¿½åŠ ã—ã¦ã„ã¾ã™ã€‚

---

## ğŸ‘¤ User
*2023-09-08 20:54:34*

.append ã¨ã‹ãªã‹ã£ãŸã£ã‘ï¼Ÿ

---

## ğŸ¤– Assistant
*2023-09-08 20:55:12*

ã¯ã„ã€ãã®é€šã‚Šã§ã™ã€‚Swift ã®é…åˆ—ã«ã¯ `.append(_:)` ãƒ¡ã‚½ãƒƒãƒ‰ãŒã‚ã‚Šã€ã“ã‚Œã‚’ä½¿ã£ã¦é…åˆ—ã«æ–°ã—ã„è¦ç´ ã‚’è¿½åŠ ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚å‰è¿°ã®ã‚³ãƒ¼ãƒ‰ã«ãŠã‘ã‚‹ `scan` æ¼”ç®—å­ã®ä¸­ã§ã“ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨ã—ã¦ã‚‚åŒã˜çµæœãŒå¾—ã‚‰ã‚Œã¾ã™ã€‚

ä»¥ä¸‹ã¯ `.append(_:)` ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨ã—ãŸä¾‹ã§ã™:

```swift
import Combine

let subject = PassthroughSubject<String, Never>()

var stringsArray: [String] = []

let cancellable = subject
    .scan([], { (accumulatedStrings, newValue) -> [String] in
        var newAccumulatedStrings = accumulatedStrings
        newAccumulatedStrings.append(newValue)
        return newAccumulatedStrings
    })
    .sink(receiveValue: { updatedArray in
        stringsArray = updatedArray
        print(stringsArray)
    })

// ãƒ†ã‚¹ãƒˆ
subject.send("Hello")
subject.send("World")
subject.send("Combine")

// å‡ºåŠ›:
// ["Hello"]
// ["Hello", "World"]
// ["Hello", "World", "Combine"]

cancellable.cancel()
```

ã“ã®ã‚³ãƒ¼ãƒ‰ã‚‚ã€æ–°ã—ã„æ–‡å­—åˆ—ãŒ `subject` ã«é€ä¿¡ã•ã‚Œã‚‹ãŸã³ã«ã€ãã®æ–‡å­—åˆ—ã‚’ `stringsArray` ã«è¿½åŠ ã—ã¦ã„ã¾ã™ã€‚ãŸã ã—ã€æ–°ã—ã„é…åˆ—ã‚’ä½œæˆã™ã‚‹ä»£ã‚ã‚Šã«ã€æ—¢å­˜ã®é…åˆ—ã« `.append(_:)` ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨ã—ã¦æ–°ã—ã„æ–‡å­—åˆ—ã‚’è¿½åŠ ã—ã¦ã„ã¾ã™ã€‚

---
