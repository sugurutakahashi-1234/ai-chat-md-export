# Makefile 1ã‚³ãƒãƒ³ãƒ‰

æ—¥ä»˜: 2024-02-27

---

## ğŸ‘¤ ãƒ¦ãƒ¼ã‚¶ãƒ¼
*2024/2/27 17:32:33*

mockolo-run ã¨presentation-code-genã‚’ã²ã¨ã¤ã®makeã‚³ãƒãƒ³ãƒ‰ã§å®Ÿè¡Œã—ãŸã„ã€‚ã©ã†ã™ã‚Œã°ã„ã„ã‹



PACKAGE_NAME := ./DISampleAppPackage
MOCKOLO_SCAN_PATH := ./$(PACKAGE_NAME)/Sources
MOCKOLO_OUTPUT_PATH := ./$(PACKAGE_NAME)/Sources/Presentation/TestTool/Mocks.swift

.PHONY: help
help:
	@awk 'BEGIN {FS = ":"} /^[a-zA-Z0-9_-]+:/ {if ($$2 == "") print "make " $$1}' Makefile

.PHONY: mint-bootstrap
mint-bootstrap:
	swift run --package-path $(PACKAGE_NAME) mint bootstrap

.PHONY: mockolo-run
mockolo-run:
	swift run --package-path $(PACKAGE_NAME) mint run mockolo -s $(MOCKOLO_SCAN_PATH) -d $(MOCKOLO_OUTPUT_PATH) --custom-imports DomainLayer -x Images Strings --mock-final

.PHONY: presentation-code-gen
presentation-code-gen:
	./Sourcery/Script/presentation_code_gen.sh $(ARG)

.PHONY: setup
setup:
	$(MAKE) mint-bootstrap
	$(MAKE) open

---

## ğŸ¤– ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ
*2024/2/27 17:33:20*

Makefileã‚’ä½¿ç”¨ã—ã¦ã€`mockolo-run` ã¨ `presentation-code-gen` ã‚’ä¸€ã¤ã®ã‚³ãƒãƒ³ãƒ‰ã§å®Ÿè¡Œã™ã‚‹ã«ã¯ã€æ–°ã—ã„ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚’Makefileã«è¿½åŠ ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã“ã®æ–°ã—ã„ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã¯ã€ã“ã‚Œã‚‰äºŒã¤ã®ã‚³ãƒãƒ³ãƒ‰ã‚’é †ç•ªã«å®Ÿè¡Œã—ã¾ã™ã€‚ä»¥ä¸‹ã®æ‰‹é †ã«å¾“ã£ã¦ã€Makefileã«å¤‰æ›´ã‚’åŠ ãˆã¦ãã ã•ã„ã€‚

1. **æ–°ã—ã„ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã®è¿½åŠ **:
   Makefileã®æœ€å¾Œã«ã€`mockolo-and-presentation` ã¨ã„ã†åå‰ã®æ–°ã—ã„ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚’è¿½åŠ ã—ã¾ã™ã€‚ã“ã®ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã¯ã€`mockolo-run` ã¨ `presentation-code-gen` ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚’ä¾å­˜é–¢ä¿‚ã¨ã—ã¦æŒ‡å®šã—ã€ã“ã‚Œã‚‰ãŒé †ç•ªã«å®Ÿè¡Œã•ã‚Œã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚

2. **ARGå¤‰æ•°ã®ä½¿ç”¨**:
   `presentation-code-gen` ã‚¿ãƒ¼ã‚²ãƒƒãƒˆãŒ `$(ARG)` ã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹ã“ã¨ã«æ³¨æ„ã—ã¦ãã ã•ã„ã€‚ã“ã®å¤‰æ•°ã‚’ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã‹ã‚‰æ¸¡ã™å ´åˆã€`make` ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹éš›ã«å¼•æ•°ã¨ã—ã¦æŒ‡å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ä¾‹: `make presentation-code-gen ARG=value`

ä»¥ä¸‹ã¯ã€ä¸Šè¨˜ã®å¤‰æ›´ã‚’å«ã‚€æ›´æ–°ã•ã‚ŒãŸMakefileã®ä¾‹ã§ã™:

```makefile
PACKAGE_NAME := ./DISampleAppPackage
MOCKOLO_SCAN_PATH := ./$(PACKAGE_NAME)/Sources
MOCKOLO_OUTPUT_PATH := ./$(PACKAGE_NAME)/Sources/Presentation/TestTool/Mocks.swift

.PHONY: help
help:
	@awk 'BEGIN {FS = ":"} /^[a-zA-Z0-9_-]+:/ {if ($$2 == "") print "make " $$1}' Makefile

.PHONY: mint-bootstrap
mint-bootstrap:
	swift run --package-path $(PACKAGE_NAME) mint bootstrap

.PHONY: mockolo-run
mockolo-run:
	swift run --package-path $(PACKAGE_NAME) mint run mockolo -s $(MOCKOLO_SCAN_PATH) -d $(MOCKOLO_OUTPUT_PATH) --custom-imports DomainLayer -x Images Strings --mock-final

.PHONY: presentation-code-gen
presentation-code-gen:
	./Sourcery/Script/presentation_code_gen.sh $(ARG)

.PHONY: setup
setup:
	$(MAKE) mint-bootstrap
	$(MAKE) open

# æ–°ã—ã„ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚’è¿½åŠ 
.PHONY: all-code-gen
all-code-gen: mockolo-run presentation-code-gen
```

ã“ã®å¤‰æ›´å¾Œã€ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¦ã€`mockolo-run` ã¨ `presentation-code-gen` ã‚’ä¸€ã¤ã®æ“ä½œã§å®Ÿè¡Œã§ãã¾ã™ã€‚`presentation-code-gen` ã«å¿…è¦ãªå¼•æ•°ãŒã‚ã‚‹å ´åˆã¯ã€`ARG=value` ã‚’é©åˆ‡ã«ç½®ãæ›ãˆã¦ãã ã•ã„ã€‚

```bash
make all-code-gen ARG=value
```

ã“ã®æ–¹æ³•ã§ã€Makefileã‚’ä½¿ç”¨ã—ã¦è¤‡æ•°ã®ã‚¿ã‚¹ã‚¯ã‚’ç°¡å˜ã«å®Ÿè¡Œã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

---
