# Makefile 1コマンド

日付: 2024-02-27

---

## 👤 ユーザー
*2024/2/27 17:32:33*

mockolo-run とpresentation-code-genをひとつのmakeコマンドで実行したい。どうすればいいか



PACKAGE_NAME := ./DISampleAppPackage
MOCKOLO_SCAN_PATH := ./$(PACKAGE_NAME)/Sources
MOCKOLO_OUTPUT_PATH := ./$(PACKAGE_NAME)/Sources/Presentation/TestTool/Mocks.swift

.PHONY: help
help:
	@awk 'BEGIN {FS = ":"} /^[a-zA-Z0-9_-]+:/ {if ($$2 == "") print "make " $$1}' Makefile

.PHONY: mint-bootstrap
mint-bootstrap:
	swift run --package-path $(PACKAGE_NAME) mint bootstrap

.PHONY: mockolo-run
mockolo-run:
	swift run --package-path $(PACKAGE_NAME) mint run mockolo -s $(MOCKOLO_SCAN_PATH) -d $(MOCKOLO_OUTPUT_PATH) --custom-imports DomainLayer -x Images Strings --mock-final

.PHONY: presentation-code-gen
presentation-code-gen:
	./Sourcery/Script/presentation_code_gen.sh $(ARG)

.PHONY: setup
setup:
	$(MAKE) mint-bootstrap
	$(MAKE) open

---

## 🤖 アシスタント
*2024/2/27 17:33:20*

Makefileを使用して、`mockolo-run` と `presentation-code-gen` を一つのコマンドで実行するには、新しいターゲットをMakefileに追加する必要があります。この新しいターゲットは、これら二つのコマンドを順番に実行します。以下の手順に従って、Makefileに変更を加えてください。

1. **新しいターゲットの追加**:
   Makefileの最後に、`mockolo-and-presentation` という名前の新しいターゲットを追加します。このターゲットは、`mockolo-run` と `presentation-code-gen` ターゲットを依存関係として指定し、これらが順番に実行されるようにします。

2. **ARG変数の使用**:
   `presentation-code-gen` ターゲットが `$(ARG)` を使用していることに注意してください。この変数をコマンドラインから渡す場合、`make` コマンドを実行する際に引数として指定する必要があります。例: `make presentation-code-gen ARG=value`

以下は、上記の変更を含む更新されたMakefileの例です:

```makefile
PACKAGE_NAME := ./DISampleAppPackage
MOCKOLO_SCAN_PATH := ./$(PACKAGE_NAME)/Sources
MOCKOLO_OUTPUT_PATH := ./$(PACKAGE_NAME)/Sources/Presentation/TestTool/Mocks.swift

.PHONY: help
help:
	@awk 'BEGIN {FS = ":"} /^[a-zA-Z0-9_-]+:/ {if ($$2 == "") print "make " $$1}' Makefile

.PHONY: mint-bootstrap
mint-bootstrap:
	swift run --package-path $(PACKAGE_NAME) mint bootstrap

.PHONY: mockolo-run
mockolo-run:
	swift run --package-path $(PACKAGE_NAME) mint run mockolo -s $(MOCKOLO_SCAN_PATH) -d $(MOCKOLO_OUTPUT_PATH) --custom-imports DomainLayer -x Images Strings --mock-final

.PHONY: presentation-code-gen
presentation-code-gen:
	./Sourcery/Script/presentation_code_gen.sh $(ARG)

.PHONY: setup
setup:
	$(MAKE) mint-bootstrap
	$(MAKE) open

# 新しいターゲットを追加
.PHONY: all-code-gen
all-code-gen: mockolo-run presentation-code-gen
```

この変更後、以下のコマンドを使用して、`mockolo-run` と `presentation-code-gen` を一つの操作で実行できます。`presentation-code-gen` に必要な引数がある場合は、`ARG=value` を適切に置き換えてください。

```bash
make all-code-gen ARG=value
```

この方法で、Makefileを使用して複数のタスクを簡単に実行できるようになります。

---
