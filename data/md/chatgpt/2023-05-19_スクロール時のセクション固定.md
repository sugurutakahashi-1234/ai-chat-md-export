# スクロール時のセクション固定

日付: 2023-05-19

---

## 👤 ユーザー
*2023/05/19 21:59:27*

SwiftUI のコードでスクロールした際にセクションを固定する方法を教えて欲しい

---

## 🤖 アシスタント
*2023/05/19 22:00:36*

現在のところ（2023年5月現在）、SwiftUIはUITableViewのようなセクションヘッダーの固定機能を直接サポートしていません。しかし、SwiftUIの親ビューとしてUIKitを使用して、この機能を追加することができます。以下にその一例を示します。

まず、UIKitの`UITableView`をSwiftUIで使用できるようにラップする必要があります。これには`UIViewRepresentable`プロトコルを使用します。

以下にその例を示します。

```swift
import SwiftUI
import UIKit

struct UITableViewWrapper: UIViewRepresentable {
    typealias UIViewType = UITableView

    let sections: [Section]

    func makeUIView(context: Context) -> UITableView {
        let tableView = UITableView(frame: .zero, style: .grouped)
        tableView.dataSource = context.coordinator
        tableView.delegate = context.coordinator
        tableView.register(UITableViewCell.self, forCellReuseIdentifier: "cell")
        return tableView
    }

    func updateUIView(_ uiView: UITableView, context: Context) {
        
    }

    func makeCoordinator() -> Coordinator {
        return Coordinator(self)
    }

    class Coordinator: NSObject, UITableViewDataSource, UITableViewDelegate {
        var parent: UITableViewWrapper

        init(_ parent: UITableViewWrapper) {
            self.parent = parent
        }

        func numberOfSections(in tableView: UITableView) -> Int {
            return parent.sections.count
        }

        func tableView(_ tableView: UITableView, numberOfRowsInSection section: Int) -> Int {
            return parent.sections[section].rows.count
        }

        func tableView(_ tableView: UITableView, cellForRowAt indexPath: IndexPath) -> UITableViewCell {
            let cell = tableView.dequeueReusableCell(withIdentifier: "cell", for: indexPath)
            cell.textLabel?.text = parent.sections[indexPath.section].rows[indexPath.row]
            return cell
        }

        func tableView(_ tableView: UITableView, titleForHeaderInSection section: Int) -> String? {
            return parent.sections[section].header
        }
    }
}

struct Section {
    let header: String
    let rows: [String]
}

struct ContentView: View {
    var body: some View {
        UITableViewWrapper(sections: [
            Section(header: "Section 1", rows: ["Row 1", "Row 2", "Row 3"]),
            Section(header: "Section 2", rows: ["Row 1", "Row 2", "Row 3"]),
            // Add more sections as needed
        ])
    }
}
```

上記のコードはSwiftUIのView内でUITableViewをラップし、複数のセクションとそれぞれのセクションに含まれる行を表示します。スクロールすると、セクションヘッダーは画面の上部に固定されます。

ただし、このような方法はネイティブのSwiftUIビューとは見た目が異なり、またSwiftUIとUIKitを混在させるため、予期せぬ問題が生じる可能性があります。そのため、Appleが将来的にこの機能をSwiftUIにネイティブで実装することを期待するのが最善です。

---
