# MapPage ãƒœã‚¿ãƒ³è¨­å®š

Date: 2024-12-10

---

## ðŸ‘¤ User
*2024-12-10 21:28:11*

{
  "content_type": "image_asset_pointer",
  "asset_pointer": "file-service://file-GTJkCbpwbiF6rTcrVWJKoy",
  "size_bytes": 384171,
  "width": 563,
  "height": 1036,
  "fovea": null,
  "metadata": {
    "dalle": null,
    "gizmo": null,
    "generation": null,
    "container_pixel_height": null,
    "container_pixel_width": null,
    "emu_omit_glimpse_image": null,
    "emu_patches_override": null,
    "sanitized": true,
    "asset_pointer_link": null,
    "watermarked_asset_pointer": null
  }
}
MapPage ã®ã‚¿ãƒ–ã§ãƒœãƒˆãƒ ã«3ã¤ã®ç¾åœ¨åœ°ã®ãƒœã‚¿ãƒ³ã¨Exploreã®ãƒœã‚¿ãƒ³ã¨å†™çœŸã®ã‚¢ã‚¤ã‚³ãƒ³ã®ãƒœã‚¿ãƒ³ã‚’è¨­å®šã—ã¦ã»ã—ã„ã€‚ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ãŸæ™‚ã®å‡¦ç†ã¯ã‹ã‚‰ã«ã—ã¦ã»ã—ã„

import 'package:flutter/material.dart';
import 'package:hooks_riverpod/hooks_riverpod.dart';

class MapPage extends HookConsumerWidget {
  const MapPage({super.key});

  @override
  Widget build(BuildContext context, WidgetRef ref) {
    return const Center(child: Text('Map'));
  }
}

import 'package:flutter/material.dart';
import 'package:go_router/go_router.dart';
import 'package:snpit_guild_app/domain/screen.dart';

class TabPage extends StatelessWidget {
  const TabPage({required this.navigationShell, super.key});
  final StatefulNavigationShell navigationShell;

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        leadingWidth: 100,
        leading: Row(
          mainAxisSize: MainAxisSize.min,
          children: [
            IconButton(
              icon: const Icon(Icons.person),
              onPressed: () {
                context.push(Screen.myPage.path);
              },
            ),
            IconButton(
              icon: const Icon(Icons.notifications),
              onPressed: () {
                context.push(Screen.notificationList.path);
              },
            ),
          ],
        ),
        actions: [
          Padding(
            padding: const EdgeInsets.only(right: 16),
            child: InkWell(
              onTap: () {
                context.push(Screen.wallet.path);
              },
              child: const Row(
                children: [
                  Icon(Icons.token, size: 20),
                  SizedBox(width: 4),
                  Text('35.05 STP'), // TODO: ä»®ãƒ‡ãƒ¼ã‚¿
                ],
              ),
            ),
          ),
        ],
      ),
      body: navigationShell,
      bottomNavigationBar: BottomNavigationBar(
        currentIndex: navigationShell.currentIndex,
        onTap: navigationShell.goBranch,
        items: const [
          BottomNavigationBarItem(icon: Icon(Icons.map), label: 'Map'),
          BottomNavigationBarItem(icon: Icon(Icons.group), label: 'Guild'),
        ],
      ),
    );
  }
}
ChatGPT:
ChatGPT

---

## ðŸ¤– Assistant
*2024-12-10 21:28:28*

Here's an updated `MapPage` implementation with the bottom buttons (current location, Explore, and photo icon) added. The button actions are set to empty for now as per your request:

```dart
import 'package:flutter/material.dart';
import 'package:hooks_riverpod/hooks_riverpod.dart';

class MapPage extends HookConsumerWidget {
  const MapPage({super.key});

  @override
  Widget build(BuildContext context, WidgetRef ref) {
    return Scaffold(
      body: Stack(
        children: [
          const Center(child: Text('Map')), // Replace this with your map widget
          Positioned(
            bottom: 16,
            left: 16,
            right: 16,
            child: Row(
              mainAxisAlignment: MainAxisAlignment.spaceBetween,
              children: [
                // Current Location Button
                FloatingActionButton(
                  onPressed: () {}, // Empty for now
                  child: const Icon(Icons.my_location),
                ),
                // Explore Button
                ElevatedButton(
                  onPressed: () {}, // Empty for now
                  style: ElevatedButton.styleFrom(
                    shape: RoundedRectangleBorder(
                      borderRadius: BorderRadius.circular(16),
                    ),
                    padding: const EdgeInsets.symmetric(
                        horizontal: 24, vertical: 12),
                  ),
                  child: Row(
                    children: const [
                      Icon(Icons.explore),
                      SizedBox(width: 8),
                      Text('Explore'),
                    ],
                  ),
                ),
                // Photo Icon Button
                FloatingActionButton(
                  onPressed: () {}, // Empty for now
                  child: const Icon(Icons.photo),
                ),
              ],
            ),
          ),
        ],
      ),
    );
  }
}
```

### Key Features:
1. **Floating Buttons**:
   - Left: "Current Location" button with a `my_location` icon.
   - Right: "Photo" button with a `photo` icon.
2. **Explore Button**:
   - Positioned in the center with an `explore` icon and text.

You can customize the `onPressed` actions later when the required functionality is ready. Let me know if you need further refinements!

---

## ðŸ‘¤ User
*2024-12-10 21:31:18*

ä¾‹å¤–ãŒç™ºç”Ÿã—ã¾ã—ãŸ
FlutterError (There are multiple heroes that share the same tag within a subtree.
Within each subtree for which heroes are to be animated (i.e. a PageRoute subtree), each Hero must have a unique non-null tag.
In this case, multiple heroes had the following tag: &lt;default FloatingActionButton tag&gt;
# Here is the subtree for one of the offending heroes: Hero)
import 'package:flutter/material.dart';
import 'package:hooks_riverpod/hooks_riverpod.dart';

class MapPage extends HookConsumerWidget {
  const MapPage({super.key});

  @override
  Widget build(BuildContext context, WidgetRef ref) {
    return Scaffold(
      body: Stack(
        children: [
          const Center(child: Text('Map')),
          Positioned(
            bottom: 16,
            left: 16,
            right: 16,
            child: Row(
              mainAxisAlignment: MainAxisAlignment.spaceBetween,
              children: [
                FloatingActionButton(
                  onPressed: () {
                    debugPrint('TODO: My Location');
                  },
                  child: const Icon(Icons.my_location),
                ),
                ElevatedButton(
                  onPressed: () {
                    debugPrint('TODO: Explore');
                  },
                  style: ElevatedButton.styleFrom(
                    shape: RoundedRectangleBorder(
                      borderRadius: BorderRadius.circular(16),
                    ),
                    padding: const EdgeInsets.symmetric(
                        horizontal: 24, vertical: 12,),
                  ),
                  child: const Row(
                    children: [
                      Icon(Icons.explore),
                      SizedBox(width: 8),
                      Text('Explore'),
                    ],
                  ),
                ),
                FloatingActionButton(
                  onPressed: () {
                    debugPrint('TODO: My Location');
                  },
                  child: const Icon(Icons.photo),
                ),
              ],
            ),
          ),
        ],
      ),
    );
  }
}

---

## ðŸ¤– Assistant
*2024-12-10 21:31:41*

The issue occurs because the `FloatingActionButton` widget automatically uses a `Hero` widget with a default tag to enable hero animations during transitions. When there are multiple `FloatingActionButton` widgets in the same subtree without unique tags, this error is thrown.

To fix this, you can assign a unique `heroTag` to each `FloatingActionButton`:

### Updated Code:
```dart
import 'package:flutter/material.dart';
import 'package:hooks_riverpod/hooks_riverpod.dart';

class MapPage extends HookConsumerWidget {
  const MapPage({super.key});

  @override
  Widget build(BuildContext context, WidgetRef ref) {
    return Scaffold(
      body: Stack(
        children: [
          const Center(child: Text('Map')),
          Positioned(
            bottom: 16,
            left: 16,
            right: 16,
            child: Row(
              mainAxisAlignment: MainAxisAlignment.spaceBetween,
              children: [
                // Current Location Button
                FloatingActionButton(
                  heroTag: 'current_location_button', // Unique heroTag
                  onPressed: () {
                    debugPrint('TODO: My Location');
                  },
                  child: const Icon(Icons.my_location),
                ),
                // Explore Button
                ElevatedButton(
                  onPressed: () {
                    debugPrint('TODO: Explore');
                  },
                  style: ElevatedButton.styleFrom(
                    shape: RoundedRectangleBorder(
                      borderRadius: BorderRadius.circular(16),
                    ),
                    padding: const EdgeInsets.symmetric(
                        horizontal: 24, vertical: 12),
                  ),
                  child: const Row(
                    children: [
                      Icon(Icons.explore),
                      SizedBox(width: 8),
                      Text('Explore'),
                    ],
                  ),
                ),
                // Photo Button
                FloatingActionButton(
                  heroTag: 'photo_button', // Unique heroTag
                  onPressed: () {
                    debugPrint('TODO: Photo');
                  },
                  child: const Icon(Icons.photo),
                ),
              ],
            ),
          ),
        ],
      ),
    );
  }
}
```

### Key Changes:
1. **`heroTag` Property**:
   - Set unique `heroTag` values for each `FloatingActionButton` to prevent hero animation conflicts.
   - Example: `heroTag: 'current_location_button'` and `heroTag: 'photo_button'`.

### Why This Fixes the Problem:
Each `FloatingActionButton` now has a unique `Hero` tag, ensuring no conflicts during page transitions or animations.

Let me know if you encounter further issues!

---

## ðŸ‘¤ User
*2024-12-10 21:35:32*

SpotListPage ã‹ã‚‰ SpotDetailPage ã¸ã® push ã®å°Žç·šã‚’ä½œã£ã¦ã»ã—ã„

import 'package:flutter/material.dart';
import 'package:go_router/go_router.dart';
import 'package:hooks_riverpod/hooks_riverpod.dart';
import 'package:snpit_guild_app/domain/screen.dart';

class MapPage extends HookConsumerWidget {
  const MapPage({super.key});

  @override
  Widget build(BuildContext context, WidgetRef ref) {
    return Scaffold(
      body: Stack(
        children: [
          const Center(child: Text('Map')),
          Positioned(
            bottom: 16,
            left: 16,
            right: 16,
            child: Row(
              mainAxisAlignment: MainAxisAlignment.spaceBetween,
              children: [
                FloatingActionButton(
                  heroTag: 'current_location_button',
                  onPressed: () {
                    debugPrint('TODO: My Location');
                  },
                  child: const Icon(Icons.my_location),
                ),
                ElevatedButton(
                  onPressed: () {
                    debugPrint('TODO: Explore');
                  },
                  style: ElevatedButton.styleFrom(
                    shape: RoundedRectangleBorder(
                      borderRadius: BorderRadius.circular(16),
                    ),
                    padding: const EdgeInsets.symmetric(
                        horizontal: 24, vertical: 12,),
                  ),
                  child: const Row(
                    children: [
                      Icon(Icons.explore),
                      SizedBox(width: 8),
                      Text('Explore'),
                    ],
                  ),
                ),
                FloatingActionButton(
                  onPressed: () {
                    context.push(Screen.spotList.path);
                  },
                  child: const Icon(Icons.photo),
                ),
              ],
            ),
          ),
        ],
      ),
    );
  }
}

import 'package:flutter/material.dart';

class SpotListPage extends StatelessWidget {
  const SpotListPage({super.key});

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(title: const Text('SpotListPage')),
      body: const Center(child: Text('SpotListPage')),
    );
  }
}

import 'package:flutter/material.dart';

class SpotDetailPage extends StatelessWidget {
  const SpotDetailPage({super.key});

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(title: const Text('SpotDetailPage')),
      body: const Center(child: Text('SpotDetailPage')),
    );
  }
}

---

## ðŸ¤– Assistant
*2024-12-10 21:35:51*

Here's how you can set up the navigation from `SpotListPage` to `SpotDetailPage` using `GoRouter`:

### Step 1: Update `Screen` Enum
Make sure `Screen` includes routes for both `SpotListPage` and `SpotDetailPage`:

```dart
enum Screen {
  spotList('/spot-list'),
  spotDetail('/spot-detail');

  const Screen(this.path);
  final String path;
}
```

### Step 2: Configure Routes in `GoRouter`
Update your `GoRouter` configuration to include the routes for `SpotListPage` and `SpotDetailPage`:

```dart
import 'package:go_router/go_router.dart';
import 'package:snpit_guild_app/pages/spot_list_page.dart';
import 'package:snpit_guild_app/pages/spot_detail_page.dart';

final GoRouter router = GoRouter(
  routes: [
    GoRoute(
      path: Screen.spotList.path,
      builder: (context, state) => const SpotListPage(),
    ),
    GoRoute(
      path: Screen.spotDetail.path,
      builder: (context, state) => const SpotDetailPage(),
    ),
  ],
);
```

### Step 3: Update `SpotListPage` to Navigate to `SpotDetailPage`
Add a button or list item in `SpotListPage` to navigate to `SpotDetailPage`:

```dart
import 'package:flutter/material.dart';
import 'package:go_router/go_router.dart';
import 'package:snpit_guild_app/domain/screen.dart';

class SpotListPage extends StatelessWidget {
  const SpotListPage({super.key});

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(title: const Text('SpotListPage')),
      body: ListView.builder(
        itemCount: 10,
        itemBuilder: (context, index) {
          return ListTile(
            title: Text('Spot $index'),
            onTap: () {
              context.push(Screen.spotDetail.path);
            },
          );
        },
      ),
    );
  }
}
```

### Step 4: Verify the Navigation in `MapPage`
Ensure the `FloatingActionButton` in `MapPage` navigates to `SpotListPage`:

```dart
FloatingActionButton(
  onPressed: () {
    context.push(Screen.spotList.path);
  },
  heroTag: 'photo_button',
  child: const Icon(Icons.photo),
),
```

### How It Works
1. The `FloatingActionButton` in `MapPage` navigates to `SpotListPage`.
2. In `SpotListPage`, tapping a list item navigates to `SpotDetailPage`.

Let me know if you need further assistance!

---

## ðŸ‘¤ User
*2024-12-10 21:38:45*

ç”»é¢ã®é«˜ã•ã®50%ã®ãƒãƒ¼ãƒ•ãƒ¢ãƒ¼ãƒ€ãƒ«ã§ã‚ã‚‹ ExplorerListPage ã«debugPrint('TODO: Explore');ã®ã¨ã“ã‚ã‚’å¤‰ãˆã¦ã€ãã®ç”»é¢ãŒç«‹ã¡ä¸ŠãŒã‚‹ã‚ˆã†ã«ã—ã¦ã»ã—ã„ã€‚


import 'package:flutter/material.dart';
import 'package:go_router/go_router.dart';
import 'package:hooks_riverpod/hooks_riverpod.dart';
import 'package:snpit_guild_app/domain/screen.dart';

class MapPage extends HookConsumerWidget {
  const MapPage({super.key});

  @override
  Widget build(BuildContext context, WidgetRef ref) {
    return Scaffold(
      body: Stack(
        children: [
          const Center(child: Text('Map')),
          Positioned(
            bottom: 16,
            left: 16,
            right: 16,
            child: Row(
              mainAxisAlignment: MainAxisAlignment.spaceBetween,
              children: [
                FloatingActionButton(
                  heroTag: 'current_location_button',
                  onPressed: () {
                    debugPrint('TODO: My Location');
                  },
                  child: const Icon(Icons.my_location),
                ),
                ElevatedButton(
                  onPressed: () {
                    debugPrint('TODO: Explore');
                  },
                  style: ElevatedButton.styleFrom(
                    shape: RoundedRectangleBorder(
                      borderRadius: BorderRadius.circular(16),
                    ),
                    padding: const EdgeInsets.symmetric(
                        horizontal: 24, vertical: 12,),
                  ),
                  child: const Row(
                    children: [
                      Icon(Icons.explore),
                      SizedBox(width: 8),
                      Text('Explore'),
                    ],
                  ),
                ),
                FloatingActionButton(
                  onPressed: () {
                    context.push(Screen.spotList.path);
                  },
                  child: const Icon(Icons.photo),
                ),
              ],
            ),
          ),
        ],
      ),
    );
  }
}

---

## ðŸ¤– Assistant
*2024-12-10 21:39:17*

To implement a half-height modal for `ExplorerListPage` when the "Explore" button is tapped, you can use `showModalBottomSheet` with the desired height set to 50% of the screen. Hereâ€™s how you can modify your code:

### Updated Code

1. **Create the `ExplorerListPage` Widget**:
   Define the page to be displayed in the modal.

```dart
import 'package:flutter/material.dart';

class ExplorerListPage extends StatelessWidget {
  const ExplorerListPage({super.key});

  @override
  Widget build(BuildContext context) {
    return Column(
      mainAxisSize: MainAxisSize.min,
      children: [
        Container(
          width: 40,
          height: 4,
          margin: const EdgeInsets.symmetric(vertical: 8),
          decoration: BoxDecoration(
            color: Colors.grey[300],
            borderRadius: BorderRadius.circular(2),
          ),
        ),
        const Text(
          'Explorer List',
          style: TextStyle(fontSize: 18, fontWeight: FontWeight.bold),
        ),
        Expanded(
          child: ListView.builder(
            itemCount: 10,
            itemBuilder: (context, index) {
              return ListTile(
                title: Text('Explorer Item $index'),
                onTap: () {
                  debugPrint('Tapped Explorer Item $index');
                },
              );
            },
          ),
        ),
      ],
    );
  }
}
```

2. **Update the "Explore" Button**:
   Replace the `debugPrint` with `showModalBottomSheet`.

```dart
ElevatedButton(
  onPressed: () {
    showModalBottomSheet(
      context: context,
      isScrollControlled: true,
      shape: const RoundedRectangleBorder(
        borderRadius: BorderRadius.vertical(top: Radius.circular(16)),
      ),
      builder: (context) {
        return DraggableScrollableSheet(
          initialChildSize: 0.5, // Start at 50% height
          minChildSize: 0.5, // Minimum height is 50%
          maxChildSize: 1.0, // Can be dragged to full screen
          expand: false,
          builder: (context, scrollController) {
            return ExplorerListPage();
          },
        );
      },
    );
  },
  style: ElevatedButton.styleFrom(
    shape: RoundedRectangleBorder(
      borderRadius: BorderRadius.circular(16),
    ),
    padding: const EdgeInsets.symmetric(horizontal: 24, vertical: 12),
  ),
  child: const Row(
    children: [
      Icon(Icons.explore),
      SizedBox(width: 8),
      Text('Explore'),
    ],
  ),
),
```

### Explanation
- **`showModalBottomSheet`**:
  Opens the `ExplorerListPage` as a bottom sheet.
  
- **`DraggableScrollableSheet`**:
  Allows the modal to start at 50% height and expand to full screen when dragged.

- **Rounded Top Corners**:
  The `RoundedRectangleBorder` gives the modal a rounded top edge for better aesthetics.

3. **Result**:
   When the "Explore" button is tapped, the `ExplorerListPage` will open as a half-height modal that can be dragged to expand to full screen.

Let me know if you need further adjustments!

---

## ðŸ‘¤ User
*2024-12-10 21:40:25*

é«˜ã•ã¯å›ºå®šã§ã„ã„ã‚ˆ

---

## ðŸ¤– Assistant
*2024-12-10 21:40:50*

If you want the height of the modal to remain fixed at 50% of the screen height, you can use `showModalBottomSheet` with a constrained `SizedBox` to control the height. Here's the updated implementation:

### Updated Code

1. **Fixed Height for the Modal**:
   Modify the "Explore" button to display a fixed-height modal.

```dart
ElevatedButton(
  onPressed: () {
    showModalBottomSheet(
      context: context,
      isScrollControlled: true,
      shape: const RoundedRectangleBorder(
        borderRadius: BorderRadius.vertical(top: Radius.circular(16)),
      ),
      builder: (context) {
        return SizedBox(
          height: MediaQuery.of(context).size.height * 0.5, // 50% of screen height
          child: ExplorerListPage(),
        );
      },
    );
  },
  style: ElevatedButton.styleFrom(
    shape: RoundedRectangleBorder(
      borderRadius: BorderRadius.circular(16),
    ),
    padding: const EdgeInsets.symmetric(horizontal: 24, vertical: 12),
  ),
  child: const Row(
    children: [
      Icon(Icons.explore),
      SizedBox(width: 8),
      Text('Explore'),
    ],
  ),
),
```

2. **`ExplorerListPage` Implementation**:
   No changes are needed from the previous code. It will be embedded in the modal.

```dart
import 'package:flutter/material.dart';

class ExplorerListPage extends StatelessWidget {
  const ExplorerListPage({super.key});

  @override
  Widget build(BuildContext context) {
    return Column(
      mainAxisSize: MainAxisSize.min,
      children: [
        Container(
          width: 40,
          height: 4,
          margin: const EdgeInsets.symmetric(vertical: 8),
          decoration: BoxDecoration(
            color: Colors.grey[300],
            borderRadius: BorderRadius.circular(2),
          ),
        ),
        const Text(
          'Explorer List',
          style: TextStyle(fontSize: 18, fontWeight: FontWeight.bold),
        ),
        Expanded(
          child: ListView.builder(
            itemCount: 10,
            itemBuilder: (context, index) {
              return ListTile(
                title: Text('Explorer Item $index'),
                onTap: () {
                  debugPrint('Tapped Explorer Item $index');
                },
              );
            },
          ),
        ),
      ],
    );
  }
}
```

### Explanation
- **Fixed Height**:
  The modal height is set using `SizedBox` with a height of `MediaQuery.of(context).size.height * 0.5`, which makes it exactly 50% of the screen height.

- **Rounded Corners**:
  The `RoundedRectangleBorder` ensures the modal has rounded corners at the top.

- **No Dragging**:
  Since the height is fixed, the user won't be able to drag to expand or minimize the modal.

Let me know if this works for you or if you need additional changes!

---

## ðŸ‘¤ User
*2024-12-10 21:46:10*

ä»Šã®ã¾ã¾ã ã¨ã‚¿ãƒ–ãƒãƒ¼ã®ä¸Šã‹ã‚‰showModalBottomSheetã—ã¦ã„ã‚‹ã®ã§ã€ã‚¿ãƒ–ãƒãƒ¼ã®ä¸‹ã‹ã‚‰showModalBottomSheetã™ã‚‹ã‚ˆã†ã«ã—ãŸã„ã€‚ã©ã†ã™ã‚Œã°ã„ã„ã‹ï¼Ÿ

import 'package:flutter/material.dart';
import 'package:go_router/go_router.dart';
import 'package:hooks_riverpod/hooks_riverpod.dart';
import 'package:snpit_guild_app/domain/screen.dart';
import 'package:snpit_guild_app/presentation/pages/explorer_list_page.dart';

class MapPage extends HookConsumerWidget {
  const MapPage({super.key});

  @override
  Widget build(BuildContext context, WidgetRef ref) {
    return Scaffold(
      body: Stack(
        children: [
          const Center(child: Text('Map')),
          Positioned(
            bottom: 16,
            left: 16,
            right: 16,
            child: Row(
              mainAxisAlignment: MainAxisAlignment.spaceBetween,
              children: [
                FloatingActionButton(
                  heroTag: 'current_location_button',
                  onPressed: () {
                    debugPrint('TODO: My Location');
                  },
                  child: const Icon(Icons.my_location),
                ),
                ElevatedButton(
                  onPressed: () {
                    showModalBottomSheet&lt;void&gt;(
                      context: context,
                      isScrollControlled: true,
                      shape: const RoundedRectangleBorder(
                      borderRadius:
                        BorderRadius.vertical(top: Radius.circular(16)),
                      ),
                      builder: (context) {
                      return SizedBox(
                        height: MediaQuery.of(context).size.height *
                          0.5,
                        child: ExplorerListPage(),
                      );
                      },
                    );
                  },
                  style: ElevatedButton.styleFrom(
                    shape: RoundedRectangleBorder(
                      borderRadius: BorderRadius.circular(16),
                    ),
                    padding: const EdgeInsets.symmetric(
                        horizontal: 24, vertical: 12),
                  ),
                  child: const Row(
                    children: [
                      Icon(Icons.explore),
                      SizedBox(width: 8),
                      Text('Explore'),
                    ],
                  ),
                ),
                FloatingActionButton(
                  onPressed: () {
                    context.push(Screen.spotList.path);
                  },
                  child: const Icon(Icons.photo),
                ),
              ],
            ),
          ),
        ],
      ),
    );
  }
}

import 'package:flutter/material.dart';
import 'package:go_router/go_router.dart';
import 'package:snpit_guild_app/domain/screen.dart';

class TabPage extends StatelessWidget {
  const TabPage({required this.navigationShell, super.key});
  final StatefulNavigationShell navigationShell;

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        leadingWidth: 100,
        leading: Row(
          mainAxisSize: MainAxisSize.min,
          children: [
            IconButton(
              icon: const Icon(Icons.person),
              onPressed: () {
                context.push(Screen.myPage.path);
              },
            ),
            IconButton(
              icon: const Icon(Icons.notifications),
              onPressed: () {
                context.push(Screen.notificationList.path);
              },
            ),
          ],
        ),
        actions: [
          Padding(
            padding: const EdgeInsets.only(right: 16),
            child: InkWell(
              onTap: () {
                context.push(Screen.wallet.path);
              },
              child: const Row(
                children: [
                  Icon(Icons.token, size: 20),
                  SizedBox(width: 4),
                  Text('35.05 STP'), // TODO: ä»®ãƒ‡ãƒ¼ã‚¿
                ],
              ),
            ),
          ),
        ],
      ),
      body: navigationShell,
      bottomNavigationBar: BottomNavigationBar(
        currentIndex: navigationShell.currentIndex,
        onTap: navigationShell.goBranch,
        items: const [
          BottomNavigationBarItem(icon: Icon(Icons.map), label: 'Map'),
          BottomNavigationBarItem(icon: Icon(Icons.group), label: 'Guild'),
        ],
      ),
    );
  }
}

---

## ðŸ¤– Assistant
*2024-12-10 21:46:55*

To make the `showModalBottomSheet` appear from below the tab bar (not on top of it), you need to adjust its parent widget. The modal is currently tied to the `MapPage`, but the `BottomNavigationBar` is part of `TabPage`. To achieve the desired behavior, you should attach the `showModalBottomSheet` to the `TabPage`'s `Scaffold`.

Hereâ€™s how to fix it:

### Updated Implementation

1. **Pass a Context from `TabPage`**:
   Update the `TabPage` to pass its `Scaffold` context to the child pages (`MapPage`).

```dart
import 'package:flutter/material.dart';
import 'package:go_router/go_router.dart';

class TabPage extends StatelessWidget {
  const TabPage({required this.navigationShell, super.key});
  final StatefulNavigationShell navigationShell;

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        leadingWidth: 100,
        leading: Row(
          mainAxisSize: MainAxisSize.min,
          children: [
            IconButton(
              icon: const Icon(Icons.person),
              onPressed: () {
                context.push(Screen.myPage.path);
              },
            ),
            IconButton(
              icon: const Icon(Icons.notifications),
              onPressed: () {
                context.push(Screen.notificationList.path);
              },
            ),
          ],
        ),
        actions: [
          Padding(
            padding: const EdgeInsets.only(right: 16),
            child: InkWell(
              onTap: () {
                context.push(Screen.wallet.path);
              },
              child: const Row(
                children: [
                  Icon(Icons.token, size: 20),
                  SizedBox(width: 4),
                  Text('35.05 STP'), // TODO: ä»®ãƒ‡ãƒ¼ã‚¿
                ],
              ),
            ),
          ),
        ],
      ),
      body: Builder(
        builder: (scaffoldContext) => navigationShell
            .currentPage(childContext: scaffoldContext), // Pass scaffoldContext
      ),
      bottomNavigationBar: BottomNavigationBar(
        currentIndex: navigationShell.currentIndex,
        onTap: navigationShell.goBranch,
        items: const [
          BottomNavigationBarItem(icon: Icon(Icons.map), label: 'Map'),
          BottomNavigationBarItem(icon: Icon(Icons.group), label: 'Guild'),
        ],
      ),
    );
  }
}
```

2. **Update the `MapPage`**:
   Modify the `MapPage` to accept the `BuildContext` of the parent `Scaffold` and use it for the modal.

```dart
import 'package:flutter/material.dart';
import 'package:hooks_riverpod/hooks_riverpod.dart';
import 'package:snpit_guild_app/presentation/pages/explorer_list_page.dart';

class MapPage extends HookConsumerWidget {
  const MapPage({super.key, required this.scaffoldContext});

  final BuildContext scaffoldContext; // Receive context from TabPage

  @override
  Widget build(BuildContext context, WidgetRef ref) {
    return Scaffold(
      body: Stack(
        children: [
          const Center(child: Text('Map')),
          Positioned(
            bottom: 16,
            left: 16,
            right: 16,
            child: Row(
              mainAxisAlignment: MainAxisAlignment.spaceBetween,
              children: [
                FloatingActionButton(
                  heroTag: 'current_location_button',
                  onPressed: () {
                    debugPrint('TODO: My Location');
                  },
                  child: const Icon(Icons.my_location),
                ),
                ElevatedButton(
                  onPressed: () {
                    showModalBottomSheet<void>(
                      context: scaffoldContext, // Use parent Scaffold context
                      isScrollControlled: true,
                      shape: const RoundedRectangleBorder(
                        borderRadius:
                            BorderRadius.vertical(top: Radius.circular(16)),
                      ),
                      builder: (context) {
                        return SizedBox(
                          height: MediaQuery.of(context).size.height * 0.5,
                          child: const ExplorerListPage(),
                        );
                      },
                    );
                  },
                  style: ElevatedButton.styleFrom(
                    shape: RoundedRectangleBorder(
                      borderRadius: BorderRadius.circular(16),
                    ),
                    padding: const EdgeInsets.symmetric(
                        horizontal: 24, vertical: 12),
                  ),
                  child: const Row(
                    children: [
                      Icon(Icons.explore),
                      SizedBox(width: 8),
                      Text('Explore'),
                    ],
                  ),
                ),
                FloatingActionButton(
                  onPressed: () {
                    debugPrint('TODO: Photo');
                  },
                  child: const Icon(Icons.photo),
                ),
              ],
            ),
          ),
        ],
      ),
    );
  }
}
```

3. **Update the Navigation Shell**:
   Ensure `navigationShell` can pass the correct context to the `MapPage`:

```dart
class StatefulNavigationShell {
  int currentIndex = 0;
  Widget currentPage({required BuildContext childContext}) {
    switch (currentIndex) {
      case 0:
        return MapPage(scaffoldContext: childContext); // Pass the context
      case 1:
        return const GuildPage(); // Example for another tab
      default:
        return const SizedBox.shrink();
    }
  }

  void goBranch(int index) {
    currentIndex = index;
    // Add navigation logic if needed
  }
}
```

### Explanation
1. **Why Pass the `Scaffold` Context**:
   The modal sheet needs to be attached to the `Scaffold` of the `TabPage`, which hosts the `BottomNavigationBar`.

2. **How it Works**:
   - The `Builder` in `TabPage` creates a new context tied to the `Scaffold`.
   - This context is passed to `MapPage` via `navigationShell`.
   - `MapPage` uses this context for `showModalBottomSheet`, ensuring it appears from below the `BottomNavigationBar`.

3. **Result**:
   The modal sheet opens below the `BottomNavigationBar`, achieving the desired behavior.

---
