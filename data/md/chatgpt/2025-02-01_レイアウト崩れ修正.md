# ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆå´©ã‚Œä¿®æ­£

æ—¥ä»˜: 2025-02-01

---

## ğŸ‘¤ ãƒ¦ãƒ¼ã‚¶ãƒ¼
*2025/02/02 01:18:23*

{
  "content_type": "image_asset_pointer",
  "asset_pointer": "file-service://file-5etCUqhz1jDsCxKb2Fwzft",
  "size_bytes": 466550,
  "width": 791,
  "height": 1595,
  "fovea": null,
  "metadata": {
    "dalle": null,
    "gizmo": null,
    "generation": null,
    "container_pixel_height": null,
    "container_pixel_width": null,
    "emu_omit_glimpse_image": null,
    "emu_patches_override": null,
    "sanitized": true,
    "asset_pointer_link": null,
    "watermarked_asset_pointer": null
  }
}
ã“ã®ã‚ˆã†ã«ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆãŒå´©ã‚Œã¦ã—ã¾ã£ã¦ã„ã‚‹

import 'package:flutter/material.dart';
import 'package:flutter_hooks/flutter_hooks.dart';
import 'package:flutter_svg/flutter_svg.dart';
import 'package:go_router/go_router.dart';
import 'package:hooks_riverpod/hooks_riverpod.dart';
import 'package:snpit_guild_app/domain/design/color_token.dart';
import 'package:snpit_guild_app/domain/screen.dart';
import 'package:snpit_guild_app/gen/assets.gen.dart';
import 'package:snpit_guild_app/presentation/providers/access_token.dart';

import 'package:snpit_guild_app/presentation/providers/api_client/auth/request_code.dart';
import 'package:snpit_guild_app/presentation/providers/api_client/users/get_user.dart';
import 'package:snpit_guild_app/presentation/providers/flavor_provider.dart';
import 'package:snpit_guild_app/presentation/providers/show_force_update.dart';
import 'package:snpit_guild_app/presentation/providers/show_maintenance.dart';
import 'package:snpit_guild_app/presentation/widgets/dialogs/terms_of_service_dialog.dart';
import 'package:snpit_guild_app/utils/show_dialog_utils.dart';
import 'package:snpit_guild_app/utils/snack_bar_utils.dart';

class LoginPage extends HookConsumerWidget {
  const LoginPage({super.key});

  @override
  Widget build(BuildContext context, WidgetRef ref) {
    final flavor = ref.watch(flavorProvider);
    final textEditingController = useTextEditingController();
    final isLoadingState = useState(false);

    ref
      ..listen&lt;int&gt;(showMaintenanceNotifierProvider, (previous, next) async {
        showMaintenanceDialog(context);
      })
      ..listen&lt;int&gt;(showForceUpdateNotifierProvider, (previous, next) async {
        showForceUpdateDialog(context);
      });

    useEffect(
      () {
        Future.microtask(() async {
          try {
            isLoadingState.value = true;

            final currentAccessToken =
                await ref.read(accessTokenNotifierProvider.future);

            if (currentAccessToken == null) {
              debugPrint('No access token found.');
              return;
            }

            await ref.read(getMyUserNotifierProvider.notifier).getMyUser();

            if (context.mounted) {
              context.go(Screen.map.path);
            }
          } on Exception catch (error) {
            // ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³åˆ‡ã‚Œã®æ™‚ã‚‚ã‚ã‚‹ã®ã§ã‚¹ãƒŠãƒƒã‚¯ãƒãƒ¼ã¯å‡ºã•ãªã„
            debugPrint('Error: $error');
          } finally {
            if (context.mounted) {
              isLoadingState.value = false;
            }
          }
        });
        return null;
      },
      [],
    );

    Future&lt;void&gt; onLongPressLogo() async {
      if (flavor.isDebugMode) {
        await context.push(Screen.debugMenu.path);
      }
    }

    Future&lt;void&gt; onTapLogin() async {
      final email = textEditingController.text.trim();
      if (email.isEmpty) {
        ScaffoldMessenger.of(context).showSnackBar(
          const SnackBar(
            content: Text('Please enter a valid email.'),
          ),
        );
        return;
      }

      try {
        isLoadingState.value = true;

        if (context.mounted) {
          final confirm = await showDialog&lt;bool&gt;(
            context: context,
            barrierDismissible: false,
            builder: (BuildContext context) {
              return const TermsOfServiceDialog();
            },
          );

          if (confirm != true) {
            return;
          }
        }

        await ref.read(requestCodeNotifierProvider.notifier).requestCode(email);

        if (context.mounted) {
          await context.push(Screen.verificationCode.path, extra: email);
        }
      } on Exception catch (error) {
        if (context.mounted) {
          showErrorSnackBar(context, error);
        }
      } finally {
        if (context.mounted) {
          isLoadingState.value = false;
        }
      }
    }

    return Scaffold(
      body: GestureDetector(
        onTap: () {
          FocusScope.of(context).unfocus();
        },
        child: Stack(
          children: [
            Center(
              child: Padding(
                padding: const EdgeInsets.symmetric(horizontal: 24),
                child: Column(
                  mainAxisAlignment: MainAxisAlignment.center,
                  children: [
                    GestureDetector(
                      onLongPress: () async {
                        await onLongPressLogo();
                      },
                      child: SvgPicture.asset(
                        Assets.images.logoLogin.path,
                      ),
                    ),
                    const SizedBox(height: 38),
                    Image.asset(
                      Assets.images.loginFig.path,
                    ),
                    const SizedBox(height: 54),
                    TextField(
                      controller: textEditingController,
                      decoration: const InputDecoration(
                        prefixIcon: Padding(
                          padding: EdgeInsets.all(12),
                          child: Icon(
                            Icons.email_outlined,
                            color: ColorToken.text,
                            size: 24,
                          ),
                        ),
                        hintText: 'Enter your email',
                      ),
                    ),
                    const SizedBox(height: 24),
                    ElevatedButton(
                      onPressed: isLoadingState.value
                          ? null
                          : () async {
                              await onTapLogin();
                            },
                      child: const Text('Login'),
                    ),
                  ],
                ),
              ),
            ),
            if (isLoadingState.value)
              const Center(
                child: CircularProgressIndicator(),
              ),
          ],
        ),
      ),
    );
  }
}

---

## ğŸ¤– ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ
*2025/02/02 01:18:40*

ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ãŒå‡ºã‚‹ã“ã¨ã§ä¸‹æ–¹å‘ã«ã¯ã¿å‡ºã—ã¦ã—ã¾ã†å…¸å‹çš„ãªãƒ‘ã‚¿ãƒ¼ãƒ³ãªã®ã§ã€ä»¥ä¸‹ã®ã‚ˆã†ã«ã€Œã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«å¯èƒ½ãªè¦ªã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆã‚’ç”¨æ„ã—ã€ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰è¡¨ç¤ºæ™‚ã«ç”»é¢ãŒç¸®ã‚€ã‚ˆã†ã«ã™ã‚‹ã€å®Ÿè£…ã«ã™ã‚‹ã®ãŒä¸€èˆ¬çš„ã§ã™ã€‚  
å…·ä½“çš„ã«ã¯ã€`Scaffold` ã« `resizeToAvoidBottomInset: true` ã‚’è¨­å®šã—ãŸã‚Šã€`body` ã‚’ `SingleChildScrollView` ã‚„ `ListView` ã§åŒ…ã‚“ã§ã‚ã’ã‚‹ã¨ã€ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ãŒå‡ºã¦ã‚‚ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆãŒå´©ã‚Œã«ãããªã‚Šã¾ã™ã€‚

ãŸã¨ãˆã°ä¸‹è¨˜ã®ã‚ˆã†ã«æ›¸ãæ›ãˆã¦ã¿ã¦ãã ã•ã„ï¼ˆè¦ç‚¹ã¯ `SingleChildScrollView` ã¨ `SafeArea` ã®åˆ©ç”¨ã§ã™ï¼‰ã€‚

```dart
return Scaffold(
  resizeToAvoidBottomInset: true, // ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰åˆ†ã ã‘ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚’ç¸®ã‚ã‚‹
  body: GestureDetector(
    onTap: () {
      FocusScope.of(context).unfocus();
    },
    child: SafeArea(
      child: SingleChildScrollView(
        padding: const EdgeInsets.symmetric(horizontal: 24),
        child: Container(
          // MediaQueryã§å…¨ä½“ã®é«˜ã•ã‚’å–å¾—ã—ã¦ãŠãã¨ã€
          // ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã§ç„¡é§„ãªç©ºããŒå‡ºãªã„ã‚ˆã†ã«èª¿æ•´ã—ã‚„ã™ã„
          constraints: BoxConstraints(
            minHeight: MediaQuery.of(context).size.height 
                      - MediaQuery.of(context).padding.top
                      - MediaQuery.of(context).padding.bottom,
          ),
          child: Column(
            mainAxisAlignment: MainAxisAlignment.center,
            children: [
              GestureDetector(
                onLongPress: onLongPressLogo,
                child: SvgPicture.asset(
                  Assets.images.logoLogin.path,
                ),
              ),
              const SizedBox(height: 38),
              Image.asset(
                Assets.images.loginFig.path,
              ),
              const SizedBox(height: 54),
              TextField(
                controller: textEditingController,
                decoration: const InputDecoration(
                  prefixIcon: Padding(
                    padding: EdgeInsets.all(12),
                    child: Icon(
                      Icons.email_outlined,
                      color: ColorToken.text,
                      size: 24,
                    ),
                  ),
                  hintText: 'Enter your email',
                ),
              ),
              const SizedBox(height: 24),
              ElevatedButton(
                onPressed: isLoadingState.value ? null : onTapLogin,
                child: const Text('Login'),
              ),
              // ã“ã“ã«ä½™ç™½ã‚’å…¥ã‚Œã¦ãŠãã¨ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ãŒã‹ã¶ã‚Šã«ãããªã‚‹
              const SizedBox(height: 40),
            ],
          ),
        ),
      ),
    ),
  ),
);
```

- `SingleChildScrollView` ã§ãƒ©ãƒƒãƒ—ã™ã‚‹ã“ã¨ã§ã€ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ãŒå‡ºã¦ã‚‚å…¨ä½“ã‚’ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚  
- `resizeToAvoidBottomInset` ã‚’ `true` ã«ã—ã¦ãŠãã¨ã€ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã®é«˜ã•åˆ†ã ã‘ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚’ç¸®ã‚ã¦ãã‚Œã¾ã™ã€‚  
- `SafeArea` ã‚’ä½¿ã†ã¨ã€ãƒãƒƒãƒã‚„ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒãƒ¼ã«ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŒã‹ã¶ã‚‰ãªã„ã‚ˆã†ã«èª¿æ•´ã§ãã¾ã™ã€‚  
- ç”»é¢ã®é«˜ã•ã‚ˆã‚Šå¤§ãã„è¦ç´ ãŒã‚ã‚‹å ´åˆã¯ `SingleChildScrollView` ã‚„ `ListView` ã‚’ä½¿ã£ã¦ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã•ã›ã‚‹ã¨ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆå´©ã‚Œã‚’é˜²ã’ã¾ã™ã€‚  

ã“ã®ã‚ˆã†ã«æ›¸ãæ›ãˆã‚Œã°ã€ã€ŒBOTTOM OVERFLOWED BY xx PIXELSã€ãŒè§£æ¶ˆã•ã‚Œã€ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰è¡¨ç¤ºæ™‚ã«ã‚‚å´©ã‚Œãšã«è¡¨ç¤ºã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ã¯ãšã§ã™ã€‚

---

## ğŸ‘¤ ãƒ¦ãƒ¼ã‚¶ãƒ¼
*2025/02/02 01:22:12*

ãƒ­ã‚´ã‚’ã‚»ãƒ³ã‚¿ãƒ¼ã«ç½®ã„ã¦ãŠããŸã„ã‚“ã 

---

## ğŸ¤– ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ
*2025/02/02 01:22:38*

ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ãŒå‡ºã¦ãã¦ã‚‚ç¸¦æ–¹å‘ã«ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã§ãã‚‹ã‚ˆã†ã«ã—ã¤ã¤ã€ã€Œç”»é¢ãŒå¤§ãã„å ´åˆã¯ãƒ­ã‚´ã‚’ç¸¦ä¸­å¤®ã«é…ç½®ã—ã¦ãŠããŸã„ã€ã¨ã„ã†å ´åˆã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ã« `SingleChildScrollView` ã¨ `ConstrainedBox` ã‚’çµ„ã¿åˆã‚ã›ã¦æ›¸ãã¨å®Ÿç¾ã—ã‚„ã™ã„ã§ã™ã€‚

ãƒã‚¤ãƒ³ãƒˆã¯ã€**æœ€å°é«˜ã•(`minHeight`)ã‚’ç”»é¢é«˜(`MediaQuery.of(context).size.height`)ã«ã—ã¦**ãŠãã€`Column` ã® `mainAxisAlignment` ã‚’ `center` ã«ã™ã‚‹ã“ã¨ã§ã™ã€‚ã“ã‚Œã§

- **ç”»é¢ã‚µã‚¤ã‚ºã‚ˆã‚Šå°ã•ã„å†…å®¹**ãªã‚‰ãƒ­ã‚´ãªã©ãŒç”»é¢ä¸­å¤®ã«æ¥ã‚‹  
- **ç”»é¢ã‚µã‚¤ã‚ºã‚ˆã‚Šå¤§ãã„å†…å®¹**ã«ãªã‚‹ (ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ãŒè¡¨ç¤ºã•ã‚Œã‚‹ãªã©) ã¨ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã§ãã‚‹  

ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

```dart
return Scaffold(
  resizeToAvoidBottomInset: true, // ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã§ç”»é¢ãŒå°ã•ããªã‚‹ã®ã‚’è¨±å¯
  body: GestureDetector(
    onTap: () => FocusScope.of(context).unfocus(),
    child: SafeArea(
      child: SingleChildScrollView(
        child: ConstrainedBox(
          // ä¸­èº«ã®æœ€å°ã®é«˜ã•ã‚’ã€Œç”»é¢ä¸€æ¯ã€ã«ã™ã‚‹
          constraints: BoxConstraints(
            minHeight: MediaQuery.of(context).size.height,
          ),
          // â†‘ã“ã‚Œã«ã‚ˆã‚Šã€ç”»é¢ãŒåºƒã„ã¨ãã¯ã¡ã‚‡ã†ã©1ç”»é¢ã«ãƒ•ã‚£ãƒƒãƒˆã—ã€
          // ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŒç”»é¢ã‚ˆã‚Šå¤§ãã„ã¨ãã¯ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã§ãã‚‹
          child: Padding(
            padding: const EdgeInsets.symmetric(horizontal: 24),
            child: Column(
              mainAxisAlignment: MainAxisAlignment.center, // ç¸¦ä¸­å¤®æƒãˆ
              children: [
                // --- ãƒ­ã‚´ ---
                GestureDetector(
                  onLongPress: onLongPressLogo,
                  child: SvgPicture.asset(
                    Assets.images.logoLogin.path,
                  ),
                ),
                const SizedBox(height: 38),
                Image.asset(
                  Assets.images.loginFig.path,
                ),
                const SizedBox(height: 54),

                // --- ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹å…¥åŠ› ---
                TextField(
                  controller: textEditingController,
                  decoration: const InputDecoration(
                    prefixIcon: Padding(
                      padding: EdgeInsets.all(12),
                      child: Icon(
                        Icons.email_outlined,
                        color: ColorToken.text,
                        size: 24,
                      ),
                    ),
                    hintText: 'Enter your email',
                  ),
                ),
                const SizedBox(height: 24),

                // --- ãƒ­ã‚°ã‚¤ãƒ³ãƒœã‚¿ãƒ³ ---
                ElevatedButton(
                  onPressed: isLoadingState.value ? null : onTapLogin,
                  child: const Text('Login'),
                ),

                // ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã«éš ã‚Œã«ããã™ã‚‹ãŸã‚ã®ä½™ç™½
                const SizedBox(height: 40),
              ],
            ),
          ),
        ),
      ),
    ),
  ),
);
```

ã“ã®ã‚ˆã†ã«å®Ÿè£…ã™ã‚‹ã¨ã€ç”»é¢ãŒä½™ã£ã¦ã„ã‚‹ã¨ãã¯ãƒ­ã‚´ã‚’å«ã‚€ã™ã¹ã¦ã®ã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆãŒçœŸã‚“ä¸­ã«é…ç½®ã•ã‚Œã€ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ãŒå‡ºã¦ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŒç”»é¢ä»¥ä¸Šã«å¤§ãããªã£ã¦ã‚‚ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ãŒæœ‰åŠ¹ã«ãªã‚‹ã®ã§ã€ä¸‹ç«¯ãŒåˆ‡ã‚Œãšã«ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆå´©ã‚Œã‚’é˜²ãã“ã¨ãŒã§ãã¾ã™ã€‚

---
