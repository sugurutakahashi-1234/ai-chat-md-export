# ä¸¦è¡Œå‡¦ç†ã®å®‰å…¨æ€§

Date: 2024-10-28

---

## ğŸ‘¤ User
*2024-10-28 14:03:30*

ã‚¨ãƒ©ãƒ¼ã‚’æ—¥æœ¬èªã§

Reference to static property 'updateJWTTokenError' is not concurrency-safe because it involves shared mutable state

class ContentDebugViewModel: ObservableObject {
    init() {
        Notification.Name.updateJWTTokenError.addObserver(self, selector: #selector(handleUpdateJWTTokenError))
    }

    @objc func handleUpdateJWTTokenError() {
        print("handleUpdateJWTTokenError...")
    }
}

---

## ğŸ¤– Assistant
*2024-10-28 14:03:43*

ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯ã€é™çš„ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ `'updateJWTTokenError'` ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹éš›ã«ã€å…±æœ‰ã®å¯å¤‰çŠ¶æ…‹ã«é–¢ä¸ã—ã¦ã„ã‚‹ãŸã‚ã€ä¸¦è¡Œå‡¦ç†ã«å®‰å…¨ã§ã¯ãªã„ã“ã¨ã‚’ç¤ºã—ã¦ã„ã¾ã™ã€‚ã“ã®ãŸã‚ã€ä¸¦è¡Œå‡¦ç†ã«å¯¾å¿œã™ã‚‹å½¢ã§ã®ã‚³ãƒ¼ãƒ‰ã®ä¿®æ­£ãŒå¿…è¦ã§ã™ã€‚

ä»¥ä¸‹ã¯ã€ä¸¦è¡Œå‡¦ç†ã«å¯¾å¿œã™ã‚‹ãŸã‚ã®ä¿®æ­£æ¡ˆã§ã™ï¼š

1. **`@MainActor` ã‚’ä½¿ã†**:  
   `ContentDebugViewModel` ã‚’ `@MainActor` ã«æŒ‡å®šã™ã‚‹ã“ã¨ã§ã€ãƒ¡ã‚¤ãƒ³ã‚¹ãƒ¬ãƒƒãƒ‰ã§ã®å®Ÿè¡Œã‚’ä¿è¨¼ã—ã€ä¸¦è¡Œå‡¦ç†ã®å®‰å…¨æ€§ã‚’ç¢ºä¿ã—ã¾ã™ã€‚

```swift
@MainActor
class ContentDebugViewModel: ObservableObject {
    init() {
        Notification.Name.updateJWTTokenError.addObserver(self, selector: #selector(handleUpdateJWTTokenError))
    }

    @objc func handleUpdateJWTTokenError() {
        print("handleUpdateJWTTokenError...")
    }
}
```

2. **Swift Concurrencyã‚’ä½¿ç”¨ã™ã‚‹**:  
   `NotificationCenter` ã® `addObserver` ãƒ¡ã‚½ãƒƒãƒ‰ã‚’éåŒæœŸå¯¾å¿œã® `AsyncStream` ã‚„ `async/await` ã‚’ä½¿ã£ã¦ç›£è¦–ã™ã‚‹ã‚ˆã†ã«å¤‰æ›´ã™ã‚‹æ–¹æ³•ã‚‚ã‚ã‚Šã¾ã™ã€‚

ä¾‹ãˆã°ï¼š

```swift
import Combine

@MainActor
class ContentDebugViewModel: ObservableObject {
    private var cancellables = Set<AnyCancellable>()
    
    init() {
        NotificationCenter.default.publisher(for: .updateJWTTokenError)
            .sink { [weak self] _ in
                self?.handleUpdateJWTTokenError()
            }
            .store(in: &cancellables)
    }

    private func handleUpdateJWTTokenError() {
        print("handleUpdateJWTTokenError...")
    }
}
```

ã“ã®ã‚ˆã†ã«ã—ã¦ã€ä¸¦è¡Œå‡¦ç†ç’°å¢ƒã«ãŠã„ã¦ã‚‚å®‰å…¨ãªå½¢ã§é€šçŸ¥ã‚’ç›£è¦–ã§ãã¾ã™ã€‚

---
