# 画像ボーダー追加方法

日付: 2024-12-20

---

## 👤 ユーザー
*2024/12/20 15:32:47*

SpotListPage にも SpotDetailPage と同様に画像に白のボーダーを設定したい。

import 'package:flutter/material.dart';
import 'package:go\_router/go\_router.dart';
import 'package:snpit\_guild\_app/domain/screen.dart';
import 'package:snpit\_guild\_app/utils/extensions/uri\_extensions.dart';

class SpotListPage extends StatelessWidget {
  const SpotListPage({super.key});

  @override
  Widget build(BuildContext context) {
    final spotList = List.generate(
      12,
      (index) =&gt; {
        'imageUrl': UriExtensions.randomImageUrl.toString(),
        'label': String.fromCharCode(65 + index),
      },
    );

    return Scaffold(
      appBar: AppBar(
        automaticallyImplyLeading: false,
        title: const Text('Spot list'),
        actions: \[
          IconButton(
            icon: const Icon(Icons.close),
            onPressed: () {
              // ボトムシート全体を閉じる
              Navigator.of(context, rootNavigator: true).pop();
            },
          ),
        \],
      ),
      body: GridView.builder(
        padding: const EdgeInsets.all(16),
        gridDelegate: const SliverGridDelegateWithFixedCrossAxisCount(
          crossAxisCount: 3,
          crossAxisSpacing: 8,
          mainAxisSpacing: 8,
        ),
        itemCount: spotList.length,
        itemBuilder: (context, index) {
          final spot = spotList\[index\];
          final imageUrl = spot\['imageUrl'\]!;
          final label = spot\['label'\]!;

          return GestureDetector(
            onTap: () {
              context.push(Screen.spotDetail.path);
            },
            child: Stack(
              alignment: Alignment.bottomCenter,
              children: \[
                Container(
                  color: Colors.grey\[200\],
                  child: ClipRRect(
                    borderRadius: BorderRadius.circular(8),
                    child: Image.network(
                      imageUrl,
                      fit: BoxFit.cover,
                      width: double.infinity,
                      height: double.infinity,
                      loadingBuilder: (context, child, loadingProgress) {
                        if (loadingProgress == null) {
                          return child;
                        }
                        // TODO: なぜかローディングが表示されない
                        return const Center(
                          child: CircularProgressIndicator(),
                        );
                      },
                      errorBuilder: (context, error, stackTrace) {
                        debugPrint('Image loading error: $error');
                        return const Center(
                          child: Icon(Icons.error, color: Colors.red),
                        );
                      },
                    ),
                  ),
                ),
                Positioned(
                  top: 8,
                  left: 8,
                  child: Container(
                    padding:
                        const EdgeInsets.symmetric(horizontal: 8, vertical: 4),
                    decoration: BoxDecoration(
                      color: Colors.black.withValues(alpha: 0.5),
                      borderRadius: BorderRadius.circular(4),
                    ),
                    child: Text(
                      label,
                      style: const TextStyle(color: Colors.white, fontSize: 12),
                    ),
                  ),
                ),
              \],
            ),
          );
        },
      ),
    );
  }
}

import 'package:flutter/material.dart';
import 'package:flutter\_hooks/flutter\_hooks.dart';
import 'package:hooks\_riverpod/hooks\_riverpod.dart';
import 'package:snpit\_guild\_app/presentation/design\_token/color\_token.dart';
import 'package:snpit\_guild\_app/utils/extensions/uri\_extensions.dart';

class SpotDetailPage extends HookConsumerWidget {
  const SpotDetailPage({super.key});

  @override
  Widget build(BuildContext context, WidgetRef ref) {
    // TODO: API 疎通 or 前画面からもってくる
    final imageUrl = useState(UriExtensions.randomImageUrl.toString());

    // TODO: 仮実装
    final items = \[
      const ListTile(
        contentPadding: EdgeInsets.symmetric(horizontal: 16),
        title: Text('Difficulty level'),
        trailing: CircleAvatar(
          backgroundColor: ColorToken.rarityCommon,
          child: Text('D'),
        ),
      ),
      ListTile(
        contentPadding: const EdgeInsets.symmetric(horizontal: 16),
        title: const Text(
          'Holder',
          style: TextStyle(fontSize: 14),
        ),
        trailing: const Row(
          mainAxisSize: MainAxisSize.min,
          children: \[
            Text(
              'Your Guild',
              style: TextStyle(
                fontSize: 14,
              ),
            ),
            SizedBox(width: 8),
            Icon(
              Icons.arrow\_forward\_ios,
              size: 16,
              color: ColorToken.text,
            ),
          \],
        ),
        onTap: () {
          debugPrint('Navigate to Guild Detail');
        },
      ),
    \];

    return Scaffold(
      appBar: AppBar(
        title: const Text('Detail'),
        leading: IconButton(
          icon: const Icon(Icons.arrow\_back),
          onPressed: () {
            Navigator.pop(context);
          },
        ),
        actions: \[
          IconButton(
            icon: const Icon(Icons.close),
            onPressed: () {
              // ボトムシート全体を閉じる
              Navigator.of(context, rootNavigator: true).pop();
            },
          ),
        \],
      ),
      body: SingleChildScrollView(
        padding: const EdgeInsets.all(16),
        child: Column(
          crossAxisAlignment: CrossAxisAlignment.stretch,
          children: \[
            AspectRatio(
              aspectRatio: 1,
              child: ClipRRect(
                borderRadius: BorderRadius.circular(8),
                child: Stack(
                  fit: StackFit.expand,
                  children: \[
                    // 角丸にボーダー を入れるには Container x Padding を使う
                    Container(
                      decoration: BoxDecoration(
                        border: Border.all(color: Colors.white, width: 2),
                        borderRadius: BorderRadius.circular(8),
                      ),
                    ),
                    Padding(
                      padding: const EdgeInsets.all(2),
                      child: ClipRRect(
                        borderRadius: BorderRadius.circular(8),
                        child: Image.network(
                          imageUrl.value,
                          fit: BoxFit.cover,
                          loadingBuilder: (context, child, loadingProgress) {
                            if (loadingProgress == null) {
                              return child;
                            }
                            return const Center(
                              child: CircularProgressIndicator(),
                            );
                          },
                          errorBuilder: (context, error, stackTrace) {
                            debugPrint('Image loading error: $error');
                            return const Center(
                              child: Icon(Icons.error, color: Colors.red),
                            );
                          },
                        ),
                      ),
                    ),
                  \],
                ),
              ),
            ),
            const SizedBox(height: 16),
            DecoratedBox(
              decoration: BoxDecoration(
                color: ColorToken.bg,
                borderRadius: BorderRadius.circular(8),
                border: Border.all(
                  color: ColorToken.border,
                  width: 0.5,
                ),
              ),
              // ListView.separated() で実装すると最後の要素に謎の余白が生じたため Column で実装
              child: Column(
                mainAxisSize: MainAxisSize.min,
                children: List.generate(
                  items.length,
                  (index) =&gt; Column(
                    children: \[
                      items\[index\],
                      if (index &lt; items.length - 1) // 最後のアイテムには線を追加しない
                        Container(
                          height: 0.5,
                          color: ColorToken.border,
                        ),
                    \],
                  ),
                ),
              ),
            ),
          \],
        ),
      ),
    );
  }
}

---

## 🤖 アシスタント
*2024/12/20 15:33:03*

`SpotListPage` にも `SpotDetailPage` と同様に画像に白のボーダーを設定するには、以下のように変更します。`SpotDetailPage` の画像表示部分の実装を参考に、`SpotListPage` の `GridView.builder` 内でボーダー付きの `Container` を追加します。

修正後のコードは以下の通りです：

```dart
return GestureDetector(
  onTap: () {
    context.push(Screen.spotDetail.path);
  },
  child: Stack(
    alignment: Alignment.bottomCenter,
    children: [
      Container(
        decoration: BoxDecoration(
          border: Border.all(color: Colors.white, width: 2),
          borderRadius: BorderRadius.circular(8),
        ),
        child: Padding(
          padding: const EdgeInsets.all(2),
          child: ClipRRect(
            borderRadius: BorderRadius.circular(8),
            child: Image.network(
              imageUrl,
              fit: BoxFit.cover,
              width: double.infinity,
              height: double.infinity,
              loadingBuilder: (context, child, loadingProgress) {
                if (loadingProgress == null) {
                  return child;
                }
                return const Center(
                  child: CircularProgressIndicator(),
                );
              },
              errorBuilder: (context, error, stackTrace) {
                debugPrint('Image loading error: $error');
                return const Center(
                  child: Icon(Icons.error, color: Colors.red),
                );
              },
            ),
          ),
        ),
      ),
      Positioned(
        top: 8,
        left: 8,
        child: Container(
          padding: const EdgeInsets.symmetric(horizontal: 8, vertical: 4),
          decoration: BoxDecoration(
            color: Colors.black.withAlpha(128),
            borderRadius: BorderRadius.circular(4),
          ),
          child: Text(
            label,
            style: const TextStyle(color: Colors.white, fontSize: 12),
          ),
        ),
      ),
    ],
  ),
);
```

### 変更点の説明
1. **ボーダーの追加**:
   - `Container` を使用して `border` を設定。
   - `Border.all(color: Colors.white, width: 2)` を指定して白のボーダーを描画。

2. **パディングの適用**:
   - 内側の画像をボーダーに接触しないようにするため、`Padding` ウィジェットを追加。

3. **画像のクリッピング**:
   - `ClipRRect` を使用して画像をボーダーに合わせて角丸にクリッピング。

これにより、`SpotListPage` の画像にも白いボーダーが適用され、`SpotDetailPage` と統一感のあるデザインになります。

---
