# SwiftUIã§ãƒªãƒ¢ãƒ¼ãƒˆé€šçŸ¥ç®¡ç†

Date: 2024-07-10

---

## ğŸ‘¤ User
*2024-07-10 14:48:15*

func application(application: UIApplication,
                 didRegisterForRemoteNotificationsWithDeviceToken deviceToken: Data) {}ã‚’SwiftUIã§å®Ÿè¡Œã—ãŸã„

---

## ğŸ¤– Assistant
*2024-07-10 14:48:40*

`UIApplicationDelegate`ã‚’ä½¿ã‚ãšã«SwiftUIã§ãƒªãƒ¢ãƒ¼ãƒˆé€šçŸ¥ã®ãƒ‡ãƒã‚¤ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ç™»éŒ²ã™ã‚‹ãŸã‚ã«ã¯ã€`UIApplicationDelegateAdaptor`ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚’ä½¿ã£ã¦`AppDelegate`ã‚’SwiftUIã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«çµ±åˆã™ã‚‹æ–¹æ³•ãŒã‚ã‚Šã¾ã™ã€‚

ä»¥ä¸‹ã«ãã®æ–¹æ³•ã‚’ç¤ºã—ã¾ã™ã€‚

1. `AppDelegate`ã‚¯ãƒ©ã‚¹ã‚’ä½œæˆã—ã€`didRegisterForRemoteNotificationsWithDeviceToken`ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®Ÿè£…ã—ã¾ã™ã€‚
2. `AppDelegate`ã‚’SwiftUIã®`@UIApplicationDelegateAdaptor`ã‚’ä½¿ã£ã¦çµ±åˆã—ã¾ã™ã€‚
3. SwiftUIã®`App`ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚’å®Ÿè£…ã™ã‚‹æ§‹é€ ä½“ã§`UIApplication.shared.registerForRemoteNotifications()`ã‚’å‘¼ã³å‡ºã—ã¾ã™ã€‚

ä»¥ä¸‹ã¯ãã®å®Ÿè£…ä¾‹ã§ã™ã€‚

```swift
import SwiftUI
import UIKit

// AppDelegateã‚¯ãƒ©ã‚¹ã‚’ä½œæˆ
class AppDelegate: NSObject, UIApplicationDelegate {
    func application(_ application: UIApplication,
                     didRegisterForRemoteNotificationsWithDeviceToken deviceToken: Data) {
        // ãƒ‡ãƒã‚¤ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å–å¾—ã—ãŸå¾Œã®å‡¦ç†ã‚’ã“ã“ã«æ›¸ãã¾ã™
        print("Device Token: \(deviceToken)")
    }

    func application(_ application: UIApplication,
                     didFailToRegisterForRemoteNotificationsWithError error: Error) {
        // ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸå ´åˆã®å‡¦ç†ã‚’ã“ã“ã«æ›¸ãã¾ã™
        print("Failed to register for remote notifications: \(error)")
    }
}

@main
struct YourApp: App {
    // AppDelegateã‚’SwiftUIã«çµ±åˆ
    @UIApplicationDelegateAdaptor(AppDelegate.self) var appDelegate

    var body: some Scene {
        WindowGroup {
            ContentView()
                .onAppear {
                    // ãƒªãƒ¢ãƒ¼ãƒˆé€šçŸ¥ã®ç™»éŒ²ã‚’ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
                    UIApplication.shared.registerForRemoteNotifications()
                    
                    // é€šçŸ¥ã®è¨±å¯ã‚’è¦æ±‚
                    UNUserNotificationCenter.current().requestAuthorization(options: [.alert, .sound, .badge]) { granted, error in
                        if granted {
                            DispatchQueue.main.async {
                                UIApplication.shared.registerForRemoteNotifications()
                            }
                        } else {
                            print("Notification permission denied.")
                        }
                        if let error = error {
                            print("Error requesting notification authorization: \(error)")
                        }
                    }
                }
        }
    }
}

struct ContentView: View {
    var body: some View {
        Text("Hello, world!")
            .padding()
    }
}
```

ã“ã®æ–¹æ³•ã§ã€SwiftUIã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã‚‚ãƒªãƒ¢ãƒ¼ãƒˆé€šçŸ¥ã®ãƒ‡ãƒã‚¤ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ç™»éŒ²ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚`AppDelegate`å†…ã§ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å–å¾—ã—ãŸå¾Œã®å‡¦ç†ã‚’å®Ÿè£…ã™ã‚‹ã“ã¨ã§ã€å¿…è¦ãªå‡¦ç†ã‚’è¡Œã†ã“ã¨ãŒã§ãã¾ã™ã€‚

---

## ğŸ‘¤ User
*2024-07-10 14:49:13*

UIApplicationDelegateAdaptor ã¯ @main ã§ã¯ãªã„ã¨ã“ã‚ã§ã‚‚ã˜ã£ã“ã†ã§ãã‚‹ã®ã‹ï¼Ÿ

---

## ğŸ¤– Assistant
*2024-07-10 14:49:34*

`UIApplicationDelegateAdaptor`ã¯ã€`@main`å±æ€§ãŒä»˜ã„ãŸã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆã®`App`ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚’å®Ÿè£…ã™ã‚‹æ§‹é€ ä½“ä»¥å¤–ã§ã‚‚ä½¿ç”¨ã§ãã¾ã™ã€‚å…·ä½“çš„ã«ã¯ã€SwiftUIã®ãƒ“ãƒ¥ãƒ¼éšå±¤å†…ã§åˆ©ç”¨ã™ã‚‹ã“ã¨ã‚‚å¯èƒ½ã§ã™ã€‚ä»¥ä¸‹ã«ãã®æ–¹æ³•ã‚’ç¤ºã—ã¾ã™ã€‚

`UIApplicationDelegateAdaptor`ã‚’ä½¿ã£ã¦`AppDelegate`ã‚’çµ±åˆã—ã€ãã‚Œã‚’ä»»æ„ã®SwiftUIã®ãƒ“ãƒ¥ãƒ¼å†…ã§ä½¿ç”¨ã™ã‚‹æ–¹æ³•ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚

```swift
import SwiftUI
import UIKit

// AppDelegateã‚¯ãƒ©ã‚¹ã‚’ä½œæˆ
class AppDelegate: NSObject, UIApplicationDelegate {
    func application(_ application: UIApplication,
                     didRegisterForRemoteNotificationsWithDeviceToken deviceToken: Data) {
        // ãƒ‡ãƒã‚¤ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å–å¾—ã—ãŸå¾Œã®å‡¦ç†ã‚’ã“ã“ã«æ›¸ãã¾ã™
        print("Device Token: \(deviceToken)")
    }

    func application(_ application: UIApplication,
                     didFailToRegisterForRemoteNotificationsWithError error: Error) {
        // ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸå ´åˆã®å‡¦ç†ã‚’ã“ã“ã«æ›¸ãã¾ã™
        print("Failed to register for remote notifications: \(error)")
    }
}

@main
struct YourApp: App {
    var body: some Scene {
        WindowGroup {
            ContentView()
        }
    }
}

struct ContentView: View {
    @UIApplicationDelegateAdaptor(AppDelegate.self) var appDelegate

    var body: some View {
        Text("Hello, world!")
            .padding()
            .onAppear {
                // ãƒªãƒ¢ãƒ¼ãƒˆé€šçŸ¥ã®ç™»éŒ²ã‚’ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
                UIApplication.shared.registerForRemoteNotifications()
                
                // é€šçŸ¥ã®è¨±å¯ã‚’è¦æ±‚
                UNUserNotificationCenter.current().requestAuthorization(options: [.alert, .sound, .badge]) { granted, error in
                    if granted {
                        DispatchQueue.main.async {
                            UIApplication.shared.registerForRemoteNotifications()
                        }
                    } else {
                        print("Notification permission denied.")
                    }
                    if let error = error {
                        print("Error requesting notification authorization: \(error)")
                    }
                }
            }
    }
}
```

ã“ã®ä¾‹ã§ã¯ã€`ContentView`ã®ä¸­ã§`@UIApplicationDelegateAdaptor`ã‚’ä½¿ã£ã¦`AppDelegate`ã‚’çµ±åˆã—ã¦ã„ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€`App`ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚’å®Ÿè£…ã™ã‚‹æ§‹é€ ä½“ä»¥å¤–ã®ä»»æ„ã®å ´æ‰€ã§`UIApplicationDelegateAdaptor`ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ãƒ“ãƒ¥ãƒ¼ã®è¡¨ç¤ºã¨åŒæ™‚ã«ãƒªãƒ¢ãƒ¼ãƒˆé€šçŸ¥ã®ç™»éŒ²ã‚„é€šçŸ¥è¨±å¯ã®è¦æ±‚ã‚’è¡Œã†ã“ã¨ãŒã§ãã¾ã™ã€‚

---
