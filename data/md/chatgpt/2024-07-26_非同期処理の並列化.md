# éåŒæœŸå‡¦ç†ã®ä¸¦åˆ—åŒ–

æ—¥ä»˜: 2024-07-26

---

## ğŸ‘¤ ãƒ¦ãƒ¼ã‚¶ãƒ¼
*2024/07/26 14:12:02*

ä»¥ä¸‹ã‚’ä¸¦åˆ—ã§å‡¦ç†ã•ã›ãŸã„

    func onAppear() async {
        dependency.logDriver.onAppearLog()
        
        isLoading = true
        defer {
            isLoading = false
        }

        do {
            account  = try await dependency.apiRequestDriver.getAccount()
        } catch {
            dependency.logDriver.errorLog("\(error)")
            appError = error.toAppError
            showAlert = true
        }
        
        do {
            talkThreads  = try await dependency.apiRequestDriver.getTalkThreads()
        } catch {
            dependency.logDriver.errorLog("\(error)")
            appError = error.toAppError
            showAlert = true
        }
    }

---

## ğŸ¤– ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ
*2024/07/26 14:12:10*

ä¸¦åˆ—å‡¦ç†ã‚’è¡Œã†ãŸã‚ã«ã¯ã€`TaskGroup` ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã€è¤‡æ•°ã®éåŒæœŸã‚¿ã‚¹ã‚¯ã‚’åŒæ™‚ã«å®Ÿè¡Œã—ã€ãã‚Œãã‚Œã®çµæœã‚’å¾…ã¤ã“ã¨ãŒã§ãã¾ã™ã€‚ä»¥ä¸‹ã«ä¸¦åˆ—å‡¦ç†ã‚’å®Ÿè£…ã—ãŸã‚³ãƒ¼ãƒ‰ã‚’ç¤ºã—ã¾ã™ã€‚

```swift
func onAppear() async {
    dependency.logDriver.onAppearLog()

    isLoading = true
    defer {
        isLoading = false
    }

    await withTaskGroup(of: Void.self) { taskGroup in
        taskGroup.addTask {
            do {
                account = try await dependency.apiRequestDriver.getAccount()
            } catch {
                dependency.logDriver.errorLog("\(error)")
                appError = error.toAppError
                showAlert = true
            }
        }
        
        taskGroup.addTask {
            do {
                talkThreads = try await dependency.apiRequestDriver.getTalkThreads()
            } catch {
                dependency.logDriver.errorLog("\(error)")
                appError = error.toAppError
                showAlert = true
            }
        }
    }
}
```

ã“ã®ã‚³ãƒ¼ãƒ‰ã§ã¯ã€`withTaskGroup` ã‚’ä½¿ç”¨ã—ã¦ã‚¿ã‚¹ã‚¯ã‚°ãƒ«ãƒ¼ãƒ—ã‚’ä½œæˆã—ã€ãã®ä¸­ã§ `getAccount` ã¨ `getTalkThreads` ã®å‘¼ã³å‡ºã—ã‚’ä¸¦åˆ—ã«å®Ÿè¡Œã—ã¾ã™ã€‚ãã‚Œãã‚Œã®ã‚¿ã‚¹ã‚¯ãŒã‚¨ãƒ©ãƒ¼ã‚’å‡¦ç†ã—ã€ãƒ­ã‚°ã‚’å‡ºåŠ›ã—ã€ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤ºã™ã‚‹å‡¦ç†ã‚’è¡Œã£ã¦ã„ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ä¸¡æ–¹ã®éåŒæœŸå‡¦ç†ãŒä¸¦åˆ—ã«å®Ÿè¡Œã•ã‚Œã€å…¨ä½“ã®å‡¦ç†æ™‚é–“ãŒçŸ­ç¸®ã•ã‚Œã¾ã™ã€‚

---

## ğŸ‘¤ ãƒ¦ãƒ¼ã‚¶ãƒ¼
*2024/07/26 14:12:32*

ã‚‚ã£ã¨ç°¡å˜ã«ã§ããªã„ã®ï¼Ÿ

---

## ğŸ¤– ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ
*2024/07/26 14:12:38*

ä¸¦åˆ—å‡¦ç†ã‚’ã•ã‚‰ã«ç°¡å˜ã«å®Ÿè£…ã™ã‚‹ãŸã‚ã«ã€`async let` ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€è¤‡æ•°ã®éåŒæœŸæ“ä½œã‚’ä¸¦è¡Œã—ã¦å®Ÿè¡Œã—ã€ãã‚Œã‚‰ã®çµæœã‚’å¾…ã¤ã“ã¨ãŒã§ãã¾ã™ã€‚ä»¥ä¸‹ã«ç°¡ç•¥åŒ–ã•ã‚ŒãŸã‚³ãƒ¼ãƒ‰ã‚’ç¤ºã—ã¾ã™ã€‚

```swift
func onAppear() async {
    dependency.logDriver.onAppearLog()

    isLoading = true
    defer {
        isLoading = false
    }

    do {
        async let accountResult = dependency.apiRequestDriver.getAccount()
        async let talkThreadsResult = dependency.apiRequestDriver.getTalkThreads()
        
        account = try await accountResult
        talkThreads = try await talkThreadsResult
    } catch {
        dependency.logDriver.errorLog("\(error)")
        appError = error.toAppError
        showAlert = true
    }
}
```

ã“ã®æ–¹æ³•ã§ã¯ã€`async let` ã‚’ä½¿ã£ã¦ `getAccount` ã¨ `getTalkThreads` ã®å‘¼ã³å‡ºã—ã‚’ä¸¦è¡Œã—ã¦å®Ÿè¡Œã—ã€ãã‚Œãã‚Œã®çµæœã‚’ `await` ã§å¾…ã¡ã¾ã™ã€‚ã©ã¡ã‚‰ã‹ã®ã‚¿ã‚¹ã‚¯ã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸå ´åˆã€ã‚­ãƒ£ãƒƒãƒãƒ–ãƒ­ãƒƒã‚¯ã§ã‚¨ãƒ©ãƒ¼ã‚’å‡¦ç†ã—ã¾ã™ã€‚ã“ã®æ–¹æ³•ã«ã‚ˆã‚Šã€ä¸¦åˆ—å‡¦ç†ãŒã•ã‚‰ã«ã‚·ãƒ³ãƒ—ãƒ«ã«å®Ÿè£…ã§ãã¾ã™ã€‚

---
