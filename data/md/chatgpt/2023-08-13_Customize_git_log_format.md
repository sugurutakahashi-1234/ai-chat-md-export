# Customize git log format

日付: 2023-08-13

---

## 👤 ユーザー
*2023/8/13 21:21:31*

以下みたいにgithubのlogのフォーマットの指定があるが、いろんなオプションを紹介して欲しい。とくにコミットメッセージの3行目とかを取得したい。

git log -5 --pretty=format:"%s"

---

## 🤖 アシスタント
*2023/8/13 21:22:13*

`git log` コマンドの `--pretty=format:` オプションは、ログのフォーマットをカスタマイズするための非常に強力な機能です。`format:` の後に続くプレースホルダーによって、さまざまなコミット情報を取得できます。

まず、基本的なプレースホルダーからいくつかを紹介します:

- `%H`: コミットハッシュ
- `%h`: 短縮コミットハッシュ
- `%an`: 作者の名前
- `%ae`: 作者のメールアドレス
- `%cn`: コミッターの名前
- `%ce`: コミッターのメールアドレス
- `%cd`: コミット日付
- `%s`: コミットのサブジェクト(一行目)
- `%b`: コミットのボディ(コミットメッセージの一行目の次から)

特にコミットメッセージの3行目を取得したい場合は、直接的な方法は用意されていませんが、以下のような方法で取得できるでしょう:

```bash
git log -5 --pretty=format:"%b" | awk 'NR % 2 == 1'
```

ここで、`awk 'NR % 2 == 1'` は、`%b` で取得されるコミットのボディから奇数行（1行目、3行目、5行目...）だけを取得するものです。もし、コミットメッセージが常に同じフォーマット（例えば、タイトル、空白の行、そして詳細の行）であれば、この方法で3行目を取得できるでしょう。

ただし、全てのコミットメッセージが同じフォーマットを持っているとは限らないので、実際のリポジトリの状態に応じて適切なコマンドを使用することが必要です。

---

## 👤 ユーザー
*2023/8/13 21:41:43*

標準出力結果について、1行ずつ改行する方法をおしえてほしい

---

## 🤖 アシスタント
*2023/8/13 21:42:18*

標準出力の結果を1行ずつ改行して表示する場合、特別な手段を講じる必要は基本的にありません。というのも、多くのコマンドやプログラムは、デフォルトで結果を1行ずつ改行して出力します。

ただし、あるコマンドやプログラムが改行を挟まずに連続的にデータを出力する場合や、あるいは改行を用いずにデータを区切る場合など、期待した出力形式と異なる場合があります。そのような場合には、出力を整形するツールを使用して改行を追加することができます。

例えば、スペースやカンマで区切られた文字列を1行ずつの出力に整形したい場合、`tr` コマンドや `awk` コマンドを使用することができます。

1. `tr` コマンドを使用してスペースやカンマで区切られた文字列を改行に置き換える方法:

```bash
echo "apple orange,banana,grape" | tr " ,"
" \n"
```

2. `awk` コマンドを使用してスペースで区切られた文字列を改行に置き換える方法:

```bash
echo "apple orange banana grape" | awk '{ for(i=1; i<=NF; i++) print $i }'
```

これらの方法を使用すると、出力の各データが1行ずつ改行されて表示されます。

---

## 👤 ユーザー
*2023/8/13 21:42:37*

さらにただ、1行改行させたいだけいなんだ

---

## 🤖 アシスタント
*2023/8/13 21:42:55*

了解しました。標準出力の後に単純に1行改行を追加したい場合、以下のように`echo`コマンドを使用して空の行を追加することができます。

例:

```bash
echo "これはテストです。" ; echo
```

このコマンドは、"これはテストです。"を出力した後に、空の行を出力します。

また、コマンドの出力結果に対して改行を追加したい場合は、以下のようにパイプラインを使用することもできます。

例:

```bash
echo "これはテストです。" | { cat; echo; }
```

このコマンドは、`echo`コマンドの出力を`cat`コマンドでそのまま表示し、その後に`echo`コマンドを使って1行の空の行を追加しています。

---

## 👤 ユーザー
*2023/8/13 21:43:22*

3行の出力があったらマイ行改行を入れて6行にしたいんだ。

---

## 🤖 アシスタント
*2023/8/13 21:43:42*

3行の出力の間に毎回改行を挿入して、合計6行にしたい場合、`awk`を使用すると効率的に行うことができます。

例として、次のような3行の出力があるとします。

```
行1
行2
行3
```

この出力に毎行の後に改行を追加するには、以下の`awk`コマンドを使用します。

```bash
echo -e "行1\n行2\n行3" | awk '1; {print ""}'
```

このコマンドの結果、次の6行の出力が得られます。

```
行1

行2

行3

```

`awk`の`1;`は、入力行をそのまま出力する意味で、その後の`{print ""}`が改行を追加します。この結果、元の各行の後に空の行が追加され、合計6行の出力が得られます。

---

## 👤 ユーザー
*2023/8/13 21:44:24*

2行改行を入れたくてどうすればいい

---

## 🤖 アシスタント
*2023/8/13 21:44:36*

2行の改行を毎回挿入したい場合、`awk`を使って以下のようにします。

```bash
echo -e "行1\n行2\n行3" | awk '1; {print "\n"}'
```

このコマンドは、各行の後に2行の改行を追加します。結果として、次のような出力が得られます。

```
行1


行2


行3


```

`awk`の`1;`は入力行をそのまま出力する意味で、その後の`{print "\n"}`が2行の改行を追加します。

---

## 👤 ユーザー
*2023/8/13 21:45:43*

git log -10 --date=short --pretty=format:"\[%ad\] %s %b" | grep "Merge pull request" | awk '1; {print "\\n"}'

について、\[%ad\] %s %b についてそれぞれ改行いれたい。

---

## 🤖 アシスタント
*2023/8/13 21:46:08*

指定した`git log`のフォーマットオプションで、`[%ad] %s %b`の各部分に改行を挿入したい場合、次のように変更できます。

```bash
git log -10 --date=short --pretty=format:"[%ad]\n%s\n%b"
```

このコマンドは以下のような形式で出力されます：

```
[2023-08-13]
コミットのタイトル
コミットのボディ内容
```

この出力に対して、さらに`grep`と`awk`を適用して、"Merge pull request"を含む行の後に2行の改行を追加する場合、以下のようにコマンドを組み合わせます。

```bash
git log -10 --date=short --pretty=format:"[%ad]\n%s\n%b" | grep "Merge pull request" -A 2 | awk '1; {print "\n"}'
```

ここで、`grep -A 2`はマッチした行の後に2行を追加して出力するオプションです。この場合、"Merge pull request"という文字列を含む行と、それに続く2行（タイトルとボディ）を出力します。その後、`awk`を使用して各行の後に改行を追加します。

---

## 👤 ユーザー
*2023/8/13 21:46:41*

以下になってしまった。

\[2023-08-13\]\\n#546 ドキュメントやCI/CDの整理\\n

---

## 🤖 アシスタント
*2023/8/13 21:46:58*

失礼しました。説明とコマンドの調整に混乱が生じたようです。

ご希望の結果を得るためには、次のようにコマンドを修正します：

1. `git log`コマンドで所望のフォーマットでログを取得。
2. `grep`で"Merge pull request"を含む行をフィルタリング。
3. `awk`で各行の後に1行の改行を追加。

```bash
git log -10 --date=short --pretty=format:"[%ad]\n%s\n%b" | grep "Merge pull request" -A 2 | awk '1; {print ""}'
```

このコマンドを実行すると、次のような出力が得られるはずです：

```
[2023-08-13]
#546 ドキュメントやCI/CDの整理

...
```

ご希望の出力が得られるか、試してみてください。

---

## 👤 ユーザー
*2023/8/13 21:47:25*

いや、\\n がうまくかいぎょうできていないみたい。

---

## 🤖 アシスタント
*2023/8/13 21:47:40*

申し訳ございません。私の説明が間違っていました。

`\n` は、実際の文字列として表示されてしまうので、正しい改行を生成するためには、`git log` のフォーマット部分の改行の挿入方法を変更する必要があります。

以下のコマンドを試してみてください：

```bash
git log -10 --date=short --pretty=format:"[%ad]%n%s%n%b" | grep "Merge pull request" -A 2 | awk '1; {print ""}'
```

ここで `%n` は、`git log` の `--pretty=format:` オプション内で改行を挿入するためのプレースホルダーです。

このコマンドで期待する出力が得られるはずです。

---
