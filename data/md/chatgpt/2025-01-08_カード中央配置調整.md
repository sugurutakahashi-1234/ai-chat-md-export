# ã‚«ãƒ¼ãƒ‰ä¸­å¤®é…ç½®èª¿æ•´

æ—¥ä»˜: 2025-01-08

---

## ğŸ‘¤ ãƒ¦ãƒ¼ã‚¶ãƒ¼
*2025/01/08 19:23:40*

{
  "content_type": "image_asset_pointer",
  "asset_pointer": "file-service://file-4t5DHqotmP3dd6oAoVpbJV",
  "size_bytes": 333842,
  "width": 1236,
  "height": 1150,
  "fovea": null,
  "metadata": {
    "dalle": null,
    "gizmo": null,
    "generation": null,
    "container_pixel_height": null,
    "container_pixel_width": null,
    "emu_omit_glimpse_image": null,
    "emu_patches_override": null,
    "sanitized": true,
    "asset_pointer_link": null,
    "watermarked_asset_pointer": null
  }
}
{
  "content_type": "image_asset_pointer",
  "asset_pointer": "file-service://file-2bDYSABpQ2j72Bu3y32TZu",
  "size_bytes": 203929,
  "width": 766,
  "height": 784,
  "fovea": null,
  "metadata": {
    "dalle": null,
    "gizmo": null,
    "generation": null,
    "container_pixel_height": null,
    "container_pixel_width": null,
    "emu_omit_glimpse_image": null,
    "emu_patches_override": null,
    "sanitized": true,
    "asset_pointer_link": null,
    "watermarked_asset_pointer": null
  }
}
2æšç›®ãŒç¾æ™‚ç‚¹ã§ã®å®Ÿè£…ã§ã‚ã‚‹ãŒã€1æšç›®ã®ã‚ˆã†ã«å®Ÿè£…ã—ãŸã„ã€‚
ã‚«ãƒ¼ãƒ‰ã®å¹…ã‚’ç”»é¢ã®æ¨ªå¹…ã®horizonã®32ã®ä½™ç™½ã‚’æŒã¤æ¨ªå¹…ã«ã—ã¦ã»ã—ã„ã€‚
ã¾ãŸã€ã‚«ãƒ¼ãƒ‰ã®ä¸‹å´ã®ä½™ç™½ã‚’ç„¡ãã—ã¦ã»ã—ã„ã®ã¨ä¸­å¤®ã«é…ç½®ã—ã¦ã»ã—ã„ã€‚

import 'package:carousel_slider/carousel_slider.dart';
import 'package:flutter/material.dart';
import 'package:flutter_hooks/flutter_hooks.dart';
import 'package:geolocator/geolocator.dart';
import 'package:go_router/go_router.dart';
import 'package:google_maps_flutter/google_maps_flutter.dart';
import 'package:hooks_riverpod/hooks_riverpod.dart';
import 'package:snpit_guild_app/infrastructure/snapit_guild_api/snapit_guild_api.openapi.dart';
import 'package:snpit_guild_app/presentation/design_token/color_token.dart';
import 'package:snpit_guild_app/presentation/providers/api_client/explorers/get_explorer_info.dart';
import 'package:snpit_guild_app/presentation/providers/api_client/explorers/update_explorer.dart';

class ExplorerListPage extends HookConsumerWidget {
  const ExplorerListPage({super.key});

  @override
  Widget build(BuildContext context, WidgetRef ref) {
    final selectedExplorerIndex = useState(0);
    final explorerState = ref.watch(getExplorerNotifierProvider);

    useEffect(
      () {
        WidgetsBinding.instance.addPostFrameCallback((_) {
          ref.read(getExplorerNotifierProvider.notifier).executeRequest();
        });
        return null;
      },
      [],
    );

    Widget buildExplorerCard(ExplorerDTO explorer, {required bool isSelected}) {
      final imageUrl = explorer.explorerImage?.isNotEmpty == true
          ? explorer.explorerImage
          : null;

      return Card(
        shape: RoundedRectangleBorder(
          borderRadius: BorderRadius.circular(16),
          side: BorderSide(
            color: isSelected ? ColorToken.primary : ColorToken.secondary,
          ),
        ),
        color: ColorToken.bg,
        elevation: 4,
        child: Padding(
          padding: const EdgeInsets.all(16),
          child: Column(
            crossAxisAlignment: CrossAxisAlignment.start,
            children: [
              Row(
                children: [
                  ClipRRect(
                    borderRadius: BorderRadius.circular(8),
                    child: imageUrl != null
                        ? Image.network(
                            imageUrl,
                            height: 120,
                            width: 120,
                            fit: BoxFit.cover,
                            errorBuilder: (context, error, stackTrace) {
                              return Container(
                                width: 120,
                                height: 120,
                                color: ColorToken.bgDark,
                                child: const Icon(
                                  Icons.broken_image_outlined,
                                  size: 96,
                                  color: ColorToken.text,
                                ),
                              );
                            },
                          )
                        : Container(
                            width: 120,
                            height: 120,
                            color: ColorToken.bgDark,
                            child: const Icon(
                              Icons.hide_image_outlined,
                              size: 96,
                              color: ColorToken.text,
                            ),
                          ),
                  ),
                  Expanded(
                    child: Column(
                      mainAxisSize: MainAxisSize.min,
                      crossAxisAlignment: CrossAxisAlignment.start,
                      children: [
                        const Text(
                          'Life',
                          style: TextStyle(
                            fontSize: 14,
                            color: ColorToken.border,
                          ),
                        ),
                        const SizedBox(height: 4),
                        LinearProgressIndicator(
                          value: (explorer.energy ?? 0) / 100,
                          valueColor: const AlwaysStoppedAnimation&lt;Color&gt;(
                            ColorToken.primary,
                          ),
                          backgroundColor: ColorToken.bgDark,
                        ),
                        const SizedBox(height: 12),
                        const Text(
                          'Search range',
                          style: TextStyle(
                            fontSize: 14,
                            color: ColorToken.border,
                          ),
                        ),
                        const SizedBox(height: 4),
                        Text(
                          '${explorer.range ?? 0}km radius',
                          style: const TextStyle(
                            fontSize: 14,
                          ),
                        ),
                        const SizedBox(height: 12),
                        Text(
                          explorer.explorerDescription ?? 'No description',
                          style: const TextStyle(
                            fontSize: 12,
                          ),
                        ),
                      ],
                    ),
                  ),
                ],
              ),
            ],
          ),
        ),
      );
    }

    return Scaffold(
      appBar: AppBar(
        automaticallyImplyLeading: false,
        title: const Text('Select explorer'),
        actions: [
          IconButton(
            onPressed: () =&gt; context.pop(),
            icon: const Icon(Icons.close),
          ),
        ],
      ),
      body: explorerState.when(
        data: (explorers) {
          if ((explorers ?? []).isEmpty) {
            return const Center(child: Text('No explorers available.'));
          }

          return Column(
            children: [
              Expanded(
                child: CarouselSlider.builder(
                  options: CarouselOptions(
                    onPageChanged: (index, reason) {
                      selectedExplorerIndex.value = index;
                    },
                  ),
                  itemCount: explorers?.length ?? 0,
                  itemBuilder: (context, index, realIndex) {
                    final explorer = explorers?[index];
                    final isSelected = index == selectedExplorerIndex.value;

                    return Padding(
                      padding: const EdgeInsets.symmetric(horizontal: 8),
                      child: explorer != null
                          ? buildExplorerCard(explorer, isSelected: isSelected)
                          : null,
                    );
                  },
                ),
              ),
            ],
          );
        },
        loading: () =&gt; const Center(child: CircularProgressIndicator()),
        error: (error, _) =&gt; Center(child: Text('Error: $error')),
      ),
      bottomNavigationBar: SafeArea(
        child: Padding(
          padding: const EdgeInsets.all(16),
          child: ElevatedButton(
            onPressed: () async {
              final explorers = explorerState.value;
              if (explorers != null && explorers.isNotEmpty) {
                final position = await Geolocator.getCurrentPosition();
                final selectedExplorer = explorers[selectedExplorerIndex.value];
                await ref.read(updateExplorerNotifierProvider.notifier).search(
                      selectedExplorer.explorerId!,
                      LatLng(position.latitude, position.longitude),
                    );
              }

              if (context.mounted) {
                context.pop();
              }
            },
            child: const Text('Start explore'),
          ),
        ),
      ),
    );
  }
}

---

## ğŸ¤– ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ
*2025/01/08 19:24:45*

ä»¥ä¸‹ã®ãƒã‚¤ãƒ³ãƒˆã‚’æŠ¼ã•ãˆã‚‹ã“ã¨ã§ã€

1. **ã‚«ãƒ¼ãƒ‰å¹…ã‚’ç”»é¢æ¨ªå¹…âˆ’å·¦å³32pxï¼ˆåˆè¨ˆ64pxï¼‰ã«ã™ã‚‹**  
2. **ã‚«ãƒ¼ãƒ‰ã®ä¸‹ä½™ç™½ã‚’ãªãã™**  
3. **ä¸­å¤®ã«é…ç½®ã™ã‚‹**

ã¨ã„ã£ãŸè¦ä»¶ã‚’æº€ãŸã›ã¾ã™ã€‚

---

## ã‚«ã‚®ã¨ãªã‚‹è¨­å®š

1. **`Card`ã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆã®`margin`ã‚’ã‚¼ãƒ­ã«ã™ã‚‹**  
   - `Card`ã«ã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§4pxç¨‹åº¦ã®ãƒãƒ¼ã‚¸ãƒ³ãŒä»˜ã„ã¦ã„ã¾ã™ã€‚ã“ã‚Œã‚’æ¶ˆã™ãŸã‚ã« `margin: EdgeInsets.zero` ã‚’è¨­å®šã—ã¾ã™ã€‚  

2. **ä¸Šä¸‹ä½™ç™½ã®èª¿æ•´**  
   - ã‚«ãƒ¼ãƒ‰è‡ªä½“ã®ä¸‹ä½™ç™½ã‚’ãªãã—ãŸã„å ´åˆã¯ã€`Card`ã®å¤–å´ï¼ˆä¾‹ãˆã° `Padding` ã‚„ `Margin`) ã‚’å«ã‚ã€ä¸è¦ãªä¸Šä¸‹ã®ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°ã‚’ã‚¼ãƒ­ã«ã™ã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚

3. **å·¦å³32pxåˆ†ã‚’ç¢ºä¿ã—ãŸå¹…ã«ã™ã‚‹**  
   - `CarouselSlider` ã® `viewportFraction` ã‚’ä½¿ã†æ–¹æ³•  
     - ç”»é¢å¹…ã«å¯¾ã—ã¦ã€Œå·¦å³ã§åˆè¨ˆ32pxã®ä½™ç™½ã‚’é™¤ã„ãŸå‰²åˆã€ã«ã—ã¾ã™ã€‚ä¾‹ãˆã°ç”»é¢å¹…ã‚’ `W` ã¨ã™ã‚‹ã¨ `(W - 64) / W` ãŒã‚«ãƒ¼ãƒ‰å¹…ã®å‰²åˆã«ãªã‚Šã¾ã™ã€‚  
     - ãŸã ã—ã€å®Ÿæ©Ÿã«ã‚ˆã£ã¦ç”»é¢å¹…ãŒç•°ãªã‚‹ãŸã‚ã€ç´°ã‹ã„åˆ¶å¾¡ãŒå¿…è¦ãªå ´åˆã¯ `LayoutBuilder` ã‚„ `MediaQuery` ã‚’ç”¨ã„ã¦å‹•çš„ã«è¨ˆç®—ã™ã‚‹æ–¹æ³•ã‚‚ã‚ã‚Šã¾ã™ã€‚
   - `CarouselSlider` ã® `enlargeCenterPage` ã‚’ä½¿ã†/ä½¿ã‚ãªã„  
     - ä¸­å¤®ã«æ‹¡å¤§è¡¨ç¤ºã—ãŸã„å ´åˆã¯ `enlargeCenterPage: true` ã‚’ä½¿ã„ã€æ‹¡å¤§ã¯ä¸è¦ã§ãŸã ä¸­å¤®é…ç½®ã ã‘ã«ã—ãŸã„å ´åˆã¯ã‚ªãƒ•ã«ã—ã€`viewportFraction` ã ã‘ã§èª¿æ•´ã—ã¾ã™ã€‚  
   - `Padding` ã®ã¿ã§èª¿æ•´ã™ã‚‹æ–¹æ³•  
     - `itemBuilder` å†…ã§ `SizedBox(width: MediaQuery.of(context).size.width - 64, child: Card(...))` ã®ã‚ˆã†ã«ã—ã¦ã€å·¦å³ã«32pxãšã¤ç©ºã‘ã‚‹æ–¹æ³•ã‚‚ã‚ã‚Šã¾ã™ã€‚

---

## å®Ÿè£…ä¾‹

ä»¥ä¸‹ã®ä¾‹ã§ã¯ã€

- ã‚«ãƒ¼ãƒ‰ã®å¹…ãŒç”»é¢å¹…ã‹ã‚‰å·¦å³32px(è¨ˆ64px)ã‚’å¼•ã„ãŸã‚µã‚¤ã‚ºã«ãªã‚‹ã‚ˆã†ã«  
- ã‚«ãƒ¼ãƒ‰ä¸‹ä½™ç™½ã‚’ãªãã—ã€ä¸­å¤®ã«è¡¨ç¤º  
- ãƒšãƒ¼ã‚¸åˆ‡ã‚Šæ›¿ãˆæ™‚ã«ã¯ä¸­å¤®ã«ã‚«ãƒ¼ã‚½ãƒ«ãŒåˆã†ã‚ˆã†ã«  

ã¨ã„ã†è¨­å®šã‚’ã—ã¦ã„ã¾ã™ã€‚

```dart
import 'package:carousel_slider/carousel_slider.dart';
import 'package:flutter/material.dart';
import 'package:flutter_hooks/flutter_hooks.dart';
import 'package:geolocator/geolocator.dart';
import 'package:go_router/go_router.dart';
import 'package:google_maps_flutter/google_maps_flutter.dart';
import 'package:hooks_riverpod/hooks_riverpod.dart';
import 'package:snpit_guild_app/infrastructure/snapit_guild_api/snapit_guild_api.openapi.dart';
import 'package:snpit_guild_app/presentation/design_token/color_token.dart';
import 'package:snpit_guild_app/presentation/providers/api_client/explorers/get_explorer_info.dart';
import 'package:snpit_guild_app/presentation/providers/api_client/explorers/update_explorer.dart';

class ExplorerListPage extends HookConsumerWidget {
  const ExplorerListPage({super.key});

  @override
  Widget build(BuildContext context, WidgetRef ref) {
    final selectedExplorerIndex = useState(0);
    final explorerState = ref.watch(getExplorerNotifierProvider);

    useEffect(() {
      WidgetsBinding.instance.addPostFrameCallback((_) {
        ref.read(getExplorerNotifierProvider.notifier).executeRequest();
      });
      return null;
    }, []);

    Widget buildExplorerCard(
      ExplorerDTO explorer, {
      required bool isSelected,
    }) {
      final imageUrl =
          explorer.explorerImage?.isNotEmpty == true ? explorer.explorerImage : null;

      return Card(
        // â˜… ã‚«ãƒ¼ãƒ‰å¤–å´ã®ä½™ç™½ã‚’æ¶ˆã™
        margin: EdgeInsets.zero,
        shape: RoundedRectangleBorder(
          borderRadius: BorderRadius.circular(16),
          side: BorderSide(
            color: isSelected ? ColorToken.primary : ColorToken.secondary,
          ),
        ),
        color: ColorToken.bg,
        elevation: 4,
        child: Padding(
          padding: const EdgeInsets.all(16),
          child: Column(
            // ä¸‹éƒ¨ã«ä½™ç™½ã‚’ä½œã‚ŠãŸããªã„å ´åˆãªã©ã¯ã“ã“ã§é…ç½®ã‚’è¦‹ç›´ã™
            crossAxisAlignment: CrossAxisAlignment.start,
            children: [
              Row(
                children: [
                  ClipRRect(
                    borderRadius: BorderRadius.circular(8),
                    child: imageUrl != null
                        ? Image.network(
                            imageUrl,
                            height: 120,
                            width: 120,
                            fit: BoxFit.cover,
                            errorBuilder: (context, error, stackTrace) {
                              return Container(
                                width: 120,
                                height: 120,
                                color: ColorToken.bgDark,
                                child: const Icon(
                                  Icons.broken_image_outlined,
                                  size: 96,
                                  color: ColorToken.text,
                                ),
                              );
                            },
                          )
                        : Container(
                            width: 120,
                            height: 120,
                            color: ColorToken.bgDark,
                            child: const Icon(
                              Icons.hide_image_outlined,
                              size: 96,
                              color: ColorToken.text,
                            ),
                          ),
                  ),
                  const SizedBox(width: 16),
                  Expanded(
                    child: Column(
                      crossAxisAlignment: CrossAxisAlignment.start,
                      children: [
                        const Text(
                          'Life',
                          style: TextStyle(
                            fontSize: 14,
                            color: ColorToken.border,
                          ),
                        ),
                        const SizedBox(height: 4),
                        LinearProgressIndicator(
                          value: (explorer.energy ?? 0) / 100,
                          valueColor: const AlwaysStoppedAnimation<Color>(
                            ColorToken.primary,
                          ),
                          backgroundColor: ColorToken.bgDark,
                        ),
                        const SizedBox(height: 12),
                        const Text(
                          'Search range',
                          style: TextStyle(
                            fontSize: 14,
                            color: ColorToken.border,
                          ),
                        ),
                        const SizedBox(height: 4),
                        Text(
                          '${explorer.range ?? 0}km radius',
                          style: const TextStyle(fontSize: 14),
                        ),
                        const SizedBox(height: 12),
                        Text(
                          explorer.explorerDescription ?? 'No description',
                          style: const TextStyle(fontSize: 12),
                        ),
                      ],
                    ),
                  ),
                ],
              ),
            ],
          ),
        ),
      );
    }

    return Scaffold(
      appBar: AppBar(
        automaticallyImplyLeading: false,
        title: const Text('Select explorer'),
        actions: [
          IconButton(
            onPressed: () => context.pop(),
            icon: const Icon(Icons.close),
          ),
        ],
      ),
      body: explorerState.when(
        data: (explorers) {
          if ((explorers ?? []).isEmpty) {
            return const Center(child: Text('No explorers available.'));
          }

          return Column(
            children: [
              Expanded(
                child: CarouselSlider.builder(
                  itemCount: explorers?.length ?? 0,
                  itemBuilder: (context, index, realIndex) {
                    final explorer = explorers?[index];
                    final isSelected = index == selectedExplorerIndex.value;
                    if (explorer == null) return const SizedBox();

                    return Center(
                      // â˜… ã‚«ãƒ¼ãƒ‰ã®å¹…ã‚’ç”»é¢å¹… - 64 ã«å›ºå®šã—ã€å·¦å³32pxãšã¤ä½™ç™½ã‚’ç¢ºä¿
                      child: SizedBox(
                        width: MediaQuery.of(context).size.width - 64,
                        child: buildExplorerCard(explorer, isSelected: isSelected),
                      ),
                    );
                  },
                  options: CarouselOptions(
                    // ã‚«ãƒ¼ãƒ‰ã‚’çœŸã‚“ä¸­ã«é…ç½® & ã‚¹ãƒ©ã‚¤ãƒ‰åˆ‡ã‚Šæ›¿ãˆæ™‚ã®ã‚¢ãƒ‹ãƒ¡ã‚’è¨­å®š
                    enlargeCenterPage: false, // å¿…è¦ã§ã‚ã‚Œã°trueã«ã™ã‚‹ã¨ä¸­å¤®ã®ã¿æ‹¡å¤§
                    enableInfiniteScroll: false,
                    // ç”»é¢å¹…ã«å¯¾ã™ã‚‹ã‚«ãƒ¼ãƒ‰ã®å æœ‰å‰²åˆã‚’è¨­å®š
                    // viewportFractionã‚’ (ç”»é¢å¹… - 64)/ç”»é¢å¹… ã«åˆã‚ã›ã¦ã‚‚OK
                    viewportFraction: 1.0, 
                    onPageChanged: (index, reason) {
                      selectedExplorerIndex.value = index;
                    },
                  ),
                ),
              ),
            ],
          );
        },
        loading: () => const Center(child: CircularProgressIndicator()),
        error: (error, _) => Center(child: Text('Error: $error')),
      ),
      bottomNavigationBar: SafeArea(
        child: Padding(
          padding: const EdgeInsets.all(16),
          child: ElevatedButton(
            onPressed: () async {
              final explorers = explorerState.value;
              if (explorers != null && explorers.isNotEmpty) {
                final position = await Geolocator.getCurrentPosition();
                final selectedExplorer = explorers[selectedExplorerIndex.value];
                await ref.read(updateExplorerNotifierProvider.notifier).search(
                      selectedExplorer.explorerId!,
                      LatLng(position.latitude, position.longitude),
                    );
              }

              if (context.mounted) {
                context.pop();
              }
            },
            child: const Text('Start explore'),
          ),
        ),
      ),
    );
  }
}
```

### ãƒã‚¤ãƒ³ãƒˆè§£èª¬

- **`SizedBox` ã§å¹…ã‚’ `MediaQuery.of(context).size.width - 64`**  
  ã“ã‚Œã«ã‚ˆã‚Šã€å·¦å³ã«32pxãšã¤ä½™ç™½ãŒç”Ÿã¾ã‚Œã€ã‚«ãƒ¼ãƒ‰ã®å¹…ãŒã€Œç”»é¢å¹… - 64ã€ã«å›ºå®šã•ã‚Œã¾ã™ã€‚

- **`Card(margin: EdgeInsets.zero)`**  
  ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã® `Card` ãƒãƒ¼ã‚¸ãƒ³ã‚’å‰Šé™¤ã—ã¦ã€ä¸è¦ãªä½™ç™½ã‚’ãªãã—ã¦ã„ã¾ã™ã€‚

- **`CarouselOptions(viewportFraction: 1.0)`**  
  `viewportFraction` ã‚’ `1.0` ã«ã™ã‚‹ã“ã¨ã§ã€ã‚¹ãƒ©ã‚¤ãƒ‰1æšã‚ãŸã‚Šç”»é¢å¹…ã„ã£ã±ã„ã«ä½¿ã†ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚ãã®ã†ãˆã§ `SizedBox` ã§å®Ÿéš›ã®ã‚«ãƒ¼ãƒ‰å¹…ã‚’åˆ¶å¾¡ã—ã¦ã„ã‚‹ã®ã§ã€çµæœçš„ã«ä¸­å¤®ã«ãã‚ã£ãŸã‚«ãƒ¼ãƒ‰è¡¨ç¤ºã«ãªã‚Šã¾ã™ã€‚

- **ä¸‹å´ã®ä½™ç™½ã‚’ãªãã™**  
  ã‚«ãƒ¼ãƒ‰ä¸‹éƒ¨ã«ä½™ç™½ã‚’ä»˜ã‘ã‚‹ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°ã‚„`SizedBox(height: ...)` ã‚’å…¥ã‚Œã¦ã„ãªã„ãŸã‚ã€ä¸‹éƒ¨ã®ä½™ç™½ãŒã‚ã‚Šã¾ã›ã‚“ã€‚ã‚‚ã—è¦ªã®ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆå´ã§ä½™ç™½ãŒã§ãã¦ã„ã‚‹å ´åˆã¯ã€ãã®ç®‡æ‰€ã‚’èª¿æ•´ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

ä¸Šè¨˜ã‚’å‚è€ƒã«èª¿æ•´ã™ã‚Œã°ã€
- **å·¦å³32pxã®ä½™ç™½**  
- **ä¸‹ä½™ç™½ã‚¼ãƒ­**  
- **ä¸­å¤®é…ç½®**  

ãŒå®Ÿç¾ã§ãã¾ã™ã€‚ãŠè©¦ã—ãã ã•ã„ã€‚

---

## ğŸ‘¤ ãƒ¦ãƒ¼ã‚¶ãƒ¼
*2025/01/08 22:02:35*

SizedBox ä½¿ã£ã¦ã‚‚ã‚µã‚¤ã‚ºãŒæŒ‡å®šã§ããªã‹ã£ãŸ

---

## ğŸ¤– ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ
*2025/01/08 22:03:13*

CarouselSlider ã¯å†…éƒ¨ã§ç‹¬è‡ªã®ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆåˆ¶å¾¡ã‚’è¡Œã†ãŸã‚ã€å˜ã« `SizedBox(width: xxx)` ã‚’é…ç½®ã—ã¦ã‚‚æ€ã£ãŸé€šã‚Šã«ã‚µã‚¤ã‚ºãŒåæ˜ ã•ã‚Œãªã„ã‚±ãƒ¼ã‚¹ãŒã‚ã‚Šã¾ã™ã€‚  

Flutter ã§ã¯ **ã€Œè¦ªå­ã®åˆ¶ç´„ã€** ã«ã‚ˆã£ã¦ã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆã®ã‚µã‚¤ã‚ºãŒæ±ºã¾ã‚‹ãŸã‚ã€CarouselSlider ã‹ã‚‰ã©ã®ã‚ˆã†ãªåˆ¶ç´„ãŒã‹ã‹ã£ã¦ã„ã‚‹ã‹ã‚’ç†è§£ã—ã¦ãŠãå¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚  

ä»¥ä¸‹ã®ã‚ˆã†ãªæ–¹æ³•ã‚’è©¦ã™ã¨ã€ã‚«ãƒ¼ãƒ‰å¹…ã‚’ã†ã¾ãå›ºå®šã§ãã‚‹å¯èƒ½æ€§ãŒé«˜ã„ã§ã™ã€‚

---

## 1. `viewportFraction` ã‚’ä½¿ã£ã¦ã‚«ãƒ¼ãƒ‰å¹…ã‚’åˆ¶å¾¡ã™ã‚‹

`CarouselOptions` ã® `viewportFraction` ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã§ã€Œç”»é¢å¹…ã«å¯¾ã—ã¦ã©ã®ãã‚‰ã„ã®å‰²åˆã‚’è¡¨ç¤ºã™ã‚‹ã‹ã€ã‚’æŒ‡å®šã—ã¾ã™ã€‚

ãŸã¨ãˆã°ã€
```dart
viewportFraction: 0.9,
```
ã¨ã™ã‚Œã° **ç”»é¢å¹…ã® 90%** ã®å¹…ã§ã‚«ãƒ¼ãƒ‰ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚å·¦å³ã® 10% ã¯ä½™ç™½ï¼ˆã¾ãŸã¯ä»–ã®ã‚«ãƒ¼ãƒ‰ã®ä¸€éƒ¨ï¼‰ã¨ã—ã¦è¦‹ãˆã¾ã™ã€‚

#### ç”»é¢å¹… - 64px åˆ†ã‚’å‰²åˆã§è¨ˆç®—ã™ã‚‹

å·¦å³ã« 32px ãšã¤ä½™ç™½ã‚’ã¨ã£ã¦åˆè¨ˆ 64px ã‚’ç©ºã‘ãŸã„å ´åˆã€ç”»é¢å¹…ã‚’ `W` ã¨ã™ã‚‹ã¨

```
(W - 64) / W
```

ãŒãã®ã¾ã¾å‰²åˆã«ãªã‚Šã¾ã™ã€‚ ç”»é¢å¹…ãŒ 360px ã®å ´åˆã‚’ä¾‹ã«ã™ã‚‹ã¨

```
(360 - 64) / 360 = 296 / 360 â‰ˆ 0.82
```

ã“ã®å€¤ã‚’ `viewportFraction` ã«è¨­å®šã—ã¦ã¿ã¦ãã ã•ã„ã€‚

```dart
CarouselSlider.builder(
  options: CarouselOptions(
    viewportFraction: (MediaQuery.of(context).size.width - 64) /
        MediaQuery.of(context).size.width,
    // ä¾‹: enlargeCenterPage ãªã©ã¯ãŠå¥½ã¿ã§
    enlargeCenterPage: false,
  ),
  itemCount: ...,
  itemBuilder: (context, index, realIndex) {
    return Card(/* ... */);
  },
)
```

ã“ã‚Œã§ã‚«ãƒ¼ãƒ‰ä¸€æšã‚ãŸã‚ŠãŒã€Œç”»é¢å¹… - 64pxã€ã®å¤§ãã•ã‚’åŸºæº–ã«é…ç½®ã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚  

- `enlargeCenterPage: false` ã«ã™ã‚‹ã¨ä¸­å¤®æ‹¡å¤§ãŒç„¡åŠ¹ã«ãªã‚‹ãŸã‚ã€ã¡ã‚‡ã†ã©å·¦å³ 32px ãŒä½™ã‚‹ã‚ˆã†ã«è¦‹ãˆã‚„ã™ããªã‚Šã¾ã™ã€‚  
- `enlargeCenterPage: true` ã‚’ä½¿ã„ãŸã„å ´åˆã¯ã€æ‹¡å¤§ç‡ã§ã¾ãŸè¦‹ãŸç›®ãŒå¤‰ã‚ã‚‹ã®ã§ãƒãƒ©ãƒ³ã‚¹ã‚’è¦‹ãªãŒã‚‰èª¿æ•´ãŒå¿…è¦ã§ã™ã€‚

---

## 2. `itemWidth` ã¨ `itemHeight` ã‚’æŒ‡å®šã™ã‚‹

`CarouselOptions` ã®ä¸­ã«ã¯ã€`viewportFraction` ä»¥å¤–ã« `itemWidth` ã‚„ `itemHeight` ã‚‚å­˜åœ¨ã—ã¾ã™ã€‚ã“ã‚Œã‚‰ã¯ **å›ºå®šãƒ”ã‚¯ã‚»ãƒ«** ã§ã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆå¹…ã‚„é«˜ã•ã‚’æ±ºã‚ãŸã„ã¨ãã«ä½¿ã„ã¾ã™ã€‚

```dart
CarouselSlider.builder(
  options: CarouselOptions(
    // ãŸã¨ãˆã° ã€Œç”»é¢å¹… - 64pxã€ ã‚’ãã®ã¾ã¾æŒ‡å®š
    itemWidth: MediaQuery.of(context).size.width - 64,
    // é«˜ã•ã‚‚å›ºå®šã—ãŸã„å ´åˆ
    itemHeight: 400,
    enlargeCenterPage: false,
    enableInfiniteScroll: false,
  ),
  itemCount: ...,
  itemBuilder: (context, index, realIndex) {
    return Card(/* ... */);
  },
)
```

- `itemWidth` ã‚’æŒ‡å®šã™ã‚‹ã¨ã€CarouselSlider å´ã¯ã€Œ1 ã¤ã®ã‚«ãƒ¼ãƒ‰ã®å¹…ã¯ã“ã‚Œã€ã¨è§£é‡ˆã—ã€ã‚¹ãƒ©ã‚¤ãƒ‰ã‚’ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã—ã¾ã™ã€‚  
- `viewportFraction` ã¨ `itemWidth` ã¯åŒæ™‚ã«æŒ‡å®šã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ãŒã€åŸºæœ¬çš„ã«ã©ã¡ã‚‰ã‹ç‰‡æ–¹ã‚’ä½¿ãˆã°ååˆ†ã§ã™ã€‚  

---

## 3. `SizedBox` ã§åŒ…ã‚€å ´åˆã®ãƒã‚¤ãƒ³ãƒˆ

ã‚‚ã— `SizedBox`(width: ...) ã§æ˜ç¤ºçš„ã«å¹…ã‚’è¨­å®šã—ãŸã„å ´åˆã¯ã€**`CarouselOptions(viewportFraction: 1.0)`** ã«ã—ã¦ã‚ã’ã‚‹ã¨ã€CarouselSlider ãŒã€Œæ¨ªå¹…ã„ã£ã±ã„ä½¿ã£ã¦ã„ã„ã‚ˆã€ã¨ã„ã†åˆ¶ç´„ã‚’å­ã¸æ¸¡ã™ãŸã‚ã€å­ã® `SizedBox(width: ...)` ãŒæœ‰åŠ¹ã«ãªã‚Šã‚„ã™ããªã‚Šã¾ã™ã€‚

```dart
CarouselSlider.builder(
  options: CarouselOptions(
    viewportFraction: 1.0,   // è¦ªã¨ã—ã¦ã¯æ¨ªå¹…100%ã‚’æ¸¡ã™ã‚¤ãƒ¡ãƒ¼ã‚¸
    enlargeCenterPage: false,
  ),
  itemCount: ...,
  itemBuilder: (context, index, realIndex) {
    return Center(
      child: SizedBox(
        width: MediaQuery.of(context).size.width - 64,
        child: Card(/* ... */),
      ),
    );
  },
)
```

- ãŸã ã—ã€CarouselSlider è‡ªä½“ãŒè¡Œã†ã‚¹ãƒ¯ã‚¤ãƒ—æ–¹å‘ã®ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ(å·¦å³ã«ã‚¹ãƒ©ã‚¤ãƒ‰)ã‚’è€ƒæ…®ã™ã‚‹ã¨ã€`viewportFraction: 1.0` ã‚’ä½¿ã†å ´åˆã¯ã€Œéš£ã®ã‚«ãƒ¼ãƒ‰ãŒã¯ã¿å‡ºã—ã¦è¦‹ãˆã‚‹ã€ã¨ã„ã† UI ã«ã¯ãªã‚‰ãšã€å®Œå…¨ã« 1 ãƒšãƒ¼ã‚¸ï¼1 ã‚«ãƒ¼ãƒ‰ ã¨ã„ã†è¦‹ãˆæ–¹ã«ãªã‚Šã¾ã™ã€‚  
- ä»–ã®ã‚«ãƒ¼ãƒ‰ã‚’ã¡ã‚‰è¦‹ã›ã—ãŸã„ã‚ˆã†ãªãƒ‡ã‚¶ã‚¤ãƒ³ã®å ´åˆã¯ã€`viewportFraction` ã‚’ 0.8 ã€œ 0.9 ç¨‹åº¦ã«ã—ã€æ¨ªå¹…ã«ä½™è£•ã‚’æŒãŸã›ã¾ã™ã€‚

---

## 4. ã‚«ãƒ¼ãƒ‰ä¸‹å´ã®ä½™ç™½ã‚’ãªãã™

`Card` ã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã„ãã¤ã‹ã®ãƒãƒ¼ã‚¸ãƒ³ãŒä»˜ã„ã¦ã„ã¾ã™ãŒã€Flutter ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«ã‚ˆã£ã¦ã¯ `Card` ã®å¤–å´ã«ä½™ç™½ãŒãªã„å ´åˆã‚‚ã‚ã‚Šã¾ã™ã€‚ã‚‚ã—ä¸‹ä½™ç™½ãŒæ°—ã«ãªã‚‹å ´åˆã¯ã€ä»¥ä¸‹ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¾ã—ã‚‡ã†ã€‚

1. `Card( margin: EdgeInsets.zero, ... )` ã§å¤–å´ãƒãƒ¼ã‚¸ãƒ³ã‚’æ˜ç¤ºçš„ã«ã‚¼ãƒ­ã«ã™ã‚‹ã€‚  
2. `Padding` ã‚„ `SizedBox(height: ...)` ã‚’ã©ã“ã‹ã§å…¥ã‚Œã¦ã„ãªã„ã‹ç¢ºèªã™ã‚‹ã€‚  
3. è¦ªã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆ(ä¾‹ãˆã° `Padding` ãªã©)ãŒä¸‹æ–¹å‘ã«ä½™ç™½ã‚’ä½œã£ã¦ã„ãªã„ã‹ç¢ºèªã™ã‚‹ã€‚  

CarouselSlider è‡ªä½“ãŒä¸‹ã«ä½™ç™½ã‚’åŠ ãˆã‚‹ã“ã¨ã¯ã‚ã¾ã‚Šãªã„ã®ã§ã€ä¸»ã« `Card` ã‚„è¦ªãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã®ä½™ç™½ã‚’è¦‹ç›´ã—ã¦ãã ã•ã„ã€‚

---

## ã¾ã¨ã‚

- **ã€ŒCarouselSlider ã§ã‚«ãƒ¼ãƒ‰ã®å¹…ã‚’ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã™ã‚‹ã€ï¼ `viewportFraction` or `itemWidth` ã‚’ä½¿ã†**  
- `SizedBox` ã ã‘ã§ã‚µã‚¤ã‚ºæŒ‡å®šãŒã†ã¾ãã„ã‹ãªã„å ´åˆã¯ã€CarouselSlider å´ã® `viewportFraction` ã‚„ `itemWidth` ã¨ä½µç”¨ã™ã‚‹ã‹ã€`viewportFraction: 1.0` ã«ã—ã¦ã‚«ãƒ¼ãƒ‰ã‚’ä¸­å¤®ã«å›ºå®šå¹…ã§å‡ºã™ã®ãŒç°¡å˜ã€‚  
- ã‚«ãƒ¼ãƒ‰ã®ä¸‹å´ä½™ç™½ã¯ `Card` ã® `margin` ã‚„ `Padding` ã‚’å†åº¦ç¢ºèªã—ã¦èª¿æ•´ã€‚  

ä¸Šè¨˜ã‚’çµ„ã¿åˆã‚ã›ã‚‹ã“ã¨ã§ã€ã€Œæ¨ªå¹…ã‚’ç”»é¢å¹… - 64px ã«ã—ã¦ã€ä¸‹ä½™ç™½ãªã—ã§ä¸­å¤®å¯„ã›è¡¨ç¤ºã™ã‚‹ã€ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆãŒå®Ÿç¾ã§ãã‚‹ã¯ãšã§ã™ã€‚ãœã²ãŠè©¦ã—ãã ã•ã„ã€‚

---
