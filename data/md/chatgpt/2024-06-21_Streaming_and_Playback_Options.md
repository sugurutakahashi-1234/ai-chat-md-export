# Streaming and Playback Options

日付: 2024-06-21

---

## 👤 ユーザー
*2024/6/21 15:50:21*

以下の内容をまとめてほしい。

- ストリーミング再生の調査
  - そもそも音量インタラクションの表示は AVPlayer では簡単には対応できず、AVAudioPlayer でのみ対応しております
  - ただ、AVAudioPlayer ではいわゆるストリーミング再生ができないので、代替手段として、ローカルにダウンロードしながら再生するプログレッシブダウンロードを挑戦しました
  - ただ、プログレッシブダウンロードでの再生はFile操作などの処理が入って複雑になり、また、50KBほどダウンロードしないと再生に失敗することがあり、音声ファイルの1分が訳500KBの世界なので、そこまでプログレッシブダウンロードの速度優位性がなく、むしろ普通にダウンロードの完了を待って、Data型として、AVAudioPlayer で再生してもそこまで速度が変わらなかったので、https: のURL に対しては Data 型でダウンロードして、それを再生するようにしました。
  - ストリーミング再生可能なAVAudioEngine を使う方法も検討したが、音量だったり、音声波形などを取得するのは難しかった

そもそも論として、ストリーミング再生をしたければ、音声波形を出すのは難しい。

ストリーミング再生あり+音声波形あり: AVPlayer x AVAudioEngine  or AudioKit
ストリーミング再生あり+なし: AVPlayer
ローカル再生 + 音声波形あり: AVAudioPlayer
ローカル再生 + なし: AVAudioPlayer

ただ、AVAudioEngine はOSの低レイヤーの処理が求められるため、実装難易度が高い（高橋は1日かけてもできませんでした。）

AudioKit はちょっと試そうと思ったのですが、git clone してもビルドできず、結局 AVAudioEngine を使いそうな雰囲気だったので、諦めています。

また、ローカル再生についても再生ファイルの容量がそこまで大きくないので、プログレッシブダウンロードしなくても、500KBぐらいであれば 3秒ほどで終わるので、まあ妥協の範囲内かと思いました。

---

## 🤖 アシスタント
*2024/6/21 15:50:46*

### ストリーミング再生の調査まとめ

1. \*\*音量インタラクションの表示\*\*
   - AVPlayerでは音量インタラクションの表示が難しい。
   - AVAudioPlayerは音量インタラクションに対応可能だが、ストリーミング再生はできない。

2. \*\*プログレッシブダウンロードの試行\*\*
   - ローカルにダウンロードしながら再生するプログレッシブダウンロードに挑戦したが、複雑なFile操作が必要であり、約50KBをダウンロードしないと再生に失敗することがある。
   - 音声ファイル1分が約500KBであり、プログレッシブダウンロードの速度優位性が少ない。
   - 結果として、`https:`のURLに対しては、ダウンロード完了後にData型としてAVAudioPlayerで再生する方法に変更。

3. \*\*AVAudioEngineの検討\*\*
   - ストリーミング再生が可能なAVAudioEngineの使用も検討したが、音量や音声波形の取得が難しいため断念。

4. \*\*ストリーミング再生と音声波形表示の難しさ\*\*
   - ストリーミング再生を行う場合、音声波形を表示するのは難しい。

5. \*\*推奨される再生方法の組み合わせ\*\*
   - ストリーミング再生 + 音声波形表示: AVPlayer x AVAudioEngine または AudioKit
   - ストリーミング再生 + 音声波形表示なし: AVPlayer
   - ローカル再生 + 音声波形表示: AVAudioPlayer
   - ローカル再生 + 音声波形表示なし: AVAudioPlayer

6. \*\*実装難易度\*\*
   - AVAudioEngineはOSの低レイヤーの処理が必要で実装難易度が高い（1日かけても実装できなかった）。
   - AudioKitも試みたが、ビルドに失敗し、結局AVAudioEngineを使用する必要があると感じたため諦めた。

7. \*\*ローカル再生の妥協点\*\*
   - ローカル再生については、再生ファイルの容量が500KB程度であれば3秒ほどでダウンロードが完了するため、プログレッシブダウンロードの必要性は低いと判断。

これにより、ストリーミング再生を希望する場合、音声波形の表示は難しいことが分かりました。ローカル再生においては、音声波形の表示が可能であり、ダウンロード完了後に再生する方法が現実的です。

---

## 👤 ユーザー
*2024/6/21 15:51:18*

マークダウン形式にしてほしい。

---

## 🤖 アシスタント
*2024/6/21 15:51:25*

### ストリーミング再生の調査まとめ

1. \*\*音量インタラクションの表示\*\*
   - AVPlayerでは音量インタラクションの表示が難しい。
   - AVAudioPlayerは音量インタラクションに対応可能だが、ストリーミング再生はできない。

2. \*\*プログレッシブダウンロードの試行\*\*
   - ローカルにダウンロードしながら再生するプログレッシブダウンロードに挑戦したが、複雑なFile操作が必要であり、約50KBをダウンロードしないと再生に失敗することがある。
   - 音声ファイル1分が約500KBであり、プログレッシブダウンロードの速度優位性が少ない。
   - 結果

---
