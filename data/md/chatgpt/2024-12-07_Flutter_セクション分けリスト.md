# Flutter セクション分けリスト

日付: 2024-12-07

---

## 👤 ユーザー
*2024/12/07 18:49:05*

flutterでlistをセクション分けして配置したい

---

## 🤖 アシスタント
*2024/12/07 18:49:20*

Flutterでリストをセクション分けして表示する場合、`ListView`と`ListView.builder`を組み合わせて実現できます。また、セクションごとのヘッダーを追加するには、適切にデータを整形してヘッダー用のウィジェットを含めるようにします。

以下は、セクション分けされたリストのサンプル実装です。

### サンプルコード

```dart
import 'package:flutter/material.dart';

class SectionedListPage extends HookConsumerWidget {
  @override
  Widget build(BuildContext context, WidgetRef ref) {
    // セクションごとのデータ
    final data = {
      'Section 1': ['Item 1-1', 'Item 1-2', 'Item 1-3'],
      'Section 2': ['Item 2-1', 'Item 2-2'],
      'Section 3': ['Item 3-1', 'Item 3-2', 'Item 3-3', 'Item 3-4'],
    };

    return Scaffold(
      appBar: AppBar(title: Text('セクション分けリスト')),
      body: ListView.builder(
        itemCount: data.keys.length,
        itemBuilder: (context, sectionIndex) {
          final sectionTitle = data.keys.elementAt(sectionIndex);
          final sectionItems = data[sectionTitle]!;

          return Column(
            crossAxisAlignment: CrossAxisAlignment.start,
            children: [
              // セクションヘッダー
              Padding(
                padding: const EdgeInsets.all(8.0),
                child: Text(
                  sectionTitle,
                  style: TextStyle(
                    fontSize: 18,
                    fontWeight: FontWeight.bold,
                  ),
                ),
              ),
              // セクション内アイテム
              ListView.builder(
                shrinkWrap: true,
                physics: NeverScrollableScrollPhysics(),
                itemCount: sectionItems.length,
                itemBuilder: (context, itemIndex) {
                  final item = sectionItems[itemIndex];
                  return ListTile(
                    title: Text(item),
                  );
                },
              ),
            ],
          );
        },
      ),
    );
  }
}
```

### 主なポイント
1. **データ構造**:
   - セクションタイトルをキー、セクション内のアイテムを値としたマップを使用。
   - 例: `{ 'Section 1': ['Item 1', 'Item 2'] }`

2. **ネストした`ListView.builder`**:
   - 外側の`ListView.builder`でセクションを作成し、内側の`ListView.builder`でセクション内のアイテムを描画。

3. **`shrinkWrap`と`physics`**:
   - 内側のリストビューが親のリストビューと正しくスクロール動作するように、`shrinkWrap: true`と`physics: NeverScrollableScrollPhysics()`を指定。

### 見た目の調整
- セクションヘッダーのデザインを`Divider`や背景色などで調整可能。
- セクションを折りたたみ可能にする場合は、`ExpansionTile`を利用するのも便利です。

必要に応じてカスタマイズできます！

---

## 👤 ユーザー
*2024/12/07 18:50:07*

flutter標準でセクションっていう概念ないの？
iOSであるやつ

---

## 🤖 アシスタント
*2024/12/07 18:50:24*

FlutterにはiOSのような標準の「セクション」という概念はありません。ただし、似た機能を実現するために、Flutter標準の`ListView`や`CustomScrollView`を組み合わせることで、セクション分けされたリストを簡単に構築できます。

### iOSのセクション相当のFlutterの実現方法

#### 1. **`CustomScrollView`と`SliverList`の組み合わせ**
`CustomScrollView`は、複数のスクロール可能な領域（スライバー）を組み合わせることでセクション風のリストを構築できます。以下にサンプルを示します。

---

### サンプルコード

```dart
import 'package:flutter/material.dart';

class SectionedListView extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    // データ構造
    final data = {
      'Section 1': ['Item 1-1', 'Item 1-2', 'Item 1-3'],
      'Section 2': ['Item 2-1', 'Item 2-2'],
      'Section 3': ['Item 3-1', 'Item 3-2', 'Item 3-3', 'Item 3-4'],
    };

    return Scaffold(
      appBar: AppBar(title: Text('セクション分けリスト')),
      body: CustomScrollView(
        slivers: [
          for (var section in data.entries) ...[
            // セクションヘッダー
            SliverToBoxAdapter(
              child: Padding(
                padding: const EdgeInsets.all(8.0),
                child: Text(
                  section.key,
                  style: TextStyle(
                    fontSize: 18,
                    fontWeight: FontWeight.bold,
                  ),
                ),
              ),
            ),
            // セクション内リスト
            SliverList(
              delegate: SliverChildBuilderDelegate(
                (context, index) {
                  final item = section.value[index];
                  return ListTile(title: Text(item));
                },
                childCount: section.value.length,
              ),
            ),
          ],
        ],
      ),
    );
  }
}
```

---

### コードのポイント

1. **`CustomScrollView`**:
   - 複数のスクロール可能な要素（スライバー）を1つのスクロールビュー内に組み合わせられます。

2. **`SliverToBoxAdapter`**:
   - セクションのヘッダー部分を追加するために使用します。

3. **`SliverList`**:
   - セクション内のリストを作成します。

4. **`for`ループでセクションを構築**:
   - 各セクションデータをループで処理し、セクションヘッダーとリストを構築。

---

### FlutterとiOSの違い

| 機能 | iOS (UITableView) | Flutter |
|------|-------------------|---------|
| セクション | 標準でサポート (`UITableViewDataSource` にセクション対応) | 明示的にはなし。`CustomScrollView`で実装 |
| セクションヘッダー固定 | デフォルトで対応 (`UITableViewStyleGrouped`) | `SliverPersistentHeader`を使えば可能 |
| 折りたたみ | `UITableView`で`didSelectRowAt`と組み合わせ | `ExpansionTile`を使うのが簡単 |

---

### 固定ヘッダーを追加したい場合

もし、スクロール時にセクションヘッダーを固定（ピン留め）したい場合は、`SliverPersistentHeader`を利用します。

```dart
SliverPersistentHeader(
  pinned: true,
  delegate: _SectionHeaderDelegate('Section Title'),
)
```

このようにFlutterでは柔軟性が高い代わりに、構築を手動で行う必要があります。必要に応じて、標準の`ListView`や`CustomScrollView`を選んで実装してください！

---
