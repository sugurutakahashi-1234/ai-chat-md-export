# ã‚¹ãƒãƒ¼ã‚¯ã‚±ãƒ¼ã‚¹ã®è¾æ›¸ã‚­ãƒ¼å¤‰æ›

æ—¥ä»˜: 2023-06-08

---

## ğŸ‘¤ ãƒ¦ãƒ¼ã‚¶ãƒ¼
*2023/06/08 19:13:19*

Swiftã§è¾æ›¸å‹ã®ã‚­ãƒ¼ã‚’æ–‡å­—åˆ—ã§è¨­å®šã—ã¦ã„ã‚‹ã®ã§ã™ãŒã€ã‚¨ãƒ³ã‚³ãƒ¼ãƒ€ãƒ–ãƒ«ã«å¯¾å¿œã—ã¦ã€ã‚¹ãƒãƒ¼ã‚¯ã‚±ãƒ¼ã‚¹ã¨ã‹ã«ã—ãŸã„ã ã©ã†ã™ã‚Œã°ã„ã„ã€‚

---

## ğŸ¤– ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ
*2023/06/08 19:14:04*

Swiftã§ã¯ã€`Encodable` ãŠã‚ˆã³ `Decodable` ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚’ä½¿ç”¨ã—ã¦JSONã‚’ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰/ãƒ‡ã‚³ãƒ¼ãƒ‰ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã‚Œã‚’åˆ©ç”¨ã—ã¦ã‚­ãƒ¼ã‚’ã‚¹ãƒãƒ¼ã‚¯ã‚±ãƒ¼ã‚¹ã«å¤‰æ›ã™ã‚‹ã“ã¨ã‚‚å¯èƒ½ã§ã™ã€‚

å…·ä½“çš„ã«ã¯ã€`JSONEncoder` ã‚„ `JSONDecoder` ã® `keyDecodingStrategy` ã‚„ `keyEncodingStrategy` ã‚’ `.convertFromSnakeCase` ã‚„ `.convertToSnakeCase` ã«è¨­å®šã™ã‚‹ã“ã¨ã§ã€ã‚­ãƒ¼ã®å¤‰æ›ã‚’è¡Œã†ã“ã¨ãŒã§ãã¾ã™ã€‚

ä¾‹ãˆã°ã€æ¬¡ã®ã‚ˆã†ãªæ§‹é€ ä½“ãŒã‚ã‚‹ã¨ã—ã¾ã™:

```swift
struct MyStruct: Codable {
    let someKey: String
}
```

ã“ã®æ§‹é€ ä½“ã‚’ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã™ã‚‹ã¨ãã«ã€ã‚­ãƒ¼ã‚’ã‚¹ãƒãƒ¼ã‚¯ã‚±ãƒ¼ã‚¹ã«å¤‰æ›ã™ã‚‹ã«ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ã—ã¾ã™:

```swift
let myStruct = MyStruct(someKey: "some value")

let encoder = JSONEncoder()
encoder.keyEncodingStrategy = .convertToSnakeCase

do {
    let jsonData = try encoder.encode(myStruct)
    if let jsonString = String(data: jsonData, encoding: .utf8) {
        print(jsonString)
        // prints: {"some_key":"some value"}
    }
} catch {
    print("Error encoding: \(error)")
}
```

ã¾ãŸã€JSONãƒ‡ãƒ¼ã‚¿ã‚’ãƒ‡ã‚³ãƒ¼ãƒ‰ã™ã‚‹ã¨ãã«ã€ã‚­ãƒ¼ã‚’ã‚¹ãƒãƒ¼ã‚¯ã‚±ãƒ¼ã‚¹ã‹ã‚‰ã‚­ãƒ£ãƒ¡ãƒ«ã‚±ãƒ¼ã‚¹ã«å¤‰æ›ã™ã‚‹ã«ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ã—ã¾ã™:

```swift
let jsonString = "{\"some_key\":\"some value\"}"
if let jsonData = jsonString.data(using: .utf8) {
    let decoder = JSONDecoder()
    decoder.keyDecodingStrategy = .convertFromSnakeCase

    do {
        let myStruct = try decoder.decode(MyStruct.self, from: jsonData)
        print(myStruct.someKey)
        // prints: "some value"
    } catch {
        print("Error decoding: \(error)")
    }
}
```

ä»¥ä¸Šã®ã‚ˆã†ã«ã€`keyEncodingStrategy` ã¨ `keyDecodingStrategy` ã‚’è¨­å®šã™ã‚‹ã“ã¨ã§ã€ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰/ãƒ‡ã‚³ãƒ¼ãƒ‰æ™‚ã®ã‚­ãƒ¼ã®ã‚±ãƒ¼ã‚¹ã‚’å¤‰æ›ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

---

## ğŸ‘¤ ãƒ¦ãƒ¼ã‚¶ãƒ¼
*2023/06/08 19:14:26*

ã“ã†ã‚†ã†ã®ã‚’ã‚¨ãƒ³ã‚³ãƒ¼ãƒ€ãƒ–ãƒ«ã®structã‚’åˆ¥ã«ä½œã£ã¦æ¬²ã—ã‹ã£ãŸ

fileprivate extension CGSize {
    var dict: [String: Double] {
        [
            "width": width,
            "height": height
        ]
    }
}

---

## ğŸ¤– ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ
*2023/06/08 19:15:05*

æŒ‡å®šã•ã‚ŒãŸ `CGSize` ã®æ‹¡å¼µã«å¯¾ã™ã‚‹ `Codable` ã‚µãƒãƒ¼ãƒˆã‚’æä¾›ã™ã‚‹ãŸã‚ã«ã€ã‚«ã‚¹ã‚¿ãƒ  `Encodable` ãŠã‚ˆã³ `Decodable` ã®å®Ÿè£…ã‚’è¿½åŠ ã§ãã¾ã™ã€‚ã‚¹ãƒãƒ¼ã‚¯ã‚±ãƒ¼ã‚¹ã®ã‚­ãƒ¼ã‚’ä½¿ç”¨ã—ãŸã„å ´åˆã€`CodingKeys` ã‚’ä½¿ç”¨ã—ã¦ã‚­ãƒ¼ã‚’å®šç¾©ã—ã¾ã™ã€‚

```swift
import CoreGraphics

extension CGSize: Encodable {
    enum CodingKeys: String, CodingKey {
        case width
        case height
    }

    public func encode(to encoder: Encoder) throws {
        var container = encoder.container(keyedBy: CodingKeys.self)
        try container.encode(width, forKey: .width)
        try container.encode(height, forKey: .height)
    }
}

extension CGSize: Decodable {
    public init(from decoder: Decoder) throws {
        let container = try decoder.container(keyedBy: CodingKeys.self)
        self.init()
        width = try container.decode(CGFloat.self, forKey: .width)
        height = try container.decode(CGFloat.self, forKey: .height)
    }
}
```

ã“ã†ã™ã‚‹ã“ã¨ã§ `CGSize` ãŒç›´æ¥ `Encodable` ã¨ `Decodable` ã‚’æº€ãŸã™ãŸã‚ã€ã‚¹ãƒãƒ¼ã‚¯ã‚±ãƒ¼ã‚¹ã®ã‚­ãƒ¼ã‚’ä½¿ç”¨ã—ã¦ `CGSize` ã‚’ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ãŠã‚ˆã³ãƒ‡ã‚³ãƒ¼ãƒ‰ã§ãã¾ã™ã€‚

ãªãŠã€`Encoder` ã‚„ `Decoder` ã® `keyEncodingStrategy` ã¾ãŸã¯ `keyDecodingStrategy` ã‚’ `.convertToSnakeCase` ã¾ãŸã¯ `.convertFromSnakeCase` ã«è¨­å®šã™ã‚‹ã“ã¨ã§ã€ã‚­ãƒ¼ã‚’è‡ªå‹•çš„ã«ã‚¹ãƒãƒ¼ã‚¯ã‚±ãƒ¼ã‚¹ã«å¤‰æ›ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

ã“ã®æ–¹æ³•ã§ã¯ `CGSize` ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãŒ `Double` ã§ã¯ãªã `CGFloat` ã§ã‚ã‚‹ãŸã‚ã€ç›´æ¥ `Double` ã‚’ãƒ‡ã‚³ãƒ¼ãƒ‰ã—ã‚ˆã†ã¨ã™ã‚‹ã¨ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã™ã€‚ãã®ãŸã‚ã€ä¸Šè¨˜ã®ã‚³ãƒ¼ãƒ‰ã§ã¯ `CGFloat` ã‚’ç›´æ¥ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ãŠã‚ˆã³ãƒ‡ã‚³ãƒ¼ãƒ‰ã—ã¦ã„ã¾ã™ã€‚

---

## ğŸ‘¤ ãƒ¦ãƒ¼ã‚¶ãƒ¼
*2023/06/08 19:16:34*

åˆ¥ã«struct Size: Encodable ã¿ãŸã„ãªå®šç¾©ã‚’ä½œã£ã¦ãã‚Œã«å¤‰æ›ã™ã‚‹ã®ã¯ã©ã†â“

---

## ğŸ¤– ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ
*2023/06/08 19:17:14*

è¦æœ›ã«åˆã‚ã›ã¦ `CGSize` ã®ä»£ã‚ã‚Šã«ä½¿ç”¨ã™ã‚‹åˆ¥ã®ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰å¯èƒ½ãª `Size` æ§‹é€ ä½“ã‚’ä½œæˆã™ã‚‹ã“ã¨ã‚‚å¯èƒ½ã§ã™ã€‚

```swift
import CoreGraphics

struct Size: Encodable {
    let width: Double
    let height: Double
    
    // ã‚¤ãƒ‹ã‚·ãƒ£ãƒ©ã‚¤ã‚¶ã§ CGSize ã‚’å—ã‘å–ã‚Šã€width ã¨ height ã‚’å¤‰æ›ã—ã¾ã™
    init(from size: CGSize) {
        self.width = Double(size.width)
        self.height = Double(size.height)
    }
    
    enum CodingKeys: String, CodingKey {
        case width
        case height
    }
    
    func encode(to encoder: Encoder) throws {
        var container = encoder.container(keyedBy: CodingKeys.self)
        try container.encode(width, forKey: .width)
        try container.encode(height, forKey: .height)
    }
}
```

ã“ã‚Œã«ã‚ˆã‚Šã€ã‚ãªãŸã® `CGSize` ã‚’ `Size` ã«å¤‰æ›ã—ã€ãã‚Œã‚’ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

```swift
let cgSize = CGSize(width: 10, height: 20)
let size = Size(from: cgSize)

let encoder = JSONEncoder()
encoder.keyEncodingStrategy = .convertToSnakeCase

do {
    let jsonData = try encoder.encode(size)
    if let jsonString = String(data: jsonData, encoding: .utf8) {
        print(jsonString)
        // prints: {"width":10,"height":20}
    }
} catch {
    print("Error encoding: \(error)")
}
```

ã“ã®ä¾‹ã§ã¯ `CGSize` ã® `width` ã¨ `height` ã‚’ `Double` ã«å¤‰æ›ã—ã¦ã‹ã‚‰ `Size` ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«ä¿å­˜ã—ã¦ã„ã¾ã™ã€‚ãã—ã¦ã€ãã® `Size` ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã—ã¦ã„ã¾ã™ã€‚ã“ã®æ–¹æ³•ã§ã‚ã‚Œã°ã€ã‚­ãƒ¼ã‚’ã‚¹ãƒãƒ¼ã‚¯ã‚±ãƒ¼ã‚¹ã«å¤‰æ›ã™ã‚‹ãŸã‚ã« `keyEncodingStrategy` ã‚’è¨­å®šã™ã‚‹ã“ã¨ã‚‚å¯èƒ½ã§ã™ã€‚

---

## ğŸ‘¤ ãƒ¦ãƒ¼ã‚¶ãƒ¼
*2023/06/08 19:17:29*

func encode(to encoder: Encoder) throws {} ã®è¨˜è¿°ã£ã¦çœç•¥ã§ããªã„ã®ï¼Ÿ

---

## ğŸ¤– ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ
*2023/06/08 19:18:11*

Swiftã® `Encodable` ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã«æº–æ‹ ã™ã‚‹å ´åˆã€ `encode(to encoder: Encoder) throws` ã¨ã„ã†ãƒ¡ã‚½ãƒƒãƒ‰ã‚’æä¾›ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã—ã‹ã—ã€ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãŒã™ã¹ã¦è‡ªåˆ†è‡ªèº«ã§ `Encodable` ã‚’æº€ãŸã—ã¦ã„ã‚‹å ´åˆï¼ˆã¤ã¾ã‚Šã€ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãŒã™ã¹ã¦ `Encodable` ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã«æº–æ‹ ã—ã¦ã„ã‚‹å‹ã§ã‚ã‚‹å ´åˆï¼‰ã«ã¯ã€ã“ã®ãƒ¡ã‚½ãƒƒãƒ‰ã®å®Ÿè£…ã‚’çœç•¥ã™ã‚‹ã“ã¨ãŒå¯èƒ½ã§ã™ã€‚

ä¾‹ãˆã°æ¬¡ã®ã‚ˆã†ã«æ›¸ã‘ã¾ã™ï¼š

```swift
import CoreGraphics

struct Size: Encodable {
    let width: Double
    let height: Double
    
    init(from size: CGSize) {
        self.width = Double(size.width)
        self.height = Double(size.height)
    }
}
```

ã“ã®ã‚³ãƒ¼ãƒ‰ã§ã¯ `Size` ã¯ `Encodable` ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã«æº–æ‹ ã—ã¦ã„ã¾ã™ãŒã€ `encode(to:)` ãƒ¡ã‚½ãƒƒãƒ‰ã¯æ˜ç¤ºçš„ã«å®Ÿè£…ã—ã¦ã„ã¾ã›ã‚“ã€‚ã“ã‚Œã¯ã€ `width` ã¨ `height` ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãŒã©ã¡ã‚‰ã‚‚ `Encodable` ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã«æº–æ‹ ã—ã¦ã„ã‚‹ `Double` å‹ã§ã‚ã‚‹ãŸã‚ã€SwiftãŒè‡ªå‹•çš„ã«ã“ã‚Œã‚‰ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã™ã‚‹æ–¹æ³•ã‚’ç†è§£ã—ã¦ã„ã‚‹ã‹ã‚‰ã§ã™ã€‚

ã—ãŸãŒã£ã¦ã€ã‚«ã‚¹ã‚¿ãƒ ã®ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ãƒ­ã‚¸ãƒƒã‚¯ï¼ˆç‰¹æ®Šãªæ¡ä»¶ã§ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã™ã‚‹ã€ä¸€éƒ¨ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’ç„¡è¦–ã™ã‚‹ãªã©ï¼‰ãŒå¿…è¦ãªã„é™ã‚Šã€ `encode(to:)` ãƒ¡ã‚½ãƒƒãƒ‰ã®å®Ÿè£…ã‚’çœç•¥ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

---
