# OpenAPI バリデーションツール

日付: 2025-06-04

---

## 👤 ユーザー
*2025/06/05 01:11:05*

openapi.yaml が openapi 形式であることをバリデーションする npm ツール

---

## 🤖 アシスタント
*2025/06/05 01:11:35*

以下は **OpenAPI 仕様（YAML／JSON）をバリデーションできる代表的な npm CLI ツール** と、その選定ポイントです。  
どれも `pnpm dlx`／`npx` で単発実行でき、CI に組み込みやすいものに絞りました。

| ツール | 対応 OAS | 主な特徴 | 最終リリース | カスタムルール | 補足 |
|-------|---------|---------|-------------|---------------|------|
| **Redocly CLI (`@redocly/cli`)** | 2.0, 3.0, 3.1 | `lint` で仕様チェック＋ガバナンス、`bundle` で `$ref` 解決、Portal 連携も可能 | 1 週間前 | JS/JSON-YAML で柔軟に定義可 | 実務で API ガイドラインを徹底したいときの定番 citeturn0search0turn0search4 |
| **Spectral (`@stoplight/spectral-cli`)** | 2.0, 3.0, 3.1 | JSON/YAML 汎用リンター。OpenAPI 用に 90 以上の既定ルールを同梱。ルールを YAML で宣言的に拡張可能 | 先月 | 可能（YAML で declarative） | 軽量で汎用性が高く“ルールを書く”文化にフィット citeturn0search1turn0search9 |
| **IBM OpenAPI Validator (`ibm-openapi-validator`)** | 3.0, 3.1 | OAS 準拠＋IBM 独自ベストプラクティスをチェック。CLI と JS API の両方を提供 | 先月 | 可能（YAML/JS） | “設計ガイドラインを強制したい”場合に便利 citeturn0search3turn0search7 |
| **swagger-cli** | 2.0, 3.0 | `validate` に特化したシンプル CLI。 `$ref` 解決機能もあり | 2023-11（アーカイブ済み） | 不可 | OAS 3.1 非対応・メンテ停止。既存プロジェクトでのみ推奨 citeturn1search0turn1search1 |
| **@apidevtools/swagger-parser** | 2.0, 3.0 | Node ライブラリ寄り。`validate()` を直接呼び出し可能 | 1 年前 | − | コード内で“動的”に検証したい場合に ◎ citeturn1search3 |

---

### 典型的な使い方（ローカル／CI 共通）

```bash
# 例: Redocly CLI
pnpm dlx @redocly/cli lint openapi.yaml

# 例: Spectral
pnpm dlx @stoplight/spectral-cli lint openapi.yaml

# 例: IBM OpenAPI Validator
pnpm dlx ibm-openapi-validator openapi.yaml
```

#### GitHub Actions への最小組み込み例（Spectral）

```yaml
# .github/workflows/openapi-lint.yml
name: OpenAPI validation

on:
  pull_request:
    paths: ["openapi.yaml"]

jobs:
  spectral:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: pnpm/action-setup@v3
        with:
          version: 9
      - run: pnpm dlx @stoplight/spectral-cli lint openapi.yaml
```

---

### ツール選びの目安

1. **ガバナンスも一緒にしたいなら Redocly CLI**  
   独自ルールで「必ず `operationId` を snake_case」にする、といったガイドラインを CI で強制できます。SwaggerHub／Redocly Portal と併用するとドキュメント公開まで一気通貫。citeturn0search0  
2. **軽量でプラガブルなら Spectral**  
   ESLint に近い開発体験。ルールを YAML で記述できるのでコードレスで運用しやすい。AsyncAPI など複数フォーマットも一つで lint 可能。citeturn0search5  
3. **企業ガイドライン準拠をチェックしたいなら IBM OpenAPI Validator**  
   「例外系も含めレスポンスが定義されているか」「エンベロープ構造が正しいか」等、実践的なチェックが多い。citeturn0search3  
4. **既存資産で swagger-cli を使っている場合は乗り換え検討**  
   3.1 非対応・メンテ停止につき、新規導入には Spectral か Redocly CLI を推奨。citeturn1search1  

---

#### ちょっとした Tips

- **複数ツール併用もアリ**  
  例：`spectral` でスタイル／ベストプラクティス、`redocly bundle` で `$ref` 解決→公開用ファイル生成、など。  
- **CI 実行時間が気になる場合**  
  Spectral／Redocly ともに `--fail-severity error` 等でエラーのみ検査すると高速化できます。  
- **VS Code プラグイン**  
  Spectral は公式拡張あり。ローカル保存時に即フィードバックを得ることで PR 時の修正コスト減。  

これで **openapi.yaml が“OpenAPI として正しいか”を確実に担保**できます。運用ポリシーや要求レベルに合わせて、最適なツールを選択・組み合わせてみてください。

---

## 👤 ユーザー
*2025/06/05 01:16:51*

Redocly CLIと swagger-cli の関係性

---

## 🤖 アシスタント
*2025/06/05 01:17:33*

### ざっくり結論

**swagger-cli はメンテ終了 → 後継として Redocly CLI を公式推奨**  
README でも “Redocly CLI を使ってね” と明記され、移行ガイドが用意されています。citeturn1search6turn0search1

---

## 歴史と開発体制

|               | swagger-cli | Redocly CLI |
|---------------|-------------|-------------|
| 出自 | API Dev Tools（Ben H. 他） | Redocly 社（ReDoc 開発元） |
| 初期リリース | 2017 年ごろ | 2020 年ごろ |
| 最終リリース | 2023-11（以降アーカイブ） | 継続的（月イチ程度） |
| メンテ状況 | **Deprecated**（機能追加なし） | アクティブ開発中 |
| 主担当 | Ben → 2023 年に保守負荷で終了宣言 | Redocly チーム＋ OSS コントリビュータ |

&gt; swagger-cli の主要メンテナが Redocly CLI の機能・コミュニティを高く評価し「後継として乗り換えてほしい」と表明。citeturn1search5

---

## 機能差と互換性

| 機能 | swagger-cli | Redocly CLI |
|------|-------------|-------------|
| **validate** | ✅ (2.0/3.0) | ✅ (2.0/3.0/3.1) |
| **bundle / dereference** | ✅ | ✅ (高速＋柔軟な `$ref` 解決) |
| **lint / custom rules** | なし | ✅ ESLint 風ルール・ガバナンス |
| **ドキュメント生成 (Redoc)** | なし | ✅ `build-docs`, `preview-docs` |
| **API Portal 連携 / Cloud 連携** | なし | ✅ (任意) |
| **プラグイン拡張** | なし | ✅ `--plugin` / JS ルール |

### コマンド置き換え例

| swagger-cli | Redocly CLI |
|-------------|-------------|
| `swagger-cli validate api.yaml` | `redocly lint api.yaml` |
| `swagger-cli bundle api.yaml -o dist.yaml` | `redocly bundle api.yaml --output dist.yaml` |

移行ガイドは公式 docs に整備されており、コマンド名とオプションを写経するだけでほぼ移行できます。citeturn0search1

---

## 依存関係・内部アーキテクチャ

- **共通点**  
  両者とも `json-schema-ref-parser` 系ライブラリを利用し、YAML/JSON の `$ref` 解決ロジックを継承。
- **相違点**  
  Redocly CLI は独自コアパッケージ `@redocly/openapi-core` を中心に再設計。rule engine、Redoc ビルダー、ポータル連携などを追加して “API ライフサイクルツール” へ拡張。

---

## いつどちらを使うべき？

| シナリオ | 推奨 |
|----------|------|
| **新規プロジェクト／OAS 3.1 対応** | **Redocly CLI** 一択 |
| 既存 CI が swagger-cli 依存 | 移行ガイドに従い段階的に Redocly CLI へ |
| 「とりあえず validate/bundle だけで十分」 | Redocly CLI で同機能をそのまま代替可能 |
| 社内 API ガイドラインを lint で強制 | Redocly CLI（カスタムルール） |

&gt; swagger-cli を残す技術的理由はほぼ無いため、**2025 年現在は Redocly CLI が事実上の標準** と考えて OK です。

---

### まとめ

- swagger-cli は **保守終了**。  
- Redocly CLI が **機能 superset** で公式後継。  
- 移行は *validate → lint*, *bundle → bundle* とコマンド写し替えで完了。  
- OAS 3.1 対応・ガバナンス・ドキュメント生成まで一手に担えるのが Redocly CLI。  

今後の投資先としては Redocly CLI を採用し、必要に応じて Spectral など補助リンターを組み合わせるのがモダンな選択肢です。

---
