# dart format オプション

日付: 2024-12-07

---

## 👤 ユーザー
*2024/12/07 23:23:22*

dart format のオプジョンなどを指定したい。行が長いことによる改行をやめさせたいんだ。

---

## 🤖 アシスタント
*2024/12/07 23:23:34*

`dart format` では、デフォルトで行の長さが 80 文字を超える場合に自動で改行されます。ただし、この動作をカスタマイズしたい場合、プロジェクトのルートに `.dart_tool/package_config.json` を利用して設定を追加することはできませんが、代わりに `--line-length` オプションを使って行の長さを変更できます。

例えば、行の長さを 120 に変更するには、以下のコマンドを使用します。

```bash
dart format --line-length 120 .
```

### 手順:
1. **一時的に変更**  
   上記コマンドのように直接オプションを指定します。

2. **プロジェクト全体に適用**  
   プロジェクトごとに一貫性を持たせたい場合、`analysis_options.yaml` ファイルをプロジェクトのルートに作成（または編集）し、以下のように指定します。

```yaml
linter:
  rules:
    - lines_longer_than_80_chars
analyzer:
  strong-mode:
    implicit-casts: false
```

ただし、この方法は `dart format` の直接の挙動には影響しません。

3. **改行を完全にやめさせる方法はない**  
   `dart format` は一部のコードスタイルを強制的に適用します。そのため、改行を完全になくすことはできません。ただし、手動でフォーマットを調整して保存後に再度 `dart format` を適用しなければ、特定のスタイルを維持することは可能です。

もしどうしても改行を避けたい場合、手動で改行されないスタイルを適用し、`dart format` を適用しないワークフローにする必要があります。ただし、これは他の開発者とのコード整合性に問題を生じる可能性があるため推奨されません。

改行を減らしつつ適切なスタイルを維持するには、変数名や構造の簡略化を検討するのも一つの方法です。

---

## 👤 ユーザー
*2024/12/07 23:24:45*

たとえば g.dartなどの変更は避けたい

---

## 🤖 アシスタント
*2024/12/07 23:25:03*

`g.dart` ファイルや自動生成されたファイルに対して `dart format` を適用しないようにするには、以下の方法を検討してください。

---

### 1. **`.gitignore` に追加する**  
`g.dart` ファイルは通常、自動生成されるものなので、フォーマットから除外したい場合、これらを Git にコミットしない設定を利用できます。  
プロジェクトのルートにある `.gitignore` ファイルに以下を追加してください。

```
*.g.dart
```

ただし、この方法ではコミットの管理に影響します。

---

### 2. **`dart format` で特定ファイルを除外する**
`dart format` コマンドでフォーマットするディレクトリやファイルを明示的に指定することで、`g.dart` を避けられます。

例: 特定のディレクトリのみをフォーマットする場合

```bash
dart format lib/pages lib/widgets
```

この場合、`lib/models/*.g.dart` のような `g.dart` ファイルを含まないディレクトリだけを指定することで、フォーマットの対象から外せます。

---

### 3. **分析とフォーマットを自動生成ファイルから除外する**
`analysis_options.yaml` を利用して、自動生成されたファイルをフォーマットや解析の対象から除外できます。

プロジェクトルートに `analysis_options.yaml` を作成（または編集）し、以下を追加します。

```yaml
analyzer:
  exclude:
    - "**/*.g.dart"
```

これにより、`g.dart` ファイルは Dart アナライザー（静的解析）および一部の自動フォーマットの対象から除外されます。

---

### 4. **`build_runner` の再実行を活用**
`g.dart` は通常、`build_runner` によって自動生成されるため、フォーマットにこだわる必要がない場合は、フォーマットせずに生成された状態をそのまま使用します。

`build_runner` を再実行することで、`dart format` による変更を上書きできます。

```bash
dart run build_runner build --delete-conflicting-outputs
```

これで、`dart format` による影響を元に戻せます。

---

### 5. **フォーマットを無効化するコメントを利用**
どうしても一部のファイルだけフォーマットを適用したくない場合、以下のように Dart のフォーマットを無効化するコメントをファイルの冒頭に追加します。

```dart
// @dart=2.12
// ignore_for_file: file_names
```

ただし、この方法は手動で制御が必要で、`build_runner` の生成プロセスで上書きされる可能性があります。

---

### ベストプラクティス
自動生成されたファイルに手を加えず、`build_runner` の再生成や分析除外設定で管理するのが最も効率的です。また、プロジェクト全体で統一されたスタイルを維持するため、できるだけ自動フォーマッタを活用することをお勧めします。

---
