# APIエラー標準形式

Date: 2025-02-20

---

## 👤 User
*2025-02-21 00:46:41*

APIエラーの標準形

---

## 🤖 Assistant
*2025-02-21 00:47:28*

APIエラーの標準形を設計する際は、一貫性を持たせ、クライアント側が適切に処理できるようにすることが重要です。以下のような形にするのが一般的です。

### **エラーの標準形**
```json
{
  "error": {
    "code": "INVALID_REQUEST",
    "message": "The request is invalid.",
    "details": [
      {
        "field": "email",
        "message": "Email is required."
      },
      {
        "field": "password",
        "message": "Password must be at least 8 characters."
      }
    ],
    "status": 400
  }
}
```

### **各フィールドの説明**
| フィールド名      | 型           | 説明 |
|----------------|------------|------|
| `error`       | `object`    | エラー情報のルートオブジェクト |
| `code`        | `string`    | エラーコード（開発者向け識別子） |
| `message`     | `string`    | エラーメッセージ（ユーザー向けメッセージを含む場合も） |
| `details`     | `array`     | 入力エラーの詳細リスト（フィールドごとのエラー情報） |
| `field`       | `string`    | エラーが発生したフィールド名（バリデーションエラーの場合） |
| `status`      | `integer`   | HTTP ステータスコード |

---

## **エラーコードの例**
| コード名 | 意味 |
|---------|------|
| `INVALID_REQUEST` | 無効なリクエスト（バリデーションエラーなど） |
| `UNAUTHORIZED` | 認証エラー（ログインが必要など） |
| `FORBIDDEN` | アクセス権がない |
| `NOT_FOUND` | リソースが見つからない |
| `INTERNAL_ERROR` | サーバー内部エラー |
| `RATE_LIMIT_EXCEEDED` | レートリミット超過 |
| `CONTENT_FILTERED` | 投稿がフィルタリングされた |

---

## **HTTP ステータスコードとのマッピング**
| HTTP ステータス | エラーコードの例 |
|---------------|----------------|
| `400 Bad Request` | `INVALID_REQUEST` |
| `401 Unauthorized` | `UNAUTHORIZED` |
| `403 Forbidden` | `FORBIDDEN` |
| `404 Not Found` | `NOT_FOUND` |
| `409 Conflict` | `DUPLICATE_ENTRY` |
| `429 Too Many Requests` | `RATE_LIMIT_EXCEEDED` |
| `500 Internal Server Error` | `INTERNAL_ERROR` |

---

このような標準形を定めることで、エラー処理が統一され、フロントエンドやクライアントアプリ側での処理がしやすくなります。

### **カスタマイズのポイント**
- 日本語対応を行う場合は、`message` の値をローカライズする。
- `details` をカスタマイズして、エラーの発生状況に応じた詳細情報を提供する（例: APIのパス、リクエストパラメータ）。
- `code` を統一的に管理し、クライアント側がハンドリングしやすいようにする。

あなたのアプリに合わせて、このフォーマットを調整すると良いですね。

---
