# Structシングルトン可能か?

日付: 2023-07-19

---

## 👤 ユーザー
*2023/07/19 16:49:24*

Swiftでシングルトンをclassではなくて、structでも可能なのか知りたい

---

## 🤖 アシスタント
*2023/07/19 16:50:01*

Swiftでは、`class`を使ってシングルトンを作成するのが一般的ですが、`struct`を使ってもシングルトンパターンを実装することは可能です。ただし、Swiftの`struct`は値型であるため、`class`のような参照型とは異なる動作をします。

以下に、Swiftで`struct`を使ってシングルトンを作成する一例を示します。

```swift
struct Singleton {
    static let shared = Singleton()

    var someProperty: String = "Initial Value"

    private init() { }
}

// 使用例
var value = Singleton.shared.someProperty  // "Initial Value"
Singleton.shared.someProperty = "New Value"  // Error: Cannot assign to property: 'shared' is a 'let' constant
```

このコードでは、`Singleton`構造体に`static let shared`という一つのインスタンスを持たせています。また、構造体の初期化関数を`private`にしていますので、この構造体は外部から新たにインスタンス化することができません。

ただし、このコードには問題があります。`Singleton.shared.someProperty = "New Value"`という行はエラーを出します。Swiftの`struct`は値型であり、`let`キーワードで定義されたプロパティは不変であるため、このような変更は許されません。

したがって、`struct`を使用してシングルトンを作成することは技術的に可能ですが、Swiftの`class`のように参照型であることを活用したシングルトンパターンの一部の特性を利用することはできません。全てのシングルトンが`class`を必要とするわけではありませんが、シングルトンが一つの共有インスタンスを変更可能に保つ必要がある場合、`class`を使用することを強く推奨します。

---
