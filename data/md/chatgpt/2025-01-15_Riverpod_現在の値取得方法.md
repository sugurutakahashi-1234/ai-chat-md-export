# Riverpod 現在の値取得方法

日付: 2025-01-15

---

## 👤 ユーザー
*2025/1/15 18:40:16*

これから現在の値を取り出すときはどうすればいいの

@Riverpod(keepAlive: true)
class WeaveTargetSpotId extends _$WeaveTargetSpotId {
  @override
  String? build() =&gt; null;

  void update(String id) {
    debugPrint('WeavedSpotId: $id');
    state = id;
  }
}

---

## 🤖 アシスタント
*2025/1/15 18:40:42*

現在の値を取得するには、`ref.watch` または `ref.read` を利用して `WeaveTargetSpotId` プロバイダーの状態を取得できます。

### 現在の値を取得する方法
`Riverpod` では、プロバイダーの状態を取得するために以下の2つの方法があります。

#### 1. **`ref.watch` を使う (リアクティブに値を監視)**
`ref.watch` を使うと、値が変更されたときに自動的にリビルドされます。

```dart
final currentSpotId = ref.watch(weaveTargetSpotIdProvider);
```

#### 2. **`ref.read` を使う (値を1回だけ取得)**
`ref.read` を使うと、現在の値を一度だけ取得します。値の変更を監視しない場合に使用します。

```dart
final currentSpotId = ref.read(weaveTargetSpotIdProvider);
```

### `WeaveTargetSpotId` のプロバイダー
あなたのコードに対応するプロバイダー名を `weaveTargetSpotIdProvider` と仮定すると、以下のようになります。

```dart
@Riverpod(keepAlive: true)
class WeaveTargetSpotId extends _$WeaveTargetSpotId {
  @override
  String? build() => null;

  void update(String id) {
    debugPrint('WeavedSpotId: $id');
    state = id;
  }
}
```

### 値の取得例

#### ウィジェット内での利用例

```dart
@override
Widget build(BuildContext context, WidgetRef ref) {
  final currentSpotId = ref.watch(weaveTargetSpotIdProvider);

  return Text(currentSpotId ?? 'No ID selected');
}
```

#### 非同期処理やイベント内での利用例
例えば、ボタンの `onPressed` 内で現在の値を取得する場合は `ref.read` を使います。

```dart
ElevatedButton(
  onPressed: () {
    final currentSpotId = ref.read(weaveTargetSpotIdProvider);
    print('Current Spot ID: $currentSpotId');
  },
  child: Text('Print Current ID'),
);
```

### 補足
- `ref.watch` はリアクティブな値の監視に使い、ウィジェットのビルドメソッド内で使用します。
- `ref.read` は一度だけ値を取得する際に使います。非同期処理やイベントの中で使用するのが一般的です。

以上を使えば、現在の値を簡単に取り出すことができます！

---
