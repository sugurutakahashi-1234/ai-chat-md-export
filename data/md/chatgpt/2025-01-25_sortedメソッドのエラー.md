# sortedメソッドのエラー

Date: 2025-01-25

---

## 👤 User
*2025-01-25 22:40:46*

sorted()でエラーになる
The method 'sorted' isn't defined for the type 'Iterable'.
Try correcting the name to the name of an existing method, or defining a method named 'sorted'.dartundefined_method
cameraList
                  .where(
                    (camera) =&gt; !editingCameraListStateValue.any(
                      (editingCamera) =&gt;
                          editingCamera.cameraId == camera.cameraId,
                    ),
                  )
                  .sorted()
                  .asMap()
                  .entries
                  .map((entry) {

extension ListCameraDtoX on List&lt;CameraDTO&gt; {
  List&lt;CameraDTO&gt; sorted() {
    return List.from(this)
      ..sort(
        (a, b) =&gt; (b.level ?? 0).compareTo(a.level ?? 0),
      );
  }

  num get totalSearchQ =&gt;
      fold&lt;num&gt;(0, (sum, camera) =&gt; sum + (camera.searchQ ?? 0));

  num get totalAttackE =&gt;
      fold&lt;num&gt;(0, (sum, camera) =&gt; sum + (camera.attackE ?? 0));

  num get totalLuckL =&gt;
      fold&lt;num&gt;(0, (sum, camera) =&gt; sum + (camera.luckL ?? 0));

  num get totalDefenseB =&gt;
      fold&lt;num&gt;(0, (sum, camera) =&gt; sum + (camera.defenseB ?? 0));
}

---

## 🤖 Assistant
*2025-01-25 22:40:59*

エラーの原因は、`sorted()`メソッドを`Iterable`に対して使用していることです。Dartでは`sorted()`はデフォルトで`Iterable`に用意されているメソッドではなく、`List`型に対してのみ使えるように、独自にエクステンションを定義する必要があります。

現在、`ListCameraDtoX`エクステンションに`sorted()`を定義していますが、`cameraList.where(...)`の戻り値は`Iterable`型であり、`ListCameraDtoX`で定義した`sorted()`を認識しません。

解決するためには、`where`の結果を`List`に変換してから`sorted()`を呼び出す必要があります。以下のように修正してみてください。

```dart
cameraList
  .where(
    (camera) => !editingCameraListStateValue.any(
      (editingCamera) => editingCamera.cameraId == camera.cameraId,
    ),
  )
  .toList() // ここでIterableをListに変換
  .sorted() // その後でsorted()を呼び出す
  .asMap()
  .entries
  .map((entry) {
    // ...
  });
```

### 修正ポイント
1. `.where(...)`は`Iterable`を返すため、その後に`sorted()`を使う前に`.toList()`で`List`に変換する必要があります。
2. エクステンションの`sorted()`は`List`型に対して動作するように設計されているため、`toList()`の後で`sorted()`を呼び出すことで正しく動作します。

これでエラーは解消され、コードが意図通りに動作するはずです！

---
