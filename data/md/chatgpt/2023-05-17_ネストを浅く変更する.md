# ネストを浅く変更する

日付: 2023-05-17

---

## 👤 ユーザー
*2023/5/17 17:36:49*

以下の関数をネストを浅く変更してみて

    func typographyStyle(\_ typography: Typography) -&gt; some View {
        if typography.textStyle.customFont == .systemDefault {
            self
                .font(.system(size: typography.textStyle.size, weight: typography.textStyle.weight.weight))
                .lineSpacing(typography.textStyle.lineHeight.value(for: typography.textStyle.size))
        } else {
            if #available(iOS 16.0, \*) {
                self
                    .font(.custom(typography.textStyle.customFont.name, size: typography.textStyle.size))
                    .fontWeight(typography.textStyle.weight.weight)
                    .lineSpacing(typography.textStyle.lineHeight.value(for: typography.textStyle.size))
            } else {
                self
                    .font(.custom(typography.textStyle.customFont.name, size: typography.textStyle.size))
                    .font(fontWeightForLegacyIOS(weight: typography.textStyle.weight.weight)) // fontWeight(\_ weight: Font.Weight?) -&gt; some View が iOS16.0未満では対応されていない
                    .lineSpacing(typography.textStyle.lineHeight.value(for: typography.textStyle.size))
            }
        }
    }

---

## 🤖 アシスタント
*2023/5/17 17:38:34*

既存の条件分岐を一部統合することでネストを浅くすることが可能です。以下に示すのは、その一例です。

```swift
func typographyStyle(_ typography: Typography) -> some View {
    if typography.textStyle.customFont == .systemDefault {
        return self
            .font(.system(size: typography.textStyle.size, weight: typography.textStyle.weight.weight))
            .lineSpacing(typography.textStyle.lineHeight.value(for: typography.textStyle.size))
    }
    
    if #available(iOS 16.0, *) {
        return self
            .font(.custom(typography.textStyle.customFont.name, size: typography.textStyle.size))
            .fontWeight(typography.textStyle.weight.weight)
            .lineSpacing(typography.textStyle.lineHeight.value(for: typography.textStyle.size))
    }
    
    return self
        .font(.custom(typography.textStyle.customFont.name, size: typography.textStyle.size))
        .font(fontWeightForLegacyIOS(weight: typography.textStyle.weight.weight)) // fontWeight(_ weight: Font.Weight?) -> some View が iOS16.0未満では対応されていない
        .lineSpacing(typography.textStyle.lineHeight.value(for: typography.textStyle.size))
}
```

このバージョンでは、各条件ごとに早期リターンを行っています。これにより、ネストを減らし、読みやすさを向上させています。ただし、Swiftの`some View`の制限により、このような早期リターンは必ずしも可能ではない場合があります。その場合は、各条件に対応するビューを変数に代入し、最後にその変数を返す方法を考えることができます。

---
