# éæ´»æ€§ã‹ã‚‰æ´»æ€§åŒ–

æ—¥ä»˜: 2023-07-13

---

## ğŸ‘¤ ãƒ¦ãƒ¼ã‚¶ãƒ¼
*2023/07/13 18:26:20*

SwiftUI ã®Viewã‚’è¡¨ç¤ºã—ã¦ã‹ã‚‰30ç§’ãŸã£ãŸã‚‰éæ´»æ€§ã‹ã‚‰æ´»æ€§ã«ãªã‚‹ãƒœã‚¿ãƒ³ã‚’ã¤ãã£ã¦ã»ã—ã„

MVVMãƒ¢ãƒ‡ãƒ«ã§å®Ÿè£…ã—ã¦æ¬²ã—ã„

---

## ğŸ¤– ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ
*2023/07/13 18:27:02*

SwiftUIã§MVVMãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ä½¿ç”¨ã—ã¦ã€æŒ‡å®šã—ãŸæ™‚é–“ï¼ˆã“ã®å ´åˆã¯30ç§’ï¼‰å¾Œã«æ´»æ€§åŒ–ã™ã‚‹ãƒœã‚¿ãƒ³ã‚’ä½œæˆã™ã‚‹ãŸã‚ã®ä¸€ä¾‹ã‚’ä»¥ä¸‹ã«ç¤ºã—ã¾ã™ã€‚

ã¾ãšã€ãƒ¢ãƒ‡ãƒ«ã¨ãƒ“ãƒ¥ãƒ¼ãƒ¢ãƒ‡ãƒ«ã‚’ä½œæˆã—ã¾ã™ï¼š

```swift
// Model
class TimerModel: ObservableObject {
    var timer: Timer?

    func start(after seconds: Int, completion: @escaping () -> Void) {
        timer = Timer.scheduledTimer(withTimeInterval: TimeInterval(seconds), repeats: false) { _ in
            completion()
        }
    }

    func cancel() {
        timer?.invalidate()
        timer = nil
    }
}

// ViewModel
class TimerViewModel: ObservableObject {
    private let model: TimerModel
    @Published var isButtonActive: Bool = false

    init(model: TimerModel) {
        self.model = model
    }

    func startTimer() {
        model.start(after: 30) {
            DispatchQueue.main.async {
                self.isButtonActive = true
            }
        }
    }

    func cancelTimer() {
        model.cancel()
    }
}
```

æ¬¡ã«ã€ãƒ“ãƒ¥ãƒ¼ã‚’ä½œæˆã—ã¾ã™ï¼š

```swift
struct TimerView: View {
    @ObservedObject var viewModel: TimerViewModel

    var body: some View {
        Button(action: {
            // button action here
        }) {
            Text("My Button")
        }
        .disabled(!viewModel.isButtonActive)
        .onAppear {
            viewModel.startTimer()
        }
        .onDisappear {
            viewModel.cancelTimer()
        }
    }
}
```

ã“ã“ã§ã€ãƒœã‚¿ãƒ³ã¯`viewModel.isButtonActive`ãŒ`true`ã«ãªã‚‹ã¾ã§ç„¡åŠ¹åŒ–ã•ã‚Œã¦ã„ã¾ã™ã€‚`Button`ã®`disabled(_:)`ä¿®é£¾å­ã‚’ä½¿ç”¨ã—ã¦ã“ã®åˆ¶å¾¡ã‚’è¡Œã£ã¦ã„ã¾ã™ã€‚`onAppear(_:)`ä¿®é£¾å­ã«ã‚ˆã‚Šã€ãƒ“ãƒ¥ãƒ¼ãŒè¡¨ç¤ºã•ã‚ŒãŸã¨ãã«ã‚¿ã‚¤ãƒãƒ¼ãŒé–‹å§‹ã•ã‚Œã€`onDisappear(_:)`ä¿®é£¾å­ã«ã‚ˆã‚Šã€ãƒ“ãƒ¥ãƒ¼ãŒæ¶ˆãˆãŸã¨ãã«ã‚¿ã‚¤ãƒãƒ¼ãŒã‚­ãƒ£ãƒ³ã‚»ãƒ«ã•ã‚Œã¾ã™ã€‚

ãªãŠã€ã“ã®ä¾‹ã§ã¯ã‚¿ã‚¤ãƒãƒ¼ã®çµŒéæ™‚é–“ã¯30ç§’ã«å›ºå®šã•ã‚Œã¦ã„ã¾ã™ãŒã€å¿…è¦ã«å¿œã˜ã¦å‹•çš„ã«å¤‰æ›´ã™ã‚‹ã“ã¨ã‚‚å¯èƒ½ã§ã™ã€‚

---

## ğŸ‘¤ ãƒ¦ãƒ¼ã‚¶ãƒ¼
*2023/07/13 18:28:20*

self.isButtonActive = true ã®å‡¦ç†ã¯ Viewã§ã¯ãªã presenterã§ãŠã“ãªã†ã‚ˆã†ã«ã—ã¦ã»ã—ã„

---

## ğŸ¤– ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ
*2023/07/13 18:28:45*

äº†è§£ã—ã¾ã—ãŸã€‚ãã®è¦æœ›ã«åŸºã¥ãã€`Presenter`ã‚’å°å…¥ã—ã€`Presenter`ã‹ã‚‰ãƒ“ãƒ¥ãƒ¼ãƒ¢ãƒ‡ãƒ«ã®çŠ¶æ…‹ã‚’æ›´æ–°ã™ã‚‹ã‚ˆã†ã«ã‚³ãƒ¼ãƒ‰ã‚’æ”¹è‰¯ã—ã¾ã™ã€‚ã¾ãšã€`Presenter`ã®å®šç¾©ã‚’è¿½åŠ ã—ã¾ã™ï¼š

```swift
class TimerPresenter {
    private let viewModel: TimerViewModel

    init(viewModel: TimerViewModel) {
        self.viewModel = viewModel
    }

    func startTimer() {
        viewModel.model.start(after: 30) {
            DispatchQueue.main.async {
                self.viewModel.isButtonActive = true
            }
        }
    }

    func cancelTimer() {
        viewModel.model.cancel()
    }
}
```

ãã—ã¦ã€`TimerViewModel`ã‚¯ãƒ©ã‚¹ã‚’æ¬¡ã®ã‚ˆã†ã«ä¿®æ­£ã—ã¾ã™ï¼š

```swift
class TimerViewModel: ObservableObject {
    let model: TimerModel
    @Published var isButtonActive: Bool = false

    init(model: TimerModel) {
        self.model = model
    }
}
```

æœ€å¾Œã«ã€`TimerView`ã‚’`Presenter`ã‚’ä½¿ç”¨ã™ã‚‹ã‚ˆã†ã«ä¿®æ­£ã—ã¾ã™ï¼š

```swift
struct TimerView: View {
    @ObservedObject var viewModel: TimerViewModel
    private var presenter: TimerPresenter

    init(viewModel: TimerViewModel) {
        self.viewModel = viewModel
        self.presenter = TimerPresenter(viewModel: viewModel)
    }

    var body: some View {
        Button(action: {
            // button action here
        }) {
            Text("My Button")
        }
        .disabled(!viewModel.isButtonActive)
        .onAppear {
            presenter.startTimer()
        }

---
