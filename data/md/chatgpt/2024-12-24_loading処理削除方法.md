# loadingå‡¦ç†å‰Šé™¤æ–¹æ³•

æ—¥ä»˜: 2024-12-24

---

## ğŸ‘¤ ãƒ¦ãƒ¼ã‚¶ãƒ¼
*2024/12/24 16:28:40*

loading ã®å‡¦ç†ã¯ã„ã‚‰ãªã„

ref.listen&lt;AsyncValue&lt;String?&gt;&gt;(
      deleteGuildNotifierProvider,
      (previous, next) {
        next.when(
          data: (data) {
            if (data == null) {
              return;
            }
            ScaffoldMessenger.of(context).showSnackBar(
              SnackBar(content: Text('Guild deleted successfully: $data')),
            );
            context.pop();
          },
          error: (e, stackTrace) {
            ScaffoldMessenger.of(context).showSnackBar(
              SnackBar(content: Text('Error deleting guild: $e')),
            );
          },
          loading: () {
            ScaffoldMessenger.of(context).showSnackBar(
              const SnackBar(content: Text('Deleting guild...')),
            );
          },
        );
      },
    );

---

## ğŸ¤– ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ
*2024/12/24 16:28:52*

`loading` ã®å‡¦ç†ãŒä¸è¦ã§ã‚ã‚Œã°ã€ä»¥ä¸‹ã®ã‚ˆã†ã« `when` ã®å‡¦ç†ã‹ã‚‰ `loading` ã‚±ãƒ¼ã‚¹ã‚’å‰Šé™¤ã§ãã¾ã™ã€‚`loading` ã‚’å‰Šé™¤ã—ã¦ã‚‚ `when` ã®æ§‹æ–‡çš„ã«å•é¡Œã‚ã‚Šã¾ã›ã‚“ã€‚

### ä¿®æ­£ç‰ˆã‚³ãƒ¼ãƒ‰
```dart
ref.listen<AsyncValue<String?>>(
  deleteGuildNotifierProvider,
  (previous, next) {
    next.when(
      data: (data) {
        if (data == null) {
          return;
        }
        ScaffoldMessenger.of(context).showSnackBar(
          SnackBar(content: Text('Guild deleted successfully: $data')),
        );
        context.pop();
      },
      error: (e, stackTrace) {
        ScaffoldMessenger.of(context).showSnackBar(
          SnackBar(content: Text('Error deleting guild: $e')),
        );
      },
      loading: null, // ã“ã®éƒ¨åˆ†ã‚’å‰Šé™¤ã™ã‚‹ã‹ã€å˜ã«æŒ‡å®šã—ãªã„
    );
  },
);
```

ã¾ãŸã¯ `when` ã‚’ä½¿ã‚ãšã« `map` ã‚’ä½¿ã£ã¦å‡¦ç†ã‚’ç°¡ç•¥åŒ–ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ï¼ˆ`loading` ã‚’ç„¡è¦–ã™ã‚‹å ´åˆï¼‰ã€‚

```dart
ref.listen<AsyncValue<String?>>(
  deleteGuildNotifierProvider,
  (previous, next) {
    next.map(
      data: (data) {
        if (data.value == null) {
          return;
        }
        ScaffoldMessenger.of(context).showSnackBar(
          SnackBar(content: Text('Guild deleted successfully: ${data.value}')),
        );
        context.pop();
      },
      error: (error) {
        ScaffoldMessenger.of(context).showSnackBar(
          SnackBar(content: Text('Error deleting guild: ${error.error}')),
        );
      },
      loading: (_) {},
    );
  },
);
```

ã©ã¡ã‚‰ã®æ–¹æ³•ã§ã‚‚ã€`loading` ã®å‡¦ç†ã‚’ç„¡åŠ¹åŒ–ã§ãã¾ã™ã€‚æœ€çµ‚çš„ã«ã¯ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ã‚³ãƒ¼ãƒ‰ã‚¹ã‚¿ã‚¤ãƒ«ã‚„è¦ä»¶ã«å¿œã˜ã¦é¸ã‚“ã§ãã ã•ã„ã€‚

---

## ğŸ‘¤ ãƒ¦ãƒ¼ã‚¶ãƒ¼
*2024/12/24 16:30:52*

ã“ã‚Œã‚‚whenã§æ›¸ãç›´ã—ãŸã„

    ref.listen&lt;AsyncValue&lt;GuildInfoResponseDtoData?&gt;&gt;(
      getMyGuildNotifierProvider,
      (previous, next) {
        if (next is AsyncData) {
          if (next.value == null) {
            return;
          }
          if (context.mounted) {
            context.push(Screen.guildRequest.path);
          }
        } else if (next is AsyncError) {
          if (context.mounted) {
            ScaffoldMessenger.of(context).showSnackBar(
              SnackBar(
                content: Text('Error: ${next.error}'),
              ),
            );
          }
        }
      },
    );

---

## ğŸ¤– ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ
*2024/12/24 16:31:06*

`when` ã‚’ä½¿ç”¨ã—ã¦æ›¸ãç›´ã™ã¨ã€ä»¥ä¸‹ã®ã‚ˆã†ã« `next` ã® `AsyncData` ã‚„ `AsyncError` ã®å‡¦ç†ã‚’åˆ†ã‹ã‚Šã‚„ã™ãè¨˜è¿°ã§ãã¾ã™ã€‚

### `when` ã‚’ä½¿ç”¨ã—ãŸã‚³ãƒ¼ãƒ‰

```dart
ref.listen<AsyncValue<GuildInfoResponseDtoData?>>(
  getMyGuildNotifierProvider,
  (previous, next) {
    next.when(
      data: (data) {
        if (data == null) {
          return;
        }
        if (context.mounted) {
          context.push(Screen.guildRequest.path);
        }
      },
      error: (e, stackTrace) {
        if (context.mounted) {
          ScaffoldMessenger.of(context).showSnackBar(
            SnackBar(
              content: Text('Error: $e'),
            ),
          );
        }
      },
      loading: () {
        // `loading` ã®å‡¦ç†ãŒä¸è¦ã§ã‚ã‚Œã°ç©ºã«ã™ã‚‹ã‹ã€å‰Šé™¤å¯èƒ½ã§ã™ã€‚
      },
    );
  },
);
```

### ä¿®æ­£ãƒã‚¤ãƒ³ãƒˆ
1. **`when` ã‚’ä½¿ç”¨**:
   - `AsyncValue` ã®çŠ¶æ…‹ (`data`, `error`, `loading`) ã‚’ã‚¹ãƒƒã‚­ãƒªåˆ†å²ã§ãã¾ã™ã€‚

2. **`loading` ã®å‡¦ç†**:
   - å¿…è¦ãªã„å ´åˆã¯ `loading` ã«ç©ºã®ãƒ©ãƒ ãƒ€å¼ `{}` ã‚’è¨˜è¿°ã™ã‚‹ã‹ã€çœç•¥å¯èƒ½ã§ã™ã€‚

3. **`context.mounted` ãƒã‚§ãƒƒã‚¯**:
   - å®‰å…¨ã«ç”»é¢é·ç§»ã‚„ UI æ›´æ–°ã‚’è¡Œã†ãŸã‚ã« `context.mounted` ã‚’ä¿æŒã€‚

`when` ã‚’ä½¿ã†ã“ã¨ã§ã‚³ãƒ¼ãƒ‰ã®æ§‹é€ ãŒçµ±ä¸€ã•ã‚Œã€èª­ã¿ã‚„ã™ã•ãŒå‘ä¸Šã—ã¾ã™ã€‚

---

## ğŸ‘¤ ãƒ¦ãƒ¼ã‚¶ãƒ¼
*2024/12/24 16:31:33*

ã“ã‚Œã‚‚

    ref.listen&lt;AsyncValue&lt;String?&gt;&gt;(createGuildNotifierProvider,
        (previous, next) {
      if (next is AsyncData) {
        if (next.value == null) {
          return;
        }
        if (context.mounted) {
          ScaffoldMessenger.of(context).showSnackBar(
            const SnackBar(content: Text('ã‚®ãƒ«ãƒ‰ãŒä½œæˆã•ã‚Œã¾ã—ãŸï¼')),
          );
          ref.read(onCreatedGuildNotifierProvider.notifier).trigger();
          context.pop();
        }
      } else if (next is AsyncError) {
        if (context.mounted) {
          ScaffoldMessenger.of(context).showSnackBar(
            SnackBar(content: Text('ã‚®ãƒ«ãƒ‰ã®ä½œæˆã«å¤±æ•—ã—ã¾ã—ãŸ: ${next.error}')),
          );
        }
      }
    });

---

## ğŸ¤– ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ
*2024/12/24 16:31:43*

`when` ã‚’ä½¿ç”¨ã—ã¦ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã™ã‚‹ã¨ã€ä»¥ä¸‹ã®ã‚ˆã†ã«ã‚³ãƒ¼ãƒ‰ã‚’æ•´ç†ã§ãã¾ã™ã€‚

### `when` ã‚’ä½¿ç”¨ã—ãŸãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°å¾Œã®ã‚³ãƒ¼ãƒ‰

```dart
ref.listen<AsyncValue<String?>>(createGuildNotifierProvider, (previous, next) {
  next.when(
    data: (data) {
      if (data == null) {
        return;
      }
      if (context.mounted) {
        ScaffoldMessenger.of(context).showSnackBar(
          const SnackBar(content: Text('ã‚®ãƒ«ãƒ‰ãŒä½œæˆã•ã‚Œã¾ã—ãŸï¼')),
        );
        ref.read(onCreatedGuildNotifierProvider.notifier).trigger();
        context.pop();
      }
    },
    error: (error, stackTrace) {
      if (context.mounted) {
        ScaffoldMessenger.of(context).showSnackBar(
          SnackBar(content: Text('ã‚®ãƒ«ãƒ‰ã®ä½œæˆã«å¤±æ•—ã—ã¾ã—ãŸ: $error')),
        );
      }
    },
    loading: () {
      // `loading` ã®å‡¦ç†ãŒå¿…è¦ã§ãªã‘ã‚Œã°ç©ºã§OK
    },
  );
});
```

### ä¿®æ­£ãƒã‚¤ãƒ³ãƒˆ
1. **`when` ã‚’ä½¿ç”¨ã—ã¦åˆ†å²ã‚’æ˜ç¢ºåŒ–**:
   - `AsyncData` ã¯ `data` ã«ã€`AsyncError` ã¯ `error` ã«ç°¡æ½”ã«å¯¾å¿œã§ãã¾ã™ã€‚

2. **`loading` ã®å‡¦ç†**:
   - å¿…è¦ã§ã‚ã‚Œã°è¨˜è¿°ã—ã€ä¸è¦ã§ã‚ã‚Œã°ç©ºã«ã™ã‚‹ã‹çœç•¥å¯èƒ½ã§ã™ã€‚

3. **`context.mounted` ãƒã‚§ãƒƒã‚¯**:
   - ç”»é¢é·ç§»ã‚„ UI æ›´æ–°å‰ã«å®‰å…¨æ€§ã‚’ç¢ºä¿ã€‚

### ãƒ¡ãƒªãƒƒãƒˆ
- `if` æ–‡ã®ãƒã‚¹ãƒˆãŒæ¸›ã‚Šã€ã‚³ãƒ¼ãƒ‰ãŒèª­ã¿ã‚„ã™ããªã‚Šã¾ã™ã€‚
- `when` ã‚’åˆ©ç”¨ã™ã‚‹ã“ã¨ã§ã€`AsyncValue` ã®ã™ã¹ã¦ã®çŠ¶æ…‹ã‚’ç¶²ç¾…çš„ã«æ‰±ã†ã“ã¨ãŒæ˜ç¢ºã«ãªã‚Šã¾ã™ã€‚

---
