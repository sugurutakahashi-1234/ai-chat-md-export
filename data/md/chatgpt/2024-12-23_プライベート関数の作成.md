# ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆé–¢æ•°ã®ä½œæˆ

æ—¥ä»˜: 2024-12-23

---

## ğŸ‘¤ ãƒ¦ãƒ¼ã‚¶ãƒ¼
*2024/12/23 17:16:59*

ã“ã®updateGuildMemberã‚’ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã«ã™ã‚‹æ–¹æ³•

import 'package:flutter/foundation.dart';
import 'package:hooks_riverpod/hooks_riverpod.dart';
import 'package:riverpod_annotation/riverpod_annotation.dart';

import 'package:snpit_guild_app/infrastructure/snapit_guild_api/snapit_guild_api.openapi.dart';
import 'package:snpit_guild_app/presentation/providers/api_client/guild_api_provider.dart';

part 'update_guild_member.g.dart';

@riverpod
class LeaveGuildNotifier extends _$LeaveGuildNotifier {
  @override
  Future&lt;String?&gt; build() async =&gt; null;

  Future&lt;void&gt; leaveGuild({
    required String guildId,
    required String userId,
  }) async {
    state = const AsyncValue.loading();
    try {
      final result = await updateGuildMember(
        ref: ref,
        guildId: guildId,
        userId: userId,
        memberStatus: UpdateGuildMemberRequestDtoMemberStatus.LEFT,
      );
      debugPrint('Result : $result');
      state = AsyncValue.data(result);
     } on Exception catch (e, stackTrace) {
      debugPrint('Error in GetGuildInfoNotifier: $e');
      debugPrint('StackTrace: $stackTrace');
      state = AsyncValue.error(e, stackTrace);
    }
  }
}

@riverpod
class KickGuildNotifier extends _$KickGuildNotifier {
  @override
  Future&lt;String?&gt; build() async =&gt; null;

  Future&lt;void&gt; kickGuild({
    required String guildId,
    required String userId,
  }) async {
    state = const AsyncValue.loading();
    try {
      final result = await updateGuildMember(
        ref: ref,
        guildId: guildId,
        userId: userId,
        memberStatus: UpdateGuildMemberRequestDtoMemberStatus.KICKED,
      );
      debugPrint('Result : $result');
      state = AsyncValue.data(result);
    } on Exception catch (e, stackTrace) {
      debugPrint('Error in KickGuildNotifier: $e');
      debugPrint('StackTrace: $stackTrace');
      state = AsyncValue.error(e, stackTrace);
    }
  }
}

@riverpod
class RequestGuildNotifier extends _$RequestGuildNotifier {
  @override
  Future&lt;String?&gt; build() async =&gt; null;

  Future&lt;void&gt; requestGuild({
    required String guildId,
    required String userId,
  }) async {
    state = const AsyncValue.loading();
    try {
      final result = await updateGuildMember(
        ref: ref,
        guildId: guildId,
        userId: userId,
        memberStatus: UpdateGuildMemberRequestDtoMemberStatus.REQUESTED,
      );
      debugPrint('Result : $result');
      state = AsyncValue.data(result);
    } on Exception catch (e, stackTrace) {
      debugPrint('Error in RequestGuildNotifier: $e');
      debugPrint('StackTrace: $stackTrace');
      state = AsyncValue.error(e, stackTrace);
    }
  }
}

@riverpod
class ApproveGuildNotifier extends _$ApproveGuildNotifier {
  @override
  Future&lt;String?&gt; build() async =&gt; null;

  Future&lt;void&gt; approveGuild({
    required String guildId,
    required String userId,
  }) async {
    state = const AsyncValue.loading();
    try {
      final result = await updateGuildMember(
        ref: ref,
        guildId: guildId,
        userId: userId,
        memberStatus: UpdateGuildMemberRequestDtoMemberStatus.APPROVED,
      );
      debugPrint('Result : $result');
      state = AsyncValue.data(result);
    } on Exception catch (e, stackTrace) {
      debugPrint('Error in ApproveGuildNotifier: $e');
      debugPrint('StackTrace: $stackTrace');
      state = AsyncValue.error(e, stackTrace);
    }
  }
}

Future&lt;String?&gt; updateGuildMember({
  required Ref ref,
  required String guildId,
  required String userId,
  required UpdateGuildMemberRequestDtoMemberStatus memberStatus,
}) async {
  final api = await ref.watch(guildApiProvider.future);
  final response = await api.guildControllerUpdateGuildMember(
    UpdateGuildMemberRequestDto(
      updateStatus: true,
      memberStatus: memberStatus,
    ),
    guildId: guildId,
    userId: userId,
  );
  debugPrint('Response Body: ${response.data}');
  debugPrint('Response Body.data: ${response.data?.data}');
  return response.data?.data;
}

---

## ğŸ¤– ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ
*2024/12/23 17:17:32*

`updateGuildMember` ã‚’ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã«ã™ã‚‹ã«ã¯ã€ã‚¯ãƒ©ã‚¹ã‚„ãƒ•ã‚¡ã‚¤ãƒ«å†…ã§ã®ã¿åˆ©ç”¨å¯èƒ½ãªå½¢ã«å¤‰æ›´ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ä»¥ä¸‹ã®ã„ãšã‚Œã‹ã®æ–¹æ³•ã§å®Ÿç¾ã§ãã¾ã™ã€‚

---

### **æ–¹æ³• 1: ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆé–¢æ•°ã«ã™ã‚‹**
é–¢æ•°ã®å…ˆé ­ã«ã‚¢ãƒ³ãƒ€ãƒ¼ã‚¹ã‚³ã‚¢ï¼ˆ`_`ï¼‰ã‚’ä»˜ã‘ã¦ã€ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã‚¹ã‚³ãƒ¼ãƒ—ã«ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

```dart
Future<String?> _updateGuildMember({
  required Ref ref,
  required String guildId,
  required String userId,
  required UpdateGuildMemberRequestDtoMemberStatus memberStatus,
}) async {
  final api = await ref.watch(guildApiProvider.future);
  final response = await api.guildControllerUpdateGuildMember(
    UpdateGuildMemberRequestDto(
      updateStatus: true,
      memberStatus: memberStatus,
    ),
    guildId: guildId,
    userId: userId,
  );
  debugPrint('Response Body: ${response.data}');
  debugPrint('Response Body.data: ${response.data?.data}');
  return response.data?.data;
}
```

ã“ã®å¤‰æ›´ã«ä¼´ã„ã€ã™ã¹ã¦ã®å‘¼ã³å‡ºã—ç®‡æ‰€ã‚‚ `_updateGuildMember` ã«å¤‰æ›´ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

---

### **æ–¹æ³• 2: Notifier ã‚¯ãƒ©ã‚¹ã«çµ„ã¿è¾¼ã‚€**
é–¢æ•°ã‚’å€‹åˆ¥ã«å…¬é–‹ã™ã‚‹ã®ã§ã¯ãªãã€`LeaveGuildNotifier` ãªã©ã®ã‚¯ãƒ©ã‚¹ã«çµ„ã¿è¾¼ã‚€æ–¹æ³•ã§ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šå¤–éƒ¨ã‹ã‚‰ã¯ã‚¢ã‚¯ã‚»ã‚¹ã§ããªããªã‚Šã¾ã™ã€‚

```dart
@riverpod
class LeaveGuildNotifier extends _$LeaveGuildNotifier {
  @override
  Future<String?> build() async => null;

  Future<void> leaveGuild({
    required String guildId,
    required String userId,
  }) async {
    state = const AsyncValue.loading();
    try {
      final result = await _updateGuildMember(
        guildId: guildId,
        userId: userId,
        memberStatus: UpdateGuildMemberRequestDtoMemberStatus.LEFT,
      );
      debugPrint('Result : $result');
      state = AsyncValue.data(result);
    } on Exception catch (e, stackTrace) {
      debugPrint('Error in GetGuildInfoNotifier: $e');
      debugPrint('StackTrace: $stackTrace');
      state = AsyncValue.error(e, stackTrace);
    }
  }

  Future<String?> _updateGuildMember({
    required String guildId,
    required String userId,
    required UpdateGuildMemberRequestDtoMemberStatus memberStatus,
  }) async {
    final api = await ref.watch(guildApiProvider.future);
    final response = await api.guildControllerUpdateGuildMember(
      UpdateGuildMemberRequestDto(
        updateStatus: true,
        memberStatus: memberStatus,
      ),
      guildId: guildId,
      userId: userId,
    );
    debugPrint('Response Body: ${response.data}');
    debugPrint('Response Body.data: ${response.data?.data}');
    return response.data?.data;
  }
}
```

ã“ã®æ–¹æ³•ã§ã¯ã€`_updateGuildMember` ã¯ `LeaveGuildNotifier` ã®å†…éƒ¨å°‚ç”¨é–¢æ•°ã¨ãªã‚Šã¾ã™ã€‚

---

### **æ–¹æ³• 3: ãƒ•ã‚¡ã‚¤ãƒ«ã‚¹ã‚³ãƒ¼ãƒ—ã«åˆ¶é™ã™ã‚‹**
é–¢æ•°ã‚’ç¾åœ¨ã®ãƒ•ã‚¡ã‚¤ãƒ«å†…ã§ã®ã¿åˆ©ç”¨å¯èƒ½ã«ã™ã‚‹å ´åˆã¯ã€ãƒ•ã‚¡ã‚¤ãƒ«å†…ã§ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã‚¹ã‚³ãƒ¼ãƒ—ã¨ã—ã¦å®šç¾©ã—ã¾ã™ã€‚

1. é–¢æ•°åã®å…ˆé ­ã«ã‚¢ãƒ³ãƒ€ãƒ¼ã‚¹ã‚³ã‚¢ï¼ˆ`_`ï¼‰ã‚’è¿½åŠ ã—ã¾ã™ã€‚
2. é–¢æ•°ã‚’ç¾åœ¨ã®ãƒ•ã‚¡ã‚¤ãƒ«å†…ã§å®šç¾©ã•ã‚ŒãŸå…¨ã¦ã® Notifier ã‚¯ãƒ©ã‚¹ã§åˆ©ç”¨å¯èƒ½ã«ã—ã¾ã™ã€‚

```dart
Future<String?> _updateGuildMember({
  required Ref ref,
  required String guildId,
  required String userId,
  required UpdateGuildMemberRequestDtoMemberStatus memberStatus,
}) async {
  final api = await ref.watch(guildApiProvider.future);
  final response = await api.guildControllerUpdateGuildMember(
    UpdateGuildMemberRequestDto(
      updateStatus: true,
      memberStatus: memberStatus,
    ),
    guildId: guildId,
    userId: userId,
  );
  debugPrint('Response Body: ${response.data}');
  debugPrint('Response Body.data: ${response.data?.data}');
  return response.data?.data;
}
```

Notifier å†…ã§ã“ã®é–¢æ•°ã‚’å‘¼ã³å‡ºã™éš›ã¯ã€`_updateGuildMember` ã‚’åˆ©ç”¨ã—ã¾ã™ã€‚

---

### **ã©ã®æ–¹æ³•ã‚’é¸ã¶ã¹ãã‹**
- **æ–¹æ³• 1:** é–¢æ•°ã‚’ç°¡å˜ã«ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆåŒ–ã—ãŸã„å ´åˆã€‚
- **æ–¹æ³• 2:** Notifier å†…ã§å®Œçµã•ã›ãŸã„å ´åˆï¼ˆå¤–éƒ¨ã‹ã‚‰ã‚¢ã‚¯ã‚»ã‚¹ã•ã‚Œãªã„è¨­è¨ˆãŒæ±‚ã‚ã‚‰ã‚Œã‚‹å ´åˆï¼‰ã€‚
- **æ–¹æ³• 3:** ãƒ•ã‚¡ã‚¤ãƒ«å†…ã®ä»–ã®ã‚¯ãƒ©ã‚¹ã‹ã‚‰å…±æœ‰ã—ãŸã„å ´åˆã€‚

ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®è¨­è¨ˆæ–¹é‡ã«åˆã‚ã›ã¦é¸æŠã—ã¦ãã ã•ã„ã€‚

---
