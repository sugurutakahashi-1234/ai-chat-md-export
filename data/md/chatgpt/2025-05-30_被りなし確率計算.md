# 被りなし確率計算

日付: 2025-05-30

---

## 👤 ユーザー
*2025/5/30 18:25:11*

15種あったときに被りなしで6種を手に入れられる確率は？

---

## 🤖 アシスタント
*2025/5/30 18:25:52*

### 考え方  
- \*\*前提\*\*：15 種類のアイテムがあり，1 回ごとに同じ確率 \\(1/15\\) で当たる “ガチャ” を \*\*6 回\*\* 引く（重複の可能性あり）。  
- “被りなし” ＝ 6 回の結果が \*\*すべて異なる\*\* こと。

### 計算  
1. \*\*総パターン数\*\*  
   \\\[
     15^6
   \\\]
   （各回 15 通りの結果があり，独立に 6 回）

2. \*\*重複なしのパターン数\*\*  
   1 回目は 15 通り，2 回目は残り 14 通り … 6 回目は残り 10 通り  
   \\\[
     15 \\times 14 \\times 13 \\times 12 \\times 11 \\times 10
     \\;=\\;{}^{15}\\!P\_{6}\\;=\\;3,603,600
   \\\]

3. \*\*確率\*\*  
   \\\[
     P
     \\;=\\;
     \\frac{15 \\times 14 \\times 13 \\times 12 \\times 11 \\times 10}{15^6}
     \\;=\\;
     \\frac{3{,}603{,}600}{11{,}390{,}625}
     \\;=\\;
     \\frac{16{,}016}{50{,}625}
     \\;\\approx\\;0.3164
   \\\]

### 結果  
- \*\*確率（小数）\*\*：約 \*\*0.316\*\*  
- \*\*確率（百分率）\*\*：\*\*31.6 %\*\*  

---

&gt; もし 6 個を “箱から取り出して戻さない” ように \*\*重複がそもそも起こらない方法\*\*（無作為抽出だが非復元）で手に入れるなら，被りは絶対に起こらないので確率は 1（100 %）になります。

---

## 👤 ユーザー
*2025/5/30 18:38:47*

12回引いてダブりが0の場合の確率1つの場合の確率2,3,4の場合の確率はいくつか

---

## 🤖 アシスタント
*2025/5/30 18:39:58*

## 前提と用語確認
- **15 種類**のアイテムがあり，1 回ごとに **等確率 (1/15)** で当たるとします。  
- 12 回引くあいだ **戻しアリ**（ガチャを回すイメージ）なので，各回は独立です。  
- **ダブりが *d* 個**  
  - ここでは「 重複して出た回数 」を *d* と定義します。  
    - 例）12 回中 **1 回だけ**過去に出たアイテムがまた出た → *d = 1*  
    - このとき取得できた異なる種類の数は 12 − *d* 個になります。  

## 一般式
```
n = 12          # 回す回数
m = 15          # 種類数
d = ダブり回数  # 求めたい 0〜4

r = n - d       # 重複なしで手に入った種類数
```

1. **r 個の種類を選ぶ**  …  \(\displaystyle \binom{m}{r}\)  
2. **12 枚の引き方が r 種すべてに 1 回以上割り振られる通り数**  
   - これは「12 個の玉を r 個の箱に**空き箱なし**で入れる順序付き配置」  
   - 通り数 ＝  \(r! \times S(12,r)\)  
   - \(S(n,k)\) は **第二種 Stirling 数**  
3. **全通り**は \(m^{12}\)

\[
\boxed{P(d)=\dfrac{\binom{m}{\,n-d\,}\; (n-d)!\; S(n,\,n-d)}{m^{\,n}}}
\]

---

## 必要な Stirling 数 \(S(12,r)\)

| \(r\) | \(S(12,r)\) |
|:---:|:---:|
| 12 | 1 |
| 11 | 66 |
| 10 | 1 705 |
| 9  | 22 275 |
| 8  | 159 027 |

---

## 計算結果（15 種を 12 回）  

| ダブり数 \(d\) | 異種数 \(r = 12-d\) | 確率（分数） | 確率（小数） | パーセント |
|:---:|:---:|:---|:---|:---|
| 0 | 12 | \(\dfrac{7\,175\,168}{4\,271\,484\,375}\) | 0.001 679 78 | **0.168 %** |
| 1 | 11 | \(\dfrac{39\,463\,424}{1\,423\,828\,125}\) | 0.027 716 4 | **2.772 %** |
| 2 | 10 | \(\dfrac{611\,683\,072}{4\,271\,484\,375}\) | 0.143 201 5 | **14.320 %** |
| 3 | 9  | \(\dfrac{9\,865\,856}{31\,640\,625}\) | 0.311 810 | **31.181 %** |
| 4 | 8  | \(\dfrac{6\,791\,937\,152}{21\,357\,421\,875}\) | 0.318 013 | **31.801 %** |

> *12 回引いたとき “ダブりが 0〜4 回” になる確率は合計で約 80.24 % です。*

---

### 使った主な公式
- **第二種 Stirling 数**  
  \[
    S(n,k)=\frac1{k!}\sum_{j=0}^{k}(-1)^j\binom{k}{j}(k-j)^n
  \]
- **順序付き重複なし配置**（surjection の通り数）  
  \[
    \text{surjections}(n\!\to\!k)=k!\,S(n,k)
  \]

これでご希望の 0〜4 回のダブり確率が求まりました。必要に応じて他の *d* についても同じ公式で計算できます。

---
