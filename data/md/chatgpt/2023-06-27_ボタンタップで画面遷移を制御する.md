# ãƒœã‚¿ãƒ³ã‚¿ãƒƒãƒ—ã§ç”»é¢é·ç§»ã‚’åˆ¶å¾¡ã™ã‚‹

æ—¥ä»˜: 2023-06-27

---

## ğŸ‘¤ ãƒ¦ãƒ¼ã‚¶ãƒ¼
*2023/06/28 05:42:46*

NavigationLink å†…ã®ãƒœã‚¿ãƒ³ã‚’ã‚¿ãƒƒãƒ—ã™ã‚‹ã¨presenter.nextButtonTapped()ã®å‡¦ç†ãŒã‚ˆã°ã‚Œã‚‹å‰ã«shouldPushPageãŒtrueã¨ãªã£ã¦ã—ã¾ã£ã¦ç”»é¢ãŒé·ç§»ã—ã¦ã—ã¾ã†ã€‚ã©ã†ã™ã‚Œã°ã„ã„ã®ã‹ï¼Ÿ

struct MissionPreparationView: View {
    @EnvironmentObject private var navigator: MissionPageNavigator
    @StateObject private var presenter: MissionPreparationPresenter
    @Binding var finishedMissionType: MissionValueType?

    init(missionTypeDetail: MissionTypeDetail,
         stepType: MissionPreparationPresenter.MissionStepType, finishedMissionType: Binding&lt;MissionValueType?&gt;)
    {
        _presenter = .init(wrappedValue: .init(missionTypeDetail: missionTypeDetail, stepType: stepType))
        _finishedMissionType = finishedMissionType
    }

    var body: some View {
        ZStack {
            VStack(alignment: .leading) {
                if let missionType = presenter.missionType {
                    EmomilIconBubbleView(text: bubbleText, type: .horizontal, multilineTextAlignment: .leading)
                    MissionPreparationIconViewView(missionType: missionType)
                    Spacer()
                }

                NavigationLink(isActive: $presenter.shouldPushPage) {
                    nextPageView
                } label: {
                    Button {
                        Task {
                            await presenter.nextButtonTapped()
                        }
                    } label: {
                        Text(buttonText)
                    }
                }
            }
            RetryButton(didTap: $presenter.retryTapEvent)
                .isHidden(presenter.error == nil, remove: true)
        }
        .padding()
        .frame(maxWidth: .infinity)
        .overlayLoading(isPresented: $presenter.isLoading, allowsGesture: false)
        .background(CoreAssets.Color.Neutral.neutral5.swiftUIColor)
        .buttonStyle(CustomButtonStyle(.primary))
        .navigationTitle(CoreStrings.Common.request)
        .navigationBarBackButtonHidden(true)
        .toolbar {
            ToolbarItem(placement: .navigationBarLeading) {
                CloseButton(dismissEnable: false) {
                    navigator.shouldShowMissionPage = false
                }
            }
        }
        .task {
            await presenter.fetchMissionType()
        }
    }
}

---

## ğŸ¤– ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ
*2023/06/28 05:43:24*

`NavigationLink`ãŒè‡ªå‹•çš„ã«ç”»é¢é·ç§»ã‚’è¡Œã†ã®ã¯ãã®è¨­è¨ˆä¸Šã®ç‰¹æ€§ã§ã™ã€‚ä¸€èˆ¬çš„ã«`NavigationLink`ã®`isActive`ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯ç”»é¢é·ç§»ã®ãƒˆãƒªã‚¬ãƒ¼ã¨ãªã‚‹ãŸã‚ã€ã‚ãªãŸã®ã‚³ãƒ¼ãƒ‰ã«ãŠã‘ã‚‹`presenter.shouldPushPage`ãŒtrueã«ãªã‚‹ã¨ã™ãã«é·ç§»ãŒå§‹ã¾ã‚Šã¾ã™ã€‚ã“ã®ãŸã‚ã€`presenter.nextButtonTapped()`ãŒå®Œäº†ã™ã‚‹å‰ã«é·ç§»ãŒé–‹å§‹ã•ã‚Œã¦ã—ã¾ã„ã¾ã™ã€‚

ã“ã®å•é¡Œã‚’è§£æ±ºã™ã‚‹ãŸã‚ã®ä¸€ã¤ã®ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã¯ã€`presenter.nextButtonTapped()`ãŒçµ‚äº†ã™ã‚‹ã¾ã§é·ç§»ã‚’é…ã‚‰ã›ã‚‹ã“ã¨ã§ã™ã€‚å…·ä½“çš„ã«ã¯ã€`NavigationLink`ã®`isActive`ãŒç›´æ¥`presenter.shouldPushPage`ã«ãƒã‚¤ãƒ³ãƒ‰ã•ã‚Œã‚‹ã®ã§ã¯ãªãã€æ–°ãŸãª`@State`å¤‰æ•°ã‚’ä½œæˆã—ã¦ãã‚Œã«ãƒã‚¤ãƒ³ãƒ‰ã—ã¾ã™ã€‚ãã—ã¦ã€`presenter.nextButtonTapped()`ãŒçµ‚äº†ã—ãŸå¾Œã§ã€ãã®æ–°ãŸãª`@State`å¤‰æ•°ã‚’`presenter.shouldPushPage`ã®å€¤ã§æ›´æ–°ã—ã¾ã™ã€‚ã“ã†ã™ã‚‹ã“ã¨ã§ã€`NavigationLink`ã®`isActive`ãŒtrueã«ãªã‚Šã€ç”»é¢é·ç§»ãŒå§‹ã¾ã‚‹ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã‚’åˆ¶å¾¡ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

ã‚³ãƒ¼ãƒ‰ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™:

```swift
struct MissionPreparationView: View {
    //...
    @State private var shouldPush = false

    var body: some View {
        //...
        NavigationLink(destination: nextPageView, isActive: $shouldPush) {
            EmptyView()
        }
        //...
        Button {
            Task {
                await presenter.nextButtonTapped()
                shouldPush = presenter.shouldPushPage
            }
        } label: {
            Text(buttonText)
        }
        //...
    }
    //...
}
```

ã“ã®ä¿®æ­£ã«ã‚ˆã‚Šã€ãƒœã‚¿ãƒ³ãŒã‚¿ãƒƒãƒ—ã•ã‚Œã‚‹ã¨`presenter.nextButtonTapped()`ãŒå‘¼ã³å‡ºã•ã‚Œã€ãã®å‡¦ç†ãŒå®Œäº†ã—ãŸå¾Œã«ç”»é¢é·ç§»ãŒé–‹å§‹ã•ã‚Œã¾ã™ã€‚

---

## ğŸ‘¤ ãƒ¦ãƒ¼ã‚¶ãƒ¼
*2023/06/28 05:43:52*

ã‚‚ã£ã¨ã‚¹ãƒãƒ¼ãƒˆãªæ–¹æ³•ãªã„ã®ï¼Ÿ

---

## ğŸ¤– ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ
*2023/06/28 05:44:35*

ã¯ã„ã€ã‚‚ã†ä¸€ã¤ã®ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã¨ã—ã¦ã€ç”»é¢é·ç§»ã‚’ç®¡ç†ã™ã‚‹è²¬ä»»ã‚’`presenter`ã«å§”ã­ã‚‹ã“ã¨ãŒè€ƒãˆã‚‰ã‚Œã¾ã™ã€‚ãã‚Œã«ã‚ˆã‚Šã€ç”»é¢é·ç§»ã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã‚’`presenter`ã®åˆ¶å¾¡ä¸‹ã«ç½®ãã“ã¨ãŒã§ãã¾ã™ã€‚

`MissionPreparationPresenter`ã«`nextPage`ã¨ã„ã†`@Published`ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’è¿½åŠ ã—ã¾ã™ã€‚ã“ã®`nextPage`ã¯é·ç§»å…ˆã®ç”»é¢ï¼ˆãƒ“ãƒ¥ãƒ¼ï¼‰ã‚’ä¿æŒã—ã¾ã™ã€‚ãã—ã¦ã€`nextButtonTapped`ãƒ¡ã‚½ãƒƒãƒ‰å†…ã§ã€å¿…è¦ãªå‡¦ç†ãŒå…¨ã¦å®Œäº†ã—ãŸå¾Œã«`nextPage`ã‚’è¨­å®šã—ã¾ã™ã€‚

ãã‚Œã‹ã‚‰ã€`MissionPreparationView`å†…ã®`NavigationLink`ã®é·ç§»å…ˆã‚’`presenter.nextPage`ã«ãƒã‚¤ãƒ³ãƒ‰ã—ã¾ã™ã€‚ã“ã†ã™ã‚‹ã“ã¨ã§ã€`presenter.nextPage`ãŒnilã§ãªã„å ´åˆã«ã®ã¿é·ç§»ãŒè¡Œã‚ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

ã“ã“ã«å…·ä½“çš„ãªã‚³ãƒ¼ãƒ‰ã‚’ç¤ºã—ã¾ã™:

```swift
class MissionPreparationPresenter: ObservableObject {
    //...
    @Published var nextPage: AnyView? = nil

    func nextButtonTapped() async {
        //...
        // do your logic
        //...
        DispatchQueue.main.async {
            self.nextPage = AnyView(NextView()) // Replace `NextView()` with your actual next view.
        }
    }
}

struct MissionPreparationView: View {
    //...
    var body: some View {
        //...
        if let nextPage = presenter.nextPage {
            NavigationLink(destination: nextPage) {
                EmptyView()
            }
        }
        Button {
            Task {
                await presenter.nextButtonTapped()
            }
        } label: {
            Text(buttonText)
        }
        //...
    }
    //...
}
```

ã“ã®ã‚ˆã†ã«ã€é·ç§»å…ˆã®ç”»é¢ã‚’`presenter`ã§ç®¡ç†ã™ã‚‹ã“ã¨ã§ã€ç”»é¢é·ç§»ã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã‚’ã‚ˆã‚Šæ­£ç¢ºã«åˆ¶å¾¡ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ãŸã ã—ã€ã“ã®æ–¹æ³•ã§ã¯`AnyView`ã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™ã®ã§ã€å‹å®‰å…¨æ€§ãŒå¤±ã‚ã‚Œã¦ã—ã¾ã„ã¾ã™ã€‚ã¾ãŸã€`AnyView`ã¯ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã«å½±éŸ¿ã‚’åŠã¼ã™å¯èƒ½æ€§ã‚‚ã‚ã‚Šã¾ã™ã®ã§ã€ã”æ³¨æ„ãã ã•ã„ã€‚

---
