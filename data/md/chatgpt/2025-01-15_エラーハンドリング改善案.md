# ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°æ”¹å–„æ¡ˆ

Date: 2025-01-15

---

## ğŸ‘¤ User
*2025-01-15 20:06:05*

ã†ã¾ãã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã§ãã¦ã„ãªã„ã‚­ãƒ£ãƒƒãƒãƒ–ãƒ­ãƒƒã‚¯ã«è¡Œã£ã¦ã»ã—ã„

@riverpod
class RequestCodeNotifier extends _$RequestCodeNotifier {
  @override
  Future&lt;String?&gt; build() async =&gt; null;

  Future&lt;void&gt; requestCode(String email) async {
    state = const AsyncValue.loading();
    try {
      final api = await ref.watch(authApiProvider.future);
      final response = await api.authControllerSendCode(
        // AuthEamilDTO(email: email),
        // TODO: Remove this hard-coded email
        AuthEamilDTO(email: 'user1@example.com'),
      );
      throw Exception(response.data.toString());
      debugPrint('Response Body: ${response.data}');
      debugPrint('Response Body.data: ${response.data?.data}');

      if (response.data?.code == -1) {
        debugPrint('Response Body.code: ${response.data?.code}');
        debugPrint(
          'Response Body.errorMessage: ${response.data?.errorMessage}',
        );
        throw Exception(response.data.toString());
      }

      state = AsyncValue.data(response.data?.data);
    } on Exception catch (e, stackTrace) {
      debugPrint('Error: $e');
      debugPrint('StackTrace: $stackTrace');
      state = AsyncValue.error(e, stackTrace);
    }
  }
}

Future&lt;void&gt; onTapRerequestCode() async {
      try {
        await ref.read(requestCodeNotifierProvider.notifier).requestCode(email);

        if (context.mounted) {
          ScaffoldMessenger.of(context).showSnackBar(
            SnackBar(
              content: const Text(
                'Verification code sent to SNPIT app.\n'
                'Please open the SNPIT app.',
              ),
              action: SnackBarAction(
                label: 'Open',
                onPressed: () {
                  openSnapitApp(context);
                },
              ),
            ),
          );
        }
      } on Exception catch (error) {
        if (context.mounted) {
          ScaffoldMessenger.of(context).showSnackBar(
            SnackBar(content: Text('Failed to request code: $error')),
          );
        }
      }
    }

---

## ğŸ¤– Assistant
*2025-01-15 20:06:38*

ç¾åœ¨ã®ã‚³ãƒ¼ãƒ‰ã‚’è¦‹ã‚‹ã¨ã€`RequestCodeNotifier`å†…ã®`try-catch`ãƒ–ãƒ­ãƒƒã‚¯ã§ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãŒè¡Œã‚ã‚Œã¦ãŠã‚Šã€ãã®å¾Œã§`onTapRerequestCode`å†…ã§ã‚‚`try-catch`ãƒ–ãƒ­ãƒƒã‚¯ã‚’ä½¿ã£ã¦ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã‚’ã—ã¦ã„ã¾ã™ã€‚ãŸã ã—ã€ä»¥ä¸‹ã®ã„ãã¤ã‹ã®ãƒã‚¤ãƒ³ãƒˆã«ã‚ˆã‚Šã€ã‚¨ãƒ©ãƒ¼ãŒæœŸå¾…é€šã‚Šã«ã‚­ãƒ£ãƒƒãƒã•ã‚Œãªã„å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚

### å•é¡Œç‚¹ã®å¯èƒ½æ€§
1. **ã‚¨ãƒ©ãƒ¼ã‚¹ãƒ­ãƒ¼ç®‡æ‰€ã®é‡è¤‡**  
   `requestCode`ãƒ¡ã‚½ãƒƒãƒ‰å†…ã§ä½•åº¦ã‚‚`throw Exception`ã‚’ä½¿ç”¨ã—ã¦ãŠã‚Šã€ç‰¹ã«ä¸è¦ãªå ´æ‰€ã§ã‚¹ãƒ­ãƒ¼ã•ã‚Œã¦ã„ã‚‹ãŸã‚ã€ã‚¨ãƒ©ãƒ¼å‡¦ç†ãŒæ„å›³ã—ãªã„æŒ™å‹•ã‚’ã™ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚

2. **`AsyncValue.error`ã®ä½¿ç”¨ã«ã‚ˆã‚‹äºŒé‡ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°**  
   `RequestCodeNotifier`ã§`AsyncValue.error`ã‚’ã‚»ãƒƒãƒˆã—ã¦ã„ã¾ã™ãŒã€`onTapRerequestCode`å†…ã®`try-catch`ã¯ãã®ã‚¨ãƒ©ãƒ¼ã‚’ç›´æ¥å–å¾—ã™ã‚‹ã“ã¨ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚

3. **ãƒªãƒ•ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚¨ãƒ©ãƒ¼**  
   `ref.watch(authApiProvider.future)`ãŒæ­£ã—ãæ©Ÿèƒ½ã—ãªã„ã€ã¾ãŸã¯éåŒæœŸå‡¦ç†ã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚

---

### æ”¹å–„æ¡ˆ

ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã¯ã€ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã‚’ç°¡ç´ åŒ–ã—ã€ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿæ™‚ã«ã‚­ãƒ£ãƒƒãƒãƒ–ãƒ­ãƒƒã‚¯ã¸ç¢ºå®Ÿã«åˆ°é”ã™ã‚‹ã‚ˆã†ã«ã™ã‚‹ãŸã‚ã®ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã§ã™ã€‚

#### ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°å¾Œã®ã‚³ãƒ¼ãƒ‰

```dart
@riverpod
class RequestCodeNotifier extends _$RequestCodeNotifier {
  @override
  Future<String?> build() async => null;

  Future<void> requestCode(String email) async {
    state = const AsyncValue.loading(); // çŠ¶æ…‹ã‚’ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã«æ›´æ–°
    try {
      final api = await ref.watch(authApiProvider.future); // APIãƒ—ãƒ­ãƒã‚¤ãƒ€ã®èª­ã¿å–ã‚Š
      final response = await api.authControllerSendCode(
        AuthEamilDTO(email: email),
      );

      // ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãŒã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰ã‚’å«ã‚€å ´åˆã¯ä¾‹å¤–ã‚’ã‚¹ãƒ­ãƒ¼
      if (response.data?.code != 0) {
        throw Exception(response.data?.errorMessage ?? 'Unknown error occurred');
      }

      // æˆåŠŸæ™‚ã®å‡¦ç†
      state = AsyncValue.data(response.data?.data);
    } catch (e, stackTrace) {
      // ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿæ™‚ã®çŠ¶æ…‹ã‚’æ›´æ–°
      state = AsyncValue.error(e, stackTrace);
      rethrow; // å‘¼ã³å‡ºã—å…ƒã®try-catchã¸ã‚¨ãƒ©ãƒ¼ã‚’ä¼æ¬
    }
  }
}

Future<void> onTapRerequestCode(BuildContext context, String email) async {
  try {
    await ref.read(requestCodeNotifierProvider.notifier).requestCode(email);

    if (context.mounted) {
      ScaffoldMessenger.of(context).showSnackBar(
        SnackBar(
          content: const Text(
            'Verification code sent to SNPIT app.\n'
            'Please open the SNPIT app.',
          ),
          action: SnackBarAction(
            label: 'Open',
            onPressed: () {
              openSnapitApp(context);
            },
          ),
        ),
      );
    }
  } catch (e) {
    if (context.mounted) {
      ScaffoldMessenger.of(context).showSnackBar(
        SnackBar(content: Text('Failed to request code: $e')),
      );
    }
  }
}
```

---

### æ”¹å–„å†…å®¹

1. **é‡è¤‡ã—ãŸ`throw Exception`ã®å‰Šé™¤**  
   å¿…è¦ãªç®‡æ‰€ã§ã®ã¿ä¾‹å¤–ã‚’ã‚¹ãƒ­ãƒ¼ã™ã‚‹ã“ã¨ã§ã€ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®è¤‡é›‘ã•ã‚’è»½æ¸›ã—ã¾ã—ãŸã€‚

2. **`rethrow`ã®ä½¿ç”¨**  
   `RequestCodeNotifier`å†…ã§ã‚­ãƒ£ãƒƒãƒã—ãŸä¾‹å¤–ã‚’å†ã‚¹ãƒ­ãƒ¼ã—ã¦ã€å‘¼ã³å‡ºã—å…ƒã®`onTapRerequestCode`ã®`catch`ãƒ–ãƒ­ãƒƒã‚¯ã§å‡¦ç†ã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã—ãŸã€‚

3. **ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®æ˜ç¤º**  
   ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®`errorMessage`ãŒå­˜åœ¨ã™ã‚‹å ´åˆã¯ãã‚Œã‚’ã€å­˜åœ¨ã—ãªã„å ´åˆã¯`Unknown error occurred`ã‚’ã‚¹ãƒ­ãƒ¼ã™ã‚‹ã“ã¨ã§ã€ãƒ‡ãƒãƒƒã‚°ãŒã—ã‚„ã™ããªã‚Šã¾ã—ãŸã€‚

4. **çŠ¶æ…‹ç®¡ç†ã®æ˜ç¢ºåŒ–**  
   æˆåŠŸæ™‚ã¨ã‚¨ãƒ©ãƒ¼æ™‚ã®`AsyncValue`ã®æ›´æ–°ã‚’é©åˆ‡ã«è¡Œã„ã€UIãŒæ­£ç¢ºã«åæ˜ ã•ã‚Œã‚‹ã‚ˆã†ã«ã—ã¾ã—ãŸã€‚

---

### ãƒ†ã‚¹ãƒˆ
- **æˆåŠŸæ™‚**  
   ãƒ¡ãƒ¼ãƒ«ãŒæ­£ã—ãé€ä¿¡ã•ã‚Œã€ã‚¹ãƒŠãƒƒã‚¯ãƒãƒ¼ã§é€šçŸ¥ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¾ã™ã€‚
- **ã‚¨ãƒ©ãƒ¼æ™‚**  
   ä¾‹å¤–ãŒã‚­ãƒ£ãƒƒãƒãƒ–ãƒ­ãƒƒã‚¯ã¸åˆ°é”ã—ã€é©åˆ‡ãªã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¾ã™ã€‚

---

## ğŸ‘¤ User
*2025-01-15 20:07:12*

ã‚ˆãã‚ã‹ã£ã¦ã„ãªã„ã®ãŒ rethrow ã‚’ã™ã‚‹ã¨ã§ããªããªã‚‹ã“ã¨ã£ã¦ã‚ã‚‹ã®ï¼Ÿ

---

## ğŸ¤– Assistant
*2025-01-15 20:07:51*

`rethrow` ã‚’ä½¿ã†å ´åˆã«åˆ¶é™ã•ã‚Œã‚‹ç‚¹ã‚„æ³¨æ„ãŒå¿…è¦ãªç‚¹ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ã€‚`rethrow` è‡ªä½“ã¯ä¾¿åˆ©ã§ã™ãŒã€ç‰¹å®šã®çŠ¶æ³ã§ã¯æœŸå¾…ã—ãŸå‹•ä½œãŒå¾—ã‚‰ã‚Œãªã„å¯èƒ½æ€§ãŒã‚ã‚‹ãŸã‚ã€æ…é‡ã«ä½¿ã†å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

---

## **1. `rethrow` ã¯ã‚­ãƒ£ãƒƒãƒã—ãŸä¾‹å¤–ã—ã‹ã‚¹ãƒ­ãƒ¼ã§ããªã„**
`rethrow` ã¯ `catch` ãƒ–ãƒ­ãƒƒã‚¯å†…ã§æ•ã¾ãˆãŸä¾‹å¤–ã‚’ãã®ã¾ã¾å†ã‚¹ãƒ­ãƒ¼ã™ã‚‹æ©Ÿèƒ½ã§ã™ã€‚ä»¥ä¸‹ã®ç‚¹ã«æ³¨æ„ã—ã¦ãã ã•ã„ï¼š

- **æ–°ã—ã„ä¾‹å¤–ã‚’ã‚¹ãƒ­ãƒ¼ã™ã‚‹ã“ã¨ã¯ã§ããªã„**
  ```dart
  try {
    // Some code that might throw an exception
  } catch (e) {
    rethrow; // ã“ã“ã§ e ã‚’ãã®ã¾ã¾å†ã‚¹ãƒ­ãƒ¼
  }
  ```

  ãŸã ã—ã€æ–°ã—ã„ä¾‹å¤–ã‚’ã‚¹ãƒ­ãƒ¼ã™ã‚‹å ´åˆã¯ `throw` ã‚’ä½¿ã†å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼š
  ```dart
  try {
    // Some code that might throw an exception
  } catch (e) {
    throw Exception('New exception: $e'); // æ–°ã—ã„ä¾‹å¤–ã‚’ç”Ÿæˆã—ã¦ã‚¹ãƒ­ãƒ¼
  }
  ```

  **çµæœ**:  
  `rethrow` ã¯ã€å…ƒã®ä¾‹å¤–ã‚’åŠ å·¥ã›ãšå†åˆ©ç”¨ã™ã‚‹å ´åˆã«ã®ã¿ä½¿ãˆã¾ã™ã€‚

---

## **2. å‘¼ã³å‡ºã—å…ƒã§é©åˆ‡ã«ã‚­ãƒ£ãƒƒãƒã—ãªã„ã¨ä¾‹å¤–ãŒã‚¢ãƒ—ãƒªå…¨ä½“ã«ä¼æ’­ã™ã‚‹**
`rethrow` ã•ã‚ŒãŸä¾‹å¤–ãŒä¸Šä½ã®å‘¼ã³å‡ºã—å…ƒã§ã‚­ãƒ£ãƒƒãƒã•ã‚Œãªã„å ´åˆã€ä¾‹å¤–ã¯ã‚¢ãƒ—ãƒªå…¨ä½“ã«ä¼æ’­ã—ã¦ã‚¯ãƒ©ãƒƒã‚·ãƒ¥ã®åŸå› ã«ãªã‚Šã¾ã™ã€‚

```dart
void someFunction() {
  try {
    throw Exception('Error occurred');
  } catch (e) {
    rethrow; // ä¸Šä½ã§ã‚­ãƒ£ãƒƒãƒã•ã‚Œãªã‘ã‚Œã°ã‚¢ãƒ—ãƒªãŒã‚¯ãƒ©ãƒƒã‚·ãƒ¥
  }
}

void main() {
  someFunction(); // ã‚­ãƒ£ãƒƒãƒã—ãªã„ã¨ä¾‹å¤–ãŒä¼æ’­
}
```

è§£æ±ºç­–ã¨ã—ã¦ã€å‘¼ã³å‡ºã—å…ƒã§é©åˆ‡ã«ä¾‹å¤–ã‚’ã‚­ãƒ£ãƒƒãƒã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼š
```dart
void main() {
  try {
    someFunction();
  } catch (e) {
    print('Caught exception: $e'); // ã‚¢ãƒ—ãƒªã®ã‚¯ãƒ©ãƒƒã‚·ãƒ¥ã‚’é˜²ã
  }
}
```

---

## **3. ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹ãŒå¤‰ã‚ã‚‰ãªã„**
`rethrow` ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹ã¯å…ƒã®ä¾‹å¤–ã®ã‚‚ã®ãŒç¶­æŒã•ã‚Œã¾ã™ã€‚ã“ã‚Œã¯é€šå¸¸ã¯ãƒ¡ãƒªãƒƒãƒˆã§ã™ãŒã€ä¾‹å¤–ã‚’åŠ å·¥ã—ã¦æ–°ã—ã„æƒ…å ±ã‚’è¿½åŠ ã™ã‚‹å¿…è¦ãŒã‚ã‚‹å ´åˆã«ã¯ä¸éƒ½åˆã§ã™ã€‚

ä¾‹ï¼š
```dart
try {
  throw Exception('Original error');
} catch (e, stackTrace) {
  print(stackTrace); // å…ƒã®ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹ã‚’è¡¨ç¤º
  rethrow;
}
```

**æ–°ã—ã„æƒ…å ±ã‚’è¿½åŠ ã—ãŸã„å ´åˆã¯ã€ä¾‹å¤–ã‚’å†ç”Ÿæˆã—ã¦ã‚¹ãƒ­ãƒ¼ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼š**
```dart
try {
  throw Exception('Original error');
} catch (e, stackTrace) {
  throw Exception('Additional context: $e');
}
```

---

## **4. éåŒæœŸå‡¦ç†ã¨ã®çµ„ã¿åˆã‚ã›**
éåŒæœŸå‡¦ç†ã§ä¾‹å¤–ã‚’å†ã‚¹ãƒ­ãƒ¼ã™ã‚‹ã¨ãã€`Future` ã®ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã«æ³¨æ„ãŒå¿…è¦ã§ã™ã€‚ä¾‹ãˆã°ã€éåŒæœŸé–¢æ•°å†…ã§ä¾‹å¤–ãŒç™ºç”Ÿã—ãŸå ´åˆã€ãã®ä¾‹å¤–ã¯é€šå¸¸ `Future` ã‚’é€šã˜ã¦è¿”ã•ã‚Œã¾ã™ã€‚

ä¾‹ï¼š
```dart
Future<void> asyncFunction() async {
  try {
    throw Exception('Error in async function');
  } catch (e) {
    rethrow; // å‘¼ã³å‡ºã—å…ƒã§ã‚­ãƒ£ãƒƒãƒã™ã‚‹å¿…è¦ã‚ã‚Š
  }
}

void main() async {
  try {
    await asyncFunction();
  } catch (e) {
    print('Caught exception: $e');
  }
}
```

**æ³¨æ„ç‚¹:**  
éåŒæœŸå‡¦ç†ã®å ´åˆã€`rethrow` ã‚’ä½¿ã£ã¦ã‚‚å‘¼ã³å‡ºã—å…ƒãŒ `await` ã—ã¦ã„ãªã„ã¨ä¾‹å¤–ã‚’ã‚­ãƒ£ãƒƒãƒã§ããšã«ã‚¹ãƒ«ãƒ¼ã•ã‚Œã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚

---

## **`rethrow` ã‚’ä½¿ã†ã¹ãå ´åˆã¨ä½¿ã‚ãªã„ã¹ãå ´åˆ**
### **ä½¿ã†ã¹ãå ´åˆ**
- å…ƒã®ä¾‹å¤–ã‚’ãã®ã¾ã¾å‘¼ã³å‡ºã—å…ƒã«ä¼ãˆãŸã„ã¨ãã€‚
- ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã‚’å‘¼ã³å‡ºã—å…ƒã«ä»»ã›ãŸã„ã¨ãã€‚
- ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹ã‚’ç¶­æŒã—ã¦ãƒ‡ãƒãƒƒã‚°ã‚’å®¹æ˜“ã«ã—ãŸã„ã¨ãã€‚

### **ä½¿ã‚ãªã„ã¹ãå ´åˆ**
- ä¾‹å¤–ã«æ–°ã—ã„æƒ…å ±ã‚„æ–‡è„ˆã‚’è¿½åŠ ã—ãŸã„ã¨ãã€‚
- å‘¼ã³å‡ºã—å…ƒãŒä¾‹å¤–ã‚’ã‚­ãƒ£ãƒƒãƒã—ãªã„å ´åˆã«ã‚¯ãƒ©ãƒƒã‚·ãƒ¥ãŒè¨±å®¹ã•ã‚Œãªã„ã¨ãã€‚

---

## **ã¾ã¨ã‚**
`rethrow` ã‚’ä½¿ã†ã¨ä¾‹å¤–ã®ä¼æ’­ãŒç°¡æ½”ã«ãªã‚Šã¾ã™ãŒã€ãã®æ€§è³ªä¸Šã€**å…ƒã®ä¾‹å¤–ã‚’ãã®ã¾ã¾ä¼ãˆã‚‹**ã¨ã„ã†ã‚·ãƒ³ãƒ—ãƒ«ãªä½¿ã„æ–¹ã«å‘ã„ã¦ã„ã¾ã™ã€‚å¿…è¦ã«å¿œã˜ã¦ä¾‹å¤–ã«è¿½åŠ æƒ…å ±ã‚’åŠ ãˆã‚‹å ´åˆã‚„ã€ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹ã‚’æ–°ãŸã«ãƒªã‚»ãƒƒãƒˆã™ã‚‹å¿…è¦ãŒã‚ã‚‹å ´åˆã¯ã€`throw` ã‚’ä½¿ã†ã»ã†ãŒæŸ”è»Ÿã§ã™ã€‚

æ˜ç¢ºãªç›®çš„ã«å¿œã˜ã¦ã€`throw` ã¨ `rethrow` ã‚’ä½¿ã„åˆ†ã‘ã‚‹ã“ã¨ãŒé‡è¦ã§ã™ï¼

---

## ğŸ‘¤ User
*2025-01-15 20:09:19*

ã“ã®æ‰‹ã®Notifierã¯rethrowã™ã‚‹ã®ãŒç„¡é›£ãªã®ã‹ãªï¼Ÿ

import 'package:flutter/foundation.dart';
import 'package:riverpod_annotation/riverpod_annotation.dart';
import 'package:snpit_guild_app/infrastructure/snapit_guild_api/snapit_guild_api.openapi.dart';
import 'package:snpit_guild_app/presentation/providers/api_client/api_provider.dart';

part 'request_code.g.dart';

@riverpod
class RequestCodeNotifier extends _$RequestCodeNotifier {
  @override
  Future&lt;String?&gt; build() async =&gt; null;

  Future&lt;void&gt; requestCode(String email) async {
    state = const AsyncValue.loading();
    try {
      final api = await ref.watch(authApiProvider.future);
      final response = await api.authControllerSendCode(
        // AuthEamilDTO(email: email),
        // TODO: Remove this hard-coded email
        AuthEamilDTO(email: 'user1@example.com'),
      );
      throw Exception(response.data.toString());
      debugPrint('Response Body: ${response.data}');
      debugPrint('Response Body.data: ${response.data?.data}');

      if (response.data?.code == -1) {
        debugPrint('Response Body.code: ${response.data?.code}');
        debugPrint(
          'Response Body.errorMessage: ${response.data?.errorMessage}',
        );
        throw Exception(response.data.toString());
      }

      state = AsyncValue.data(response.data?.data);
    } on Exception catch (e, stackTrace) {
      debugPrint('Error: $e');
      debugPrint('StackTrace: $stackTrace');
      state = AsyncValue.error(e, stackTrace);
      rethrow;
    }
  }
}

---

## ğŸ¤– Assistant
*2025-01-15 20:10:16*

ã“ã®ã‚ˆã†ãª `Notifier` ã‚¯ãƒ©ã‚¹ã§ `rethrow` ã‚’ä½¿ç”¨ã™ã‚‹ã‹ã©ã†ã‹ã¯ã€ä»¥ä¸‹ã®è¨­è¨ˆæ–¹é‡ã‚„ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã«ä¾å­˜ã—ã¾ã™ã€‚

---

## **`rethrow` ã‚’ä½¿ã†ã“ã¨ã®ãƒ¡ãƒªãƒƒãƒˆ**

1. **å‘¼ã³å‡ºã—å…ƒã§è©³ç´°ãªã‚¨ãƒ©ãƒ¼å‡¦ç†ã‚’å¯èƒ½ã«ã™ã‚‹**  
   `rethrow` ã‚’ä½¿ã†ã¨ã€ä¾‹å¤–ã‚’å‘¼ã³å‡ºã—å…ƒã«ä¼æ’­ã•ã›ã‚‹ãŸã‚ã€å‘¼ã³å‡ºã—å…ƒã§ç‹¬è‡ªã®ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãƒ­ã‚¸ãƒƒã‚¯ã‚’è¿½åŠ ã§ãã¾ã™ã€‚ä¾‹ãˆã°ã€UI ã§ã‚¹ãƒŠãƒƒã‚¯ãƒãƒ¼ã‚’è¡¨ç¤ºã™ã‚‹å‡¦ç†ã‚’è¡Œã„ãŸã„å ´åˆã‚„ã€ç‰¹å®šã®ã‚¨ãƒ©ãƒ¼ã«å¿œã˜ãŸãƒªãƒˆãƒ©ã‚¤å‡¦ç†ã‚’è¡Œã„ãŸã„å ´åˆã«ä¾¿åˆ©ã§ã™ã€‚

2. **ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹ã®ç¶­æŒ**  
   å…ƒã®ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹ãŒä¿æŒã•ã‚Œã‚‹ãŸã‚ã€ãƒ‡ãƒãƒƒã‚°æ™‚ã«ã©ã“ã§ä¾‹å¤–ãŒç™ºç”Ÿã—ãŸã®ã‹ãŒåˆ†ã‹ã‚Šã‚„ã™ããªã‚Šã¾ã™ã€‚

---

## **`rethrow` ã‚’ä½¿ã†éš›ã®æ³¨æ„ç‚¹**

1. **äºŒé‡ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®ãƒªã‚¹ã‚¯**  
   `Notifier` å†…ã§ `AsyncValue.error` ã‚’ã‚»ãƒƒãƒˆã—ã¦ã„ã‚‹å ´åˆã€å‘¼ã³å‡ºã—å…ƒã§ã‚‚åŒã˜ä¾‹å¤–ãŒã‚­ãƒ£ãƒƒãƒã•ã‚Œã¦äºŒé‡ã§ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã‚’è¡Œã£ã¦ã—ã¾ã†å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ã‚³ãƒ¼ãƒ‰ãŒè¤‡é›‘åŒ–ã™ã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚

2. **ä¾‹å¤–ãŒä¼æ’­ã—ã™ãã‚‹**  
   å‘¼ã³å‡ºã—å…ƒãŒä¾‹å¤–ã‚’ã‚­ãƒ£ãƒƒãƒã—ãªã„å ´åˆã€ä¾‹å¤–ãŒã‚¢ãƒ—ãƒªå…¨ä½“ã«ä¼æ’­ã—ã€ã‚¯ãƒ©ãƒƒã‚·ãƒ¥ã®åŸå› ã«ãªã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚

---

## **`rethrow` ã‚’ä½¿ã†ã¹ãã‹ã©ã†ã‹ã®åˆ¤æ–­åŸºæº–**

### **`rethrow` ã‚’ä½¿ã†ã¹ãå ´åˆ**
- **ä¾‹å¤–ã‚’å‘¼ã³å‡ºã—å…ƒã§å‡¦ç†ã™ã‚‹å¿…è¦ãŒã‚ã‚‹å ´åˆ**
  - å‘¼ã³å‡ºã—å…ƒã§ä¾‹å¤–ã«å¿œã˜ãŸæŒ¯ã‚‹èˆã„ã‚’ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã™ã‚‹ã€‚
  - ä¾‹å¤–ã®è©³ç´°ãªæƒ…å ±ã‚’å‘¼ã³å‡ºã—å…ƒã§æ´»ç”¨ã—ãŸã„ã€‚
- **ãƒ‡ãƒãƒƒã‚°æ™‚ã«ä¾‹å¤–ã®ç™ºç”Ÿç®‡æ‰€ã‚’è©³ç´°ã«çŸ¥ã‚ŠãŸã„å ´åˆ**
  - ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹ã‚’ä¿æŒã™ã‚‹ã“ã¨ã§ã€ä¾‹å¤–ã®ç™ºç”Ÿå…ƒã‚’è¿½è·¡ã—ã‚„ã™ãã™ã‚‹ã€‚

### **`rethrow` ã‚’é¿ã‘ã‚‹ã¹ãå ´åˆ**
- **`Notifier` ã§ã‚¨ãƒ©ãƒ¼ã‚’å®Œçµã•ã›ãŸã„å ´åˆ**
  - ä¾‹å¤–ã‚’ `AsyncValue.error` ã«è¨­å®šã—ã¦ã€UI å´ã§ãã®çŠ¶æ…‹ã‚’ç›´æ¥ç›£è¦–ã™ã‚‹å½¢ã«ã—ãŸã„å ´åˆã€‚
- **ä¾‹å¤–ã‚’åŠ å·¥ã—ã¦åˆ¥ã®å½¢å¼ã§æ‰±ã„ãŸã„å ´åˆ**
  - ä¾‹å¤–ã«ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚’è¿½åŠ ã™ã‚‹å¿…è¦ãŒã‚ã‚‹å ´åˆã¯ã€`throw` ã‚’ä½¿ã£ã¦æ–°ã—ã„ä¾‹å¤–ã‚’ã‚¹ãƒ­ãƒ¼ã™ã‚‹æ–¹ãŒé©åˆ‡ã§ã™ã€‚

---

## **ä»£æ›¿æ¡ˆï¼š`rethrow` ã‚’ä½¿ã‚ãªã„è¨­è¨ˆ**

`Notifier` å†…ã§ã‚¨ãƒ©ãƒ¼å‡¦ç†ã‚’å®Œçµã•ã›ã‚‹å ´åˆã¯ã€`rethrow` ã‚’ä½¿ã‚ãšã«ä»¥ä¸‹ã®ã‚ˆã†ã«å®Ÿè£…ã—ã¾ã™ï¼š

```dart
@riverpod
class RequestCodeNotifier extends _$RequestCodeNotifier {
  @override
  Future<String?> build() async => null;

  Future<void> requestCode(String email) async {
    state = const AsyncValue.loading();
    try {
      final api = await ref.watch(authApiProvider.future);
      final response = await api.authControllerSendCode(
        AuthEamilDTO(email: email),
      );

      if (response.data?.code == -1) {
        throw Exception(response.data?.errorMessage ?? 'Unknown error');
      }

      state = AsyncValue.data(response.data?.data);
    } catch (e, stackTrace) {
      // ã‚¨ãƒ©ãƒ¼ã‚’ AsyncValue ã«ã‚»ãƒƒãƒˆã—ã¦ã€å‘¼ã³å‡ºã—å…ƒã«ä¼æ’­ã—ãªã„
      state = AsyncValue.error(e, stackTrace);
    }
  }
}
```

---

## **`rethrow` ã‚’ä½¿ã†å ´åˆã®è¨­è¨ˆä¾‹**

å‘¼ã³å‡ºã—å…ƒã§ä¾‹å¤–ã‚’å‡¦ç†ã•ã›ãŸã„å ´åˆã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ã« `rethrow` ã‚’åˆ©ç”¨ã—ã¾ã™ï¼š

```dart
@riverpod
class RequestCodeNotifier extends _$RequestCodeNotifier {
  @override
  Future<String?> build() async => null;

  Future<void> requestCode(String email) async {
    state = const AsyncValue.loading();
    try {
      final api = await ref.watch(authApiProvider.future);
      final response = await api.authControllerSendCode(
        AuthEamilDTO(email: email),
      );

      if (response.data?.code == -1) {
        throw Exception(response.data?.errorMessage ?? 'Unknown error');
      }

      state = AsyncValue.data(response.data?.data);
    } catch (e, stackTrace) {
      state = AsyncValue.error(e, stackTrace); // çŠ¶æ…‹ã¯æ›´æ–°
      rethrow; // ä¾‹å¤–ã‚’å‘¼ã³å‡ºã—å…ƒã«ä¼æ’­
    }
  }
}
```

å‘¼ã³å‡ºã—å…ƒã§ä¾‹å¤–ã‚’å‡¦ç†ï¼š

```dart
Future<void> handleRequestCode(BuildContext context, String email) async {
  try {
    await ref.read(requestCodeNotifierProvider.notifier).requestCode(email);
    ScaffoldMessenger.of(context).showSnackBar(
      const SnackBar(content: Text('Code sent successfully')),
    );
  } catch (e) {
    ScaffoldMessenger.of(context).showSnackBar(
      SnackBar(content: Text('Failed to send code: $e')),
    );
  }
}
```

---

## **çµè«–**

### **`rethrow` ã‚’ä½¿ã†ã¹ãå ´åˆ**
- å‘¼ã³å‡ºã—å…ƒã§ä¾‹å¤–ã‚’å‡¦ç†ã—ãŸã„å ´åˆã€‚

### **`rethrow` ã‚’é¿ã‘ã‚‹ã¹ãå ´åˆ**
- ä¾‹å¤–ã‚’ `Notifier` å†…ã§å®Œå…¨ã«å‡¦ç†ã™ã‚‹å ´åˆã€‚
- çŠ¶æ…‹ç®¡ç† (`AsyncValue`) ã«ã‚¨ãƒ©ãƒ¼ã‚’åæ˜ ã™ã‚‹ã ã‘ã§ååˆ†ãªå ´åˆã€‚

**ã€ŒNotifier ã®è²¬å‹™ã€ã‚’ã©ã“ã¾ã§ã«ã™ã‚‹ã‹**ã§æ±ºã‚ã‚‹ã®ãŒæœ€é©ã§ã™ã€‚

---

## ğŸ‘¤ User
*2025-01-15 20:10:35*

AsyncValue.error ã®å®šç¾©ã¯ã‚ˆãã™ã‚‹ã€‚
UIä¸Šã§ã©ã†ã™ã¹ãã‹ã®åˆ¤æ–­ã‚’ã—ãŸã„ã€‚
UIã§ã¯ã‚¨ãƒ©ãƒ¼ã‚’å‡ºã™ã ã‘ã§ã€try catch ã§ã‚¹ãƒŠãƒƒã‚¯ãƒãƒ¼ã®ã‚ˆã†ãªã™ã¿ã‚ã‘ãŒã„ã„ã®ã‹ãªï¼Ÿ

---

## ğŸ¤– Assistant
*2025-01-15 20:11:33*

`AsyncValue.error` ã‚’å®šç¾©ã—ã¦ UI ä¸Šã§ã‚¨ãƒ©ãƒ¼è¡¨ç¤ºã‚’è¡Œã†å ´åˆã¨ã€`try-catch` ã‚’ä½¿ã£ã¦ç›´æ¥ã‚¹ãƒŠãƒƒã‚¯ãƒãƒ¼ã®ã‚ˆã†ãªã‚¨ãƒ©ãƒ¼é€šçŸ¥ã‚’è¡Œã†å ´åˆã«ã¯ã€ãã‚Œãã‚Œé©åˆ‡ãªãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ãŒã‚ã‚Šã¾ã™ã€‚ãã®ã€Œä½ã¿åˆ†ã‘ã€ã‚’æ˜ç¢ºã«ã™ã‚‹ã“ã¨ã§ã€è²¬å‹™ã‚’åˆ†é›¢ã—ã¤ã¤ã€æŸ”è»Ÿãªã‚¨ãƒ©ãƒ¼å‡¦ç†ãŒå¯èƒ½ã«ãªã‚Šã¾ã™ã€‚

ä»¥ä¸‹ã§ã€ã©ã®ã‚ˆã†ã«ä½¿ã„åˆ†ã‘ã‚‹ã¹ãã‹ã‚’è§£èª¬ã—ã¾ã™ã€‚

---

## **`AsyncValue.error` ã®å½¹å‰²**

`AsyncValue.error` ã¯ **çŠ¶æ…‹ç®¡ç†ã¨ã‚¨ãƒ©ãƒ¼æƒ…å ±ã®ä¼æ¬** ã«ç‰¹åŒ–ã—ã¦ã„ã¾ã™ã€‚  
ã“ã‚Œã«ã‚ˆã‚Šã€ä»¥ä¸‹ã®ã‚ˆã†ãªç‰¹å¾´ãŒã‚ã‚Šã¾ã™ï¼š

### **ç‰¹å¾´**
1. **UI ãƒ¬ãƒ™ãƒ«ã§ã‚¨ãƒ©ãƒ¼ã‚’ç°¡å˜ã«è¡¨ç¤º**  
   çŠ¶æ…‹ãŒ `AsyncValue.error` ã®å ´åˆã«ã€å°‚ç”¨ã® UIï¼ˆä¾‹ãˆã°ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚„å†è©¦è¡Œãƒœã‚¿ãƒ³ï¼‰ã‚’è¡¨ç¤ºã§ãã¾ã™ã€‚

2. **éåŒæœŸæ“ä½œã®çŠ¶æ…‹ã‚’ä¸€å…ƒç®¡ç†**  
   `loading`ã€`data`ã€`error` ã® 3 çŠ¶æ…‹ã‚’çµ±ä¸€çš„ã«æ‰±ãˆã‚‹ãŸã‚ã€UI ãƒ­ã‚¸ãƒƒã‚¯ãŒç°¡æ½”ã«ãªã‚Šã¾ã™ã€‚

3. **å‘¼ã³å‡ºã—å…ƒã§ã‚¨ãƒ©ãƒ¼ã®è©³ç´°ã‚’è€ƒæ…®ã—ãªã„**  
   ã‚¨ãƒ©ãƒ¼ã®è¡¨ç¤ºæ–¹æ³•ãŒ `AsyncValue` ã‚’ä»‹ã—ã¦ä¸€è²«ã™ã‚‹ãŸã‚ã€å‘¼ã³å‡ºã—å…ƒã§ä¾‹å¤–å‡¦ç†ã‚’è¡Œã†å¿…è¦ãŒå°‘ãªããªã‚Šã¾ã™ã€‚

---

## **`try-catch` ã§ã‚¹ãƒŠãƒƒã‚¯ãƒãƒ¼ã‚’è¡¨ç¤ºã™ã‚‹å½¹å‰²**

`try-catch` ã‚’ä½¿ã£ãŸã‚¨ãƒ©ãƒ¼å‡¦ç†ã¯ã€**ãƒ¦ãƒ¼ã‚¶ãƒ¼é€šçŸ¥ã‚„ç‰¹å®šã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã«åŸºã¥ã„ãŸã‚¨ãƒ©ãƒ¼é€šçŸ¥**ã«é©ã—ã¦ã„ã¾ã™ã€‚

### **ç‰¹å¾´**
1. **å³æ™‚é€šçŸ¥ãŒå¯èƒ½**  
   æ“ä½œå¾Œã«ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«å³åº§ã«é€šçŸ¥ï¼ˆã‚¹ãƒŠãƒƒã‚¯ãƒãƒ¼ãªã©ï¼‰ã‚’è¡¨ç¤ºã—ãŸã„å ´åˆã«æœ‰åŠ¹ã§ã™ã€‚

2. **ã‚«ã‚¹ã‚¿ãƒ å‡¦ç†ã«å¯¾å¿œ**  
   ã‚¨ãƒ©ãƒ¼ã®ç¨®é¡ã«ã‚ˆã£ã¦ç•°ãªã‚‹å‡¦ç†ï¼ˆä¾‹: ç‰¹å®šã®ã‚¨ãƒ©ãƒ¼æ™‚ã®ã¿ãƒªãƒˆãƒ©ã‚¤ã‚„ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œï¼‰ã‚’å®Ÿè¡Œã§ãã¾ã™ã€‚

3. **è£œå®Œçš„ãªå½¹å‰²**  
   `AsyncValue.error` ã‚’åˆ©ç”¨ã™ã‚‹ã®ãŒé©ã•ãªã„ã€é™å®šçš„ãªã‚¨ãƒ©ãƒ¼é€šçŸ¥ã«ä½¿ãˆã¾ã™ã€‚

---

## **å…·ä½“çš„ãªä½ã¿åˆ†ã‘**

ä»¥ä¸‹ã®åŸºæº–ã§ `AsyncValue.error` ã¨ `try-catch` ã‚’ä½ã¿åˆ†ã‘ã‚‹ã¨ã€ã‚ˆã‚Šç›´æ„Ÿçš„ã§è²¬å‹™ãŒåˆ†é›¢ã•ã‚ŒãŸè¨­è¨ˆã«ãªã‚Šã¾ã™ã€‚

### **1. UI è¡¨ç¤ºã§å®Œçµã™ã‚‹å ´åˆï¼š`AsyncValue.error`**
- ç”»é¢ä¸Šã§ã‚¨ãƒ©ãƒ¼ã‚’è¦–è¦šçš„ã«è¡¨ç¤ºã™ã‚‹å¿…è¦ãŒã‚ã‚‹å ´åˆã€‚
- å†è©¦è¡Œãƒœã‚¿ãƒ³ã‚’æä¾›ã—ãŸã„å ´åˆã€‚

#### å®Ÿè£…ä¾‹
```dart
Widget build(BuildContext context, WidgetRef ref) {
  final requestCodeState = ref.watch(requestCodeNotifierProvider);

  return requestCodeState.when(
    data: (data) => Text('Success: $data'),
    loading: () => const CircularProgressIndicator(),
    error: (e, stackTrace) => Column(
      children: [
        Text('Error: ${e.toString()}'),
        ElevatedButton(
          onPressed: () {
            ref.read(requestCodeNotifierProvider.notifier).requestCode('email@example.com');
          },
          child: const Text('Retry'),
        ),
      ],
    ),
  );
}
```

### **2. å³æ™‚é€šçŸ¥ãŒå¿…è¦ãªå ´åˆï¼š`try-catch`**
- æ“ä½œã®çµæœã‚’ã™ãã«é€šçŸ¥ã—ãŸã„å ´åˆï¼ˆã‚¹ãƒŠãƒƒã‚¯ãƒãƒ¼ãªã©ï¼‰ã€‚
- éåŒæœŸæ“ä½œã«ç‰¹åŒ–ã—ãŸã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãŒä¸è¦ãªå ´åˆã€‚

#### å®Ÿè£…ä¾‹
```dart
Future<void> onRequestCode(BuildContext context, String email) async {
  try {
    await ref.read(requestCodeNotifierProvider.notifier).requestCode(email);
    ScaffoldMessenger.of(context).showSnackBar(
      const SnackBar(content: Text('Verification code sent successfully')),
    );
  } catch (e) {
    ScaffoldMessenger.of(context).showSnackBar(
      SnackBar(content: Text('Failed to send verification code: $e')),
    );
  }
}
```

---

## **ä½ã¿åˆ†ã‘ã®ãƒ•ãƒ­ãƒ¼**

1. **éåŒæœŸçŠ¶æ…‹ã‚’ UI ä¸Šã§ç®¡ç†ã—ãŸã„ã‹ï¼Ÿ**  
   - **ã¯ã„** â†’ `AsyncValue.error` ã‚’ä½¿ã†ã€‚
   - **ã„ã„ãˆ** â†’ æ¬¡ã«é€²ã‚€ã€‚

2. **æ“ä½œå¾Œã«å³åº§ã«é€šçŸ¥ãŒå¿…è¦ã‹ï¼Ÿ**  
   - **ã¯ã„** â†’ `try-catch` ã‚’ä½¿ã†ã€‚
   - **ã„ã„ãˆ** â†’ çŠ¶æ³ã«å¿œã˜ã¦ `AsyncValue.error` ã‚’æ¤œè¨ã€‚

---

## **ä½µç”¨ã™ã‚‹å ´åˆã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹**

ä»¥ä¸‹ã®ã‚ˆã†ã«ã€`AsyncValue.error` ã¨ `try-catch` ã‚’ä½µç”¨ã—ã¦ã€ãã‚Œãã‚Œã®è²¬å‹™ã‚’åˆ†é›¢ã™ã‚‹ã“ã¨ã‚‚å¯èƒ½ã§ã™ï¼š

1. **éåŒæœŸå‡¦ç†ã®çŠ¶æ…‹ã‚’ UI ã§ç®¡ç†**  
   â†’ `AsyncValue.error` ã§ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¨ãƒªãƒˆãƒ©ã‚¤æ©Ÿèƒ½ã‚’æä¾›ã€‚

2. **å³æ™‚é€šçŸ¥**  
   â†’ `try-catch` ã‚’ä½¿ã„ã€æˆåŠŸæ™‚ã‚„å¤±æ•—æ™‚ã«ãƒ¦ãƒ¼ã‚¶ãƒ¼é€šçŸ¥ã‚’å®Ÿè¡Œã€‚

#### å®Ÿè£…ä¾‹ï¼ˆä½µç”¨ï¼‰
```dart
Future<void> onRequestCode(BuildContext context, String email) async {
  try {
    await ref.read(requestCodeNotifierProvider.notifier).requestCode(email);

    // æˆåŠŸé€šçŸ¥
    ScaffoldMessenger.of(context).showSnackBar(
      const SnackBar(content: Text('Verification code sent successfully')),
    );
  } catch (e) {
    // å³æ™‚ã‚¨ãƒ©ãƒ¼é€šçŸ¥
    ScaffoldMessenger.of(context).showSnackBar(
      SnackBar(content: Text('Failed to send verification code: $e')),
    );
  }
}

// UI å´
Widget build(BuildContext context, WidgetRef ref) {
  final requestCodeState = ref.watch(requestCodeNotifierProvider);

  return requestCodeState.when(
    data: (data) => Text('Success: $data'),
    loading: () => const CircularProgressIndicator(),
    error: (e, stackTrace) => Column(
      children: [
        Text('Error: ${e.toString()}'),
        ElevatedButton(
          onPressed: () {
            ref.read(requestCodeNotifierProvider.notifier).requestCode('email@example.com');
          },
          child: const Text('Retry'),
        ),
      ],
    ),
  );
}
```

---

## **ã¾ã¨ã‚**

- **`AsyncValue.error` ã®ä¸»ãªå½¹å‰²**: éåŒæœŸå‡¦ç†ã®çŠ¶æ…‹ã‚’ UI ã§ç®¡ç†ã—ã€ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç”»é¢ã«è¡¨ç¤ºã™ã‚‹ã€‚
- **`try-catch` ã®ä¸»ãªå½¹å‰²**: å³æ™‚é€šçŸ¥ã‚„ç‰¹å®šã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã«åŸºã¥ãã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã‚’è¡Œã†ã€‚

ä½ã¿åˆ†ã‘ã‚’æ„è­˜ã—ã¦ä½¿ã†ã“ã¨ã§ã€ã‚³ãƒ¼ãƒ‰ã®è²¬å‹™ãŒæ˜ç¢ºã«ãªã‚Šã€ä¿å®ˆæ€§ãŒå‘ä¸Šã—ã¾ã™ã€‚

---

## ğŸ‘¤ User
*2025-01-15 22:32:44*

re throw ã—ã¦ã„ã‚‹ã®ã«try ã‚’

---
