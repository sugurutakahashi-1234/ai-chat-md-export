# Guild IDå–å¾—æ–¹æ³•

Date: 2024-12-24

---

## ğŸ‘¤ User
*2024-12-24 16:24:23*

ã“ã®ç”»é¢ã§ const guildId = 'your-guild-id'; // å‰Šé™¤å¯¾è±¡ã®ã‚®ãƒ«ãƒ‰IDã‚’æŒ‡å®šã®ã¨ã“ã‚ã‚’getMyGuildNotifierProviderã§æ’®ã£ã¦ããŸå€¤ã«ã—ãŸã„

import 'package:flutter/material.dart';
import 'package:flutter_hooks/flutter_hooks.dart';
import 'package:go_router/go_router.dart';
import 'package:hooks_riverpod/hooks_riverpod.dart';
import 'package:snpit_guild_app/presentation/providers/api_client/guilds/delete_guild.dart';
import 'package:snpit_guild_app/presentation/providers/api_client/guilds/get_guild_info.dart';

class GuildEditPage extends HookConsumerWidget {
  const GuildEditPage({super.key});

  @override
  Widget build(BuildContext context, WidgetRef ref) {
     useEffect(
      () {
        Future.microtask(() {
          ref.read(getMyGuildNotifierProvider.notifier).executeRequest();
        });
        return null;
      },
      [],
    );

    ref.listen&lt;AsyncValue&lt;String?&gt;&gt;(
      deleteGuildNotifierProvider,
      (previous, next) {
        next.when(
          data: (data) {
            if (data == null) {
              return;
            }
            ScaffoldMessenger.of(context).showSnackBar(
              SnackBar(content: Text('Guild deleted successfully: $data')),
            );
            context.pop();
          },
          error: (e, stackTrace) {
            ScaffoldMessenger.of(context).showSnackBar(
              SnackBar(content: Text('Error deleting guild: $e')),
            );
          },
          loading: () {
            ScaffoldMessenger.of(context).showSnackBar(
              const SnackBar(content: Text('Deleting guild...')),
            );
          },
        );
      },
    );

    return Scaffold(
      appBar: AppBar(title: const Text('Guild Edit')),
      body: Padding(
        padding: const EdgeInsets.all(16),
        child: SingleChildScrollView(
          child: Column(
            children: [
              ElevatedButton(
                onPressed: () async {
                  const guildId = 'your-guild-id'; // å‰Šé™¤å¯¾è±¡ã®ã‚®ãƒ«ãƒ‰IDã‚’æŒ‡å®š
                  final deleteGuildNotifier =
                      ref.watch(deleteGuildNotifierProvider.notifier);
                  final result = await showDialog&lt;bool&gt;(
                    context: context,
                    builder: (context) =&gt; AlertDialog(
                      title: const Text('Delete Guild'),
                      content: const Text(
                        'Are you sure you want to delete this guild?',
                      ),
                      actions: [
                        TextButton(
                          onPressed: () =&gt; context.pop(false),
                          child: const Text('Cancel'),
                        ),
                        TextButton(
                          onPressed: () =&gt; context.pop(true),
                          child: const Text('Delete'),
                        ),
                      ],
                    ),
                  );

                  if (result == true) {
                    // å‰Šé™¤å‡¦ç†ã®å®Ÿè¡Œ
                    await deleteGuildNotifier.executeRequest(guildId);
                  }
                },
                child: const Text('Delete Guild'),
              ),
            ],
          ),
        ),
      ),
    );
  }
}

import 'package:flutter/foundation.dart';
import 'package:riverpod_annotation/riverpod_annotation.dart';

import 'package:snpit_guild_app/infrastructure/snapit_guild_api/snapit_guild_api.openapi.dart';
import 'package:snpit_guild_app/presentation/providers/api_client/guild_api_provider.dart';

part 'get_guild_info.g.dart';

@riverpod
class GetMyGuildNotifier extends _$GetMyGuildNotifier {
  @override
  Future&lt;GuildInfoResponseDtoData?&gt; build() async =&gt; null;

  Future&lt;void&gt; executeRequest() async {
    state = const AsyncValue.loading();
    try {
      final api = await ref.watch(guildApiProvider.future);
      final response = await api.guildControllerGetGuildInfo();
      debugPrint('Response Body: ${response.data}');
      debugPrint('Response Body.data: ${response.data?.data}');
      state = AsyncValue.data(response.data?.data);
    } on Exception catch (e, stackTrace) {
      debugPrint('Error: $e');
      debugPrint('StackTrace: $stackTrace');
      state = AsyncValue.error(e, stackTrace);
    }
  }
}



/// Guild information.
@freezed
class GuildInfoResponseDtoData with _$GuildInfoResponseDtoData {
  factory GuildInfoResponseDtoData({
    @JsonKey(name: 'guildId') required String? guildId,
    @JsonKey(name: 'guildName') required String? guildName,
    @JsonKey(name: 'guildDescription') String? guildDescription,
    @JsonKey(name: 'guildOwner') required String? guildOwner,
    @JsonKey(name: 'guildAvatar') String? guildAvatar,
    @JsonKey(name: 'guildBanner') String? guildBanner,
    @JsonKey(name: 'guildMembers') required List&lt;GuildMemberDto&gt;? guildMembers,
  }) = _GuildInfoResponseDtoData;

  factory GuildInfoResponseDtoData.fromJson(Map&lt;String, dynamic&gt; jsonMap) =&gt;
      _$GuildInfoResponseDtoDataFromJson(jsonMap);
}
@freezed
class GuildInfoResponseDtoData with _$GuildInfoResponseDtoData {
  factory GuildInfoResponseDtoData({
    @JsonKey(name: 'guildId') required String? guildId,
    @JsonKey(name: 'guildName') required String? guildName,
    @JsonKey(name: 'guildDescription') String? guildDescription,
    @JsonKey(name: 'guildOwner') required String? guildOwner,
    @JsonKey(name: 'guildAvatar') String? guildAvatar,
    @JsonKey(name: 'guildBanner') String? guildBanner,
    @JsonKey(name: 'guildMembers') required List&lt;GuildMemberDto&gt;? guildMembers,
  }) = _GuildInfoResponseDtoData;

  factory GuildInfoResponseDtoData.fromJson(Map&lt;String, dynamic&gt; jsonMap) =&gt;
      _$GuildInfoResponseDtoDataFromJson(jsonMap);
}

@freezed

---

## ğŸ¤– Assistant
*2024-12-24 16:24:46*

`const guildId = 'your-guild-id';` ã‚’ `getMyGuildNotifierProvider` ã‹ã‚‰å–å¾—ã—ãŸå€¤ã«ç½®ãæ›ãˆã‚‹ãŸã‚ã«ã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ã«å¤‰æ›´ã‚’åŠ ãˆã¾ã™ã€‚`getMyGuildNotifierProvider` ã‹ã‚‰ `guildId` ã‚’å–å¾—ã—ã¦ã€ãã®å€¤ã‚’ `deleteGuildNotifier.executeRequest` ã«æ¸¡ã™å®Ÿè£…ã§ã™ã€‚

### ä¿®æ­£å¾Œã®ã‚³ãƒ¼ãƒ‰

```dart
import 'package:flutter/material.dart';
import 'package:flutter_hooks/flutter_hooks.dart';
import 'package:go_router/go_router.dart';
import 'package:hooks_riverpod/hooks_riverpod.dart';
import 'package:snpit_guild_app/presentation/providers/api_client/guilds/delete_guild.dart';
import 'package:snpit_guild_app/presentation/providers/api_client/guilds/get_guild_info.dart';

class GuildEditPage extends HookConsumerWidget {
  const GuildEditPage({super.key});

  @override
  Widget build(BuildContext context, WidgetRef ref) {
    useEffect(
      () {
        Future.microtask(() {
          ref.read(getMyGuildNotifierProvider.notifier).executeRequest();
        });
        return null;
      },
      [],
    );

    ref.listen<AsyncValue<String?>>(
      deleteGuildNotifierProvider,
      (previous, next) {
        next.when(
          data: (data) {
            if (data == null) {
              return;
            }
            ScaffoldMessenger.of(context).showSnackBar(
              SnackBar(content: Text('Guild deleted successfully: $data')),
            );
            context.pop();
          },
          error: (e, stackTrace) {
            ScaffoldMessenger.of(context).showSnackBar(
              SnackBar(content: Text('Error deleting guild: $e')),
            );
          },
          loading: () {
            ScaffoldMessenger.of(context).showSnackBar(
              const SnackBar(content: Text('Deleting guild...')),
            );
          },
        );
      },
    );

    final guildInfo = ref.watch(getMyGuildNotifierProvider);

    return Scaffold(
      appBar: AppBar(title: const Text('Guild Edit')),
      body: Padding(
        padding: const EdgeInsets.all(16),
        child: SingleChildScrollView(
          child: Column(
            children: [
              ElevatedButton(
                onPressed: () async {
                  final guildId = guildInfo.whenOrNull(
                    data: (data) => data?.guildId,
                  );

                  if (guildId == null) {
                    ScaffoldMessenger.of(context).showSnackBar(
                      const SnackBar(content: Text('Guild ID not available')),
                    );
                    return;
                  }

                  final deleteGuildNotifier =
                      ref.watch(deleteGuildNotifierProvider.notifier);
                  final result = await showDialog<bool>(
                    context: context,
                    builder: (context) => AlertDialog(
                      title: const Text('Delete Guild'),
                      content: const Text(
                        'Are you sure you want to delete this guild?',
                      ),
                      actions: [
                        TextButton(
                          onPressed: () => context.pop(false),
                          child: const Text('Cancel'),
                        ),
                        TextButton(
                          onPressed: () => context.pop(true),
                          child: const Text('Delete'),
                        ),
                      ],
                    ),
                  );

                  if (result == true) {
                    // å‰Šé™¤å‡¦ç†ã®å®Ÿè¡Œ
                    await deleteGuildNotifier.executeRequest(guildId);
                  }
                },
                child: const Text('Delete Guild'),
              ),
            ],
          ),
        ),
      ),
    );
  }
}
```

### å¤‰æ›´ç‚¹
1. **`guildId` ã‚’ `getMyGuildNotifierProvider` ã‹ã‚‰å–å¾—**
   ```dart
   final guildId = guildInfo.whenOrNull(
     data: (data) => data?.guildId,
   );
   ```

2. **`guildId` ãŒ `null` ã®å ´åˆã®ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°**
   - `guildId` ãŒåˆ©ç”¨å¯èƒ½ã§ãªã„å ´åˆã€SnackBar ã§ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«é€šçŸ¥ã€‚

3. **`useEffect` ã®å®Ÿè¡Œã‚’å¤‰æ›´ã›ãšã€åˆå›ã« `getMyGuildNotifierProvider` ã‚’ãƒˆãƒªã‚¬ãƒ¼**
   - æ—¢å­˜ã®ã‚³ãƒ¼ãƒ‰ã‚’ãã®ã¾ã¾ä¿æŒã€‚

ã“ã®ä¿®æ­£ã«ã‚ˆã‚Šã€`guildId` ãŒå‹•çš„ã« `getMyGuildNotifierProvider` ã‹ã‚‰å–å¾—ã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

---
