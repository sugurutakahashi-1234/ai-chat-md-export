# ä¸è¶³ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ä¿®æ­£

æ—¥ä»˜: 2024-02-22

---

## ğŸ‘¤ ãƒ¦ãƒ¼ã‚¶ãƒ¼
*2024/2/22 17:45:42*

è¶³ã‚Šãªã„ã‚«ãƒ³ãƒãªã©ã‚’æ¢ã—ã¦ã»ã—ã„


let package = Package(
    name: "DISampleAppPackage",
    defaultLocalization: "ja",
    platforms: [
        .iOS(.v17),
        .macOS(.v14),
    ],
    products: [
        .library(name: "DependencyInjectorLayer", targets: ["DependencyInjectorLayer"]),
        .library(name: "DomainLayer", targets: ["DomainLayer"]),
        .library(name: "PresentationLayer", targets: ["PresentationLayer"]),
        .library(name: "PreviewCatalogLayer", targets: ["PreviewCatalogLayer"]),
        .library(name: "ScenarioCatalogLayer", targets: ["ScenarioCatalogLayer"]),
    ],
    dependencies: [
        // Library
        .package(url: "https://github.com/firebase/firebase-ios-sdk.git", exact: "10.19.0"), // TODO: 10.22 ä»¥ä¸ŠãŒãƒªãƒªãƒ¼ã‚¹ã•ã‚ŒãŸã‚‰ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã™ã‚‹ï¼ˆç›´ã‚‰ãªã„ã‹ã‚‚ã—ã‚Œãªã„ãŒï¼‰ https://github.com/firebase/firebase-ios-sdk/issues/12390
        .package(url: "https://github.com/playbook-ui/playbook-ios.git", from: "0.3.5"),
        .package(url: "https://github.com/doordash-oss/swiftui-preview-snapshots", from: "1.1.1"),
        .package(url: "https://github.com/EmergeTools/SnapshotPreviews-iOS", from: "0.8.4"),

        // Plugin
        .package(url: "https://github.com/maiyama18/LicensesPlugin", from: "0.1.6"),
        
        // CLI
        .package(url: "https://github.com/uber/mockolo", from: "2.0.1"),
    ],
    targets: [
        // MARK: Dependency Injector layer
        .target(
            name: targetName(.dependencyInjector),
            dependencies: [
                .domainLayer,
                .presentationLayer,
                .licenseFramework,
                .loggerFramework,
                .cloudServiceFramework,
            ],
            path: sourcesPath(.dependencyInjector)
        ),
        
        // MARK: Domain layer
        .target(
            name: targetName(.domain),
            dependencies: [],
            path: sourcesPath(.domain)
        ),

        // MARK: Framework layer
        .target(
            name: "LoggerFramework",
            dependencies: [
                .domainLayer
            ],
            path: sourcesPath(.framework) + "Logger"
        ),
        .target(
            name: "LicenseFramework",
            dependencies: [
                .domainLayer
            ],
            path: sourcesPath(.framework) + "License",
            plugins: [
                .licensesPlugin,
            ]
        ),
        .target(
            name: "CloudServiceFramework",
            dependencies: [
                .domainLayer,
                .firebaseAnalytics,
            ],
            path: sourcesPath(.framework) + "CloudService"
        ),

        // MARK: Presentation layer
        .target(
            name: targetName(.presentation),
            dependencies: [
                .domainLayer,
                .previewSnapshots,
            ],
            path: sourcesPath(.presentation)
        ),
        
        // MARK: Preview Catalog layer
        .target(
            name: targetName(.previewCatalog),
            dependencies: [
                .presentationLayer, // PreviewGallery() è¡Œã†ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã«ä¾å­˜ã•ã›ã‚‹ã¨ãã® Preview ãŒç”Ÿæˆã•ã‚Œã‚‹
                .previewGallery,
            ],
            path: sourcesPath(.previewCatalog)
        ),
        
        // MARK: Scenario Catalog layer
        .target(
            name: targetName(.scenarioCatalog),
            dependencies: [
                .playbook,
                .playbookUI,
                .domainLayer,
                .presentationLayer,
            ],
            path: sourcesPath(.scenarioCatalog)
        ),

        // MARK: Tests
        .testTarget(
            name: "SnapshotTests",
            dependencies: [
                .presentationLayer,
                .previewSnapshotsTesting,
            ]
        ),
    ]
)

---

## ğŸ¤– ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ
*2024/2/22 17:46:43*

ã‚³ãƒ¼ãƒ‰ã‚’ãƒã‚§ãƒƒã‚¯ã—ãŸçµæœã€ã„ãã¤ã‹ã®ä¸å…·åˆã‚„è¶³ã‚Šãªã„ã‚«ãƒ³ãƒã‚’è¦‹ã¤ã‘ã¾ã—ãŸã€‚ä»¥ä¸‹ã€ä¿®æ­£ãŒå¿…è¦ãªãƒã‚¤ãƒ³ãƒˆã§ã™ï¼š

1. `targets` å†…ã® `.target` ã¨ `.testTarget` ã®å„ `dependencies` é…åˆ—ã§ã€ä¾å­˜é–¢ä¿‚ã‚’æ–‡å­—åˆ—ã§æŒ‡å®šã—ã¦ã„ã¾ã™ãŒã€ã“ã‚Œã‚‰ã¯ `.product(name: "è£½å“å", package: "ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å")` ã®å½¢å¼ã‹ã€ã‚‚ã—ãã¯å˜ç´”ãªæ–‡å­—åˆ—ï¼ˆãŸã ã—ã€åŒã˜ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å†…ã®ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã«é™ã‚‹ï¼‰ã§ã‚ã‚‹ã¹ãã§ã™ã€‚ä¾‹ãˆã°ã€`.domainLayer` ã‚„ `.presentationLayer` ãªã©ãŒæ­£ã—ããªã„å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚

2. å„ `.target` å†…ã§ä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹ `targetName(.domain)`, `sourcesPath(.domain)` ãªã©ã®é–¢æ•°ã‚„å¤‰æ•°ãŒã‚³ãƒ¼ãƒ‰ã®ä¸­ã§å®šç¾©ã•ã‚Œã¦ã„ãªã„ãŸã‚ã€ã“ã‚Œã‚‰ãŒå®Ÿéš›ã«å­˜åœ¨ã™ã‚‹ã‹ç¢ºèªã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã‚‰ã¯ãŠãã‚‰ããƒ¦ãƒ¼ã‚¶ãƒ¼å®šç¾©ã®ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°ã‚„å¤‰æ•°ã§ã—ã‚‡ã†ã€‚

3. ã¾ãŸã€`.licensesPlugin`, `.firebaseAnalytics`, `.previewSnapshots`, `.previewSnapshotsTesting`, `.previewGallery`, `.playbook`, ãŠã‚ˆã³ `.playbookUI` ãŒã©ã®ã‚ˆã†ã«å®šç¾©ã•ã‚Œã¦ã„ã‚‹ã‹ã«ã¤ã„ã¦ã‚‚åŒæ§˜ã®å•é¡ŒãŒã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã‚‰ã¯æ­£ã—ãä¾å­˜é–¢ä¿‚ã‚’è¡¨ã™ãŸã‚ã«ã€é©åˆ‡ãªå½¢å¼ï¼ˆä¾‹ãˆã°ã€`.product(name: "è£½å“å", package: "ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å")`ï¼‰ã«ä¿®æ­£ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

4. ã‚³ãƒ¡ãƒ³ãƒˆ `// TODO: 10.22 ä»¥ä¸ŠãŒãƒªãƒªãƒ¼ã‚¹ã•ã‚ŒãŸã‚‰ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã™ã‚‹ï¼ˆç›´ã‚‰ãªã„ã‹ã‚‚ã—ã‚Œãªã„ãŒï¼‰ https://github.com/firebase/firebase-ios-sdk/issues/12390` ã¯ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚¢ã‚¤ãƒ†ãƒ ã¨ã—ã¦æ®‹ã—ã¦ãŠãã¹ãã§ã€ã“ã®éƒ¨åˆ†ã«é–¢ã™ã‚‹ã‚³ãƒ¼ãƒ‰ã®ä¿®æ­£ã¯å¿…è¦ã‚ã‚Šã¾ã›ã‚“ã€‚

ä¿®æ­£ãŒå¿…è¦ãªç®‡æ‰€ã‚’ç¤ºã™ãŸã‚ã«ã€ä¸€éƒ¨ã® `.target` ã¨ `.testTarget` ã® `dependencies` ã®æ­£ã—ã„å½¢å¼ã¸ã®ä¿®æ­£ä¾‹ã‚’ç¤ºã—ã¾ã™ï¼š

```swift
// MARK: Dependency Injector layer
.target(
    name: targetName(.dependencyInjector),
    dependencies: [
        .product(name: "DomainLayer", package: "ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å"),
        .product(name: "PresentationLayer", package: "ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å"),
        // ä»–ã®ä¾å­˜é–¢ä¿‚ã‚‚åŒæ§˜ã«ä¿®æ­£
    ],
    path: sourcesPath(.dependencyInjector)
),
```

ä¸Šè¨˜ã®ä¿®æ­£ã¯ã€å®Ÿéš›ã«ã¯å­˜åœ¨ã™ã‚‹ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸åã«ç½®ãæ›ãˆã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã¾ãŸã€ã“ã®ã‚³ãƒ¼ãƒ‰ã®ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚„ã€`targetName` ã‚„ `sourcesPath` ãªã©ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼å®šç¾©é–¢æ•°ã®å®Ÿè£…ã«å¿œã˜ã¦ã€ã•ã‚‰ã«ä¿®æ­£ãŒå¿…è¦ã«ãªã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚

---
