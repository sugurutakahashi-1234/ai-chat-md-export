# 背景画像表示の修正

Date: 2025-02-14

---

## 👤 User
*2025-02-14 19:29:37*

{
  "content_type": "image_asset_pointer",
  "asset_pointer": "file-service://file-AruxVDdX6ioMRKqwVXceKo",
  "size_bytes": 704772,
  "width": 1242,
  "height": 574,
  "fovea": null,
  "metadata": {
    "dalle": null,
    "gizmo": null,
    "generation": null,
    "container_pixel_height": null,
    "container_pixel_width": null,
    "emu_omit_glimpse_image": null,
    "emu_patches_override": null,
    "sanitized": true,
    "asset_pointer_link": null,
    "watermarked_asset_pointer": null
  }
}
{
  "content_type": "image_asset_pointer",
  "asset_pointer": "file-service://file-GxhUbyFqhdqpqsYeN7JaqC",
  "size_bytes": 48184,
  "width": 255,
  "height": 302,
  "fovea": null,
  "metadata": {
    "dalle": null,
    "gizmo": null,
    "generation": null,
    "container_pixel_height": null,
    "container_pixel_width": null,
    "emu_omit_glimpse_image": null,
    "emu_patches_override": null,
    "sanitized": true,
    "asset_pointer_link": null,
    "watermarked_asset_pointer": null
  }
}
showDialogで今のItemDetailDialogを表示するが、１枚目の添付したアセットで以下の背景をボトムに表示させたい。目標は２枚目の様な画面である

               Image.asset(
                  Assets.images.popupBgPositive.path,
                ),


import 'package:flutter/material.dart';
import 'package:go_router/go_router.dart';
import 'package:snpit_guild_app/domain/design/color_pallet.dart';
import 'package:snpit_guild_app/gen/assets.gen.dart';
import 'package:snpit_guild_app/infrastructure/snapit_guild_api/snapit_guild_api.openapi.dart';
import 'package:snpit_guild_app/presentation/extensions/font_weight_extensions.dart';
import 'package:snpit_guild_app/presentation/widgets/cancel_button.dart';
import 'package:snpit_guild_app/presentation/widgets/square_image.dart';

class ItemDetailDialog extends StatelessWidget {
  const ItemDetailDialog({
    super.key,
    required this.item,
  });

  final UserItemsDTO item;

  @override
  Widget build(BuildContext context) {
    return Dialog(
      insetPadding: const EdgeInsets.symmetric(horizontal: 16),
      shape: RoundedRectangleBorder(
        borderRadius: BorderRadius.circular(8),
      ),
      backgroundColor: ColorPallet.gray800,
      child: Container(
        width: double.infinity,
        padding: const EdgeInsets.symmetric(vertical: 24),
        child: Column(
          mainAxisSize: MainAxisSize.min,
          children: [
            Text(
              item.itemName ?? '',
              style: TextStyle(
                fontWeight: FontWeightX.semiBold,
                fontSize: 20,
              ),
              textAlign: TextAlign.center,
            ),
            const SizedBox(height: 18),
            Text(
              item.itemDescription ?? '',
              style: const TextStyle(
                fontSize: 16,
              ),
              textAlign: TextAlign.center,
            ),
            const SizedBox(height: 32),
            ClipRRect(
              borderRadius: BorderRadius.circular(4),
              child: SquareImage(
                imageUrl: item.itemImage ?? '',
                size: 160,
              ),
            ),
            const SizedBox(height: 24),
            Container(
              padding: const EdgeInsets.symmetric(
                horizontal: 12,
                vertical: 8,
              ),
              decoration: BoxDecoration(
                color: const Color(0xFF14191A),
                borderRadius: BorderRadius.circular(50),
              ),
              child: Text(
                item.itemAbility ?? '',
                style: const TextStyle(
                  fontSize: 14,
                  fontWeight: FontWeight.bold,
                ),
              ),
            ),
            const SizedBox(height: 32),
            CancelButton(
              onPressed: () async {
                context.pop();
              },
            ),
          ],
        ),
      ),
    );
  }
}

---

## 🤖 Assistant
*2025-02-14 19:30:06*

`ItemDetailDialog` のボトム部分に背景画像 (`popup_bg_positive.png`) を適用するには、 `Stack` を使用して背景画像を最背面に配置し、その上に `Container` の内容を配置するのが良い方法です。

### 修正後の `ItemDetailDialog`
```dart
import 'package:flutter/material.dart';
import 'package:go_router/go_router.dart';
import 'package:snpit_guild_app/domain/design/color_pallet.dart';
import 'package:snpit_guild_app/gen/assets.gen.dart';
import 'package:snpit_guild_app/infrastructure/snapit_guild_api/snapit_guild_api.openapi.dart';
import 'package:snpit_guild_app/presentation/extensions/font_weight_extensions.dart';
import 'package:snpit_guild_app/presentation/widgets/cancel_button.dart';
import 'package:snpit_guild_app/presentation/widgets/square_image.dart';

class ItemDetailDialog extends StatelessWidget {
  const ItemDetailDialog({
    super.key,
    required this.item,
  });

  final UserItemsDTO item;

  @override
  Widget build(BuildContext context) {
    return Dialog(
      insetPadding: const EdgeInsets.symmetric(horizontal: 16),
      shape: RoundedRectangleBorder(
        borderRadius: BorderRadius.circular(8),
      ),
      backgroundColor: Colors.transparent, // 透明にする
      child: Stack(
        clipBehavior: Clip.none,
        children: [
          // 背景画像
          Positioned(
            bottom: 0,
            left: 0,
            right: 0,
            child: Image.asset(
              Assets.images.popupBgPositive.path,
              fit: BoxFit.cover,
            ),
          ),
          // メインコンテンツ
          Container(
            width: double.infinity,
            padding: const EdgeInsets.symmetric(vertical: 24, horizontal: 16),
            decoration: BoxDecoration(
              color: ColorPallet.gray800,
              borderRadius: BorderRadius.circular(8),
            ),
            child: Column(
              mainAxisSize: MainAxisSize.min,
              children: [
                Text(
                  item.itemName ?? '',
                  style: TextStyle(
                    fontWeight: FontWeightX.semiBold,
                    fontSize: 20,
                  ),
                  textAlign: TextAlign.center,
                ),
                const SizedBox(height: 18),
                Text(
                  item.itemDescription ?? '',
                  style: const TextStyle(
                    fontSize: 16,
                  ),
                  textAlign: TextAlign.center,
                ),
                const SizedBox(height: 32),
                ClipRRect(
                  borderRadius: BorderRadius.circular(4),
                  child: SquareImage(
                    imageUrl: item.itemImage ?? '',
                    size: 160,
                  ),
                ),
                const SizedBox(height: 24),
                Container(
                  padding: const EdgeInsets.symmetric(
                    horizontal: 12,
                    vertical: 8,
                  ),
                  decoration: BoxDecoration(
                    color: const Color(0xFF14191A),
                    borderRadius: BorderRadius.circular(50),
                  ),
                  child: Text(
                    item.itemAbility ?? '',
                    style: const TextStyle(
                      fontSize: 14,
                      fontWeight: FontWeight.bold,
                    ),
                  ),
                ),
                const SizedBox(height: 32),
                CancelButton(
                  onPressed: () async {
                    context.pop();
                  },
                ),
              ],
            ),
          ),
        ],
      ),
    );
  }
}
```

### 修正ポイント
1. **背景画像を `Stack` の一番下に配置**
   - `Positioned` を使い、ボトム部分に `Image.asset` で `popupBgPositive` を配置
   - `fit: BoxFit.cover` を指定して、コンテナの幅いっぱいに広げる

2. **背景とコンテンツを分ける**
   - `Container` に `borderRadius` を設定し、背景との区別をつける

3. **ダイアログの `backgroundColor` を `Colors.transparent` に設定**
   - これにより、背景が透過し、`Stack` で配置した背景画像が正しく見えるようになる

これで、**ボトム部分に `popup_bg_positive.png` の背景が適用された `ItemDetailDialog`** になるはずです！ 🎨🚀

---

## 👤 User
*2025-02-14 19:31:09*

広げないでボトムに置いて足りない部分はbackgroundColor: ColorPallet.gray800,で背景にしたいい

---

## 🤖 Assistant
*2025-02-14 19:31:39*

それなら、`popup_bg_positive.png` を **ボトム部分に配置し、足りない部分は `ColorPallet.gray800` で塗る** ように調整します。

### 修正後の `ItemDetailDialog`
```dart
import 'package:flutter/material.dart';
import 'package:go_router/go_router.dart';
import 'package:snpit_guild_app/domain/design/color_pallet.dart';
import 'package:snpit_guild_app/gen/assets.gen.dart';
import 'package:snpit_guild_app/infrastructure/snapit_guild_api/snapit_guild_api.openapi.dart';
import 'package:snpit_guild_app/presentation/extensions/font_weight_extensions.dart';
import 'package:snpit_guild_app/presentation/widgets/cancel_button.dart';
import 'package:snpit_guild_app/presentation/widgets/square_image.dart';

class ItemDetailDialog extends StatelessWidget {
  const ItemDetailDialog({
    super.key,
    required this.item,
  });

  final UserItemsDTO item;

  @override
  Widget build(BuildContext context) {
    return Dialog(
      insetPadding: const EdgeInsets.symmetric(horizontal: 16),
      shape: RoundedRectangleBorder(
        borderRadius: BorderRadius.circular(8),
      ),
      backgroundColor: Colors.transparent, // 透明にして背景を自由に設定
      child: Container(
        decoration: BoxDecoration(
          color: ColorPallet.gray800, // 足りない部分はgray800
          borderRadius: BorderRadius.circular(8),
        ),
        child: Stack(
          alignment: Alignment.bottomCenter,
          children: [
            // 背景画像（ボトム配置）
            Positioned(
              bottom: 0,
              left: 0,
              right: 0,
              child: Image.asset(
                Assets.images.popupBgPositive.path,
                width: double.infinity, // 幅いっぱい
                fit: BoxFit.none, // 画像サイズを変えない
              ),
            ),
            // メインコンテンツ
            Padding(
              padding: const EdgeInsets.symmetric(vertical: 24, horizontal: 16),
              child: Column(
                mainAxisSize: MainAxisSize.min,
                children: [
                  Text(
                    item.itemName ?? '',
                    style: TextStyle(
                      fontWeight: FontWeightX.semiBold,
                      fontSize: 20,
                    ),
                    textAlign: TextAlign.center,
                  ),
                  const SizedBox(height: 18),
                  Text(
                    item.itemDescription ?? '',
                    style: const TextStyle(
                      fontSize: 16,
                    ),
                    textAlign: TextAlign.center,
                  ),
                  const SizedBox(height: 32),
                  ClipRRect(
                    borderRadius: BorderRadius.circular(4),
                    child: SquareImage(
                      imageUrl: item.itemImage ?? '',
                      size: 160,
                    ),
                  ),
                  const SizedBox(height: 24),
                  Container(
                    padding: const EdgeInsets.symmetric(
                      horizontal: 12,
                      vertical: 8,
                    ),
                    decoration: BoxDecoration(
                      color: const Color(0xFF14191A),
                      borderRadius: BorderRadius.circular(50),
                    ),
                    child: Text(
                      item.itemAbility ?? '',
                      style: const TextStyle(
                        fontSize: 14,
                        fontWeight: FontWeight.bold,
                      ),
                    ),
                  ),
                  const SizedBox(height: 32),
                  CancelButton(
                    onPressed: () async {
                      context.pop();
                    },
                  ),
                ],
              ),
            ),
          ],
        ),
      ),
    );
  }
}
```

### 修正ポイント
1. **背景画像を `Stack` の一番下に `Positioned` で配置**
   - `bottom: 0` にしてボトムに配置
   - `width: double.infinity` で横幅を最大にする
   - `fit: BoxFit.none` で画像サイズを維持（拡大しない）

2. **背景の足りない部分は `ColorPallet.gray800` にする**
   - `Container` の `color: ColorPallet.gray800` で背景を補完

3. **ダイアログの `backgroundColor` を `Colors.transparent` に変更**
   - `Stack` の背景画像が見えるようにするため

この方法で、背景画像がボトムに固定され、足りない部分は `ColorPallet.gray800` の背景でカバーできます！ 🎨🚀

---
