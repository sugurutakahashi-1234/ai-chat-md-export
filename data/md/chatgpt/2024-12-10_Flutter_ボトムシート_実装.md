# Flutter ボトムシート 実装

日付: 2024-12-10

---

## 👤 ユーザー
*2024/12/10 16:25:23*

最新のflutter で ボタンをタップするとbottom sheetが出てくるような実装をしてほしい。

---

## 🤖 アシスタント
*2024/12/10 16:25:45*

最新のFlutterで、ボタンをタップするとBottom Sheetが表示される実装は以下のようにできます。以下のコードは、`showModalBottomSheet`を使った例です。

### 実装コード

```dart
import 'package:flutter/material.dart';

void main() {
  runApp(MyApp());
}

class MyApp extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return MaterialApp(
      title: 'Flutter Bottom Sheet Example',
      theme: ThemeData(
        primarySwatch: Colors.blue,
      ),
      home: BottomSheetExample(),
    );
  }
}

class BottomSheetExample extends StatelessWidget {
  void _showBottomSheet(BuildContext context) {
    showModalBottomSheet(
      context: context,
      isScrollControlled: true, // 高さを動的に調整したい場合
      shape: RoundedRectangleBorder(
        borderRadius: BorderRadius.vertical(top: Radius.circular(16)),
      ),
      builder: (BuildContext context) {
        return Padding(
          padding: const EdgeInsets.all(16.0),
          child: Column(
            mainAxisSize: MainAxisSize.min, // 高さをコンテンツに合わせる
            children: [
              Text(
                'Bottom Sheet Title',
                style: Theme.of(context).textTheme.headline6,
              ),
              SizedBox(height: 16),
              Text(
                'This is the content of the bottom sheet. You can add any widgets here.',
                textAlign: TextAlign.center,
              ),
              SizedBox(height: 16),
              ElevatedButton(
                onPressed: () => Navigator.pop(context),
                child: Text('Close'),
              ),
            ],
          ),
        );
      },
    );
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        title: Text('Bottom Sheet Example'),
      ),
      body: Center(
        child: ElevatedButton(
          onPressed: () => _showBottomSheet(context),
          child: Text('Show Bottom Sheet'),
        ),
      ),
    );
  }
}
```

### 解説

1. **`showModalBottomSheet`**:
   - この関数はモーダルタイプのボトムシートを表示します。
   - `isScrollControlled`を`true`にすると、ボトムシートの高さが内容によって動的に調整されます。

2. **`RoundedRectangleBorder`**:
   - ボトムシートの角を丸めるデザインを適用しています。

3. **ナビゲーション制御**:
   - ボタンの`onPressed`で`Navigator.pop(context)`を呼び出し、ボトムシートを閉じます。

4. **動的レイアウト**:
   - `Column`のプロパティ`mainAxisSize: MainAxisSize.min`を設定することで、ボトムシートの高さが内容に応じて変化します。

### 動作
- アプリを起動すると、画面中央に「Show Bottom Sheet」というボタンが表示されます。
- ボタンをタップすると、下からスライドしてボトムシートが表示され、内容と「Close」ボタンが表示されます。
- 「Close」ボタンをタップするとボトムシートが閉じます。

このコードをコピーしてFlutterプロジェクトに貼り付ければ、すぐに動作を確認できます。

---

## 👤 ユーザー
*2024/12/10 16:27:58*

そのモーダルは画面の半分まで表示されて右上にxボタンと、下に横長のボタンを用意してほしい。そのボタンは何もしなくていいよ。

---

## 🤖 アシスタント
*2024/12/10 16:28:23*

以下は、画面の半分まで表示されるモーダルで、右上に閉じるための "×" ボタンと、下部に横長のボタンを配置したFlutterコードです。

### 実装コード

```dart
import 'package:flutter/material.dart';

void main() {
  runApp(MyApp());
}

class MyApp extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return MaterialApp(
      title: 'Flutter Bottom Sheet Example',
      theme: ThemeData(
        primarySwatch: Colors.blue,
      ),
      home: BottomSheetExample(),
    );
  }
}

class BottomSheetExample extends StatelessWidget {
  void _showBottomSheet(BuildContext context) {
    showModalBottomSheet(
      context: context,
      isScrollControlled: true,
      shape: RoundedRectangleBorder(
        borderRadius: BorderRadius.vertical(top: Radius.circular(16)),
      ),
      builder: (BuildContext context) {
        return FractionallySizedBox(
          heightFactor: 0.5, // モーダルの高さを画面の半分に調整
          child: Padding(
            padding: const EdgeInsets.all(16.0),
            child: Column(
              crossAxisAlignment: CrossAxisAlignment.stretch,
              children: [
                Row(
                  mainAxisAlignment: MainAxisAlignment.end,
                  children: [
                    IconButton(
                      onPressed: () => Navigator.pop(context),
                      icon: Icon(Icons.close),
                      tooltip: 'Close',
                    ),
                  ],
                ),
                Expanded(
                  child: Center(
                    child: Text(
                      'This is the content of the bottom sheet.',
                      textAlign: TextAlign.center,
                      style: Theme.of(context).textTheme.bodyLarge,
                    ),
                  ),
                ),
                ElevatedButton(
                  onPressed: () {}, // 何もしない
                  child: Text('Submit'),
                  style: ElevatedButton.styleFrom(
                    padding: EdgeInsets.symmetric(vertical: 16),
                  ),
                ),
              ],
            ),
          ),
        );
      },
    );
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        title: Text('Bottom Sheet Example'),
      ),
      body: Center(
        child: ElevatedButton(
          onPressed: () => _showBottomSheet(context),
          child: Text('Show Bottom Sheet'),
        ),
      ),
    );
  }
}
```

### 解説

1. **高さ調整**:
   - `FractionallySizedBox`の`heightFactor: 0.5`を使い、モーダルの高さを画面の半分に設定しています。

2. **右上の "×" ボタン**:
   - `Row`を使って右上に`IconButton`を配置し、`Navigator.pop(context)`でモーダルを閉じる機能を追加しています。

3. **横長のボタン**:
   - `ElevatedButton`を画面幅全体に広がるように配置しました。
   - `style: ElevatedButton.styleFrom(padding: EdgeInsets.symmetric(vertical: 16))`でボタンの高さを調整しています。

4. **余白とレイアウト**:
   - `Padding`と`Column`を使って、全体に余白をつけつつ、ボタンやテキストを適切に配置しています。

5. **何もしないボタン**:
   - ボタンの`onPressed`には空の処理を指定しています。

### 動作

- アプリを起動すると、中央に「Show Bottom Sheet」というボタンが表示されます。
- ボタンをタップすると、画面の半分の高さでモーダルが表示されます。
- モーダルの右上には "×" ボタンがあり、これを押すとモーダルが閉じます。
- 下部には横長の「Submit」ボタンが表示されます（何もしません）。

このコードをコピペすれば、すぐに動作確認が可能です！

---

## 👤 ユーザー
*2024/12/10 16:29:05*

BottomSheetExample ではなくて、ExplorerListPageとしてほしい

---

## 🤖 アシスタント
*2024/12/10 16:29:26*

以下は、クラス名を `ExplorerListPage` に変更したコードです。

### 更新後の実装コード

```dart
import 'package:flutter/material.dart';

void main() {
  runApp(MyApp());
}

class MyApp extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return MaterialApp(
      title: 'Flutter Bottom Sheet Example',
      theme: ThemeData(
        primarySwatch: Colors.blue,
      ),
      home: ExplorerListPage(),
    );
  }
}

class ExplorerListPage extends StatelessWidget {
  void _showBottomSheet(BuildContext context) {
    showModalBottomSheet(
      context: context,
      isScrollControlled: true,
      shape: RoundedRectangleBorder(
        borderRadius: BorderRadius.vertical(top: Radius.circular(16)),
      ),
      builder: (BuildContext context) {
        return FractionallySizedBox(
          heightFactor: 0.5, // モーダルの高さを画面の半分に調整
          child: Padding(
            padding: const EdgeInsets.all(16.0),
            child: Column(
              crossAxisAlignment: CrossAxisAlignment.stretch,
              children: [
                Row(
                  mainAxisAlignment: MainAxisAlignment.end,
                  children: [
                    IconButton(
                      onPressed: () => Navigator.pop(context),
                      icon: Icon(Icons.close),
                      tooltip: 'Close',
                    ),
                  ],
                ),
                Expanded(
                  child: Center(
                    child: Text(
                      'This is the content of the bottom sheet.',
                      textAlign: TextAlign.center,
                      style: Theme.of(context).textTheme.bodyLarge,
                    ),
                  ),
                ),
                ElevatedButton(
                  onPressed: () {}, // 何もしない
                  child: Text('Submit'),
                  style: ElevatedButton.styleFrom(
                    padding: EdgeInsets.symmetric(vertical: 16),
                  ),
                ),
              ],
            ),
          ),
        );
      },
    );
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        title: Text('Explorer List Page'),
      ),
      body: Center(
        child: ElevatedButton(
          onPressed: () => _showBottomSheet(context),
          child: Text('Show Bottom Sheet'),
        ),
      ),
    );
  }
}
```

### 修正内容

1. **クラス名を変更**:
   - `BottomSheetExample` を `ExplorerListPage` に変更しました。

2. **アプリバーのタイトル**:
   - アプリバーのタイトルを `'Explorer List Page'` に変更しました。

その他の動作は以前のコードと同じです。

### 動作

- アプリを起動すると、中央に「Show Bottom Sheet」というボタンが表示されます。
- ボタンをタップすると、画面の半分の高さでモーダルが表示されます。
- モーダルの右上には "×" ボタンがあり、これを押すとモーダルが閉じます。
- 下部には横長の「Submit」ボタンが表示されます（何もしません）。

これで、`ExplorerListPage` に対応したコードになりました！

---

## 👤 ユーザー
*2024/12/10 16:35:37*

showModalBottomSheet で出てくるモーダルを ExplorerListModal として定義してほしい

---

## 🤖 アシスタント
*2024/12/10 16:35:59*

以下は、`showModalBottomSheet` で表示されるモーダルの内容を `ExplorerListModal` として別クラスに定義したコードです。

### 更新後の実装コード

```dart
import 'package:flutter/material.dart';

void main() {
  runApp(MyApp());
}

class MyApp extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return MaterialApp(
      title: 'Flutter Bottom Sheet Example',
      theme: ThemeData(
        primarySwatch: Colors.blue,
      ),
      home: ExplorerListPage(),
    );
  }
}

class ExplorerListPage extends StatelessWidget {
  void _showBottomSheet(BuildContext context) {
    showModalBottomSheet(
      context: context,
      isScrollControlled: true,
      shape: RoundedRectangleBorder(
        borderRadius: BorderRadius.vertical(top: Radius.circular(16)),
      ),
      builder: (BuildContext context) {
        return ExplorerListModal();
      },
    );
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        title: Text('Explorer List Page'),
      ),
      body: Center(
        child: ElevatedButton(
          onPressed: () => _showBottomSheet(context),
          child: Text('Show Bottom Sheet'),
        ),
      ),
    );
  }
}

class ExplorerListModal extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return FractionallySizedBox(
      heightFactor: 0.5, // モーダルの高さを画面の半分に調整
      child: Padding(
        padding: const EdgeInsets.all(16.0),
        child: Column(
          crossAxisAlignment: CrossAxisAlignment.stretch,
          children: [
            Row(
              mainAxisAlignment: MainAxisAlignment.end,
              children: [
                IconButton(
                  onPressed: () => Navigator.pop(context),
                  icon: Icon(Icons.close),
                  tooltip: 'Close',
                ),
              ],
            ),
            Expanded(
              child: Center(
                child: Text(
                  'This is the content of the Explorer List Modal.',
                  textAlign: TextAlign.center,
                  style: Theme.of(context).textTheme.bodyLarge,
                ),
              ),
            ),
            ElevatedButton(
              onPressed: () {}, // 何もしない
              child: Text('Submit'),
              style: ElevatedButton.styleFrom(
                padding: EdgeInsets.symmetric(vertical: 16),
              ),
            ),
          ],
        ),
      ),
    );
  }
}
```

### 修正内容

1. **`ExplorerListModal` の定義**:
   - モーダルのUI部分を `ExplorerListModal` という別クラスに切り出しました。
   - `StatelessWidget` として実装し、モーダルの内容を担当します。

2. **`ExplorerListPage` の変更**:
   - `showModalBottomSheet` の `builder` に `ExplorerListModal()` を渡しています。

3. **コードの分離**:
   - モーダルの内容を独立したクラスとして定義することで、責務を明確にし、メインページ (`ExplorerListPage`) とモーダルのコンテンツを分離しました。

### 動作

- アプリを起動すると、中央に「Show Bottom Sheet」というボタンが表示されます。
- ボタンをタップすると、`ExplorerListModal` によるモーダルが表示されます。
- モーダルの右上には "×" ボタンがあり、これを押すとモーダルが閉じます。
- 下部には横長の「Submit」ボタンが表示されます（何もしません）。

これで、モーダル部分が `ExplorerListModal` として独立して管理できるようになりました！

---
