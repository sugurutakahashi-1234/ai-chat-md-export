# 選択コピー機能の実装

Date: 2024-05-29

---

## 👤 User
*2024-05-29 15:51:26*

SwiftUI で選択コピー iOS17以上

---

## 🤖 Assistant
*2024-05-29 15:51:40*

iOS 17以上で、SwiftUIを使って選択コピー機能を実装する方法について説明します。この機能は、ユーザーがテキストを選択してコピーすることを可能にします。

### 手順

1. **Text Selection Modifierの使用**:
   SwiftUIにおいて、テキストを選択可能にするためには、`textSelection`モディファイアを使用します。iOS 16から導入されたこのモディファイアは、iOS 17でも利用可能です。

2. **TextViewの設定**:
   `Text`ビューに対して、`textSelection(.enabled)`を適用します。これにより、テキストが選択可能となり、コピーアクションが有効になります。

以下に、具体的なコード例を示します。

```swift
import SwiftUI

struct ContentView: View {
    var body: some View {
        VStack {
            Text("選択してコピーできるテキストです。")
                .textSelection(.enabled)
                .padding()

            Text("このテキストも同様に選択してコピーできます。")
                .textSelection(.enabled)
                .padding()
        }
        .padding()
    }
}

struct ContentView_Previews: PreviewProvider {
    static var previews: some View {
        ContentView()
    }
}
```

### 解説
- `textSelection(.enabled)`を使用することで、そのテキストが選択可能となります。
- `VStack`を使用して、複数のテキストビューを配置しています。
- `.padding()`を追加することで、見やすいレイアウトにしています。

この方法で、iOS 17以上のSwiftUIアプリケーションで簡単に選択コピー機能を実装できます。

---

## 👤 User
*2024-05-29 15:51:48*

範囲を選択できるようにしたい

---

## 🤖 Assistant
*2024-05-29 15:52:08*

範囲選択を可能にするためには、`UITextView`を使ってカスタムのSwiftUIラッパーを作成する方法が効果的です。`UITextView`を使うことで、テキストの範囲選択が可能になります。以下に、その実装方法を説明します。

### 1. UIViewRepresentableを使用してUITextViewをラップする

まず、`UITextView`をラップするためのカスタムSwiftUIビューを作成します。

```swift
import SwiftUI
import UIKit

struct SelectableTextView: UIViewRepresentable {
    var text: String
    
    func makeUIView(context: Context) -> UITextView {
        let textView = UITextView()
        textView.isEditable = false
        textView.isSelectable = true
        textView.text = text
        textView.font = UIFont.systemFont(ofSize: 18)
        textView.backgroundColor = UIColor.clear
        return textView
    }
    
    func updateUIView(_ uiView: UITextView, context: Context) {
        uiView.text = text
    }
}

struct ContentView: View {
    var body: some View {
        VStack {
            SelectableTextView(text: "選択してコピーできるテキストです。")
                .frame(height: 100)
                .padding()
            
            SelectableTextView(text: "このテキストも同様に選択してコピーできます。")
                .frame(height: 100)
                .padding()
        }
        .padding()
    }
}

struct ContentView_Previews: PreviewProvider {
    static var previews: some View {
        ContentView()
    }
}
```

### 2. 解説

- `SelectableTextView`は`UIViewRepresentable`プロトコルを実装し、`UITextView`をSwiftUIで使用できるようにしています。
- `makeUIView`メソッドで`UITextView`を作成し、選択可能な状態に設定します。
- `updateUIView`メソッドで、必要に応じてテキストを更新します。
- `ContentView`では、`SelectableTextView`を使用してテキストビューを表示しています。

このアプローチにより、ユーザーはテキストの範囲を選択してコピーすることができます。`UITextView`はデフォルトでテキストの選択とコピーをサポートしているため、このように簡単に実装できます。

---
