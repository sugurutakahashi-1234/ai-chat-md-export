# トリプルタップ処理追加

日付: 2024-12-23

---

## 👤 ユーザー
*2024/12/23 21:44:33*

SvgPicture をトリプルタップしたときの処理を記述したい

import 'package:flutter/material.dart';
import 'package:flutter_hooks/flutter_hooks.dart';
import 'package:flutter_svg/flutter_svg.dart';
import 'package:go_router/go_router.dart';
import 'package:hooks_riverpod/hooks_riverpod.dart';
import 'package:snpit_guild_app/domain/screen.dart';
import 'package:snpit_guild_app/gen/assets.gen.dart';
import 'package:snpit_guild_app/presentation/design_token/color_token.dart';

class LoginPage extends HookConsumerWidget {
  const LoginPage({super.key});

  @override
  Widget build(BuildContext context, WidgetRef ref) {
    final textEditingController = useTextEditingController();

    return Scaffold(
      body: GestureDetector(
        onTap: () {
          FocusScope.of(context).unfocus();
        },
        child: Center(
          child: SingleChildScrollView(
            child: Padding(
              padding: const EdgeInsets.symmetric(horizontal: 24),
              child: Column(
                mainAxisAlignment: MainAxisAlignment.center,
                children: [
                  SvgPicture.asset(
                    Assets.images.logoLogin.path,
                  ),
                  const SizedBox(height: 38),
                  Image.asset(
                    Assets.images.animalsLogin.path,
                  ),
                  const SizedBox(height: 54),
                  TextField(
                    controller: textEditingController,
                    decoration: const InputDecoration(
                      prefixIcon: Padding(
                        padding: EdgeInsets.all(12),
                        child: Icon(
                          Icons.email_outlined,
                          color: ColorToken.text,
                          size: 24,
                        ),
                      ),
                      hintText: 'Enter your email',
                    ),
                  ),
                  const SizedBox(height: 24),
                  ElevatedButton(
                    onPressed: () {
                      // TODO: ログイン処理
                      context.push(Screen.verificationCode.path);
                    },
                    child: const Text('Login'),
                  ),
                ],
              ),
            ),
          ),
        ),
      ),
    );
  }
}

---

## 🤖 アシスタント
*2024/12/23 21:44:45*

トリプルタップしたときに特定の処理を実行するには、`GestureDetector`を使用してトリプルタップのジェスチャーを検出できます。以下に、`SvgPicture.asset`のトリプルタップに応じた処理を追加する例を示します。

### 実装例

```dart
import 'package:flutter/material.dart';
import 'package:flutter_hooks/flutter_hooks.dart';
import 'package:flutter_svg/flutter_svg.dart';
import 'package:go_router/go_router.dart';
import 'package:hooks_riverpod/hooks_riverpod.dart';
import 'package:snpit_guild_app/domain/screen.dart';
import 'package:snpit_guild_app/gen/assets.gen.dart';
import 'package:snpit_guild_app/presentation/design_token/color_token.dart';

class LoginPage extends HookConsumerWidget {
  const LoginPage({super.key});

  @override
  Widget build(BuildContext context, WidgetRef ref) {
    final textEditingController = useTextEditingController();
    int tapCount = 0;
    DateTime? lastTapTime;

    return Scaffold(
      body: GestureDetector(
        onTap: () {
          FocusScope.of(context).unfocus();
        },
        child: Center(
          child: SingleChildScrollView(
            child: Padding(
              padding: const EdgeInsets.symmetric(horizontal: 24),
              child: Column(
                mainAxisAlignment: MainAxisAlignment.center,
                children: [
                  GestureDetector(
                    onTap: () {
                      final now = DateTime.now();
                      if (lastTapTime == null ||
                          now.difference(lastTapTime!) &gt; const Duration(seconds: 1)) {
                        // トリプルタップのカ

---

## 👤 ユーザー
*2024/12/23 21:45:16*

もっと簡単に記述したい。レイアウトを変えずにデバッグメニューに飛ばしたいだけなんだ。

context.push(Screen.debugMenu.path);

---

## 🤖 アシスタント
*2024/12/23 21:45:43*

簡潔にトリプルタップでデバッグメニューに遷移する処理を追加するには、`GestureDetector`の`onTap`と`onTapDown`を使用して以下のように実装できます。

### 簡潔な実装例

```dart
import 'package:flutter/material.dart';
import 'package:flutter_hooks/flutter_hooks.dart';
import 'package:flutter_svg/flutter_svg.dart';
import 'package:go_router/go_router.dart';
import 'package:hooks_riverpod/hooks_riverpod.dart';
import 'package:snpit_guild_app/domain/screen.dart';
import 'package:snpit_guild_app/gen/assets.gen.dart';
import 'package:snpit_guild_app/presentation/design_token/color_token.dart';

class LoginPage extends HookConsumerWidget {
  const LoginPage({super.key});

  @override
  Widget build(BuildContext context, WidgetRef ref) {
    final textEditingController = useTextEditingController();
    int tapCount = 0;

    return Scaffold(
      body: GestureDetector(
        onTap: () {
          FocusScope.of(context).unfocus();
        },
        child: Center(
          child: SingleChildScrollView(
            child: Padding(
              padding: const EdgeInsets.symmetric(horizontal: 24),
              child: Column(
                mainAxisAlignment: MainAxisAlignment.center,
                children: [
                  GestureDetector(
                    onTap: () {
                      tapCount++;
                      Future.delayed(const Duration(milliseconds: 500), () {
                        tapCount = 0; // タップカウントをリセット
                      });
                      if (tapCount == 3) {
                        context.push(Screen.debugMenu.path); // デバッグメニューに遷移
                      }
                    },
                    child: SvgPicture.asset(
                      Assets.images.logoLogin.path,
                    ),
                  ),
                  const SizedBox(height: 38),
                  Image.asset(
                    Assets.images.animalsLogin.path,
                  ),
                  const SizedBox(height: 54),
                  TextField(
                    controller: textEditingController,
                    decoration: const InputDecoration(
                      prefixIcon: Padding(
                        padding: EdgeInsets.all(12),
                        child: Icon(
                          Icons.email_outlined,
                          color: ColorToken.text,
                          size: 24,
                        ),
                      ),
                      hintText: 'Enter your email',
                    ),
                  ),
                  const SizedBox(height: 24),
                  ElevatedButton(
                    onPressed: () {
                      // TODO: ログイン処理
                      context.push(Screen.verificationCode.path);
                    },
                    child: const Text('Login'),
                  ),
                ],
              ),
            ),
          ),
        ),
      ),
    );
  }
}
```

### 主なポイント
1. **トリプルタップを簡易実装**: `tapCount`でタップ回数をカウントし、500ms以内に3回タップされた場合に処理を実行。
2. **レイアウトを変更しない**: 既存の`SvgPicture.asset`の`GestureDetector`を使う。
3. **リセット処理**: 一定時間後に`tapCount`をリセットして誤動作を防ぐ。

これにより、トリプルタップでデバッグメニューに遷移するシンプルな仕組みを実現できます。

---

## 👤 ユーザー
*2024/12/23 21:46:13*

トリプルタップでなくても少し特殊なジェスチャー少ないコードでデバッグ画面に遷移させたい

---

## 🤖 アシスタント
*2024/12/23 21:46:39*

トリプルタップの代わりに「長押し＋タップ」のような比較的簡単なジェスチャーでデバッグ画面に遷移させる方法を以下に示します。この方法は、コードを少なく保ちながら特殊なジェスチャーを実現します。

### 実装例

```dart
import 'package:flutter/material.dart';
import 'package:flutter_hooks/flutter_hooks.dart';
import 'package:flutter_svg/flutter_svg.dart';
import 'package:go_router/go_router.dart';
import 'package:hooks_riverpod/hooks_riverpod.dart';
import 'package:snpit_guild_app/domain/screen.dart';
import 'package:snpit_guild_app/gen/assets.gen.dart';
import 'package:snpit_guild_app/presentation/design_token/color_token.dart';

class LoginPage extends HookConsumerWidget {
  const LoginPage({super.key});

  @override
  Widget build(BuildContext context, WidgetRef ref) {
    final textEditingController = useTextEditingController();
    bool isLongPressed = false;

    return Scaffold(
      body: GestureDetector(
        onTap: () {
          FocusScope.of(context).unfocus();
        },
        child: Center(
          child: SingleChildScrollView(
            child: Padding(
              padding: const EdgeInsets.symmetric(horizontal: 24),
              child: Column(
                mainAxisAlignment: MainAxisAlignment.center,
                children: [
                  GestureDetector(
                    onLongPress: () {
                      isLongPressed = true; // 長押しが検知された場合フラグを立てる
                    },
                    onTap: () {
                      if (isLongPressed) {
                        isLongPressed = false; // フラグをリセット
                        context.push(Screen.debugMenu.path); // デバッグ画面に遷移
                      }
                    },
                    child: SvgPicture.asset(
                      Assets.images.logoLogin.path,
                    ),
                  ),
                  const SizedBox(height: 38),
                  Image.asset(
                    Assets.images.animalsLogin.path,
                  ),
                  const SizedBox(height: 54),
                  TextField(
                    controller: textEditingController,
                    decoration: const InputDecoration(
                      prefixIcon: Padding(
                        padding: EdgeInsets.all(12),
                        child: Icon(
                          Icons.email_outlined,
                          color: ColorToken.text,
                          size: 24,
                        ),
                      ),
                      hintText: 'Enter your email',
                    ),
                  ),
                  const SizedBox(height: 24),
                  ElevatedButton(
                    onPressed: () {
                      // TODO: ログイン処理
                      context.push(Screen.verificationCode.path);
                    },
                    child: const Text('Login'),
                  ),
                ],
              ),
            ),
          ),
        ),
      ),
    );
  }
}
```

### 主なポイント
1. **「長押し＋タップ」ジェスチャー**:
   - `onLongPress`で長押しを検知してフラグを設定。
   - その後に`onTap`を検知して、長押しが行われた状態であればデバッグ画面に遷移。

2. **シンプルな実装**: 必要なロジックは`isLongPressed`フラグの管理のみ。

3. **ユーザビリティ**: 長押しとタップの組み合わせは誤操作を防ぎつつ、意図的にデバッグ画面にアクセスできる仕組み。

この実装はコードを最小限に抑えつつ、比較的特殊なジェスチャーでデバッグ画面に遷移することができます。

---
