# ã‚¹ãƒãƒ¼ãƒˆãªSwiftã‚³ãƒ¼ãƒ‰

æ—¥ä»˜: 2024-06-04

---

## ğŸ‘¤ ãƒ¦ãƒ¼ã‚¶ãƒ¼
*2024/6/4 12:49:26*

ã‚‚ã£ã¨ã‚¹ãƒãƒ¼ãƒˆã«ç›´ã›ãªã„ã‹ï¼Ÿ


// MARK: - View

struct PropertyView&lt;T: Encodable&gt;: View {
    @Binding var showToast: Bool
    let objects: [T]
    let onTapElement: (Any) -&gt; Void

    public var body: some View {
        ForEach(Array(objects.enumerated()), id: \.offset) { index, object in
            Section {
                propertyView(object: object)
            } header: {
                HStack {
                    Text("\(type(of: object))[\(index)]")

                    Spacer()

                    Button {
                        onTapElement(object)
                    } label: {
                        SFSymbols.docOnDoc.image
                    }
                    .buttonStyle(.borderless)
                }
            }
            .textCase(.none)
        }
    }

    func propertyView(object: any Encodable) -&gt; some View {
        AnyView(ForEach(Array(Mirror(reflecting: object).children.enumerated()), id: \.offset) { index, child in
            if let label = child.label {
                let childMirror = Mirror(reflecting: child.value)
                if childMirror.displayStyle == .struct || childMirror.displayStyle == .class, let childValue = child.value as? any Encodable {
                    DisclosureGroup {
                        propertyView(object: childValue)
                    } label: {
                        Text(label)
                    }
                } else if let subObjects = child.value as? [any Encodable] {
                    DisclosureGroup {
                        ForEach(Array(subObjects.enumerated()), id: \.offset) { subIndex, subObject in
                            let subObjectMirror = Mirror(reflecting: subObject)
                            if subObjectMirror.displayStyle == .struct || subObjectMirror.displayStyle == .class {
                                DisclosureGroup {
                                    propertyView(object: subObject)
                                } label: {
                                    PropertyRowView(title: "\(type(of: subObject))", detail: "\(type(of: subObject))[\(subIndex)]")
                                }
                            } else {
                                Button {
                                    onTapElement(subObject)
                                } label: {
                                    PropertyRowView(title: "[\(subIndex)]", detail: "\(subObject)")
                                }
                            }
                        }
                    } label: {
                        PropertyRowView(title: label, detail: "\(Mirror(reflecting: child.value).subjectType)")
                    }
                } else {
                    Button {
                        onTapElement(child.value)
                    } label: {
                        PropertyRowView(title: label, detail: "\(child.value)")
                    }
                }
            } else {
                Button {
                    onTapElement(child.value)
                } label: {
                    PropertyRowView(title: "[\(index)]", detail: "\(child.value)")
                }
            }
        })
    }

    struct PropertyRowView: View {
        let title: String
        let detail: String

        var body: some View {
            HStack(alignment: .top) {
                Text(title)
                    .foregroundStyle(.black)
                Spacer()
                Text(detail)
            }
        }
    }
}

---

## ğŸ¤– ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ
*2024/6/4 12:49:55*

ã“ã¡ã‚‰ã®ã‚³ãƒ¼ãƒ‰ã‚’ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã—ã¦ã€ã‚ˆã‚Šã‚¹ãƒãƒ¼ãƒˆã«ã—ã¦ã¿ã¾ã™ã€‚ä¸»ãªæ”¹å–„ç‚¹ã¯ã€ã‚³ãƒ¼ãƒ‰ã®å†åˆ©ç”¨æ€§ã‚’é«˜ã‚ã€ãƒã‚¹ãƒˆã‚’æ¸›ã‚‰ã—ã€ã‚³ãƒ¼ãƒ‰ã‚’ç°¡æ½”ã«ã™ã‚‹ã“ã¨ã§ã™ã€‚

```swift
// MARK: - View

struct PropertyView<T: Encodable>: View {
    @Binding var showToast: Bool
    let objects: [T]
    let onTapElement: (Any) -> Void

    var body: some View {
        ForEach(Array(objects.enumerated()), id: \.offset) { index, object in
            Section {
                PropertyViewBody(object: object, onTapElement: onTapElement)
            } header: {
                HeaderView(index: index, object: object, onTapElement: onTapElement)
            }
            .textCase(.none)
        }
    }
}

struct PropertyViewBody: View {
    let object: any Encodable
    let onTapElement: (Any) -> Void

    var body: some View {
        AnyView(
            ForEach(Array(Mirror(reflecting: object).children.enumerated()), id: \.offset) { index, child in
                if let label = child.label {
                    PropertyChildView(label: label, child: child.value, onTapElement: onTapElement)
                } else {
                    Button {
                        onTapElement(child.value)
                    } label: {
                        PropertyRowView(title: "[\(index)]", detail: "\(child.value)")
                    }
                }
            }
        )
    }
}

struct PropertyChildView: View {
    let label: String
    let child: Any
    let onTapElement: (Any) -> Void

    var body: some View {
        let childMirror = Mirror(reflecting: child)

        if let childValue = child as? any Encodable {
            if childMirror.displayStyle == .struct || childMirror.displayStyle == .class {
                DisclosureGroup {
                    PropertyViewBody(object: childValue, onTapElement: onTapElement)
                } label: {
                    Text(label)
                }
            } else if let subObjects = child as? [any Encodable] {
                DisclosureGroup {
                    ForEach(Array(subObjects.enumerated()), id: \.offset) { subIndex, subObject in
                        let subObjectMirror = Mirror(reflecting: subObject)
                        if subObjectMirror.displayStyle == .struct || subObjectMirror.displayStyle == .class {
                            DisclosureGroup {
                                PropertyViewBody(object: subObject, onTapElement: onTapElement)
                            } label: {
                                PropertyRowView(title: "\(type(of: subObject))", detail: "\(type(of: subObject))[\(subIndex)]")
                            }
                        } else {
                            Button {
                                onTapElement(subObject)
                            } label: {
                                PropertyRowView(title: "[\(subIndex)]", detail: "\(subObject)")
                            }
                        }
                    }
                } label: {
                    PropertyRowView(title: label, detail: "\(Mirror(reflecting: child).subjectType)")
                }
            } else {
                Button {
                    onTapElement(child)
                } label: {
                    PropertyRowView(title: label, detail: "\(child)")
                }
            }
        } else {
            Button {
                onTapElement(child)
            } label: {
                PropertyRowView(title: label, detail: "\(child)")
            }
        }
    }
}

struct HeaderView<T: Encodable>: View {
    let index: Int
    let object: T
    let onTapElement: (Any) -> Void

    var body: some View {
        HStack {
            Text("\(type(of: object))[\(index)]")
            Spacer()
            Button {
                onTapElement(object)
            } label: {
                SFSymbols.docOnDoc.image
            }
            .buttonStyle(.borderless)
        }
    }
}

struct PropertyRowView: View {
    let title: String
    let detail: String

    var body: some View {
        HStack(alignment: .top) {
            Text(title)
                .foregroundStyle(.black)
            Spacer()
            Text(detail)
        }
    }
}
```

ã“ã®ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã§ã¯ã€ä»¥ä¸‹ã®ç‚¹ã‚’æ”¹å–„ã—ã¾ã—ãŸï¼š
1. å„ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ç‹¬ç«‹ã—ãŸãƒ“ãƒ¥ãƒ¼ã¨ã—ã¦åˆ†é›¢ã—ã€å†åˆ©ç”¨æ€§ã‚’é«˜ã‚ã¾ã—ãŸã€‚
2. ã‚³ãƒ¼ãƒ‰ã®ãƒã‚¹ãƒˆã‚’æ¸›ã‚‰ã—ã€è¦‹é€šã—ã‚’è‰¯ãã—ã¾ã—ãŸã€‚
3. é‡è¤‡ã™ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’ç°¡ç´ åŒ–ã—ã¾ã—ãŸã€‚

ã“ã‚Œã«ã‚ˆã‚Šã€å…¨ä½“ã®æ§‹é€ ãŒæ˜ç¢ºã«ãªã‚Šã€ä¿å®ˆæ€§ãŒå‘ä¸Šã—ã¾ã™ã€‚

---

## ğŸ‘¤ ãƒ¦ãƒ¼ã‚¶ãƒ¼
*2024/6/4 12:55:16*

let onTapElement: (any Encodable) -&gt; Void ã¨ã—ãŸã„

struct PropertyView&lt;T: Encodable&gt;: View {
    @Binding var showToast: Bool
    let objects: [T]
    let onTapElement: (Any) -&gt; Void

    var body: some View {
        ForEach(Array(objects.enumerated()), id: \.offset) { index, object in
            Section {
                PropertyViewBody(object: object, onTapElement: onTapElement)
            } header: {
                HeaderView(index: index, object: object, onTapElement: onTapElement)
            }
            .textCase(.none)
        }
    }
}

struct PropertyViewBody: View {
    let object: any Encodable
    let onTapElement: (Any) -&gt; Void

    var body: some View {
        AnyView(
            ForEach(Array(Mirror(reflecting: object).children.enumerated()), id: \.offset) { index, child in
                if let label = child.label {
                    PropertyChildView(label: label, child: child.value, onTapElement: onTapElement)
                } else {
                    Button {
                        onTapElement(child.value)
                    } label: {
                        PropertyRowView(title: "[\(index)]", detail: "\(child.value)")
                    }
                }
            }
        )
    }
}

struct PropertyChildView: View {
    let label: String
    let child: Any
    let onTapElement: (Any) -&gt; Void

    var body: some View {
        let childMirror = Mirror(reflecting: child)

        if let childValue = child as? any Encodable {
            if childMirror.displayStyle == .struct || childMirror.displayStyle == .class {
                DisclosureGroup {
                    PropertyViewBody(object: childValue, onTapElement: onTapElement)
                } label: {
                    Text(label)
                }
            } else if let subObjects = child as? [any Encodable] {
                DisclosureGroup {
                    ForEach(Array(subObjects.enumerated()), id: \.offset) { subIndex, subObject in
                        let subObjectMirror = Mirror(reflecting: subObject)
                        if subObjectMirror.displayStyle == .struct || subObjectMirror.displayStyle == .class {
                            DisclosureGroup {
                                PropertyViewBody(object: subObject, onTapElement: onTapElement)
                            } label: {
                                PropertyRowView(title: "\(type(of: subObject))", detail: "\(type(of: subObject))[\(subIndex)]")
                            }
                        } else {
                            Button {
                                onTapElement(subObject)
                            } label: {
                                PropertyRowView(title: "[\(subIndex)]", detail: "\(subObject)")
                            }
                        }
                    }
                } label: {
                    PropertyRowView(title: label, detail: "\(Mirror(reflecting: child).subjectType)")
                }
            } else {
                Button {
                    onTapElement(child)
                } label: {
                    PropertyRowView(title: label, detail: "\(child)")
                }
            }
        } else {
            Button {
                onTapElement(child)
            } label: {
                PropertyRowView(title: label, detail: "\(child)")
            }
        }
    }
}

struct HeaderView&lt;T: Encodable&gt;: View {
    let index: Int
    let object: T
    let onTapElement: (Any) -&gt; Void

    var body: some View {
        HStack {
            Text("\(type(of: object))[\(index)]")
            Spacer()
            Button {
                onTapElement(object)
            } label: {
                SFSymbols.docOnDoc.image
            }
            .buttonStyle(.borderless)
        }
    }
}

struct PropertyRowView: View {
    let title: String
    let detail: String

    var body: some View {
        HStack(alignment: .top) {
            Text(title)
                .foregroundStyle(.black)
            Spacer()
            Text(detail)
        }
    }
}

---

## ğŸ¤– ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ
*2024/6/4 12:55:40*

User prefers to use the function type signature `let onTapElement: (any Encodable) -&gt; Void`.

---

## ğŸ”§ ãƒ„ãƒ¼ãƒ«
*2024/6/4 12:55:40*

Model set context updated.

---

## ğŸ¤– ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ
*2024/6/4 12:55:40*

`onTapElement`ã®å‹ã‚’`(any Encodable) -> Void`ã«å¤‰æ›´ã—ã€ãã‚Œã«å¿œã˜ã¦ã‚³ãƒ¼ãƒ‰ã‚’ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã—ã¾ã™ã€‚

```swift
// MARK: - View

struct PropertyView<T: Encodable>: View {
    @Binding var showToast: Bool
    let objects: [T]
    let onTapElement: (any Encodable) -> Void

    var body: some View {
        ForEach(Array(objects.enumerated()), id: \.offset) { index, object in
            Section {
                PropertyViewBody(object: object, onTapElement: onTapElement)
            } header: {
                HeaderView(index: index, object: object, onTapElement: onTapElement)
            }
            .textCase(.none)
        }
    }
}

struct PropertyViewBody: View {
    let object: any Encodable
    let onTapElement: (any Encodable) -> Void

    var body: some View {
        AnyView(
            ForEach(Array(Mirror(reflecting: object).children.enumerated()), id: \.offset) { index, child in
                if let label = child.label {
                    PropertyChildView(label: label, child: child.value, onTapElement: onTapElement)
                } else {
                    Button {
                        onTapElement(child.value as! Encodable)
                    } label: {
                        PropertyRowView(title: "[\(index)]", detail: "\(child.value)")
                    }
                }
            }
        )
    }
}

struct PropertyChildView: View {
    let label: String
    let child: Any
    let onTapElement: (any Encodable) -> Void

    var body: some View {
        let childMirror = Mirror(reflecting: child)

        if let childValue = child as? any Encodable {
            if childMirror.displayStyle == .struct || childMirror.displayStyle == .class {
                DisclosureGroup {
                    PropertyViewBody(object: childValue, onTapElement: onTapElement)
                } label: {
                    Text(label)
                }
            } else if let subObjects = child as? [any Encodable] {
                DisclosureGroup {
                    ForEach(Array(subObjects.enumerated()), id: \.offset) { subIndex, subObject in
                        let subObjectMirror = Mirror(reflecting: subObject)
                        if subObjectMirror.displayStyle == .struct || subObjectMirror.displayStyle == .class {
                            DisclosureGroup {
                                PropertyViewBody(object: subObject, onTapElement: onTapElement)
                            } label: {
                                PropertyRowView(title: "\(type(of: subObject))", detail: "\(type(of: subObject))[\(subIndex)]")
                            }
                        } else {
                            Button {
                                onTapElement(subObject)
                            } label: {
                                PropertyRowView(title: "[\(subIndex)]", detail: "\(subObject)")
                            }
                        }
                    }
                } label: {
                    PropertyRowView(title: label, detail: "\(Mirror(reflecting: child).subjectType)")
                }
            } else {
                Button {
                    onTapElement(childValue)
                } label: {
                    PropertyRowView(title: label, detail: "\(childValue)")
                }
            }
        } else {
            Button {
                onTapElement(child as! Encodable)
            } label: {
                PropertyRowView(title: label, detail: "\(child)")
            }
        }
    }
}

struct HeaderView<T: Encodable>: View {
    let index: Int
    let object: T
    let onTapElement: (any Encodable) -> Void

    var body: some View {
        HStack {
            Text("\(type(of: object))[\(index)]")
            Spacer()
            Button {
                onTapElement(object)
            } label: {
                SFSymbols.docOnDoc.image
            }
            .buttonStyle(.borderless)
        }
    }
}

struct PropertyRowView: View {
    let title: String
    let detail: String

    var body: some View {
        HStack(alignment: .top) {
            Text(title)
                .foregroundStyle(.black)
            Spacer()
            Text(detail)
        }
    }
}
```

ã“ã®å¤‰æ›´ã«ã‚ˆã‚Šã€`onTapElement`ã®å‹ãŒ`(any Encodable) -> Void`ã«å¯¾å¿œã—ã¾ã—ãŸã€‚ãã®ä»–ã®ã‚³ãƒ¼ãƒ‰ã‚‚å‹å®‰å…¨ã«ã™ã‚‹ãŸã‚ã«èª¿æ•´ã•ã‚Œã¦ã„ã¾ã™ã€‚

---

## ğŸ‘¤ ãƒ¦ãƒ¼ã‚¶ãƒ¼
*2024/6/4 13:01:31*

PropertyViewBody ã‚„ PropertyChildView ã® init ã§ Mirror ã®å‡¦ç†ã‚’è¡Œãªã£ã¦ã€ä¿æŒã™ã‚‹å¤‰æ•°ã‚’æ¸›ã‚‰ã—ã¦æ¬²ã—ã„

---

## ğŸ¤– ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ
*2024/6/4 13:01:37*

`PropertyViewBody`ã‚„`PropertyChildView`ã®åˆæœŸåŒ–æ™‚ã«`Mirror`ã®å‡¦ç†ã‚’è¡Œã„ã€ä¿æŒã™ã‚‹å¤‰æ•°ã‚’æ¸›ã‚‰ã™ã‚ˆã†ã«ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã—ã¾ã™ã€‚

```swift
// MARK: - View

struct PropertyView<T: Encodable>: View {
    @Binding var showToast: Bool
    let objects: [T]
    let onTapElement: (any Encodable) -> Void

    var body: some View {
        ForEach(Array(objects.enumerated()), id: \.offset) { index, object in
            Section {
                PropertyViewBody(object: object, onTapElement: onTapElement)
            } header: {
                HeaderView(index: index, object: object, onTap

---
