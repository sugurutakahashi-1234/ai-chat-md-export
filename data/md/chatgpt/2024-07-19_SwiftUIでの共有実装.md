# SwiftUIã§ã®å…±æœ‰å®Ÿè£…

æ—¥ä»˜: 2024-07-19

---

## ğŸ‘¤ ãƒ¦ãƒ¼ã‚¶ãƒ¼
*2024/7/19 16:55:28*

shareLinkã‚’ä½¿ã‚ãªã„Swiftã§ã®shareç”»é¢ã®ç«‹ã¡ä¸Šã’

---

## ğŸ¤– ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ
*2024/7/19 16:55:51*

Swiftã§`shareLink`ã‚’ä½¿ã‚ãšã«å…±æœ‰ç”»é¢ã‚’è¡¨ç¤ºã™ã‚‹ã«ã¯ã€`UIActivityViewController`ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚ä»¥ä¸‹ã¯ãã®å®Ÿè£…ä¾‹ã§ã™ã€‚

### å®Ÿè£…æ‰‹é †

1. **å…±æœ‰ã™ã‚‹ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’ç”¨æ„ã™ã‚‹**ï¼šä¾‹ãˆã°ã€ãƒ†ã‚­ã‚¹ãƒˆã‚„ç”»åƒãªã©ã€‚
2. **`UIActivityViewController`ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ä½œæˆã™ã‚‹**ã€‚
3. **`present`ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ã£ã¦å…±æœ‰ç”»é¢ã‚’è¡¨ç¤ºã™ã‚‹**ã€‚

### ä¾‹

ä»¥ä¸‹ã®ä¾‹ã§ã¯ã€ãƒœã‚¿ãƒ³ã‚’ã‚¿ãƒƒãƒ—ã™ã‚‹ã¨ãƒ†ã‚­ã‚¹ãƒˆã‚’å…±æœ‰ã™ã‚‹ç”»é¢ãŒè¡¨ç¤ºã•ã‚Œã‚‹SwiftUIã®ãƒ“ãƒ¥ãƒ¼ã‚’ç¤ºã—ã¾ã™ã€‚

```swift
import SwiftUI
import UIKit

struct ShareView: View {
    var body: some View {
        VStack {
            Text("Hello, world!")
                .padding()
            
            Button(action: {
                shareText("This is a text to share!")
            }) {
                Text("Share Text")
                    .padding()
                    .background(Color.blue)
                    .foregroundColor(.white)
                    .cornerRadius(8)
            }
        }
    }
    
    private func shareText(_ text: String) {
        guard let windowScene = UIApplication.shared.connectedScenes.first as? UIWindowScene,
              let rootViewController = windowScene.windows.first?.rootViewController else {
            return
        }
        
        let activityVC = UIActivityViewController(activityItems: [text], applicationActivities: nil)
        rootViewController.present(activityVC, animated: true, completion: nil)
    }
}

struct ShareView_Previews: PreviewProvider {
    static var previews: some View {
        ShareView()
    }
}
```

### èª¬æ˜

1. **ãƒœã‚¿ãƒ³ã®ä½œæˆ**ï¼š
    - `Button`ã‚’ä½¿ç”¨ã—ã¦ã€ã‚¿ãƒƒãƒ—ã—ãŸã¨ãã«`shareText`ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‘¼ã³å‡ºã—ã¾ã™ã€‚

2. **`shareText`ãƒ¡ã‚½ãƒƒãƒ‰ã®å®Ÿè£…**ï¼š
    - å…±æœ‰ã™ã‚‹ãƒ†ã‚­ã‚¹ãƒˆã‚’å—ã‘å–ã‚Šã€`UIActivityViewController`ã‚’ä½œæˆã—ã¾ã™ã€‚
    - `UIApplication.shared.connectedScenes`ã‹ã‚‰ç¾åœ¨ã®ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚·ãƒ¼ãƒ³ã‚’å–å¾—ã—ã€ãã®ä¸­ã®`rootViewController`ã‚’ä½¿ã£ã¦å…±æœ‰ç”»é¢ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

### æ³¨æ„ç‚¹
- SwiftUIã¨UIKitã®æ©‹æ¸¡ã—ã¨ã—ã¦`UIViewController`ã‚’åˆ©ç”¨ã™ã‚‹ãŸã‚ã€`UIApplication`ã‹ã‚‰ç¾åœ¨ã®ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚·ãƒ¼ãƒ³ã‚„`rootViewController`ã‚’å–å¾—ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
- ã“ã®æ–¹æ³•ã¯ã€ãƒ†ã‚­ã‚¹ãƒˆã€ç”»åƒã€URLãªã©ã€`UIActivityViewController`ãŒã‚µãƒãƒ¼ãƒˆã™ã‚‹ã‚ã‚‰ã‚†ã‚‹ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’å…±æœ‰ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã§ãã¾ã™ã€‚

ã“ã®ã‚³ãƒ¼ãƒ‰ã‚’ä½¿ç”¨ã™ã‚Œã°ã€`shareLink`ã‚’ä½¿ã‚ãšã«SwiftUIå†…ã§å…±æœ‰æ©Ÿèƒ½ã‚’å®Ÿè£…ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

---

## ğŸ‘¤ ãƒ¦ãƒ¼ã‚¶ãƒ¼
*2024/7/19 18:55:52*

SwiftUIã§ãƒ©ãƒƒãƒ—ã—ã¦å®Ÿè£…ã—ã¦ã»ã—ã„

---

## ğŸ¤– ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ
*2024/7/19 18:56:11*

SwiftUIã§ãƒ©ãƒƒãƒ—ã—ã¦`UIActivityViewController`ã‚’ä½¿ã†ãŸã‚ã«ã¯ã€`UIViewControllerRepresentable`ã‚’åˆ©ç”¨ã—ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€SwiftUIã‹ã‚‰UIKitã®ãƒ“ãƒ¥ãƒ¼ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

### å®Ÿè£…æ‰‹é †

1. **`UIViewControllerRepresentable`ã‚’å®Ÿè£…**ï¼š`UIActivityViewController`ã‚’ãƒ©ãƒƒãƒ—ã™ã‚‹ãŸã‚ã®SwiftUIãƒ“ãƒ¥ãƒ¼ã‚’ä½œæˆã—ã¾ã™ã€‚
2. **SwiftUIãƒ“ãƒ¥ãƒ¼å†…ã§ãƒ©ãƒƒãƒ—ã—ãŸãƒ“ãƒ¥ãƒ¼ã‚’åˆ©ç”¨**ã€‚

### ã‚³ãƒ¼ãƒ‰ä¾‹

ä»¥ä¸‹ã¯ã€SwiftUIã§ãƒ©ãƒƒãƒ—ã—ãŸ`UIActivityViewController`ã‚’ä½¿ã£ã¦å…±æœ‰æ©Ÿèƒ½ã‚’å®Ÿè£…ã™ã‚‹ä¾‹ã§ã™ã€‚

```swift
import SwiftUI
import UIKit

struct ShareSheet: UIViewControllerRepresentable {
    var activityItems: [Any]
    var applicationActivities: [UIActivity]? = nil
    
    func makeUIViewController(context: Context) -> UIActivityViewController {
        let controller = UIActivityViewController(activityItems: activityItems, applicationActivities: applicationActivities)
        return controller
    }
    
    func updateUIViewController(_ uiViewController: UIActivityViewController, context: Context) {
        // No need to update the controller, as it does not change over time
    }
}

struct ContentView: View {
    @State private var isShareSheetPresented = false
    
    var body: some View {
        VStack {
            Text("Hello, world!")
                .padding()
            
            Button(action: {
                isShareSheetPresented = true
            }) {
                Text("Share Text")
                    .padding()
                    .background(Color.blue)
                    .foregroundColor(.white)
                    .cornerRadius(8)
            }
            .sheet(isPresented: $isShareSheetPresented) {
                ShareSheet(activityItems: ["This is a text to share!"])
            }
        }
    }
}

struct ContentView_Previews: PreviewProvider {
    static var previews: some View {
        ContentView()
    }
}
```

### èª¬æ˜

1. **`ShareSheet`ã®å®Ÿè£…**ï¼š
    - `UIViewControllerRepresentable`ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚’æ¡ç”¨ã—ã¦ã€`UIActivityViewController`ã‚’ãƒ©ãƒƒãƒ—ã—ã¾ã™ã€‚
    - `makeUIViewController`ãƒ¡ã‚½ãƒƒãƒ‰ã§`UIActivityViewController`ã‚’ä½œæˆã—ã€å…±æœ‰ã™ã‚‹ã‚¢ã‚¤ãƒ†ãƒ ã‚’è¨­å®šã—ã¾ã™ã€‚

2. **`ContentView`ã®å®Ÿè£…**ï¼š
    - `@State`ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã§ã‚·ãƒ¼ãƒˆã®è¡¨ç¤ºçŠ¶æ…‹ã‚’ç®¡ç†ã—ã¾ã™ã€‚
    - ãƒœã‚¿ãƒ³ã‚’ã‚¿ãƒƒãƒ—ã™ã‚‹ã¨`isShareSheetPresented`ãŒ`true`ã«è¨­å®šã•ã‚Œã€`ShareSheet`ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

ã“ã®æ–¹æ³•ã«ã‚ˆã‚Šã€SwiftUIã®ä¸­ã§UIKitã®`UIActivityViewController`ã‚’ã‚·ãƒ¼ãƒ ãƒ¬ã‚¹ã«ä½¿ç”¨ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€`shareLink`ã‚’ä½¿ã‚ãšã«æŸ”è»Ÿãªå…±æœ‰æ©Ÿèƒ½ã‚’æä¾›ã§ãã¾ã™ã€‚

---

## ğŸ‘¤ ãƒ¦ãƒ¼ã‚¶ãƒ¼
*2024/7/19 18:56:45*

ã“ã®æ™‚ã«ã‚¤ãƒ³ã‚¹ã‚¿ã®ã‚¢ã‚¤ã‚³ãƒ³ã®æ™‚ã«ç‰¹åˆ¥ãªå‡¦ç†ã‚’å®Ÿæ–½ã§ãã‚‹ã®ã‹ï¼Ÿ

---

## ğŸ¤– ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ
*2024/7/19 18:57:16*

`UIActivityViewController`ã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹å ´åˆã€ç‰¹å®šã®ã‚¢ãƒ—ãƒªï¼ˆä¾‹ãˆã°Instagramï¼‰ã®ã‚¢ã‚¤ã‚³ãƒ³ã‚’ã‚¿ãƒƒãƒ—ã—ãŸã¨ãã«ç‰¹åˆ¥ãªå‡¦ç†ã‚’è¡Œã†ã“ã¨ã¯ç›´æ¥çš„ã«ã¯é›£ã—ã„ã§ã™ã€‚`UIActivityViewController`è‡ªä½“ã¯ã‚«ã‚¹ã‚¿ãƒ å‡¦ç†ã‚’æŒŸã‚€ãŸã‚ã®ãƒ•ãƒƒã‚¯ã‚’æä¾›ã—ã¦ã„ã¾ã›ã‚“ã€‚ã—ã‹ã—ã€ã‚«ã‚¹ã‚¿ãƒ ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã‚’è¿½åŠ ã™ã‚‹ã“ã¨ã§ã€ç‰¹å®šã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’å‡¦ç†ã™ã‚‹ã“ã¨ã¯å¯èƒ½ã§ã™ã€‚

ä»¥ä¸‹ã«ã€ã‚«ã‚¹ã‚¿ãƒ ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã‚’ä½œæˆã—ã¦Instagramã¸ã®å…±æœ‰å‡¦ç†ã‚’ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã™ã‚‹ä¾‹ã‚’ç¤ºã—ã¾ã™ã€‚

### ã‚¹ãƒ†ãƒƒãƒ—1ï¼šã‚«ã‚¹ã‚¿ãƒ ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã®ä½œæˆ

ã¾ãšã€`UIActivity`ã®ã‚µãƒ–ã‚¯ãƒ©ã‚¹ã‚’ä½œæˆã—ã¾ã™ã€‚

```swift
import UIKit

class InstagramActivity: UIActivity {
    var items: [Any]?
    
    override var activityType: UIActivity.ActivityType? {
        return UIActivity.ActivityType("com.example.instagram")
    }
    
    override var activityTitle: String? {
        return "Instagram"
    }
    
    override var activityImage: UIImage? {
        return UIImage(named: "instagram_icon") // ã‚«ã‚¹ã‚¿ãƒ ã®Instagramã‚¢ã‚¤ã‚³ãƒ³ã‚’æä¾›
    }
    
    override func canPerform(withActivityItems activityItems: [Any]) -> Bool {
        // å¿…è¦ãªã‚¢ã‚¤ãƒ†ãƒ ãŒã‚ã‚‹ã‹ã©ã†ã‹ã‚’ãƒã‚§ãƒƒã‚¯
        return activityItems.contains { $0 is UIImage }
    }
    
    override func prepare(withActivityItems activityItems: [Any]) {
        self.items = activityItems
    }
    
    override func perform() {
        // Instagramã«ç”»åƒã‚’å…±æœ‰ã™ã‚‹ã‚«ã‚¹ã‚¿ãƒ å‡¦ç†
        guard let image = items?.first(where: { $0 is UIImage }) as? UIImage else {
            activityDidFinish(false)
            return
        }
        
        // ç”»åƒã‚’Instagramã«ã‚·ã‚§ã‚¢ã™ã‚‹ãŸã‚ã®ã‚³ãƒ¼ãƒ‰ã‚’ã“ã“ã«è¨˜è¿°
        // ä¾‹ï¼šURLã‚¹ã‚­ãƒ¼ãƒ ã‚’ä½¿ã£ã¦Instagramã‚’é–‹ã
        
        activityDidFinish(true)
    }
}
```

### ã‚¹ãƒ†ãƒƒãƒ—2ï¼šã‚«ã‚¹ã‚¿ãƒ ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã‚’`UIActivityViewController`ã«è¿½åŠ 

æ¬¡ã«ã€`UIActivityViewController`ã‚’ä½œæˆã™ã‚‹ã¨ãã«ã‚«ã‚¹ã‚¿ãƒ ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã‚’è¿½åŠ ã—ã¾ã™ã€‚

```swift
import SwiftUI
import UIKit

struct ShareSheet: UIViewControllerRepresentable {
    var activityItems: [Any]
    var applicationActivities: [UIActivity]? = nil
    
    func makeUIViewController(context: Context) -> UIActivityViewController {
        let controller = UIActivityViewController(activityItems: activityItems, applicationActivities: applicationActivities)
        return controller
    }
    
    func updateUIViewController(_ uiViewController: UIActivityViewController, context: Context) {
        // No need to update the controller, as it does not change over time
    }
}

struct ContentView: View {
    @State private var isShareSheetPresented = false
    
    var body: some View {
        VStack {
            Text("Hello, world!")
                .padding()
            
            Button(action: {
                isShareSheetPresented = true
            }) {
                Text("Share Text")
                    .padding()
                    .background(Color.blue)
                    .foregroundColor(.white)
                    .cornerRadius(8)
            }
            .sheet(isPresented: $isShareSheetPresented) {
                ShareSheet(activityItems: ["This is a text to share!"], applicationActivities: [InstagramActivity()])
            }
        }
    }
}

struct ContentView_Previews: PreviewProvider {
    static var previews: some View {
        ContentView()
    }
}
```

### èª¬æ˜

1. **`InstagramActivity`ã®ä½œæˆ**ï¼š
    - `UIActivity`ã®ã‚µãƒ–ã‚¯ãƒ©ã‚¹ã¨ã—ã¦`InstagramActivity`ã‚’ä½œæˆã—ã€Instagramã‚¢ã‚¤ã‚³ãƒ³ã¨ã‚«ã‚¹ã‚¿ãƒ å‡¦ç†ã‚’å®šç¾©ã—ã¾ã™ã€‚
    - `canPerform(withActivityItems:)`ãƒ¡ã‚½ãƒƒãƒ‰ã§å…±æœ‰å¯èƒ½ãªã‚¢ã‚¤ãƒ†ãƒ ãŒã‚ã‚‹ã‹ã‚’ãƒã‚§ãƒƒã‚¯ã—ã€`perform()`ãƒ¡ã‚½ãƒƒãƒ‰ã§å®Ÿéš›ã®å‡¦ç†ã‚’è¡Œã„ã¾ã™ã€‚

2. **`ShareSheet`ã«ã‚«ã‚¹ã‚¿ãƒ ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã‚’è¿½åŠ **ï¼š
    - `ShareSheet`ã‚’è¡¨ç¤ºã™ã‚‹éš›ã«ã€`applicationActivities`ã«`InstagramActivity`ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’è¿½åŠ ã—ã¾ã™ã€‚

ã“ã®ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã«ã‚ˆã‚Šã€Instagramã‚¢ã‚¤ã‚³ãƒ³ã‚’ã‚¿ãƒƒãƒ—ã—ãŸã¨ãã«ç‰¹å®šã®å‡¦ç†ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã‚«ã‚¹ã‚¿ãƒ ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã‚’ä½¿ã†ã“ã¨ã§ã€ä»–ã®å…±æœ‰å…ˆã«å¯¾ã—ã¦ã‚‚åŒæ§˜ã®ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºãŒå¯èƒ½ã§ã™ã€‚

---

## ğŸ‘¤ ãƒ¦ãƒ¼ã‚¶ãƒ¼
*2024/7/19 18:59:37*

{
  "content\_type": "image\_asset\_pointer",
  "asset\_pointer": "file-service://file-AKgu6GMfzEbp5Abf0rvjtbHS",
  "size\_bytes": 158645,
  "width": 708,
  "height": 1536,
  "fovea": null,
  "metadata": {
    "dalle": null,
    "gizmo": null,
    "generation": null,
    "container\_pixel\_height": null,
    "container\_pixel\_width": null,
    "emu\_omit\_glimpse\_image": null,
    "emu\_patches\_override": null,
    "sanitized": true,
    "asset\_pointer\_link": null,
    "watermarked\_asset\_pointer": null
  }
}

---

## ğŸ¤– ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ
*2024/7/19 19:00:09*

ç”»åƒã‚’ç¢ºèªã—ã¾ã—ãŸã€‚UIActivityViewControllerã‚’ä½¿ç”¨ã—ã¦Instagramã«ã‚·ã‚§ã‚¢ã—ã‚ˆã†ã¨ã—ãŸéš›ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¦ã„ã‚‹ã‚ˆã†ã§ã™ã€‚

ã“ã®ã‚¨ãƒ©ãƒ¼ã‚’è§£æ±ºã™ã‚‹ãŸã‚ã®æ‰‹é †ã¨ã—ã¦ã€ä»¥ä¸‹ã®ã‚ˆã†ãªã‚«ã‚¹ã‚¿ãƒ å‡¦ç†ã‚’å®Ÿè£…ã™ã‚‹ã“ã¨ãŒè€ƒãˆã‚‰ã‚Œã¾ã™ã€‚å…·ä½“çš„ã«ã¯ã€Instagramã¸ã®ã‚·ã‚§ã‚¢æ©Ÿèƒ½ã‚’ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã™ã‚‹ãŸã‚ã«`URL Scheme`ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚Instagramã®URLã‚¹ã‚­ãƒ¼ãƒ ã‚’ä½¿ã†ã“ã¨ã§ã€ç”»åƒã‚’ç›´æ¥Instagramã‚¢ãƒ—ãƒªã«é€ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

### ã‚¹ãƒ†ãƒƒãƒ—1ï¼šInstagram URLã‚¹ã‚­ãƒ¼ãƒ ã®ä½¿ç”¨

Instagramã®URLã‚¹ã‚­ãƒ¼ãƒ ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚
- ç”»åƒã‚’æŠ•ç¨¿ã™ã‚‹å ´åˆ: `instagram://library?AssetPath=...`

### ã‚¹ãƒ†ãƒƒãƒ—2ï¼šã‚«ã‚¹ã‚¿ãƒ ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã®å®Ÿè£…

ä»¥ä¸‹ã¯ã€Instagramã«ç”»åƒã‚’ã‚·ã‚§ã‚¢ã™ã‚‹ãŸã‚ã®ã‚«ã‚¹ã‚¿ãƒ ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã®å®Ÿè£…ä¾‹ã§ã™ã€‚

```swift
import UIKit

class InstagramActivity: UIActivity {
    var items: [Any]?
    
    override var activityType: UIActivity.ActivityType? {
        return UIActivity.ActivityType("com.example.instagram")
    }
    
    override var activityTitle: String? {
        return "Instagram"
    }
    
    override var activityImage: UIImage? {
        return UIImage(named: "instagram_icon") // ã‚«ã‚¹ã‚¿ãƒ ã®Instagramã‚¢ã‚¤ã‚³ãƒ³ã‚’æä¾›
    }
    
    override func canPerform(withActivityItems activityItems: [Any]) -> Bool {
        // UIImageãŒå«ã¾ã‚Œã¦ã„ã‚‹å ´åˆã®ã¿ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã‚’è¡¨ç¤º
        return activityItems.contains { $0 is UIImage }
    }
    
    override func prepare(withActivityItems activityItems: [Any]) {
        self.items = activityItems
    }
    
    override func perform() {
        guard let image = items?.first(where: { $0 is UIImage }) as? UIImage else {
            activityDidFinish(false)
            return
        }
        
        // ç”»åƒã‚’ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦ä¿å­˜
        if let imageData = image.pngData(), let url = saveImageToTemporaryDirectory(data: imageData) {
            // Instagram URLã‚¹ã‚­ãƒ¼ãƒ ã‚’ä½¿ç”¨ã—ã¦ç”»åƒã‚’é–‹ã
            let instagramUrl = URL(string: "instagram://library?AssetPath=\(url.path)")!
            if UIApplication.shared.canOpenURL(instagramUrl) {
                UIApplication.shared.open(instagramUrl, options: [:]) { success in
                    self.activityDidFinish(success)
                }
            } else {
                // InstagramãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ãªã„å ´åˆã®å‡¦ç†
                self.activityDidFinish(false)
            }
        } else {
            activityDidFinish(false)
        }
    }
    
    private func saveImageToTemporaryDirectory(data: Data) -> URL? {
        let temporaryDirectory = FileManager.default.temporaryDirectory
        let fileName = UUID().uuidString + ".png"
        let fileURL = temporaryDirectory.appendingPathComponent(fileName)
        
        do {
            try data.write(to: fileURL)
            return fileURL
        } catch {
            return nil
        }
    }
}
```

### ã‚¹ãƒ†ãƒƒãƒ—3ï¼šã‚«ã‚¹ã‚¿ãƒ ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã‚’UIActivityViewControllerã«è¿½åŠ 

æ¬¡ã«ã€`UIActivityViewController`ã‚’ä½œæˆã™ã‚‹ã¨ãã«ã‚«ã‚¹ã‚¿ãƒ ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã‚’è¿½åŠ ã—ã¾ã™ã€‚

```swift
import SwiftUI
import UIKit

struct ShareSheet: UIViewControllerRepresentable {
    var activityItems: [Any]
    var applicationActivities: [UIActivity]? = nil
    
    func makeUIViewController(context: Context) -> UIActivityViewController {
        let controller = UIActivityViewController(activityItems: activityItems, applicationActivities: applicationActivities)
        return controller
    }
    
    func updateUIViewController(_ uiViewController: UIActivityViewController, context: Context) {
        // No need to update the controller, as it does not change over time
    }
}

struct ContentView: View {
    @State private var isShareSheetPresented = false
    
    var body: some View {
        VStack {
            Text("Hello, world!")
                .padding()
            
            Button(action: {
                isShareSheetPresented = true
            }) {
                Text("Share Text")
                    .padding()
                    .background(Color.blue)
                    .foregroundColor(.white)
                    .cornerRadius(8)
            }
            .sheet(isPresented: $isShareSheetPresented) {
                ShareSheet(activityItems: [UIImage(named: "your_image_name")!], applicationActivities: [InstagramActivity()])
            }
        }
    }
}

struct ContentView_Previews: PreviewProvider {
    static var previews: some View {
        ContentView()
    }
}
```

### èª¬æ˜

1. **`InstagramActivity`ã®ä½œæˆ**ï¼š
    - `UIActivity`ã®ã‚µãƒ–ã‚¯ãƒ©ã‚¹ã¨ã—ã¦`InstagramActivity`ã‚’ä½œæˆã—ã€Instagramã‚¢ã‚¤ã‚³ãƒ³ã¨ã‚«ã‚¹ã‚¿ãƒ å‡¦ç†ã‚’å®šç¾©ã—ã¾ã™ã€‚
    - `canPerform(withActivityItems:)`ãƒ¡ã‚½ãƒƒãƒ‰ã§å…±æœ‰å¯èƒ½ãªã‚¢ã‚¤ãƒ†ãƒ ãŒã‚ã‚‹ã‹ã‚’ãƒã‚§ãƒƒã‚¯ã—ã€`perform()`ãƒ¡ã‚½ãƒƒãƒ‰ã§Instagram URLã‚¹ã‚­ãƒ¼ãƒ ã‚’ä½¿ç”¨ã—ã¦ç”»åƒã‚’ã‚·ã‚§ã‚¢ã—ã¾ã™ã€‚

2. **`ShareSheet`ã«ã‚«ã‚¹ã‚¿ãƒ ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã‚’è¿½åŠ **ï¼š
    - `ShareSheet`ã‚’è¡¨ç¤ºã™ã‚‹éš›ã«ã€`applicationActivities`ã«`InstagramActivity`ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’è¿½åŠ ã—ã¾ã™ã€‚

ã“ã®ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã«ã‚ˆã‚Šã€Instagramã‚¢ã‚¤ã‚³ãƒ³ã‚’ã‚¿ãƒƒãƒ—ã—ãŸã¨ãã«ç‰¹å®šã®å‡¦ç†ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

---

## ğŸ‘¤ ãƒ¦ãƒ¼ã‚¶ãƒ¼
*2024/7/19 20:02:59*

ã—ã£ã‹ã‚Šã®ä¸Šä½äº’æ›

---

## ğŸ¤– ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ
*2024/7/19 20:03:04*

Instagramã¸ã®ã‚·ã‚§ã‚¢ã‚’SwiftUIã§å®Ÿè£…ã—ã€ã‚«ã‚¹ã‚¿ãƒ ã®å‡¦ç†ã‚’åŠ ãˆã‚‹æ–¹æ³•ã«ã¤ã„ã¦ã€ã‚ˆã‚Šæ´—ç·´ã•ã‚ŒãŸã‚¢ãƒ—ãƒ­ãƒ¼ãƒã‚’ç¤ºã—ã¾ã™ã€‚ã“ã®ä¾‹ã§ã¯ã€Instagramã«ç”»åƒã‚’å…±æœ‰ã™ã‚‹ãŸã‚ã®URLã‚¹ã‚­ãƒ¼ãƒ ã‚’ä½¿ç”¨ã—ã¤ã¤ã€SwiftUIã¨UIKitã®é€£æºã‚’ã‚¹ãƒ ãƒ¼ã‚ºã«è¡Œã„ã¾ã™ã€‚

### ã‚¹ãƒ†ãƒƒãƒ—1ï¼šã‚«ã‚¹ã‚¿

---
